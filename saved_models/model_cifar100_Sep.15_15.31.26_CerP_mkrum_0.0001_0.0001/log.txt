current path: saved_models/model_cifar100_Sep.15_15.31.26_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4752/5308 (89.5252%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43916113050466. Distance: 2.2815452280136643
Total norm for 4 adversaries is: 42.43916113050466. distance: 2.2815452280136643
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5327/5777 (92.2105%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.426719048941465. Distance: 2.120499388878394
Total norm for 4 adversaries is: 42.426719048941465. distance: 2.120499388878394
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4572/5123 (89.2446%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.435867570315004. Distance: 2.2383916005465756
Total norm for 4 adversaries is: 42.435867570315004. distance: 2.2383916005465756
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4939/5503 (89.7510%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.440869654051475. Distance: 2.289390254072712
Total norm for 4 adversaries is: 42.440869654051475. distance: 2.289390254072712
___Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 6225/6947 (89.6070%)
___Train Local_ResNet_18, epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6115/6947 (88.0236%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1907, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18, epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3564/4028 (88.4806%)
___Train Local_ResNet_18, epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4028 (91.7329%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0724, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4145/4736 (87.5211%)
___Train Local_ResNet_18, epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4244/4736 (89.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0113, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18, epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3477/3959 (87.8252%)
___Train Local_ResNet_18, epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3589/3959 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9444, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18, epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5477/6235 (87.8428%)
___Train Local_ResNet_18, epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5554/6235 (89.0778%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2503, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18, epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4578/5224 (87.6340%)
___Train Local_ResNet_18, epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4734/5224 (90.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4141, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18, epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3467/3929 (88.2413%)
___Train Local_ResNet_18, epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3559/3929 (90.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9358, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18, epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4613/5068 (91.0221%)
___Train Local_ResNet_18, epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4669/5068 (92.1271%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0220, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18, epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4284/4732 (90.5325%)
___Train Local_ResNet_18, epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4435/4732 (93.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8173, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18, epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4911 (89.4115%)
___Train Local_ResNet_18, epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4527/4911 (92.1808%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0313, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4350/4869 (89.3407%)
___Train Local_ResNet_18, epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0134, Accuracy: 3705/4869 (76.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.5396, Accuracy: 4553/10000 (45.5300%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3776/4249 (88.8680%)
___Train Local_ResNet_18, epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3833/4249 (90.2095%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1538, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4352/4929 (88.2938%)
___Train Local_ResNet_18, epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4473/4929 (90.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0985, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18, epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5095/5696 (89.4487%)
___Train Local_ResNet_18, epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5192/5696 (91.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0874, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18, epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3903/4364 (89.4363%)
___Train Local_ResNet_18, epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3981/4364 (91.2236%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9633, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4565/5035 (90.6653%)
___Train Local_ResNet_18, epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4641/5035 (92.1748%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9746, Accuracy: 5522/10000 (55.2200%)
time spent on training: 221.955504655838
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1047, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8372, Accuracy: 133/9900 (1.3434%)
Done in 249.20709228515625 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4856/5308 (91.4846%), train_poison_data_count: 415
Global model norm: 42.45310487209681.
Norm before scaling: 42.452841770770334. Distance: 2.0459211616801833
Total norm for 4 adversaries is: 42.452841770770334. distance: 2.0459211616801833
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5375/5777 (93.0414%), train_poison_data_count: 455
Global model norm: 42.45310487209681.
Norm before scaling: 42.44692946832624. Distance: 2.0298971512771735
Total norm for 4 adversaries is: 42.44692946832624. distance: 2.0298971512771735
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4637/5123 (90.5134%), train_poison_data_count: 403
Global model norm: 42.45310487209681.
Norm before scaling: 42.45661992193105. Distance: 2.0832197794167153
Total norm for 4 adversaries is: 42.45661992193105. distance: 2.0832197794167153
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5009/5503 (91.0231%), train_poison_data_count: 430
Global model norm: 42.45310487209681.
Norm before scaling: 42.45773260099022. Distance: 2.142000633453361
Total norm for 4 adversaries is: 42.45773260099022. distance: 2.142000633453361
___Train Local_ResNet_18, epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4504/5123 (87.9172%)
___Train Local_ResNet_18, epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4321/5123 (84.3451%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2322, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4624/5068 (91.2391%)
___Train Local_ResNet_18, epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4645/5068 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0832, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18, epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4380/5018 (87.2858%)
___Train Local_ResNet_18, epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4434/5018 (88.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1431, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3762/4161 (90.4110%)
___Train Local_ResNet_18, epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3833/4161 (92.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9834, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4270/4894 (87.2497%)
___Train Local_ResNet_18, epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4355/4894 (88.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0718, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4489/4956 (90.5771%)
___Train Local_ResNet_18, epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4532/4956 (91.4447%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1349, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18, epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4040/4587 (88.0750%)
___Train Local_ResNet_18, epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4160/4587 (90.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9466, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6175/6947 (88.8873%)
___Train Local_ResNet_18, epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6118/6947 (88.0668%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0872, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18, epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4495/5055 (88.9219%)
___Train Local_ResNet_18, epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4550/5055 (90.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1048, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4410/4929 (89.4705%)
___Train Local_ResNet_18, epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0801, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18, epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4189/4797 (87.3254%)
___Train Local_ResNet_18, epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4279/4797 (89.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1063, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18, epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4933/5645 (87.3871%)
___Train Local_ResNet_18, epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4900/5645 (86.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1533, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18, epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4875/5362 (90.9176%)
___Train Local_ResNet_18, epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4894/5362 (91.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9910, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18, epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4871/5489 (88.7411%)
___Train Local_ResNet_18, epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4950/5489 (90.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0549, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3697/4108 (89.9951%)
___Train Local_ResNet_18, epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3770/4108 (91.7722%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9716, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3725/4130 (90.1937%)
___Train Local_ResNet_18, epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3772/4130 (91.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9587, Accuracy: 5496/10000 (54.9600%)
time spent on training: 217.40323543548584
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0961, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.5137, Accuracy: 320/9900 (3.2323%)
Done in 244.4304666519165 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4901/5308 (92.3323%), train_poison_data_count: 415
Global model norm: 42.47610484050856.
Norm before scaling: 42.474006872034394. Distance: 1.9538432517223652
Total norm for 4 adversaries is: 42.474006872034394. distance: 1.9538432517223652
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5445/5777 (94.2531%), train_poison_data_count: 455
Global model norm: 42.47610484050856.
Norm before scaling: 42.46376844863601. Distance: 1.8750034332243959
Total norm for 4 adversaries is: 42.46376844863601. distance: 1.8750034332243959
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4624/5123 (90.2596%), train_poison_data_count: 403
Global model norm: 42.47610484050856.
Norm before scaling: 42.47856048156455. Distance: 2.0688437956323136
Total norm for 4 adversaries is: 42.47856048156455. distance: 2.0688437956323136
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5042/5503 (91.6228%), train_poison_data_count: 430
Global model norm: 42.47610484050856.
Norm before scaling: 42.477116426634645. Distance: 2.0328932937411626
Total norm for 4 adversaries is: 42.477116426634645. distance: 2.0328932937411626
___Train Local_ResNet_18, epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4116/4537 (90.7207%)
___Train Local_ResNet_18, epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4200/4537 (92.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9034, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18, epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4508/5123 (87.9953%)
___Train Local_ResNet_18, epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4297/5123 (83.8766%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0594, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3886/4196 (92.6120%)
___Train Local_ResNet_18, epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3923/4196 (93.4938%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9083, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4168/4605 (90.5103%)
___Train Local_ResNet_18, epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4238/4605 (92.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9291, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4212/4851 (86.8275%)
___Train Local_ResNet_18, epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4355/4851 (89.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9884, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18, epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3699/4145 (89.2400%)
___Train Local_ResNet_18, epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3777/4145 (91.1218%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9479, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4569/5035 (90.7448%)
___Train Local_ResNet_18, epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4585/5035 (91.0626%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9625, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18, epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3664/4175 (87.7605%)
___Train Local_ResNet_18, epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3709/4175 (88.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8483, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5443/5939 (91.6484%)
___Train Local_ResNet_18, epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5457/5939 (91.8842%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0141, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18, epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3968/4368 (90.8425%)
___Train Local_ResNet_18, epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3962/4368 (90.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3657, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4086/4587 (89.0778%)
___Train Local_ResNet_18, epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4091/4587 (89.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0075, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4147/4397 (94.3143%)
___Train Local_ResNet_18, epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4183/4397 (95.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7211, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18, epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4327/4869 (88.8684%)
___Train Local_ResNet_18, epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4023/4869 (82.6248%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2830, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18, epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5112/5696 (89.7472%)
___Train Local_ResNet_18, epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5145/5696 (90.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0108, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3144/3552 (88.5135%)
___Train Local_ResNet_18, epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3286/3552 (92.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8933, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4124/4736 (87.0777%)
___Train Local_ResNet_18, epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4203/4736 (88.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9210, Accuracy: 5511/10000 (55.1100%)
time spent on training: 216.04648232460022
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0926, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4769, Accuracy: 612/9900 (6.1818%)
Done in 243.0254430770874 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4891/5308 (92.1439%), train_poison_data_count: 415
Global model norm: 42.4966034373447.
Norm before scaling: 42.50058306125782. Distance: 1.989955414603243
Total norm for 4 adversaries is: 42.50058306125782. distance: 1.989955414603243
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5421/5777 (93.8376%), train_poison_data_count: 455
Global model norm: 42.4966034373447.
Norm before scaling: 42.48769784035654. Distance: 1.8698570927159583
Total norm for 4 adversaries is: 42.48769784035654. distance: 1.8698570927159583
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4674/5123 (91.2356%), train_poison_data_count: 403
Global model norm: 42.4966034373447.
Norm before scaling: 42.49589105826512. Distance: 1.9757199508310732
Total norm for 4 adversaries is: 42.49589105826512. distance: 1.9757199508310732
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5057/5503 (91.8953%), train_poison_data_count: 430
Global model norm: 42.4966034373447.
Norm before scaling: 42.49543863389928. Distance: 2.0254780852545493
Total norm for 4 adversaries is: 42.49543863389928. distance: 2.0254780852545493
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4619/5068 (91.1405%)
___Train Local_ResNet_18, epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4658/5068 (91.9100%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0907, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18, epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3508/3959 (88.6082%)
___Train Local_ResNet_18, epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3592/3959 (90.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9463, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18, epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5465/6068 (90.0626%)
___Train Local_ResNet_18, epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5593/6068 (92.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1328, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18, epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5293/5907 (89.6056%)
___Train Local_ResNet_18, epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5438/5907 (92.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3077, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18, epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4494/4956 (90.6780%)
___Train Local_ResNet_18, epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4956 (91.5456%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9822, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4280/4903 (87.2935%)
___Train Local_ResNet_18, epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4322/4903 (88.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8832, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5106/5727 (89.1566%)
___Train Local_ResNet_18, epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5079/5727 (88.6852%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0002, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18, epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4901/5346 (91.6760%)
___Train Local_ResNet_18, epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4961/5346 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0349, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5396/5871 (91.9094%)
___Train Local_ResNet_18, epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5390/5871 (91.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0325, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4345/4889 (88.8730%)
___Train Local_ResNet_18, epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4355/4889 (89.0775%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9483, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4810/5497 (87.5023%)
___Train Local_ResNet_18, epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4876/5497 (88.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2530, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4255/4818 (88.3147%)
___Train Local_ResNet_18, epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4314/4818 (89.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0004, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18, epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4107/4397 (93.4046%)
___Train Local_ResNet_18, epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4159/4397 (94.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8130, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3761/4130 (91.0654%)
___Train Local_ResNet_18, epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3793/4130 (91.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9480, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18, epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3920/4364 (89.8258%)
___Train Local_ResNet_18, epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3960/4364 (90.7424%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1460, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18, epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4842/5702 (84.9176%)
___Train Local_ResNet_18, epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4606/5702 (80.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2887, Accuracy: 4997/10000 (49.9700%)
time spent on training: 223.6438410282135
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0900, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.6817, Accuracy: 1001/9900 (10.1111%)
Done in 250.26507425308228 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4935/5308 (92.9729%), train_poison_data_count: 415
Global model norm: 42.51884060790728.
Norm before scaling: 42.516400213439695. Distance: 1.8661801481876026
Total norm for 4 adversaries is: 42.516400213439695. distance: 1.8661801481876026
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5434/5777 (94.0627%), train_poison_data_count: 455
Global model norm: 42.51884060790728.
Norm before scaling: 42.50528459791794. Distance: 1.8164389330476969
Total norm for 4 adversaries is: 42.50528459791794. distance: 1.8164389330476969
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4701/5123 (91.7626%), train_poison_data_count: 403
Global model norm: 42.51884060790728.
Norm before scaling: 42.51959997267069. Distance: 1.956876463108253
Total norm for 4 adversaries is: 42.51959997267069. distance: 1.956876463108253
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5093/5503 (92.5495%), train_poison_data_count: 430
Global model norm: 42.51884060790728.
Norm before scaling: 42.51854346148205. Distance: 1.9672179543195927
Total norm for 4 adversaries is: 42.51854346148205. distance: 1.9672179543195927
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4508/4956 (90.9605%)
___Train Local_ResNet_18, epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4522/4956 (91.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0399, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18, epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3705/4145 (89.3848%)
___Train Local_ResNet_18, epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3804/4145 (91.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8956, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4251/4797 (88.6179%)
___Train Local_ResNet_18, epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4345/4797 (90.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9888, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18, epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4647/5193 (89.4858%)
___Train Local_ResNet_18, epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4635/5193 (89.2548%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1218, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5415/5871 (92.2330%)
___Train Local_ResNet_18, epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5408/5871 (92.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0698, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18, epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3888/4196 (92.6597%)
___Train Local_ResNet_18, epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3914/4196 (93.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8828, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18, epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4430/4979 (88.9737%)
___Train Local_ResNet_18, epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4536/4979 (91.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0256, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4807/5362 (89.6494%)
___Train Local_ResNet_18, epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4875/5362 (90.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1755, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5019/5727 (87.6375%)
___Train Local_ResNet_18, epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5093/5727 (88.9296%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2332, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4878/5461 (89.3243%)
___Train Local_ResNet_18, epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4947/5461 (90.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3194, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18, epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5129/5696 (90.0456%)
___Train Local_ResNet_18, epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5143/5696 (90.2914%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0298, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4187/4605 (90.9229%)
___Train Local_ResNet_18, epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4259/4605 (92.4864%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9372, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18, epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4349/4843 (89.7997%)
___Train Local_ResNet_18, epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4384/4843 (90.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1315, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4908/5298 (92.6387%)
___Train Local_ResNet_18, epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4947/5298 (93.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8681, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18, epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4741/5427 (87.3595%)
___Train Local_ResNet_18, epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4835/5427 (89.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0540, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4449/4830 (92.1118%)
___Train Local_ResNet_18, epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4526/4830 (93.7060%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0904, Accuracy: 5333/10000 (53.3300%)
time spent on training: 221.75840520858765
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0917, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.9109, Accuracy: 1543/9900 (15.5859%)
Done in 248.31688451766968 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4957/5308 (93.3873%), train_poison_data_count: 415
Global model norm: 42.541568308886866.
Norm before scaling: 42.537559517755156. Distance: 1.8438897160756222
Total norm for 4 adversaries is: 42.537559517755156. distance: 1.8438897160756222
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5457/5777 (94.4608%), train_poison_data_count: 455
Global model norm: 42.541568308886866.
Norm before scaling: 42.533094019998856. Distance: 1.8197655899925
Total norm for 4 adversaries is: 42.533094019998856. distance: 1.8197655899925
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4727/5123 (92.2702%), train_poison_data_count: 403
Global model norm: 42.541568308886866.
Norm before scaling: 42.538495031798114. Distance: 1.8700364217424186
Total norm for 4 adversaries is: 42.538495031798114. distance: 1.8700364217424186
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5090/5503 (92.4950%), train_poison_data_count: 430
Global model norm: 42.541568308886866.
Norm before scaling: 42.53787231461733. Distance: 1.9236974991344844
Total norm for 4 adversaries is: 42.53787231461733. distance: 1.9236974991344844
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3934/4364 (90.1467%)
___Train Local_ResNet_18, epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3861/4364 (88.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1304, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4739/5353 (88.5298%)
___Train Local_ResNet_18, epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4782/5353 (89.3331%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2314, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18, epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4236/4672 (90.6678%)
___Train Local_ResNet_18, epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4324/4672 (92.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9342, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18, epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3731/4145 (90.0121%)
___Train Local_ResNet_18, epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3787/4145 (91.3631%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0601, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3896/4313 (90.3316%)
___Train Local_ResNet_18, epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3931/4313 (91.1431%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8707, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18, epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4406/4889 (90.1207%)
___Train Local_ResNet_18, epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4437/4889 (90.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0082, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4406/5050 (87.2475%)
___Train Local_ResNet_18, epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4475/5050 (88.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9726, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18, epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4773/5702 (83.7075%)
___Train Local_ResNet_18, epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4651/5702 (81.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1998, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18, epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4958/5461 (90.7892%)
___Train Local_ResNet_18, epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4977/5461 (91.1372%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1902, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18, epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4502/5122 (87.8954%)
___Train Local_ResNet_18, epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4210/5122 (82.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.4521, Accuracy: 4827/10000 (48.2700%)
___Train Local_ResNet_18, epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4309/4714 (91.4086%)
___Train Local_ResNet_18, epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4377/4714 (92.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0332, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18, epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3574/3968 (90.0706%)
___Train Local_ResNet_18, epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3657/3968 (92.1623%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7749, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18, epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3482/3959 (87.9515%)
___Train Local_ResNet_18, epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3587/3959 (90.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8817, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4495/4956 (90.6981%)
___Train Local_ResNet_18, epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4496/4956 (90.7183%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1056, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18, epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4299/4818 (89.2279%)
___Train Local_ResNet_18, epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4344/4818 (90.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1311, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18, epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3998/4368 (91.5293%)
___Train Local_ResNet_18, epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9018, Accuracy: 5550/10000 (55.5000%)
time spent on training: 212.00398635864258
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0943, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.1997, Accuracy: 2280/9900 (23.0303%)
Done in 238.97280192375183 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4958/5308 (93.4062%), train_poison_data_count: 415
Global model norm: 42.562640532991196.
Norm before scaling: 42.558166193641675. Distance: 1.8195891027560733
Total norm for 4 adversaries is: 42.558166193641675. distance: 1.8195891027560733
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5470/5777 (94.6858%), train_poison_data_count: 455
Global model norm: 42.562640532991196.
Norm before scaling: 42.55103782885325. Distance: 1.7632213198677877
Total norm for 4 adversaries is: 42.55103782885325. distance: 1.7632213198677877
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4708/5123 (91.8993%), train_poison_data_count: 403
Global model norm: 42.562640532991196.
Norm before scaling: 42.56118642429684. Distance: 1.8737441625625042
Total norm for 4 adversaries is: 42.56118642429684. distance: 1.8737441625625042
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5120/5503 (93.0402%), train_poison_data_count: 430
Global model norm: 42.562640532991196.
Norm before scaling: 42.557301387272986. Distance: 1.8391646571538007
Total norm for 4 adversaries is: 42.557301387272986. distance: 1.8391646571538007
___Train Local_ResNet_18, epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4356/4732 (92.0541%)
___Train Local_ResNet_18, epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4438/4732 (93.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8327, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18, epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4556/5035 (90.4866%)
___Train Local_ResNet_18, epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4646/5035 (92.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9350, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4246/4797 (88.5137%)
___Train Local_ResNet_18, epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4310/4797 (89.8478%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1327, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4860/5702 (85.2333%)
___Train Local_ResNet_18, epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4562/5702 (80.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1718, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3765/4161 (90.4831%)
___Train Local_ResNet_18, epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3837/4161 (92.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0885, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4982/5526 (90.1556%)
___Train Local_ResNet_18, epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4913/5526 (88.9070%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1019, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4828/5497 (87.8297%)
___Train Local_ResNet_18, epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4935/5497 (89.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0523, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18, epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5480/5939 (92.2714%)
___Train Local_ResNet_18, epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5445/5939 (91.6821%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1704, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18, epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4613/5193 (88.8311%)
___Train Local_ResNet_18, epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4551/5193 (87.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2606, Accuracy: 4901/10000 (49.0100%)
___Train Local_ResNet_18, epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4978/5559 (89.5485%)
___Train Local_ResNet_18, epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4917/5559 (88.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0892, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18, epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3556/3968 (89.6169%)
___Train Local_ResNet_18, epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3676/3968 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.7815, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18, epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3701/4086 (90.5776%)
___Train Local_ResNet_18, epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3770/4086 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8601, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18, epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4022/4527 (88.8447%)
___Train Local_ResNet_18, epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4031/4527 (89.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0832, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4008/4485 (89.3645%)
___Train Local_ResNet_18, epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3947/4485 (88.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0904, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18, epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5601/6419 (87.2566%)
___Train Local_ResNet_18, epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5621/6419 (87.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1929, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18, epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4914/5489 (89.5245%)
___Train Local_ResNet_18, epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4978/5489 (90.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9747, Accuracy: 5476/10000 (54.7600%)
time spent on training: 223.31111884117126
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0991, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.6390, Accuracy: 2994/9900 (30.2424%)
Done in 250.18596935272217 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4986/5308 (93.9337%), train_poison_data_count: 415
Global model norm: 42.58631228623376.
Norm before scaling: 42.57964446830052. Distance: 1.7694732454405622
Total norm for 4 adversaries is: 42.57964446830052. distance: 1.7694732454405622
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5484/5777 (94.9282%), train_poison_data_count: 455
Global model norm: 42.58631228623376.
Norm before scaling: 42.572470954868535. Distance: 1.719563031801965
Total norm for 4 adversaries is: 42.572470954868535. distance: 1.719563031801965
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4743/5123 (92.5825%), train_poison_data_count: 403
Global model norm: 42.58631228623376.
Norm before scaling: 42.585211566230655. Distance: 1.8659286405282436
Total norm for 4 adversaries is: 42.585211566230655. distance: 1.8659286405282436
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5126/5503 (93.1492%), train_poison_data_count: 430
Global model norm: 42.58631228623376.
Norm before scaling: 42.58021353822615. Distance: 1.8733029633002694
Total norm for 4 adversaries is: 42.58021353822615. distance: 1.8733029633002694
___Train Local_ResNet_18, epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4851/5427 (89.3864%)
___Train Local_ResNet_18, epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4873/5427 (89.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9220, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4379/4748 (92.2283%)
___Train Local_ResNet_18, epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4367/4748 (91.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8777, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18, epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5015/5645 (88.8397%)
___Train Local_ResNet_18, epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4890/5645 (86.6253%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1742, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3539/3910 (90.5115%)
___Train Local_ResNet_18, epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3351/3910 (85.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1764, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4630/5224 (88.6294%)
___Train Local_ResNet_18, epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4658/5224 (89.1654%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1342, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18, epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4653/5068 (91.8114%)
___Train Local_ResNet_18, epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4586/5068 (90.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0465, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4542/5086 (89.3040%)
___Train Local_ResNet_18, epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4598/5086 (90.4050%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8840, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18, epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4865/5489 (88.6318%)
___Train Local_ResNet_18, epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4961/5489 (90.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0520, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18, epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5491/6235 (88.0674%)
___Train Local_ResNet_18, epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5465/6235 (87.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2596, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4148/4397 (94.3370%)
___Train Local_ResNet_18, epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4194/4397 (95.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8530, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4466/4929 (90.6066%)
___Train Local_ResNet_18, epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4462/4929 (90.5255%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9000, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18, epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6264/6947 (90.1684%)
___Train Local_ResNet_18, epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6124/6947 (88.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1693, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18, epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4257/4731 (89.9810%)
___Train Local_ResNet_18, epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4374/4731 (92.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9323, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18, epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5275/6080 (86.7599%)
___Train Local_ResNet_18, epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5399/6080 (88.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2431, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3214/3552 (90.4842%)
___Train Local_ResNet_18, epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8997, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4275/4737 (90.2470%)
___Train Local_ResNet_18, epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4310/4737 (90.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0752, Accuracy: 5391/10000 (53.9100%)
time spent on training: 224.91602277755737
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1016, Accuracy: 7058/10000 (70.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 3.1290, Accuracy: 3703/9900 (37.4040%)
Done in 251.53063011169434 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4972/5308 (93.6699%), train_poison_data_count: 415
Global model norm: 42.60882923880405.
Norm before scaling: 42.603232276326466. Distance: 1.7910458428049945
Total norm for 4 adversaries is: 42.603232276326466. distance: 1.7910458428049945
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5496/5777 (95.1359%), train_poison_data_count: 455
Global model norm: 42.60882923880405.
Norm before scaling: 42.594710072635486. Distance: 1.6857611563080173
Total norm for 4 adversaries is: 42.594710072635486. distance: 1.6857611563080173
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4742/5123 (92.5630%), train_poison_data_count: 403
Global model norm: 42.60882923880405.
Norm before scaling: 42.599750815365695. Distance: 1.768550238769598
Total norm for 4 adversaries is: 42.599750815365695. distance: 1.768550238769598
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5129/5503 (93.2037%), train_poison_data_count: 430
Global model norm: 42.60882923880405.
Norm before scaling: 42.605594636572526. Distance: 1.8397573138948358
Total norm for 4 adversaries is: 42.605594636572526. distance: 1.8397573138948358
___Train Local_ResNet_18, epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4236/4549 (93.1194%)
___Train Local_ResNet_18, epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4241/4549 (93.2293%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8382, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4280/4737 (90.3525%)
___Train Local_ResNet_18, epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4351/4737 (91.8514%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0574, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18, epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3215/3552 (90.5124%)
___Train Local_ResNet_18, epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3271/3552 (92.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0374, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5032/5422 (92.8071%)
___Train Local_ResNet_18, epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5055/5422 (93.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9228, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18, epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4897/5454 (89.7873%)
___Train Local_ResNet_18, epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4878/5454 (89.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2199, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4387/4748 (92.3968%)
___Train Local_ResNet_18, epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4418/4748 (93.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8755, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18, epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4718/5399 (87.3866%)
___Train Local_ResNet_18, epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4699/5399 (87.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3041, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5404/5871 (92.0456%)
___Train Local_ResNet_18, epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5352/5871 (91.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0324, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18, epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4444/4830 (92.0083%)
___Train Local_ResNet_18, epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4470/4830 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9899, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18, epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4563/4993 (91.3879%)
___Train Local_ResNet_18, epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4597/4993 (92.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0630, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18, epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4350/4903 (88.7212%)
___Train Local_ResNet_18, epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0569, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4604/5086 (90.5230%)
___Train Local_ResNet_18, epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4632/5086 (91.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9983, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18, epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3760/4111 (91.4619%)
___Train Local_ResNet_18, epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3773/4111 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8599, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18, epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4332/4869 (88.9710%)
___Train Local_ResNet_18, epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3951/4869 (81.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2671, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18, epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3561/3910 (91.0742%)
___Train Local_ResNet_18, epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3448/3910 (88.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1147, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18, epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3723/4175 (89.1737%)
___Train Local_ResNet_18, epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3745/4175 (89.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1245, Accuracy: 5280/10000 (52.8000%)
time spent on training: 218.09544348716736
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1079, Accuracy: 7030/10000 (70.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.6622, Accuracy: 4408/9900 (44.5253%)
Done in 244.85639810562134 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5011/5308 (94.4047%), train_poison_data_count: 415
Global model norm: 42.63006293245414.
Norm before scaling: 42.621967107093084. Distance: 1.7303625207677111
Total norm for 4 adversaries is: 42.621967107093084. distance: 1.7303625207677111
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5502/5777 (95.2397%), train_poison_data_count: 455
Global model norm: 42.63006293245414.
Norm before scaling: 42.61358328595179. Distance: 1.6396545446394604
Total norm for 4 adversaries is: 42.61358328595179. distance: 1.6396545446394604
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4782/5123 (93.3437%), train_poison_data_count: 403
Global model norm: 42.63006293245414.
Norm before scaling: 42.62259145962825. Distance: 1.7409016606769685
Total norm for 4 adversaries is: 42.62259145962825. distance: 1.7409016606769685
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5132/5503 (93.2582%), train_poison_data_count: 430
Global model norm: 42.63006293245414.
Norm before scaling: 42.62434131639162. Distance: 1.8088833471994912
Total norm for 4 adversaries is: 42.62434131639162. distance: 1.8088833471994912
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4583/5075 (90.3054%)
___Train Local_ResNet_18, epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4594/5075 (90.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0714, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18, epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3450/3774 (91.4149%)
___Train Local_ResNet_18, epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3519/3774 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9218, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18, epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4404/4843 (90.9354%)
___Train Local_ResNet_18, epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4383/4843 (90.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1181, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4197/4605 (91.1401%)
___Train Local_ResNet_18, epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4288/4605 (93.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1150, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3523/3959 (88.9871%)
___Train Local_ResNet_18, epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3602/3959 (90.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8620, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18, epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4577/5035 (90.9037%)
___Train Local_ResNet_18, epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4644/5035 (92.2344%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8761, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5188/5696 (91.0815%)
___Train Local_ResNet_18, epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5183/5696 (90.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0887, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4725/5399 (87.5162%)
___Train Local_ResNet_18, epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4689/5399 (86.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3531, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18, epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4287/4903 (87.4363%)
___Train Local_ResNet_18, epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4437/4903 (90.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0126, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18, epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4435/4911 (90.3075%)
___Train Local_ResNet_18, epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4485/4911 (91.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2751, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4595/5086 (90.3460%)
___Train Local_ResNet_18, epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4606/5086 (90.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0785, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18, epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4141/4537 (91.2718%)
___Train Local_ResNet_18, epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4172/4537 (91.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8769, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18, epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4512/5018 (89.9163%)
___Train Local_ResNet_18, epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4471/5018 (89.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3048, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5485/5939 (92.3556%)
___Train Local_ResNet_18, epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5463/5939 (91.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9121, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18, epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5853/6664 (87.8301%)
___Train Local_ResNet_18, epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5602/6664 (84.0636%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1973, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18, epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4905/5702 (86.0224%)
___Train Local_ResNet_18, epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0107, Accuracy: 4527/5702 (79.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3302, Accuracy: 4868/10000 (48.6800%)
time spent on training: 222.28245329856873
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1123, Accuracy: 7000/10000 (70.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.2944, Accuracy: 5035/9900 (50.8586%)
Done in 249.05689692497253 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5028/5308 (94.7249%), train_poison_data_count: 415
Global model norm: 42.651967218607716.
Norm before scaling: 42.642883665903156. Distance: 1.6770152281523003
Total norm for 4 adversaries is: 42.642883665903156. distance: 1.6770152281523003
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5466/5777 (94.6166%), train_poison_data_count: 455
Global model norm: 42.651967218607716.
Norm before scaling: 42.63542016603537. Distance: 1.6893101626199394
Total norm for 4 adversaries is: 42.63542016603537. distance: 1.6893101626199394
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4773/5123 (93.1681%), train_poison_data_count: 403
Global model norm: 42.651967218607716.
Norm before scaling: 42.642043479063155. Distance: 1.699996314325264
Total norm for 4 adversaries is: 42.642043479063155. distance: 1.699996314325264
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5132/5503 (93.2582%), train_poison_data_count: 430
Global model norm: 42.651967218607716.
Norm before scaling: 42.64577338148163. Distance: 1.7931463947262984
Total norm for 4 adversaries is: 42.64577338148163. distance: 1.7931463947262984
___Train Local_ResNet_18, epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3980/4364 (91.2007%)
___Train Local_ResNet_18, epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3999/4364 (91.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9687, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18, epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4308/4894 (88.0262%)
___Train Local_ResNet_18, epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4327/4894 (88.4144%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0973, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4702/5068 (92.7782%)
___Train Local_ResNet_18, epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4606/5068 (90.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0799, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3903/4313 (90.4939%)
___Train Local_ResNet_18, epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3982/4313 (92.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8777, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5473/6068 (90.1945%)
___Train Local_ResNet_18, epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5530/6068 (91.1338%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0405, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4969/5645 (88.0248%)
___Train Local_ResNet_18, epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4962/5645 (87.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0696, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18, epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5062/5615 (90.1514%)
___Train Local_ResNet_18, epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5086/5615 (90.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0753, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4123/4397 (93.7685%)
___Train Local_ResNet_18, epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4226/4397 (96.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7353, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18, epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5330/5907 (90.2319%)
___Train Local_ResNet_18, epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5300/5907 (89.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2878, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4693/5193 (90.3717%)
___Train Local_ResNet_18, epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4597/5193 (88.5230%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1111, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18, epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4644/5209 (89.1534%)
___Train Local_ResNet_18, epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4663/5209 (89.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9786, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 6182/6812 (90.7516%)
___Train Local_ResNet_18, epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6235/6812 (91.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1791, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18, epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4243/4605 (92.1390%)
___Train Local_ResNet_18, epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4299/4605 (93.3550%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0428, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18, epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3486/3959 (88.0525%)
___Train Local_ResNet_18, epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3610/3959 (91.1846%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0025, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18, epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4366/4732 (92.2654%)
___Train Local_ResNet_18, epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4436/4732 (93.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8482, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18, epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4627/5075 (91.1724%)
___Train Local_ResNet_18, epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4680/5075 (92.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9631, Accuracy: 5552/10000 (55.5200%)
time spent on training: 224.36887669563293
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1211, Accuracy: 6982/10000 (69.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.0563, Accuracy: 5480/9900 (55.3535%)
Done in 251.0864496231079 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5028/5308 (94.7249%), train_poison_data_count: 415
Global model norm: 42.67400328819204.
Norm before scaling: 42.6638829594739. Distance: 1.6782286230163785
Total norm for 4 adversaries is: 42.6638829594739. distance: 1.6782286230163785
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5498/5777 (95.1705%), train_poison_data_count: 455
Global model norm: 42.67400328819204.
Norm before scaling: 42.65412225691454. Distance: 1.6042463192011032
Total norm for 4 adversaries is: 42.65412225691454. distance: 1.6042463192011032
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4772/5123 (93.1485%), train_poison_data_count: 403
Global model norm: 42.67400328819204.
Norm before scaling: 42.66512470637977. Distance: 1.7161317476457656
Total norm for 4 adversaries is: 42.66512470637977. distance: 1.7161317476457656
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5166/5503 (93.8761%), train_poison_data_count: 430
Global model norm: 42.67400328819204.
Norm before scaling: 42.663601129395126. Distance: 1.735019048756624
Total norm for 4 adversaries is: 42.663601129395126. distance: 1.735019048756624
___Train Local_ResNet_18, epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3902/4196 (92.9933%)
___Train Local_ResNet_18, epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3943/4196 (93.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8761, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18, epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4984/5645 (88.2905%)
___Train Local_ResNet_18, epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4951/5645 (87.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2228, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18, epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4909/5346 (91.8257%)
___Train Local_ResNet_18, epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4899/5346 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0736, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18, epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4429/4911 (90.1853%)
___Train Local_ResNet_18, epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4531/4911 (92.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9411, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18, epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3236/3589 (90.1644%)
___Train Local_ResNet_18, epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3032/3589 (84.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2392, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18, epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4242/4605 (92.1173%)
___Train Local_ResNet_18, epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4283/4605 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9536, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5485/6068 (90.3922%)
___Train Local_ResNet_18, epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5519/6068 (90.9525%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1503, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18, epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4046/4527 (89.3749%)
___Train Local_ResNet_18, epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4084/4527 (90.2143%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0455, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4366/4869 (89.6693%)
___Train Local_ResNet_18, epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4157/4869 (85.3769%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2729, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18, epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3766/4086 (92.1684%)
___Train Local_ResNet_18, epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3831/4086 (93.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9235, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3734/4111 (90.8295%)
___Train Local_ResNet_18, epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3796/4111 (92.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0506, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18, epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4858/5702 (85.1982%)
___Train Local_ResNet_18, epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4562/5702 (80.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2438, Accuracy: 4900/10000 (49.0000%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4058/4485 (90.4794%)
___Train Local_ResNet_18, epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3948/4485 (88.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9985, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18, epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4855/5427 (89.4601%)
___Train Local_ResNet_18, epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4854/5427 (89.4417%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1448, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4773/5353 (89.1650%)
___Train Local_ResNet_18, epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4775/5353 (89.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9141, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18, epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4908/5489 (89.4152%)
___Train Local_ResNet_18, epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4971/5489 (90.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1309, Accuracy: 5291/10000 (52.9100%)
time spent on training: 214.16998863220215
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1280, Accuracy: 6977/10000 (69.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.7394, Accuracy: 6062/9900 (61.2323%)
Done in 241.0416796207428 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5029/5308 (94.7438%), train_poison_data_count: 415
Global model norm: 42.69703436029325.
Norm before scaling: 42.686277492102924. Distance: 1.6695614074353875
Total norm for 4 adversaries is: 42.686277492102924. distance: 1.6695614074353875
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5507/5777 (95.3263%), train_poison_data_count: 455
Global model norm: 42.69703436029325.
Norm before scaling: 42.67882730118867. Distance: 1.6277901098213123
Total norm for 4 adversaries is: 42.67882730118867. distance: 1.6277901098213123
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4830/5123 (94.2807%), train_poison_data_count: 403
Global model norm: 42.69703436029325.
Norm before scaling: 42.68482473544096. Distance: 1.6674035430187877
Total norm for 4 adversaries is: 42.68482473544096. distance: 1.6674035430187877
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5183/5503 (94.1850%), train_poison_data_count: 430
Global model norm: 42.69703436029325.
Norm before scaling: 42.68797040599158. Distance: 1.7239234052579149
Total norm for 4 adversaries is: 42.68797040599158. distance: 1.7239234052579149
___Train Local_ResNet_18, epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4781/5399 (88.5534%)
___Train Local_ResNet_18, epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4706/5399 (87.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2834, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4076/4368 (93.3150%)
___Train Local_ResNet_18, epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4072/4368 (93.2234%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9005, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18, epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4898/5346 (91.6199%)
___Train Local_ResNet_18, epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4884/5346 (91.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1485, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4414/4869 (90.6552%)
___Train Local_ResNet_18, epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4207/4869 (86.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0623, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18, epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4410/4889 (90.2025%)
___Train Local_ResNet_18, epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4388/4889 (89.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0442, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4301/4797 (89.6602%)
___Train Local_ResNet_18, epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4311/4797 (89.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9508, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3523/3995 (88.1852%)
___Train Local_ResNet_18, epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3582/3995 (89.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0914, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18, epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4545/5123 (88.7175%)
___Train Local_ResNet_18, epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4138/5123 (80.7730%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.5199, Accuracy: 4588/10000 (45.8800%)
___Train Local_ResNet_18, epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5566/6235 (89.2702%)
___Train Local_ResNet_18, epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5491/6235 (88.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2021, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4656/5224 (89.1271%)
___Train Local_ResNet_18, epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4740/5224 (90.7351%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0750, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18, epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5722/6419 (89.1416%)
___Train Local_ResNet_18, epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5569/6419 (86.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1581, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18, epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5028/5652 (88.9597%)
___Train Local_ResNet_18, epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5030/5652 (88.9950%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2666, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4676/5075 (92.1379%)
___Train Local_ResNet_18, epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4744/5075 (93.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9842, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5341/5871 (90.9726%)
___Train Local_ResNet_18, epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5301/5871 (90.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0002, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5484/5939 (92.3388%)
___Train Local_ResNet_18, epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5468/5939 (92.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1251, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18, epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4836/5454 (88.6689%)
___Train Local_ResNet_18, epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4782/5454 (87.6788%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9774, Accuracy: 5492/10000 (54.9200%)
time spent on training: 221.58978962898254
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1316, Accuracy: 6959/10000 (69.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.5288, Accuracy: 6459/9900 (65.2424%)
Done in 248.71779346466064 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5023/5308 (94.6307%), train_poison_data_count: 415
Global model norm: 42.72154600624915.
Norm before scaling: 42.71159270464153. Distance: 1.677710571830744
Total norm for 4 adversaries is: 42.71159270464153. distance: 1.677710571830744
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5517/5777 (95.4994%), train_poison_data_count: 455
Global model norm: 42.72154600624915.
Norm before scaling: 42.702051589600906. Distance: 1.6508631644842502
Total norm for 4 adversaries is: 42.702051589600906. distance: 1.6508631644842502
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4781/5123 (93.3242%), train_poison_data_count: 403
Global model norm: 42.72154600624915.
Norm before scaling: 42.71114685219407. Distance: 1.691068831479341
Total norm for 4 adversaries is: 42.71114685219407. distance: 1.691068831479341
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5226/5503 (94.9664%), train_poison_data_count: 430
Global model norm: 42.72154600624915.
Norm before scaling: 42.70743980899654. Distance: 1.6412428646121386
Total norm for 4 adversaries is: 42.70743980899654. distance: 1.6412428646121386
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4983/5461 (91.2470%)
___Train Local_ResNet_18, epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4962/5461 (90.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1548, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18, epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4930/5346 (92.2185%)
___Train Local_ResNet_18, epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4945/5346 (92.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1408, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4932/5489 (89.8524%)
___Train Local_ResNet_18, epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4979/5489 (90.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1792, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18, epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4481/4929 (90.9109%)
___Train Local_ResNet_18, epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4464/4929 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0431, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18, epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4541/4956 (91.6263%)
___Train Local_ResNet_18, epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4494/4956 (90.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9646, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18, epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5192/5696 (91.1517%)
___Train Local_ResNet_18, epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5183/5696 (90.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9620, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3295/3589 (91.8083%)
___Train Local_ResNet_18, epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3181/3589 (88.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4656, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5540/6235 (88.8532%)
___Train Local_ResNet_18, epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5546/6235 (88.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2067, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18, epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3555/3959 (89.7954%)
___Train Local_ResNet_18, epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3642/3959 (91.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9103, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3794/4086 (92.8536%)
___Train Local_ResNet_18, epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3859/4086 (94.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9444, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18, epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4323/4714 (91.7056%)
___Train Local_ResNet_18, epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4309/4714 (91.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9976, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3845/4161 (92.4057%)
___Train Local_ResNet_18, epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3806/4161 (91.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9650, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4107/4485 (91.5719%)
___Train Local_ResNet_18, epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3826/4485 (85.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1588, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4949/5454 (90.7407%)
___Train Local_ResNet_18, epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4837/5454 (88.6872%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9736, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5027/5422 (92.7149%)
___Train Local_ResNet_18, epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5055/5422 (93.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8837, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4536/5122 (88.5592%)
___Train Local_ResNet_18, epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4246/5122 (82.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1948, Accuracy: 5032/10000 (50.3200%)
time spent on training: 219.95718264579773
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1309, Accuracy: 6964/10000 (69.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.3760, Accuracy: 6741/9900 (68.0909%)
Done in 247.12824964523315 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5038/5308 (94.9133%), train_poison_data_count: 415
Global model norm: 42.743451961053346.
Norm before scaling: 42.73241825958952. Distance: 1.6515006581604559
Total norm for 4 adversaries is: 42.73241825958952. distance: 1.6515006581604559
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5505/5777 (95.2917%), train_poison_data_count: 455
Global model norm: 42.743451961053346.
Norm before scaling: 42.72472897304689. Distance: 1.5931964735817197
Total norm for 4 adversaries is: 42.72472897304689. distance: 1.5931964735817197
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4826/5123 (94.2026%), train_poison_data_count: 403
Global model norm: 42.743451961053346.
Norm before scaling: 42.731809795038814. Distance: 1.6354504316533538
Total norm for 4 adversaries is: 42.731809795038814. distance: 1.6354504316533538
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5220/5503 (94.8574%), train_poison_data_count: 430
Global model norm: 42.743451961053346.
Norm before scaling: 42.73110133713353. Distance: 1.658744373211376
Total norm for 4 adversaries is: 42.73110133713353. distance: 1.658744373211376
___Train Local_ResNet_18, epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4637/5123 (90.5134%)
___Train Local_ResNet_18, epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4461/5123 (87.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2018, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18, epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4975/5526 (90.0290%)
___Train Local_ResNet_18, epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4961/5526 (89.7756%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0177, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4853/5362 (90.5073%)
___Train Local_ResNet_18, epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4827/5362 (90.0224%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0277, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3742/4111 (91.0241%)
___Train Local_ResNet_18, epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3766/4111 (91.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0691, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4118/4537 (90.7648%)
___Train Local_ResNet_18, epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4171/4537 (91.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9985, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18, epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4381/4732 (92.5824%)
___Train Local_ResNet_18, epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4408/4732 (93.1530%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8471, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4974/5497 (90.4857%)
___Train Local_ResNet_18, epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4907/5497 (89.2669%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1085, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18, epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5356/6080 (88.0921%)
___Train Local_ResNet_18, epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5333/6080 (87.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1262, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6225/6812 (91.3829%)
___Train Local_ResNet_18, epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 6163/6812 (90.4727%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2028, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4430/4889 (90.6116%)
___Train Local_ResNet_18, epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4466/4889 (91.3479%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9751, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18, epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4306/4714 (91.3449%)
___Train Local_ResNet_18, epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4390/4714 (93.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8890, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18, epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4303/4714 (91.2813%)
___Train Local_ResNet_18, epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4351/4714 (92.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1154, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3771/4130 (91.3075%)
___Train Local_ResNet_18, epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3794/4130 (91.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1206, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18, epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4075/4485 (90.8584%)
___Train Local_ResNet_18, epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3955/4485 (88.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3060, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18, epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3758/4175 (90.0120%)
___Train Local_ResNet_18, epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3797/4175 (90.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0433, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4364/4894 (89.1704%)
___Train Local_ResNet_18, epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4327/4894 (88.4144%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2159, Accuracy: 5235/10000 (52.3500%)
time spent on training: 224.85262179374695
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1374, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.2191, Accuracy: 7072/9900 (71.4343%)
Done in 251.81923508644104 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5061/5308 (95.3466%), train_poison_data_count: 415
Global model norm: 42.76577485587555.
Norm before scaling: 42.750975123655806. Distance: 1.5766166806244601
Total norm for 4 adversaries is: 42.750975123655806. distance: 1.5766166806244601
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5557/5777 (96.1918%), train_poison_data_count: 455
Global model norm: 42.76577485587555.
Norm before scaling: 42.74217107818182. Distance: 1.5142655715733755
Total norm for 4 adversaries is: 42.74217107818182. distance: 1.5142655715733755
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4784/5123 (93.3828%), train_poison_data_count: 403
Global model norm: 42.76577485587555.
Norm before scaling: 42.753834691865656. Distance: 1.6599030425010222
Total norm for 4 adversaries is: 42.753834691865656. distance: 1.6599030425010222
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5229/5503 (95.0209%), train_poison_data_count: 430
Global model norm: 42.76577485587555.
Norm before scaling: 42.753663380134746. Distance: 1.6483359644566369
Total norm for 4 adversaries is: 42.753663380134746. distance: 1.6483359644566369
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4877/5362 (90.9549%)
___Train Local_ResNet_18, epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4845/5362 (90.3581%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1128, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18, epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3757/4175 (89.9880%)
___Train Local_ResNet_18, epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3704/4175 (88.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0041, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18, epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3583/3910 (91.6368%)
___Train Local_ResNet_18, epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3556/3910 (90.9463%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0016, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4353/4714 (92.3420%)
___Train Local_ResNet_18, epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4375/4714 (92.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8523, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3953/4313 (91.6531%)
___Train Local_ResNet_18, epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3992/4313 (92.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8527, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18, epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5546/6068 (91.3975%)
___Train Local_ResNet_18, epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5533/6068 (91.1833%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2164, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3209/3552 (90.3435%)
___Train Local_ResNet_18, epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3273/3552 (92.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8783, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18, epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4371/4732 (92.3711%)
___Train Local_ResNet_18, epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4436/4732 (93.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8050, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4200/4736 (88.6824%)
___Train Local_ResNet_18, epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4226/4736 (89.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9684, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4387/4757 (92.2220%)
___Train Local_ResNet_18, epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4306/4757 (90.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9208, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18, epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4600/5086 (90.4444%)
___Train Local_ResNet_18, epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4605/5086 (90.5427%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9904, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18, epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5063/5422 (93.3788%)
___Train Local_ResNet_18, epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5065/5422 (93.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8867, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4568/4956 (92.1711%)
___Train Local_ResNet_18, epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4541/4956 (91.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0565, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18, epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3467/3774 (91.8654%)
___Train Local_ResNet_18, epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3482/3774 (92.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0442, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18, epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4677/5068 (92.2849%)
___Train Local_ResNet_18, epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4623/5068 (91.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1973, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4946/5346 (92.5178%)
___Train Local_ResNet_18, epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4986/5346 (93.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9912, Accuracy: 5488/10000 (54.8800%)
time spent on training: 218.2961230278015
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1481, Accuracy: 6938/10000 (69.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.0174, Accuracy: 7478/9900 (75.5354%)
Done in 245.28013062477112 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5070/5308 (95.5162%), train_poison_data_count: 415
Global model norm: 42.78578660205104.
Norm before scaling: 42.769713736310386. Distance: 1.5427411261590616
Total norm for 4 adversaries is: 42.769713736310386. distance: 1.5427411261590616
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5533/5777 (95.7764%), train_poison_data_count: 455
Global model norm: 42.78578660205104.
Norm before scaling: 42.76321581631958. Distance: 1.5300003713719534
Total norm for 4 adversaries is: 42.76321581631958. distance: 1.5300003713719534
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4832/5123 (94.3197%), train_poison_data_count: 403
Global model norm: 42.78578660205104.
Norm before scaling: 42.77415453166126. Distance: 1.6130874184831332
Total norm for 4 adversaries is: 42.77415453166126. distance: 1.6130874184831332
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5182/5503 (94.1668%), train_poison_data_count: 430
Global model norm: 42.78578660205104.
Norm before scaling: 42.77223956655838. Distance: 1.6672423878351676
Total norm for 4 adversaries is: 42.77223956655838. distance: 1.6672423878351676
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4623/5123 (90.2401%)
___Train Local_ResNet_18, epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4279/5123 (83.5253%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2316, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4331/4818 (89.8921%)
___Train Local_ResNet_18, epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4284/4818 (88.9166%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1370, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4613/5035 (91.6187%)
___Train Local_ResNet_18, epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5035 (92.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9650, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18, epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4153/4397 (94.4508%)
___Train Local_ResNet_18, epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4217/4397 (95.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.7953, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5310/6080 (87.3355%)
___Train Local_ResNet_18, epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5391/6080 (88.6678%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0814, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18, epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4580/5086 (90.0511%)
___Train Local_ResNet_18, epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4587/5086 (90.1888%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2776, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18, epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3738/4145 (90.1809%)
___Train Local_ResNet_18, epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3774/4145 (91.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0770, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18, epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4870/5362 (90.8243%)
___Train Local_ResNet_18, epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4852/5362 (90.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0623, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18, epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4384/4869 (90.0390%)
___Train Local_ResNet_18, epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4176/4869 (85.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2574, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4006/4364 (91.7965%)
___Train Local_ResNet_18, epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3931/4364 (90.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0138, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18, epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4479/5018 (89.2587%)
___Train Local_ResNet_18, epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4452/5018 (88.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1222, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4578/5038 (90.8694%)
___Train Local_ResNet_18, epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0735, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18, epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3786/4108 (92.1616%)
___Train Local_ResNet_18, epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3838/4108 (93.4275%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9091, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18, epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5085/5615 (90.5610%)
___Train Local_ResNet_18, epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5105/5615 (90.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1607, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18, epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4579/5055 (90.5836%)
___Train Local_ResNet_18, epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1771, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18, epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4293/4797 (89.4934%)
___Train Local_ResNet_18, epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4345/4797 (90.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0462, Accuracy: 5445/10000 (54.4500%)
time spent on training: 221.07346296310425
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1532, Accuracy: 6932/10000 (69.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.9192, Accuracy: 7698/9900 (77.7576%)
Done in 248.19068145751953 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5065/5308 (95.4220%), train_poison_data_count: 415
Global model norm: 42.80758696718521.
Norm before scaling: 42.79310264270473. Distance: 1.5575695831773324
Total norm for 4 adversaries is: 42.79310264270473. distance: 1.5575695831773324
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5538/5777 (95.8629%), train_poison_data_count: 455
Global model norm: 42.80758696718521.
Norm before scaling: 42.78421739160949. Distance: 1.5438060178902087
Total norm for 4 adversaries is: 42.78421739160949. distance: 1.5438060178902087
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4816/5123 (94.0074%), train_poison_data_count: 403
Global model norm: 42.80758696718521.
Norm before scaling: 42.794878330568075. Distance: 1.6161123193807942
Total norm for 4 adversaries is: 42.794878330568075. distance: 1.6161123193807942
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5190/5503 (94.3122%), train_poison_data_count: 430
Global model norm: 42.80758696718521.
Norm before scaling: 42.79705754798599. Distance: 1.6891900535787485
Total norm for 4 adversaries is: 42.79705754798599. distance: 1.6891900535787485
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4012/4527 (88.6238%)
___Train Local_ResNet_18, epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4026/4527 (88.9331%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0415, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18, epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3806/4086 (93.1473%)
___Train Local_ResNet_18, epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3803/4086 (93.0739%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9263, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18, epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4357/4903 (88.8640%)
___Train Local_ResNet_18, epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4406/4903 (89.8633%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0961, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18, epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3618/3968 (91.1794%)
___Train Local_ResNet_18, epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3639/3968 (91.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0050, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5086/5615 (90.5788%)
___Train Local_ResNet_18, epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5053/5615 (89.9911%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2468, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4402/4748 (92.7127%)
___Train Local_ResNet_18, epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4404/4748 (92.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0652, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4806/5361 (89.6475%)
___Train Local_ResNet_18, epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4831/5361 (90.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2393, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18, epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5050 (88.0792%)
___Train Local_ResNet_18, epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4520/5050 (89.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1428, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5027/5652 (88.9420%)
___Train Local_ResNet_18, epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5002/5652 (88.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3268, Accuracy: 4887/10000 (48.8700%)
___Train Local_ResNet_18, epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4317/4731 (91.2492%)
___Train Local_ResNet_18, epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4377/4731 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9982, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5338/5907 (90.3674%)
___Train Local_ResNet_18, epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5353/5907 (90.6213%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2968, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18, epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4673/5224 (89.4525%)
___Train Local_ResNet_18, epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4693/5224 (89.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0731, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18, epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3516/3959 (88.8103%)
___Train Local_ResNet_18, epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3611/3959 (91.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9895, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4261/4605 (92.5299%)
___Train Local_ResNet_18, epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4310/4605 (93.5939%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8803, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4330/4797 (90.2647%)
___Train Local_ResNet_18, epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4326/4797 (90.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0255, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18, epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5149/5696 (90.3968%)
___Train Local_ResNet_18, epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1571, Accuracy: 5226/10000 (52.2600%)
time spent on training: 212.58715867996216
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1538, Accuracy: 6927/10000 (69.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8263, Accuracy: 7917/9900 (79.9697%)
Done in 239.53818607330322 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5066/5308 (95.4408%), train_poison_data_count: 415
Global model norm: 42.82955579514426.
Norm before scaling: 42.814758152125535. Distance: 1.557748283202845
Total norm for 4 adversaries is: 42.814758152125535. distance: 1.557748283202845
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5565/5777 (96.3303%), train_poison_data_count: 455
Global model norm: 42.82955579514426.
Norm before scaling: 42.80731748970101. Distance: 1.5294262671753986
Total norm for 4 adversaries is: 42.80731748970101. distance: 1.5294262671753986
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4833/5123 (94.3393%), train_poison_data_count: 403
Global model norm: 42.82955579514426.
Norm before scaling: 42.816578558007905. Distance: 1.6302055464488168
Total norm for 4 adversaries is: 42.816578558007905. distance: 1.6302055464488168
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5210/5503 (94.6756%), train_poison_data_count: 430
Global model norm: 42.82955579514426.
Norm before scaling: 42.81639894426769. Distance: 1.6427722503218796
Total norm for 4 adversaries is: 42.81639894426769. distance: 1.6427722503218796
___Train Local_ResNet_18, epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4156/4397 (94.5190%)
___Train Local_ResNet_18, epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4225/4397 (96.0882%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7558, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18, epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4030/4368 (92.2619%)
___Train Local_ResNet_18, epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4056/4368 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9006, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4818/5504 (87.5363%)
___Train Local_ResNet_18, epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4774/5504 (86.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0858, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3472/3774 (91.9979%)
___Train Local_ResNet_18, epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3488/3774 (92.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8764, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18, epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5054/5526 (91.4586%)
___Train Local_ResNet_18, epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4991/5526 (90.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1190, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18, epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3920/4313 (90.8880%)
___Train Local_ResNet_18, epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3983/4313 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9653, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4538/4979 (91.1428%)
___Train Local_ResNet_18, epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4585/4979 (92.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0250, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4301/4737 (90.7959%)
___Train Local_ResNet_18, epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4330/4737 (91.4081%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1721, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18, epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4753/5399 (88.0348%)
___Train Local_ResNet_18, epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4720/5399 (87.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1811, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18, epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3726/4145 (89.8914%)
___Train Local_ResNet_18, epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3779/4145 (91.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9195, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18, epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4377/4748 (92.1862%)
___Train Local_ResNet_18, epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4334/4748 (91.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0169, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18, epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4416/5050 (87.4455%)
___Train Local_ResNet_18, epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4497/5050 (89.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1284, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4446/5018 (88.6010%)
___Train Local_ResNet_18, epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4470/5018 (89.0793%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0793, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5866/6664 (88.0252%)
___Train Local_ResNet_18, epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5606/6664 (84.1236%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3992, Accuracy: 4750/10000 (47.5000%)
___Train Local_ResNet_18, epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4036/4364 (92.4840%)
___Train Local_ResNet_18, epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4028/4364 (92.3006%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9297, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18, epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3943/4196 (93.9704%)
___Train Local_ResNet_18, epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3956/4196 (94.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7298, Accuracy: 5876/10000 (58.7600%)
time spent on training: 218.30671286582947
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1619, Accuracy: 6918/10000 (69.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7145, Accuracy: 8161/9900 (82.4343%)
Done in 245.10968232154846 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5070/5308 (95.5162%), train_poison_data_count: 415
Global model norm: 42.84945656288274.
Norm before scaling: 42.83479831035816. Distance: 1.5560202708603275
Total norm for 4 adversaries is: 42.83479831035816. distance: 1.5560202708603275
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5572/5777 (96.4514%), train_poison_data_count: 455
Global model norm: 42.84945656288274.
Norm before scaling: 42.82565377310369. Distance: 1.491223807988212
Total norm for 4 adversaries is: 42.82565377310369. distance: 1.491223807988212
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4848/5123 (94.6321%), train_poison_data_count: 403
Global model norm: 42.84945656288274.
Norm before scaling: 42.83433379156477. Distance: 1.5844380473396693
Total norm for 4 adversaries is: 42.83433379156477. distance: 1.5844380473396693
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5253/5503 (95.4570%), train_poison_data_count: 430
Global model norm: 42.84945656288274.
Norm before scaling: 42.83501774386451. Distance: 1.6084040703643017
Total norm for 4 adversaries is: 42.83501774386451. distance: 1.6084040703643017
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4539/4929 (92.0876%)
___Train Local_ResNet_18, epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4502/4929 (91.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1120, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18, epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4695/5209 (90.1325%)
___Train Local_ResNet_18, epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4654/5209 (89.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1729, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3476/3929 (88.4703%)
___Train Local_ResNet_18, epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3542/3929 (90.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9418, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4358/4818 (90.4525%)
___Train Local_ResNet_18, epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4279/4818 (88.8128%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0722, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18, epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5204/5696 (91.3624%)
___Train Local_ResNet_18, epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5188/5696 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0271, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18, epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4933/5526 (89.2689%)
___Train Local_ResNet_18, epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4911/5526 (88.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0436, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18, epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5363/5907 (90.7906%)
___Train Local_ResNet_18, epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5358/5907 (90.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2340, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18, epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4844/5427 (89.2574%)
___Train Local_ResNet_18, epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4843/5427 (89.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0848, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18, epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4667/5193 (89.8710%)
___Train Local_ResNet_18, epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4525/5193 (87.1365%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2970, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18, epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4523/5055 (89.4758%)
___Train Local_ResNet_18, epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4528/5055 (89.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1818, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18, epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4916/5298 (92.7897%)
___Train Local_ResNet_18, epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4945/5298 (93.3371%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9692, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4546/5122 (88.7544%)
___Train Local_ResNet_18, epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4427/5122 (86.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.4237, Accuracy: 4759/10000 (47.5900%)
___Train Local_ResNet_18, epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4031/4368 (92.2848%)
___Train Local_ResNet_18, epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3952/4368 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0319, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3800/4175 (91.0180%)
___Train Local_ResNet_18, epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0779, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4381/4851 (90.3113%)
___Train Local_ResNet_18, epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4460/4851 (91.9398%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0894, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4866/5353 (90.9023%)
___Train Local_ResNet_18, epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4761/5353 (88.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1122, Accuracy: 5269/10000 (52.6900%)
time spent on training: 223.40542888641357
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1628, Accuracy: 6904/10000 (69.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6520, Accuracy: 8296/9900 (83.7980%)
Done in 251.31815266609192 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5073/5308 (95.5727%), train_poison_data_count: 415
Global model norm: 42.87327318634463.
Norm before scaling: 42.85487324835779. Distance: 1.4979162047292167
Total norm for 4 adversaries is: 42.85487324835779. distance: 1.4979162047292167
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5527/5777 (95.6725%), train_poison_data_count: 455
Global model norm: 42.87327318634463.
Norm before scaling: 42.84981978566611. Distance: 1.5305321236809317
Total norm for 4 adversaries is: 42.84981978566611. distance: 1.5305321236809317
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4852/5123 (94.7101%), train_poison_data_count: 403
Global model norm: 42.87327318634463.
Norm before scaling: 42.8575079911436. Distance: 1.5338816702362483
Total norm for 4 adversaries is: 42.8575079911436. distance: 1.5338816702362483
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5236/5503 (95.1481%), train_poison_data_count: 430
Global model norm: 42.87327318634463.
Norm before scaling: 42.85691412001831. Distance: 1.5674364312528521
Total norm for 4 adversaries is: 42.85691412001831. distance: 1.5674364312528521
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4901/5427 (90.3077%)
___Train Local_ResNet_18, epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4931/5427 (90.8605%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0091, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18, epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5011/5645 (88.7688%)
___Train Local_ResNet_18, epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4840/5645 (85.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2943, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18, epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3873/4249 (91.1509%)
___Train Local_ResNet_18, epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3863/4249 (90.9155%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0327, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6299/6812 (92.4692%)
___Train Local_ResNet_18, epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6251/6812 (91.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9818, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4395/4757 (92.3902%)
___Train Local_ResNet_18, epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4339/4757 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0247, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4824/5702 (84.6019%)
___Train Local_ResNet_18, epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4656/5702 (81.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3363, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18, epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4935/5298 (93.1484%)
___Train Local_ResNet_18, epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4965/5298 (93.7146%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9978, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4124/4587 (89.9063%)
___Train Local_ResNet_18, epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4166/4587 (90.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0220, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4854/5353 (90.6781%)
___Train Local_ResNet_18, epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4887/5353 (91.2946%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9594, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18, epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3687/4028 (91.5343%)
___Train Local_ResNet_18, epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3755/4028 (93.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8298, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18, epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4298/4672 (91.9949%)
___Train Local_ResNet_18, epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4337/4672 (92.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7914, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4418/4732 (93.3643%)
___Train Local_ResNet_18, epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4434/4732 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7487, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18, epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3766/4130 (91.1864%)
___Train Local_ResNet_18, epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3814/4130 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0276, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5001/5559 (89.9622%)
___Train Local_ResNet_18, epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4907/5559 (88.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1949, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4790/5504 (87.0276%)
___Train Local_ResNet_18, epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4792/5504 (87.0640%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2119, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4554/5123 (88.8932%)
___Train Local_ResNet_18, epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4523/5123 (88.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2010, Accuracy: 5314/10000 (53.1400%)
time spent on training: 225.97393989562988
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1681, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.5920, Accuracy: 8443/9900 (85.2828%)
Done in 252.91000843048096 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5071/5308 (95.5350%), train_poison_data_count: 415
Global model norm: 42.8959496922495.
Norm before scaling: 42.88059849791118. Distance: 1.5684384222763277
Total norm for 4 adversaries is: 42.88059849791118. distance: 1.5684384222763277
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5555/5777 (96.1572%), train_poison_data_count: 455
Global model norm: 42.8959496922495.
Norm before scaling: 42.871213161849646. Distance: 1.5045693260997997
Total norm for 4 adversaries is: 42.871213161849646. distance: 1.5045693260997997
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 403
Global model norm: 42.8959496922495.
Norm before scaling: 42.87911673931437. Distance: 1.5641480718749494
Total norm for 4 adversaries is: 42.87911673931437. distance: 1.5641480718749494
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5246/5503 (95.3298%), train_poison_data_count: 430
Global model norm: 42.8959496922495.
Norm before scaling: 42.87742140802735. Distance: 1.5645729809590834
Total norm for 4 adversaries is: 42.87742140802735. distance: 1.5645729809590834
___Train Local_ResNet_18, epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4329/4797 (90.2439%)
___Train Local_ResNet_18, epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4317/4797 (89.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0603, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18, epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4673/5068 (92.2060%)
___Train Local_ResNet_18, epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4672/5068 (92.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0016, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4946/5298 (93.3560%)
___Train Local_ResNet_18, epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4972/5298 (93.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1661, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4481/4911 (91.2441%)
___Train Local_ResNet_18, epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4505/4911 (91.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0264, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18, epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4519/4979 (90.7612%)
___Train Local_ResNet_18, epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4587/4979 (92.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9950, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18, epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4240/4549 (93.2073%)
___Train Local_ResNet_18, epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3846/4549 (84.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2445, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18, epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4327/4818 (89.8090%)
___Train Local_ResNet_18, epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4307/4818 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9460, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5042/5422 (92.9915%)
___Train Local_ResNet_18, epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5023/5422 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9189, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18, epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4705/5075 (92.7094%)
___Train Local_ResNet_18, epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4682/5075 (92.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0438, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18, epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4803/5361 (89.5915%)
___Train Local_ResNet_18, epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4775/5361 (89.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0031, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3630/3910 (92.8389%)
___Train Local_ResNet_18, epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3509/3910 (89.7442%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1614, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4919/5454 (90.1907%)
___Train Local_ResNet_18, epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4863/5454 (89.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1796, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4607/5122 (89.9453%)
___Train Local_ResNet_18, epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4143/5122 (80.8864%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 3.1768, Accuracy: 4231/10000 (42.3100%)
___Train Local_ResNet_18, epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4996/5645 (88.5031%)
___Train Local_ResNet_18, epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4799/5645 (85.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2158, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18, epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5395/5871 (91.8924%)
___Train Local_ResNet_18, epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5341/5871 (90.9726%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1762, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6309/6812 (92.6160%)
___Train Local_ResNet_18, epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6243/6812 (91.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1566, Accuracy: 5264/10000 (52.6400%)
time spent on training: 227.25105214118958
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1698, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.5488, Accuracy: 8560/9900 (86.4646%)
Done in 253.76157450675964 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5105/5308 (96.1756%), train_poison_data_count: 415
Global model norm: 42.91999791126655.
Norm before scaling: 42.897425178139336. Distance: 1.4328296090438863
Total norm for 4 adversaries is: 42.897425178139336. distance: 1.4328296090438863
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5542/5777 (95.9321%), train_poison_data_count: 455
Global model norm: 42.91999791126655.
Norm before scaling: 42.89425644918122. Distance: 1.4992176240774662
Total norm for 4 adversaries is: 42.89425644918122. distance: 1.4992176240774662
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 403
Global model norm: 42.91999791126655.
Norm before scaling: 42.90265228680143. Distance: 1.5132852171224056
Total norm for 4 adversaries is: 42.90265228680143. distance: 1.5132852171224056
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5249/5503 (95.3843%), train_poison_data_count: 430
Global model norm: 42.91999791126655.
Norm before scaling: 42.901475744940875. Distance: 1.5611412243787663
Total norm for 4 adversaries is: 42.901475744940875. distance: 1.5611412243787663
___Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6233/6812 (91.5003%)
___Train Local_ResNet_18, epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6242/6812 (91.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9650, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3969/4196 (94.5901%)
___Train Local_ResNet_18, epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3983/4196 (94.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7597, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4951/5489 (90.1986%)
___Train Local_ResNet_18, epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4932/5489 (89.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0163, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18, epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4865/5353 (90.8836%)
___Train Local_ResNet_18, epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4826/5353 (90.1551%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1259, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4156/4397 (94.5190%)
___Train Local_ResNet_18, epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4194/4397 (95.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7761, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18, epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3586/3995 (89.7622%)
___Train Local_ResNet_18, epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3566/3995 (89.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0017, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18, epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4751/5361 (88.6215%)
___Train Local_ResNet_18, epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4835/5361 (90.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0504, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4467/5018 (89.0195%)
___Train Local_ResNet_18, epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4499/5018 (89.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2190, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18, epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4597/5123 (89.7326%)
___Train Local_ResNet_18, epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4543/5123 (88.6785%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0207, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4443/4843 (91.7407%)
___Train Local_ResNet_18, epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4425/4843 (91.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9331, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4534/4929 (91.9862%)
___Train Local_ResNet_18, epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4472/4929 (90.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0917, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4457/4869 (91.5383%)
___Train Local_ResNet_18, epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4177/4869 (85.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3620, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18, epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4940/5298 (93.2427%)
___Train Local_ResNet_18, epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4961/5298 (93.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9467, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4011/4364 (91.9111%)
___Train Local_ResNet_18, epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3757/4364 (86.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2954, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3781/4111 (91.9728%)
___Train Local_ResNet_18, epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3677/4111 (89.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9917, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18, epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3725/4028 (92.4777%)
___Train Local_ResNet_18, epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3718/4028 (92.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8027, Accuracy: 5782/10000 (57.8200%)
time spent on training: 220.30781316757202
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1677, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5162, Accuracy: 8631/9900 (87.1818%)
Done in 246.87068939208984 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5095/5308 (95.9872%), train_poison_data_count: 415
Global model norm: 42.942074105888565.
Norm before scaling: 42.92248645814918. Distance: 1.497647507014696
Total norm for 4 adversaries is: 42.92248645814918. distance: 1.497647507014696
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5568/5777 (96.3822%), train_poison_data_count: 455
Global model norm: 42.942074105888565.
Norm before scaling: 42.91483407166382. Distance: 1.4843761243313998
Total norm for 4 adversaries is: 42.91483407166382. distance: 1.4843761243313998
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4863/5123 (94.9248%), train_poison_data_count: 403
Global model norm: 42.942074105888565.
Norm before scaling: 42.92390699822405. Distance: 1.511280006003527
Total norm for 4 adversaries is: 42.92390699822405. distance: 1.511280006003527
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5252/5503 (95.4389%), train_poison_data_count: 430
Global model norm: 42.942074105888565.
Norm before scaling: 42.922401138930354. Distance: 1.5606584759697852
Total norm for 4 adversaries is: 42.922401138930354. distance: 1.5606584759697852
___Train Local_ResNet_18, epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3921/4196 (93.4461%)
___Train Local_ResNet_18, epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3889/4196 (92.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0194, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18, epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4952/5298 (93.4692%)
___Train Local_ResNet_18, epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4971/5298 (93.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0775, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3882/4249 (91.3627%)
___Train Local_ResNet_18, epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3815/4249 (89.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9043, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4649/5123 (90.7476%)
___Train Local_ResNet_18, epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4295/5123 (83.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2938, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3808/4130 (92.2034%)
___Train Local_ResNet_18, epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3780/4130 (91.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9522, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18, epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4501/4979 (90.3997%)
___Train Local_ResNet_18, epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4547/4979 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9777, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4867/5353 (90.9210%)
___Train Local_ResNet_18, epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4810/5353 (89.8562%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9714, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4255/4672 (91.0745%)
___Train Local_ResNet_18, epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4331/4672 (92.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9799, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4105/4587 (89.4920%)
___Train Local_ResNet_18, epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4115/4587 (89.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0718, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4535/5122 (88.5396%)
___Train Local_ResNet_18, epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0116, Accuracy: 4059/5122 (79.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3378, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18, epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4366/4818 (90.6185%)
___Train Local_ResNet_18, epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4287/4818 (88.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0278, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4639/4993 (92.9101%)
___Train Local_ResNet_18, epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4576/4993 (91.6483%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0772, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4367/4903 (89.0679%)
___Train Local_ResNet_18, epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4453/4903 (90.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0539, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18, epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4959/5559 (89.2067%)
___Train Local_ResNet_18, epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4906/5559 (88.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0538, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4496/4830 (93.0849%)
___Train Local_ResNet_18, epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4513/4830 (93.4369%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0379, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5185/5696 (91.0288%)
___Train Local_ResNet_18, epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5208/5696 (91.4326%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0459, Accuracy: 5406/10000 (54.0600%)
time spent on training: 220.86136102676392
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1738, Accuracy: 6895/10000 (68.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.4558, Accuracy: 8775/9900 (88.6364%)
Done in 247.74346899986267 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5090/5308 (95.8930%), train_poison_data_count: 415
Global model norm: 42.964147480777505.
Norm before scaling: 42.942399590814524. Distance: 1.469988280658328
Total norm for 4 adversaries is: 42.942399590814524. distance: 1.469988280658328
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5555/5777 (96.1572%), train_poison_data_count: 455
Global model norm: 42.964147480777505.
Norm before scaling: 42.9373919667491. Distance: 1.464673411320081
Total norm for 4 adversaries is: 42.9373919667491. distance: 1.464673411320081
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4890/5123 (95.4519%), train_poison_data_count: 403
Global model norm: 42.964147480777505.
Norm before scaling: 42.94472055372464. Distance: 1.4896238983962011
Total norm for 4 adversaries is: 42.94472055372464. distance: 1.4896238983962011
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5222/5503 (94.8937%), train_poison_data_count: 430
Global model norm: 42.964147480777505.
Norm before scaling: 42.94784576733375. Distance: 1.624818204834309
Total norm for 4 adversaries is: 42.94784576733375. distance: 1.624818204834309
___Train Local_ResNet_18, epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3945/4196 (94.0181%)
___Train Local_ResNet_18, epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3975/4196 (94.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7025, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18, epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4613/5123 (90.0449%)
___Train Local_ResNet_18, epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4375/5123 (85.3992%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1285, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18, epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4254/4605 (92.3779%)
___Train Local_ResNet_18, epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4348/4605 (94.4191%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8660, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18, epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4190/4736 (88.4713%)
___Train Local_ResNet_18, epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4245/4736 (89.6326%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9751, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4392/4714 (93.1693%)
___Train Local_ResNet_18, epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4386/4714 (93.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9106, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4955/5489 (90.2715%)
___Train Local_ResNet_18, epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4987/5489 (90.8544%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9018, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18, epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4548/4911 (92.6084%)
___Train Local_ResNet_18, epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4528/4911 (92.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0781, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3578/3959 (90.3764%)
___Train Local_ResNet_18, epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3622/3959 (91.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8981, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5467/5939 (92.0525%)
___Train Local_ResNet_18, epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5487/5939 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9942, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18, epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5089/5615 (90.6322%)
___Train Local_ResNet_18, epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5092/5615 (90.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1326, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18, epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 6256/6947 (90.0533%)
___Train Local_ResNet_18, epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6080/6947 (87.5198%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3909, Accuracy: 4897/10000 (48.9700%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4818/5504 (87.5363%)
___Train Local_ResNet_18, epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4816/5504 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0697, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18, epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4450/4748 (93.7237%)
___Train Local_ResNet_18, epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4470/4748 (94.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9031, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5041/5645 (89.3003%)
___Train Local_ResNet_18, epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4899/5645 (86.7848%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2619, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18, epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5424/6080 (89.2105%)
___Train Local_ResNet_18, epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5403/6080 (88.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0919, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18, epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3311/3589 (92.2541%)
___Train Local_ResNet_18, epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3249/3589 (90.5266%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9825, Accuracy: 5559/10000 (55.5900%)
time spent on training: 221.97330045700073
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1764, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4420, Accuracy: 8795/9900 (88.8384%)
Done in 248.86912631988525 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5093/5308 (95.9495%), train_poison_data_count: 415
Global model norm: 42.98531072909166.
Norm before scaling: 42.96361474995805. Distance: 1.4603895495949573
Total norm for 4 adversaries is: 42.96361474995805. distance: 1.4603895495949573
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 42.98531072909166.
Norm before scaling: 42.95461983575661. Distance: 1.3894066777910214
Total norm for 4 adversaries is: 42.95461983575661. distance: 1.3894066777910214
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4867/5123 (95.0029%), train_poison_data_count: 403
Global model norm: 42.98531072909166.
Norm before scaling: 42.96720735867209. Distance: 1.5300175124768074
Total norm for 4 adversaries is: 42.96720735867209. distance: 1.5300175124768074
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5254/5503 (95.4752%), train_poison_data_count: 430
Global model norm: 42.98531072909166.
Norm before scaling: 42.96622435759134. Distance: 1.5834979005251024
Total norm for 4 adversaries is: 42.96622435759134. distance: 1.5834979005251024
___Train Local_ResNet_18, epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4795/5361 (89.4423%)
___Train Local_ResNet_18, epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4755/5361 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0338, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18, epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3808/4086 (93.1963%)
___Train Local_ResNet_18, epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3841/4086 (94.0039%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9766, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4885/5702 (85.6717%)
___Train Local_ResNet_18, epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4608/5702 (80.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3740, Accuracy: 4704/10000 (47.0400%)
___Train Local_ResNet_18, epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5419/6080 (89.1283%)
___Train Local_ResNet_18, epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5342/6080 (87.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1825, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18, epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5499/5939 (92.5913%)
___Train Local_ResNet_18, epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5508/5939 (92.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0812, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4944/5497 (89.9400%)
___Train Local_ResNet_18, epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4936/5497 (89.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0157, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18, epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4566/5038 (90.6312%)
___Train Local_ResNet_18, epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4564/5038 (90.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9570, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4652/4993 (93.1704%)
___Train Local_ResNet_18, epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4604/4993 (92.2091%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0666, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4369/4903 (89.1087%)
___Train Local_ResNet_18, epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4441/4903 (90.5772%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9779, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 6261/6812 (91.9113%)
___Train Local_ResNet_18, epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6205/6812 (91.0893%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2378, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4992/5526 (90.3366%)
___Train Local_ResNet_18, epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4936/5526 (89.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1409, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18, epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3623/3910 (92.6598%)
___Train Local_ResNet_18, epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3503/3910 (89.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0292, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18, epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4696/5075 (92.5320%)
___Train Local_ResNet_18, epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5075 (91.2118%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1168, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3789/4108 (92.2347%)
___Train Local_ResNet_18, epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3825/4108 (93.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8930, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4973/5298 (93.8656%)
___Train Local_ResNet_18, epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4912/5298 (92.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9676, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5044/5422 (93.0284%)
___Train Local_ResNet_18, epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5001/5422 (92.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8549, Accuracy: 5701/10000 (57.0100%)
time spent on training: 225.4873242378235
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1784, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4128, Accuracy: 8852/9900 (89.4141%)
Done in 252.14827680587769 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5098/5308 (96.0437%), train_poison_data_count: 415
Global model norm: 43.00742293760898.
Norm before scaling: 42.986781727879006. Distance: 1.4855769862278723
Total norm for 4 adversaries is: 42.986781727879006. distance: 1.4855769862278723
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5594/5777 (96.8323%), train_poison_data_count: 455
Global model norm: 43.00742293760898.
Norm before scaling: 42.97754313437644. Distance: 1.4259579901693398
Total norm for 4 adversaries is: 42.97754313437644. distance: 1.4259579901693398
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5123 (94.4564%), train_poison_data_count: 403
Global model norm: 43.00742293760898.
Norm before scaling: 42.990784123242626. Distance: 1.6122661657600958
Total norm for 4 adversaries is: 42.990784123242626. distance: 1.6122661657600958
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5286/5503 (96.0567%), train_poison_data_count: 430
Global model norm: 43.00742293760898.
Norm before scaling: 42.985234054029384. Distance: 1.474679786062143
Total norm for 4 adversaries is: 42.985234054029384. distance: 1.474679786062143
___Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5439/5939 (91.5811%)
___Train Local_ResNet_18, epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5441/5939 (91.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1278, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18, epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4359/4894 (89.0682%)
___Train Local_ResNet_18, epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4347/4894 (88.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1717, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4878/5353 (91.1265%)
___Train Local_ResNet_18, epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4813/5353 (89.9122%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0438, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18, epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4080/4527 (90.1259%)
___Train Local_ResNet_18, epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4047/4527 (89.3970%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9651, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3540/3929 (90.0993%)
___Train Local_ResNet_18, epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3567/3929 (90.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7537, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18, epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5318/5907 (90.0288%)
___Train Local_ResNet_18, epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5295/5907 (89.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1796, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18, epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5040/5652 (89.1720%)
___Train Local_ResNet_18, epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5012/5652 (88.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2238, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18, epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4435/4843 (91.5755%)
___Train Local_ResNet_18, epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4423/4843 (91.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9549, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3585/3968 (90.3478%)
___Train Local_ResNet_18, epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3627/3968 (91.4062%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8405, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4491/4889 (91.8593%)
___Train Local_ResNet_18, epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4434/4889 (90.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2268, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3244/3552 (91.3288%)
___Train Local_ResNet_18, epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3344/3552 (94.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8370, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3822/4086 (93.5389%)
___Train Local_ResNet_18, epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3819/4086 (93.4655%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9915, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18, epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4523/4979 (90.8415%)
___Train Local_ResNet_18, epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4545/4979 (91.2834%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1260, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4615/5035 (91.6584%)
___Train Local_ResNet_18, epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4666/5035 (92.6713%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8891, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18, epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4594/5122 (89.6915%)
___Train Local_ResNet_18, epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4307/5122 (84.0882%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.7228, Accuracy: 4505/10000 (45.0500%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5079/5615 (90.4541%)
___Train Local_ResNet_18, epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5106/5615 (90.9350%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1690, Accuracy: 5240/10000 (52.4000%)
time spent on training: 219.99555945396423
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1847, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3666, Accuracy: 8949/9900 (90.3939%)
Done in 248.12771463394165 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5102/5308 (96.1191%), train_poison_data_count: 415
Global model norm: 43.028614548017636.
Norm before scaling: 43.006892162041886. Distance: 1.4464714558617051
Total norm for 4 adversaries is: 43.006892162041886. distance: 1.4464714558617051
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5582/5777 (96.6245%), train_poison_data_count: 455
Global model norm: 43.028614548017636.
Norm before scaling: 43.00093396968983. Distance: 1.4133103620188856
Total norm for 4 adversaries is: 43.00093396968983. distance: 1.4133103620188856
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4893/5123 (95.5104%), train_poison_data_count: 403
Global model norm: 43.028614548017636.
Norm before scaling: 43.00552545576629. Distance: 1.4667376266277485
Total norm for 4 adversaries is: 43.00552545576629. distance: 1.4667376266277485
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5287/5503 (96.0749%), train_poison_data_count: 430
Global model norm: 43.028614548017636.
Norm before scaling: 43.00557229065642. Distance: 1.470124514619669
Total norm for 4 adversaries is: 43.00557229065642. distance: 1.470124514619669
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4461/4830 (92.3602%)
___Train Local_ResNet_18, epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4482/4830 (92.7950%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1342, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4314/4737 (91.0703%)
___Train Local_ResNet_18, epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4288/4737 (90.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0295, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18, epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5120/5615 (91.1843%)
___Train Local_ResNet_18, epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5092/5615 (90.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4244, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18, epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3614/3959 (91.2857%)
___Train Local_ResNet_18, epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3665/3959 (92.5739%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8960, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18, epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18, epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3780/4175 (90.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9442, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18, epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5044/5526 (91.2776%)
___Train Local_ResNet_18, epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4942/5526 (89.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9956, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4176/4537 (92.0432%)
___Train Local_ResNet_18, epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4205/4537 (92.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0618, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3938/4313 (91.3054%)
___Train Local_ResNet_18, epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3960/4313 (91.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9207, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5109/5422 (94.2272%)
___Train Local_ResNet_18, epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5071/5422 (93.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9653, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5025/5645 (89.0168%)
___Train Local_ResNet_18, epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5015/5645 (88.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1028, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18, epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4741 (91.0567%)
___Train Local_ResNet_18, epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3860/4741 (81.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.6132, Accuracy: 4627/10000 (46.2700%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5249/5696 (92.1524%)
___Train Local_ResNet_18, epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5226/5696 (91.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1423, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4616/5038 (91.6237%)
___Train Local_ResNet_18, epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4637/5038 (92.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8704, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4384/4903 (89.4146%)
___Train Local_ResNet_18, epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4401/4903 (89.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0748, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18, epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4701/5068 (92.7585%)
___Train Local_ResNet_18, epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4670/5068 (92.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0329, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4438/4748 (93.4709%)
___Train Local_ResNet_18, epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4408/4748 (92.8391%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9841, Accuracy: 5490/10000 (54.9000%)
time spent on training: 221.39261412620544
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1852, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3333, Accuracy: 9037/9900 (91.2828%)
Done in 248.67200922966003 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5094/5308 (95.9683%), train_poison_data_count: 415
Global model norm: 43.0496950641603.
Norm before scaling: 43.02774359352347. Distance: 1.4670207618487172
Total norm for 4 adversaries is: 43.02774359352347. distance: 1.4670207618487172
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 43.0496950641603.
Norm before scaling: 43.01999501049628. Distance: 1.4133205258640855
Total norm for 4 adversaries is: 43.01999501049628. distance: 1.4133205258640855
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4874/5123 (95.1396%), train_poison_data_count: 403
Global model norm: 43.0496950641603.
Norm before scaling: 43.03016208002025. Distance: 1.5259295304102198
Total norm for 4 adversaries is: 43.03016208002025. distance: 1.5259295304102198
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5263/5503 (95.6387%), train_poison_data_count: 430
Global model norm: 43.0496950641603.
Norm before scaling: 43.03076065217402. Distance: 1.5286730666932593
Total norm for 4 adversaries is: 43.03076065217402. distance: 1.5286730666932593
___Train Local_ResNet_18, epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3245/3552 (91.3570%)
___Train Local_ResNet_18, epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3334/3552 (93.8626%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7487, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3619/3910 (92.5575%)
___Train Local_ResNet_18, epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3586/3910 (91.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2060, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18, epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4835/5399 (89.5536%)
___Train Local_ResNet_18, epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4762/5399 (88.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2328, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5094/5615 (90.7213%)
___Train Local_ResNet_18, epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5079/5615 (90.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0964, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5695/6419 (88.7210%)
___Train Local_ResNet_18, epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5620/6419 (87.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1707, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4427/4889 (90.5502%)
___Train Local_ResNet_18, epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4387/4889 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0427, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18, epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4891/5427 (90.1235%)
___Train Local_ResNet_18, epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4821/5427 (88.8336%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1277, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18, epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5280/5696 (92.6966%)
___Train Local_ResNet_18, epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5197/5696 (91.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0415, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18, epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4157/4537 (91.6244%)
___Train Local_ResNet_18, epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4167/4537 (91.8448%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9547, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18, epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3612/3995 (90.4130%)
___Train Local_ResNet_18, epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3577/3995 (89.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0637, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18, epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4637/4993 (92.8700%)
___Train Local_ResNet_18, epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4635/4993 (92.8300%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0425, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18, epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4404/4869 (90.4498%)
___Train Local_ResNet_18, epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4062/4869 (83.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1515, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4751/5068 (93.7451%)
___Train Local_ResNet_18, epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4729/5068 (93.3110%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9729, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18, epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3499/3774 (92.7133%)
___Train Local_ResNet_18, epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3540/3774 (93.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8093, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4945/5298 (93.3371%)
___Train Local_ResNet_18, epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4938/5298 (93.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1277, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4997/5461 (91.5034%)
___Train Local_ResNet_18, epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4972/5461 (91.0456%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2916, Accuracy: 5093/10000 (50.9300%)
time spent on training: 219.86153721809387
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1837, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3268, Accuracy: 9039/9900 (91.3030%)
Done in 246.69500088691711 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5130/5308 (96.6466%), train_poison_data_count: 415
Global model norm: 43.07014740694824.
Norm before scaling: 43.04494239082784. Distance: 1.3610473518402715
Total norm for 4 adversaries is: 43.04494239082784. distance: 1.3610473518402715
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.07014740694824.
Norm before scaling: 43.03949857398434. Distance: 1.41214423974184
Total norm for 4 adversaries is: 43.03949857398434. distance: 1.41214423974184
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4898/5123 (95.6080%), train_poison_data_count: 403
Global model norm: 43.07014740694824.
Norm before scaling: 43.04840486165327. Distance: 1.4500971597150052
Total norm for 4 adversaries is: 43.04840486165327. distance: 1.4500971597150052
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5266/5503 (95.6933%), train_poison_data_count: 430
Global model norm: 43.07014740694824.
Norm before scaling: 43.048203529862164. Distance: 1.4879868584175615
Total norm for 4 adversaries is: 43.048203529862164. distance: 1.4879868584175615
___Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3550/3995 (88.8611%)
___Train Local_ResNet_18, epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3589/3995 (89.8373%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0648, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4386/4851 (90.4143%)
___Train Local_ResNet_18, epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4423/4851 (91.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0758, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18, epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4682/5035 (92.9891%)
___Train Local_ResNet_18, epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4657/5035 (92.4926%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9989, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3799/4130 (91.9855%)
___Train Local_ResNet_18, epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3819/4130 (92.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8107, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18, epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4473/5018 (89.1391%)
___Train Local_ResNet_18, epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4427/5018 (88.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2000, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18, epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4935/5346 (92.3120%)
___Train Local_ResNet_18, epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4917/5346 (91.9753%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1452, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18, epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4554/4929 (92.3920%)
___Train Local_ResNet_18, epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4467/4929 (90.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2791, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4957/5454 (90.8874%)
___Train Local_ResNet_18, epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4881/5454 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0676, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18, epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3777/4108 (91.9426%)
___Train Local_ResNet_18, epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3789/4108 (92.2347%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9204, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4029/4368 (92.2390%)
___Train Local_ResNet_18, epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4081/4368 (93.4295%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9532, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18, epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3902/4249 (91.8334%)
___Train Local_ResNet_18, epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3867/4249 (91.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0654, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18, epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4295/4737 (90.6692%)
___Train Local_ResNet_18, epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4271/4737 (90.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2169, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18, epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6276/6812 (92.1315%)
___Train Local_ResNet_18, epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6250/6812 (91.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0959, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5472/5939 (92.1367%)
___Train Local_ResNet_18, epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5516/5939 (92.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8432, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18, epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5416/5907 (91.6878%)
___Train Local_ResNet_18, epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5310/5907 (89.8933%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2688, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4392/4843 (90.6876%)
___Train Local_ResNet_18, epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4451/4843 (91.9058%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9540, Accuracy: 5601/10000 (56.0100%)
time spent on training: 221.89544534683228
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1831, Accuracy: 6894/10000 (68.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3160, Accuracy: 9061/9900 (91.5253%)
Done in 248.5731077194214 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.09113536756284.
Norm before scaling: 43.0660616837123. Distance: 1.402882889417571
Total norm for 4 adversaries is: 43.0660616837123. distance: 1.402882889417571
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5567/5777 (96.3649%), train_poison_data_count: 455
Global model norm: 43.09113536756284.
Norm before scaling: 43.060607779997866. Distance: 1.4666382237768656
Total norm for 4 adversaries is: 43.060607779997866. distance: 1.4666382237768656
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4886/5123 (95.3738%), train_poison_data_count: 403
Global model norm: 43.09113536756284.
Norm before scaling: 43.07062638761915. Distance: 1.4742706920406559
Total norm for 4 adversaries is: 43.07062638761915. distance: 1.4742706920406559
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5303/5503 (96.3656%), train_poison_data_count: 430
Global model norm: 43.09113536756284.
Norm before scaling: 43.067025399460924. Distance: 1.4412202379076777
Total norm for 4 adversaries is: 43.067025399460924. distance: 1.4412202379076777
___Train Local_ResNet_18, epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6298/6812 (92.4545%)
___Train Local_ResNet_18, epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6308/6812 (92.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0211, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18, epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4950/5346 (92.5926%)
___Train Local_ResNet_18, epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4964/5346 (92.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0243, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5020/5526 (90.8433%)
___Train Local_ResNet_18, epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4913/5526 (88.9070%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1536, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4409/4757 (92.6845%)
___Train Local_ResNet_18, epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4389/4757 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0321, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18, epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4507/5018 (89.8167%)
___Train Local_ResNet_18, epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4461/5018 (88.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0396, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18, epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4200/4537 (92.5722%)
___Train Local_ResNet_18, epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4182/4537 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8744, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18, epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4637/4993 (92.8700%)
___Train Local_ResNet_18, epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4610/4993 (92.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1561, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18, epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5551/6235 (89.0297%)
___Train Local_ResNet_18, epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5423/6235 (86.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1138, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4636/5193 (89.2740%)
___Train Local_ResNet_18, epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4560/5193 (87.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2231, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18, epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4063/4485 (90.5909%)
___Train Local_ResNet_18, epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4026/4485 (89.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1646, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18, epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5398/6080 (88.7829%)
___Train Local_ResNet_18, epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5339/6080 (87.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2403, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18, epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4652/5224 (89.0505%)
___Train Local_ResNet_18, epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4733/5224 (90.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1181, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18, epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4410/4869 (90.5730%)
___Train Local_ResNet_18, epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4091/4869 (84.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1449, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18, epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4956 (92.4334%)
___Train Local_ResNet_18, epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4543/4956 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9547, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18, epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5249/5696 (92.1524%)
___Train Local_ResNet_18, epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5264/5696 (92.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9544, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4462/4889 (91.2661%)
___Train Local_ResNet_18, epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4480/4889 (91.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9935, Accuracy: 5521/10000 (55.2100%)
time spent on training: 226.99740886688232
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1855, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3254, Accuracy: 9045/9900 (91.3636%)
Done in 253.86078596115112 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5116/5308 (96.3828%), train_poison_data_count: 415
Global model norm: 43.11476327779152.
Norm before scaling: 43.089972470855244. Distance: 1.4234654680303722
Total norm for 4 adversaries is: 43.089972470855244. distance: 1.4234654680303722
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5572/5777 (96.4514%), train_poison_data_count: 455
Global model norm: 43.11476327779152.
Norm before scaling: 43.08630793698417. Distance: 1.4558209257829027
Total norm for 4 adversaries is: 43.08630793698417. distance: 1.4558209257829027
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4902/5123 (95.6861%), train_poison_data_count: 403
Global model norm: 43.11476327779152.
Norm before scaling: 43.09314522101006. Distance: 1.466430130582722
Total norm for 4 adversaries is: 43.09314522101006. distance: 1.466430130582722
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5282/5503 (95.9840%), train_poison_data_count: 430
Global model norm: 43.11476327779152.
Norm before scaling: 43.0914653922147. Distance: 1.4828402967832242
Total norm for 4 adversaries is: 43.0914653922147. distance: 1.4828402967832242
___Train Local_ResNet_18, epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5073/5422 (93.5633%)
___Train Local_ResNet_18, epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4940/5422 (91.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0984, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18, epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4940/5497 (89.8672%)
___Train Local_ResNet_18, epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4942/5497 (89.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2206, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18, epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5704/6419 (88.8612%)
___Train Local_ResNet_18, epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5538/6419 (86.2751%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5342, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18, epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5438/5871 (92.6248%)
___Train Local_ResNet_18, epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5409/5871 (92.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0312, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18, epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4147/4397 (94.3143%)
___Train Local_ResNet_18, epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7861, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18, epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4701/4993 (94.1518%)
___Train Local_ResNet_18, epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4650/4993 (93.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0927, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18, epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3573/3959 (90.2501%)
___Train Local_ResNet_18, epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3636/3959 (91.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1132, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18, epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5100/5652 (90.2335%)
___Train Local_ResNet_18, epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5036/5652 (89.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2964, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18, epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4971/5702 (87.1799%)
___Train Local_ResNet_18, epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4767/5702 (83.6022%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2504, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18, epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3606/3968 (90.8770%)
___Train Local_ResNet_18, epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3656/3968 (92.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8013, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18, epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5463/5939 (91.9852%)
___Train Local_ResNet_18, epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5469/5939 (92.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9771, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4643/5123 (90.6305%)
___Train Local_ResNet_18, epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4404/5123 (85.9653%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3399, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18, epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4295/4549 (94.4164%)
___Train Local_ResNet_18, epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4216/4549 (92.6797%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0979, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18, epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3248/3552 (91.4414%)
___Train Local_ResNet_18, epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3290/3552 (92.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8864, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18, epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4542/5122 (88.6763%)
___Train Local_ResNet_18, epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4388/5122 (85.6697%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1719, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18, epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6337/6812 (93.0270%)
___Train Local_ResNet_18, epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6249/6812 (91.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0695, Accuracy: 5336/10000 (53.3600%)
time spent on training: 224.86793303489685
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1895, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3029, Accuracy: 9092/9900 (91.8384%)
Done in 251.532231092453 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5115/5308 (96.3640%), train_poison_data_count: 415
Global model norm: 43.13649642957515.
Norm before scaling: 43.11213151525986. Distance: 1.4198195303825027
Total norm for 4 adversaries is: 43.11213151525986. distance: 1.4198195303825027
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5572/5777 (96.4514%), train_poison_data_count: 455
Global model norm: 43.13649642957515.
Norm before scaling: 43.10650645131776. Distance: 1.4551335061818171
Total norm for 4 adversaries is: 43.10650645131776. distance: 1.4551335061818171
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.13649642957515.
Norm before scaling: 43.11543004096315. Distance: 1.4650233451102885
Total norm for 4 adversaries is: 43.11543004096315. distance: 1.4650233451102885
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5256/5503 (95.5115%), train_poison_data_count: 430
Global model norm: 43.13649642957515.
Norm before scaling: 43.11707637805032. Distance: 1.5470671871516373
Total norm for 4 adversaries is: 43.11707637805032. distance: 1.5470671871516373
___Train Local_ResNet_18, epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4383/4731 (92.6443%)
___Train Local_ResNet_18, epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4407/4731 (93.1516%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9592, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4338/4797 (90.4315%)
___Train Local_ResNet_18, epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4367/4797 (91.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9246, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4635/5035 (92.0556%)
___Train Local_ResNet_18, epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4683/5035 (93.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0556, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4924/5362 (91.8314%)
___Train Local_ResNet_18, epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4890/5362 (91.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0710, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4687/5123 (91.4894%)
___Train Local_ResNet_18, epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4235/5123 (82.6664%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3081, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18, epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5039/5346 (94.2574%)
___Train Local_ResNet_18, epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4938/5346 (92.3681%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0925, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4386/4714 (93.0420%)
___Train Local_ResNet_18, epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4444/4714 (94.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9587, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18, epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5045/5652 (89.2604%)
___Train Local_ResNet_18, epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5036/5652 (89.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1254, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18, epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4094/4527 (90.4352%)
___Train Local_ResNet_18, epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4050/4527 (89.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9835, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18, epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3962/4313 (91.8618%)
___Train Local_ResNet_18, epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4038/4313 (93.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7451, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18, epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 6208/6947 (89.3623%)
___Train Local_ResNet_18, epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6013/6947 (86.5553%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.4301, Accuracy: 4645/10000 (46.4500%)
___Train Local_ResNet_18, epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4669/4993 (93.5109%)
___Train Local_ResNet_18, epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4596/4993 (92.0489%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1318, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4633/5086 (91.0932%)
___Train Local_ResNet_18, epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4644/5086 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8579, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18, epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4599/5038 (91.2862%)
___Train Local_ResNet_18, epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4621/5038 (91.7229%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9706, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18, epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4993/5461 (91.4301%)
___Train Local_ResNet_18, epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4978/5461 (91.1555%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0089, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18, epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5163/5727 (90.1519%)
___Train Local_ResNet_18, epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5046/5727 (88.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1642, Accuracy: 5262/10000 (52.6200%)
time spent on training: 225.9627823829651
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1902, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2758, Accuracy: 9156/9900 (92.4848%)
Done in 252.64342594146729 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 43.15792589296678.
Norm before scaling: 43.13370468081993. Distance: 1.425438408587774
Total norm for 4 adversaries is: 43.13370468081993. distance: 1.425438408587774
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5539/5777 (95.8802%), train_poison_data_count: 455
Global model norm: 43.15792589296678.
Norm before scaling: 43.130011314357. Distance: 1.5100472447917965
Total norm for 4 adversaries is: 43.130011314357. distance: 1.5100472447917965
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4923/5123 (96.0960%), train_poison_data_count: 403
Global model norm: 43.15792589296678.
Norm before scaling: 43.132442462413806. Distance: 1.3918986113883316
Total norm for 4 adversaries is: 43.132442462413806. distance: 1.3918986113883316
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5277/5503 (95.8931%), train_poison_data_count: 430
Global model norm: 43.15792589296678.
Norm before scaling: 43.134741879733674. Distance: 1.5048942194165345
Total norm for 4 adversaries is: 43.134741879733674. distance: 1.5048942194165345
___Train Local_ResNet_18, epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3971/4313 (92.0705%)
___Train Local_ResNet_18, epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3996/4313 (92.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7821, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18, epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4399/4894 (89.8856%)
___Train Local_ResNet_18, epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4261/4894 (87.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1888, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18, epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4168/4397 (94.7919%)
___Train Local_ResNet_18, epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4240/4397 (96.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7100, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18, epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4464/4748 (94.0185%)
___Train Local_ResNet_18, epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4350/4748 (91.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0697, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18, epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5268/5696 (92.4860%)
___Train Local_ResNet_18, epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5179/5696 (90.9235%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1432, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18, epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4898/5427 (90.2524%)
___Train Local_ResNet_18, epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4857/5427 (89.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0759, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18, epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4261/4605 (92.5299%)
___Train Local_ResNet_18, epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4230/4605 (91.8567%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0063, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18, epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5093/5422 (93.9321%)
___Train Local_ResNet_18, epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4996/5422 (92.1431%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9885, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5447/5871 (92.7781%)
___Train Local_ResNet_18, epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5381/5871 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0187, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5111/5652 (90.4282%)
___Train Local_ResNet_18, epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5099/5652 (90.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0921, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4898/5362 (91.3465%)
___Train Local_ResNet_18, epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4816/5362 (89.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1004, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18, epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4946/5702 (86.7415%)
___Train Local_ResNet_18, epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4691/5702 (82.2694%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3042, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18, epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4713/5075 (92.8670%)
___Train Local_ResNet_18, epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4633/5075 (91.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1080, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5605/6068 (92.3698%)
___Train Local_ResNet_18, epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5559/6068 (91.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1223, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6356/6812 (93.3059%)
___Train Local_ResNet_18, epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6311/6812 (92.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0282, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18, epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4439/4732 (93.8081%)
___Train Local_ResNet_18, epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4496/4732 (95.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8839, Accuracy: 5667/10000 (56.6700%)
time spent on training: 228.54504561424255
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1902, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2625, Accuracy: 9180/9900 (92.7273%)
Done in 255.07146859169006 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5116/5308 (96.3828%), train_poison_data_count: 415
Global model norm: 43.179804114868766.
Norm before scaling: 43.15466880249604. Distance: 1.4051130997284753
Total norm for 4 adversaries is: 43.15466880249604. distance: 1.4051130997284753
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5579/5777 (96.5726%), train_poison_data_count: 455
Global model norm: 43.179804114868766.
Norm before scaling: 43.148912075291655. Distance: 1.4163145394362546
Total norm for 4 adversaries is: 43.148912075291655. distance: 1.4163145394362546
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4907/5123 (95.7837%), train_poison_data_count: 403
Global model norm: 43.179804114868766.
Norm before scaling: 43.15707169067501. Distance: 1.4365314039972847
Total norm for 4 adversaries is: 43.15707169067501. distance: 1.4365314039972847
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5252/5503 (95.4389%), train_poison_data_count: 430
Global model norm: 43.179804114868766.
Norm before scaling: 43.15711270408535. Distance: 1.5230483120414722
Total norm for 4 adversaries is: 43.15711270408535. distance: 1.5230483120414722
___Train Local_ResNet_18, epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5613/6235 (90.0241%)
___Train Local_ResNet_18, epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5546/6235 (88.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2482, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18, epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5136/5422 (94.7252%)
___Train Local_ResNet_18, epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5059/5422 (93.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9695, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4153/4587 (90.5385%)
___Train Local_ResNet_18, epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4175/4587 (91.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9908, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18, epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4762/5399 (88.2015%)
___Train Local_ResNet_18, epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4629/5399 (85.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0286, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18, epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3620/3910 (92.5831%)
___Train Local_ResNet_18, epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3505/3910 (89.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2685, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18, epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5343/5907 (90.4520%)
___Train Local_ResNet_18, epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5365/5907 (90.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1807, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18, epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4865/5361 (90.7480%)
___Train Local_ResNet_18, epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4874/5361 (90.9159%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0979, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18, epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4553/5018 (90.7334%)
___Train Local_ResNet_18, epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4496/5018 (89.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0997, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18, epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6271/6947 (90.2692%)
___Train Local_ResNet_18, epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6052/6947 (87.1167%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2305, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18, epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3329/3589 (92.7556%)
___Train Local_ResNet_18, epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3173/3589 (88.4090%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0558, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5026/5559 (90.4119%)
___Train Local_ResNet_18, epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4920/5559 (88.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2689, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18, epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6299/6812 (92.4692%)
___Train Local_ResNet_18, epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6252/6812 (91.7792%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2764, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18, epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4993/5346 (93.3969%)
___Train Local_ResNet_18, epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4941/5346 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1148, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4380/4903 (89.3331%)
___Train Local_ResNet_18, epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4396/4903 (89.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3269, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18, epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4180/4397 (95.0648%)
___Train Local_ResNet_18, epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4193/4397 (95.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8764, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18, epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4642/5035 (92.1946%)
___Train Local_ResNet_18, epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4650/5035 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9658, Accuracy: 5595/10000 (55.9500%)
time spent on training: 224.82888865470886
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1941, Accuracy: 6865/10000 (68.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2469, Accuracy: 9218/9900 (93.1111%)
Done in 251.8166048526764 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5118/5308 (96.4205%), train_poison_data_count: 415
Global model norm: 43.20278876451438.
Norm before scaling: 43.177843529697036. Distance: 1.415243003791534
Total norm for 4 adversaries is: 43.177843529697036. distance: 1.415243003791534
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.20278876451438.
Norm before scaling: 43.16959594056765. Distance: 1.3711056613676422
Total norm for 4 adversaries is: 43.16959594056765. distance: 1.3711056613676422
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4915/5123 (95.9399%), train_poison_data_count: 403
Global model norm: 43.20278876451438.
Norm before scaling: 43.177908554136515. Distance: 1.4024154092230465
Total norm for 4 adversaries is: 43.177908554136515. distance: 1.4024154092230465
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5273/5503 (95.8205%), train_poison_data_count: 430
Global model norm: 43.20278876451438.
Norm before scaling: 43.179190646453904. Distance: 1.5153629037030811
Total norm for 4 adversaries is: 43.179190646453904. distance: 1.5153629037030811
___Train Local_ResNet_18, epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5437/5871 (92.6077%)
___Train Local_ResNet_18, epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5440/5871 (92.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9957, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18, epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4684/5193 (90.1983%)
___Train Local_ResNet_18, epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4602/5193 (88.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4610, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18, epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5038/5559 (90.6278%)
___Train Local_ResNet_18, epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4922/5559 (88.5411%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2026, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18, epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4513/4843 (93.1860%)
___Train Local_ResNet_18, epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4413/4843 (91.1212%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1694, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18, epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4303/4672 (92.1019%)
___Train Local_ResNet_18, epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4342/4672 (92.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0192, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18, epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4704/5075 (92.6897%)
___Train Local_ResNet_18, epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4679/5075 (92.1970%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0214, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4382/4851 (90.3319%)
___Train Local_ResNet_18, epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4422/4851 (91.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9497, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18, epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4748/5209 (91.1499%)
___Train Local_ResNet_18, epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4734/5209 (90.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0205, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18, epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5215/5696 (91.5555%)
___Train Local_ResNet_18, epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5137/5696 (90.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0529, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4619/5122 (90.1796%)
___Train Local_ResNet_18, epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4125/5122 (80.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3825, Accuracy: 4796/10000 (47.9600%)
___Train Local_ResNet_18, epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4268/4741 (90.0232%)
___Train Local_ResNet_18, epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3954/4741 (83.4001%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3374, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18, epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4348/4797 (90.6400%)
___Train Local_ResNet_18, epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4325/4797 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0203, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18, epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3988/4196 (95.0429%)
___Train Local_ResNet_18, epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3990/4196 (95.0906%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8145, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18, epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3796/4111 (92.3376%)
___Train Local_ResNet_18, epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3749/4111 (91.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8609, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18, epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4432/4869 (91.0249%)
___Train Local_ResNet_18, epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4101/4869 (84.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2484, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18, epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5068/5645 (89.7786%)
___Train Local_ResNet_18, epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4965/5645 (87.9539%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1479, Accuracy: 5118/10000 (51.1800%)
time spent on training: 222.82978510856628
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1955, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2468, Accuracy: 9224/9900 (93.1717%)
Done in 249.9726369380951 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.225652467603076.
Norm before scaling: 43.19836942633078. Distance: 1.3652758066769601
Total norm for 4 adversaries is: 43.19836942633078. distance: 1.3652758066769601
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 43.225652467603076.
Norm before scaling: 43.191235084053076. Distance: 1.3792830430609107
Total norm for 4 adversaries is: 43.191235084053076. distance: 1.3792830430609107
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4911/5123 (95.8618%), train_poison_data_count: 403
Global model norm: 43.225652467603076.
Norm before scaling: 43.20220670362221. Distance: 1.4290398970600948
Total norm for 4 adversaries is: 43.20220670362221. distance: 1.4290398970600948
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5285/5503 (96.0385%), train_poison_data_count: 430
Global model norm: 43.225652467603076.
Norm before scaling: 43.202064012740614. Distance: 1.5014889003408183
Total norm for 4 adversaries is: 43.202064012740614. distance: 1.5014889003408183
___Train Local_ResNet_18, epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4880/5353 (91.1638%)
___Train Local_ResNet_18, epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4898/5353 (91.5001%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0352, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3255/3552 (91.6385%)
___Train Local_ResNet_18, epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3325/3552 (93.6092%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8013, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18, epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3595/3959 (90.8058%)
___Train Local_ResNet_18, epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3662/3959 (92.4981%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9109, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4606/5055 (91.1177%)
___Train Local_ResNet_18, epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4620/5055 (91.3947%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0020, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18, epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4951/5702 (86.8292%)
___Train Local_ResNet_18, epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0128, Accuracy: 4325/5702 (75.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3936, Accuracy: 4659/10000 (46.5900%)
___Train Local_ResNet_18, epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3782/4108 (92.0643%)
___Train Local_ResNet_18, epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3794/4108 (92.3564%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9928, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18, epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6360/6812 (93.3647%)
___Train Local_ResNet_18, epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6272/6812 (92.0728%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1855, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18, epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4144/4485 (92.3969%)
___Train Local_ResNet_18, epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3961/4485 (88.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1967, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18, epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4710/5193 (90.6990%)
___Train Local_ResNet_18, epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4481/5193 (86.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3809, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18, epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4196/4397 (95.4287%)
___Train Local_ResNet_18, epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4202/4397 (95.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7856, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18, epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3801/4145 (91.7008%)
___Train Local_ResNet_18, epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3825/4145 (92.2799%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0349, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18, epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4989/5346 (93.3221%)
___Train Local_ResNet_18, epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4959/5346 (92.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2331, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18, epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3521/3774 (93.2962%)
___Train Local_ResNet_18, epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3538/3774 (93.7467%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8431, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18, epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5030/5461 (92.1077%)
___Train Local_ResNet_18, epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4981/5461 (91.2104%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0684, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5050/5652 (89.3489%)
___Train Local_ResNet_18, epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4976/5652 (88.0396%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3025, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18, epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5513/5939 (92.8271%)
___Train Local_ResNet_18, epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5448/5939 (91.7326%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9447, Accuracy: 5525/10000 (55.2500%)
time spent on training: 218.8246190547943
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.2036, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2266, Accuracy: 9272/9900 (93.6566%)
Done in 245.7736427783966 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5125/5308 (96.5524%), train_poison_data_count: 415
Global model norm: 43.24560806819.
Norm before scaling: 43.219285234845536. Distance: 1.403310416020145
Total norm for 4 adversaries is: 43.219285234845536. distance: 1.403310416020145
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.24560806819.
Norm before scaling: 43.21113312986814. Distance: 1.3558777733436203
Total norm for 4 adversaries is: 43.21113312986814. distance: 1.3558777733436203
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4917/5123 (95.9789%), train_poison_data_count: 403
Global model norm: 43.24560806819.
Norm before scaling: 43.220567511946065. Distance: 1.4001041901510414
Total norm for 4 adversaries is: 43.220567511946065. distance: 1.4001041901510414
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5294/5503 (96.2021%), train_poison_data_count: 430
Global model norm: 43.24560806819.
Norm before scaling: 43.22014809289615. Distance: 1.4791031228327634
Total norm for 4 adversaries is: 43.22014809289615. distance: 1.4791031228327634
___Train Local_ResNet_18, epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4103/4485 (91.4827%)
___Train Local_ResNet_18, epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3770/4485 (84.0580%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2129, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18, epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4265/4605 (92.6167%)
___Train Local_ResNet_18, epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4293/4605 (93.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9550, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18, epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5233/5696 (91.8715%)
___Train Local_ResNet_18, epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5230/5696 (91.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0051, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18, epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3840/4161 (92.2855%)
___Train Local_ResNet_18, epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3763/4161 (90.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0923, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18, epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3970/4196 (94.6139%)
___Train Local_ResNet_18, epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3951/4196 (94.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8403, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18, epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4426/4818 (91.8638%)
___Train Local_ResNet_18, epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4364/4818 (90.5770%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9237, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18, epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4688/4993 (93.8914%)
___Train Local_ResNet_18, epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4597/4993 (92.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3603, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18, epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3652/3968 (92.0363%)
___Train Local_ResNet_18, epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3662/3968 (92.2883%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9572, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18, epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5352/6080 (88.0263%)
___Train Local_ResNet_18, epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5342/6080 (87.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3297, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18, epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4600/5038 (91.3061%)
___Train Local_ResNet_18, epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4598/5038 (91.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0017, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18, epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5911/6664 (88.7005%)
___Train Local_ResNet_18, epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5657/6664 (84.8890%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3027, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18, epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3786/4111 (92.0944%)
___Train Local_ResNet_18, epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3761/4111 (91.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1581, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18, epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5042/5526 (91.2414%)
___Train Local_ResNet_18, epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4924/5526 (89.1060%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2226, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18, epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4760/5068 (93.9227%)
___Train Local_ResNet_18, epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4684/5068 (92.4230%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1402, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18, epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3585/3959 (90.5532%)
___Train Local_ResNet_18, epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3637/3959 (91.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8729, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18, epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4070/4368 (93.1777%)
___Train Local_ResNet_18, epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4098/4368 (93.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9525, Accuracy: 5612/10000 (56.1200%)
time spent on training: 216.61905813217163
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.2012, Accuracy: 6854/10000 (68.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2220, Accuracy: 9286/9900 (93.7980%)
Done in 243.69152855873108 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.265536125315.
Norm before scaling: 43.237659965102324. Distance: 1.3099709622608253
Total norm for 4 adversaries is: 43.237659965102324. distance: 1.3099709622608253
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5584/5777 (96.6592%), train_poison_data_count: 455
Global model norm: 43.265536125315.
Norm before scaling: 43.2333105443592. Distance: 1.4308150384289144
Total norm for 4 adversaries is: 43.2333105443592. distance: 1.4308150384289144
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4924/5123 (96.1156%), train_poison_data_count: 403
Global model norm: 43.265536125315.
Norm before scaling: 43.23943151222041. Distance: 1.3834124626753137
Total norm for 4 adversaries is: 43.23943151222041. distance: 1.3834124626753137
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.265536125315.
Norm before scaling: 43.240445002154814. Distance: 1.4236792550667348
Total norm for 4 adversaries is: 43.240445002154814. distance: 1.4236792550667348
___Train Local_ResNet_18, epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4276/4605 (92.8556%)
___Train Local_ResNet_18, epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4303/4605 (93.4419%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8381, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18, epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4740/5193 (91.2767%)
___Train Local_ResNet_18, epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4586/5193 (88.3112%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.4317, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18, epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4737/5209 (90.9388%)
___Train Local_ResNet_18, epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4727/5209 (90.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0232, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18, epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5499/5939 (92.5913%)
___Train Local_ResNet_18, epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5501/5939 (92.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9648, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5265/5696 (92.4333%)
___Train Local_ResNet_18, epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5204/5696 (91.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0223, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18, epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3803/4108 (92.5755%)
___Train Local_ResNet_18, epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3753/4108 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0276, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18, epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4505/4889 (92.1456%)
___Train Local_ResNet_18, epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4483/4889 (91.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0085, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5068/5645 (89.7786%)
___Train Local_ResNet_18, epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4937/5645 (87.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1673, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18, epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4531/4911 (92.2623%)
___Train Local_ResNet_18, epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4459/4911 (90.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1262, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18, epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4159/4587 (90.6693%)
___Train Local_ResNet_18, epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4153/4587 (90.5385%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0667, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3331/3589 (92.8114%)
___Train Local_ResNet_18, epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3213/3589 (89.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0276, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4973/5298 (93.8656%)
___Train Local_ResNet_18, epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4946/5298 (93.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9700, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18, epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5023/5497 (91.3771%)
___Train Local_ResNet_18, epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4960/5497 (90.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8548, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18, epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4458/4869 (91.5588%)
___Train Local_ResNet_18, epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3995/4869 (82.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.4149, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18, epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3955/4196 (94.2564%)
___Train Local_ResNet_18, epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3949/4196 (94.1134%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7770, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18, epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3628/3968 (91.4315%)
___Train Local_ResNet_18, epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3699/3968 (93.2208%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8412, Accuracy: 5788/10000 (57.8800%)
time spent on training: 220.3440065383911
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.2046, Accuracy: 6833/10000 (68.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2272, Accuracy: 9266/9900 (93.5960%)
Done in 247.06857252120972 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.286550611791505.
Norm before scaling: 43.26087770768252. Distance: 1.4022447131365514
Total norm for 4 adversaries is: 43.26087770768252. distance: 1.4022447131365514
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5588/5777 (96.7284%), train_poison_data_count: 455
Global model norm: 43.286550611791505.
Norm before scaling: 43.25514499292974. Distance: 1.4067918369382857
Total norm for 4 adversaries is: 43.25514499292974. distance: 1.4067918369382857
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4880/5123 (95.2567%), train_poison_data_count: 403
Global model norm: 43.286550611791505.
Norm before scaling: 43.26353145891901. Distance: 1.4647619606072741
Total norm for 4 adversaries is: 43.26353145891901. distance: 1.4647619606072741
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5287/5503 (96.0749%), train_poison_data_count: 430
Global model norm: 43.286550611791505.
Norm before scaling: 43.26035850711437. Distance: 1.4338768619727789
Total norm for 4 adversaries is: 43.26035850711437. distance: 1.4338768619727789
___Train Local_ResNet_18, epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3863/4161 (92.8383%)
___Train Local_ResNet_18, epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3861/4161 (92.7902%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0102, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18, epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4397/4748 (92.6074%)
___Train Local_ResNet_18, epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4320/4748 (90.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0169, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18, epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4868/5361 (90.8040%)
___Train Local_ResNet_18, epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4752/5361 (88.6402%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0539, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18, epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3795/4145 (91.5561%)
___Train Local_ResNet_18, epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3786/4145 (91.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0211, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18, epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4374/4714 (92.7874%)
___Train Local_ResNet_18, epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4396/4714 (93.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0004, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18, epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3836/4175 (91.8802%)
___Train Local_ResNet_18, epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3789/4175 (90.7545%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9967, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18, epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3549/3929 (90.3283%)
___Train Local_ResNet_18, epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3592/3929 (91.4228%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9749, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18, epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4079/4368 (93.3837%)
___Train Local_ResNet_18, epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3982/4368 (91.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0511, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18, epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5728/6419 (89.2351%)
___Train Local_ResNet_18, epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5558/6419 (86.5867%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2246, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18, epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4233/4549 (93.0534%)
___Train Local_ResNet_18, epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4080/4549 (89.6900%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0374, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4611/5122 (90.0234%)
___Train Local_ResNet_18, epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4214/5122 (82.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3981, Accuracy: 4806/10000 (48.0600%)
___Train Local_ResNet_18, epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4519/4911 (92.0179%)
___Train Local_ResNet_18, epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4480/4911 (91.2238%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2537, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18, epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3749/4028 (93.0735%)
___Train Local_ResNet_18, epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3754/4028 (93.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9759, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5192/5727 (90.6583%)
___Train Local_ResNet_18, epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5101/5727 (89.0693%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1662, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18, epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4718/4993 (94.4923%)
___Train Local_ResNet_18, epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4601/4993 (92.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2534, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18, epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4376/4714 (92.8299%)
___Train Local_ResNet_18, epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4380/4714 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1856, Accuracy: 5347/10000 (53.4700%)
time spent on training: 218.98651576042175
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.2047, Accuracy: 6834/10000 (68.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2148, Accuracy: 9303/9900 (93.9697%)
Done in 245.60900735855103 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5137/5308 (96.7784%), train_poison_data_count: 415
Global model norm: 43.30619345545811.
Norm before scaling: 43.27835335523552. Distance: 1.350762190940811
Total norm for 4 adversaries is: 43.27835335523552. distance: 1.350762190940811
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.30619345545811.
Norm before scaling: 43.26950991496495. Distance: 1.3537450818846914
Total norm for 4 adversaries is: 43.26950991496495. distance: 1.3537450818846914
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4899/5123 (95.6276%), train_poison_data_count: 403
Global model norm: 43.30619345545811.
Norm before scaling: 43.28067463516483. Distance: 1.4209007866174739
Total norm for 4 adversaries is: 43.28067463516483. distance: 1.4209007866174739
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5302/5503 (96.3474%), train_poison_data_count: 430
Global model norm: 43.30619345545811.
Norm before scaling: 43.28201009034744. Distance: 1.4707206329884175
Total norm for 4 adversaries is: 43.28201009034744. distance: 1.4707206329884175
___Train Local_ResNet_18, epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5032/5461 (92.1443%)
___Train Local_ResNet_18, epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4983/5461 (91.2470%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1427, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18, epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4072/4364 (93.3089%)
___Train Local_ResNet_18, epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3888/4364 (89.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9361, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18, epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4398/4714 (93.2966%)
___Train Local_ResNet_18, epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4440/4714 (94.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8913, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18, epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4444/4757 (93.4202%)
___Train Local_ResNet_18, epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4359/4757 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0988, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18, epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4972/5346 (93.0041%)
___Train Local_ResNet_18, epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5006/5346 (93.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9777, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18, epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4308/4605 (93.5505%)
___Train Local_ResNet_18, epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4312/4605 (93.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9119, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18, epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5573/6068 (91.8425%)
___Train Local_ResNet_18, epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5552/6068 (91.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1688, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4518/5050 (89.4653%)
___Train Local_ResNet_18, epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4520/5050 (89.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0067, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18, epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5178/5615 (92.2173%)
___Train Local_ResNet_18, epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5061/5615 (90.1336%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2442, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18, epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4925/5427 (90.7500%)
___Train Local_ResNet_18, epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4791/5427 (88.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1093, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4375/4731 (92.4752%)
___Train Local_ResNet_18, epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4372/4731 (92.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0036, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3893/4249 (91.6216%)
___Train Local_ResNet_18, epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3864/4249 (90.9390%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0492, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18, epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4601/5123 (89.8107%)
___Train Local_ResNet_18, epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4219/5123 (82.3541%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2799, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18, epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4629/5038 (91.8817%)
___Train Local_ResNet_18, epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4654/5038 (92.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9966, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18, epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4688/4993 (93.8914%)
___Train Local_ResNet_18, epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4619/4993 (92.5095%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0698, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18, epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4538/4979 (91.1428%)
___Train Local_ResNet_18, epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4501/4979 (90.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1158, Accuracy: 5301/10000 (53.0100%)
time spent on training: 214.39556193351746
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.2023, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2036, Accuracy: 9339/9900 (94.3333%)
Done in 241.29141664505005 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5157/5308 (97.1552%), train_poison_data_count: 415
Global model norm: 43.327657318067345.
Norm before scaling: 43.29821982303372. Distance: 1.317118873482747
Total norm for 4 adversaries is: 43.29821982303372. distance: 1.317118873482747
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.327657318067345.
Norm before scaling: 43.29280362488811. Distance: 1.3570859644373092
Total norm for 4 adversaries is: 43.29280362488811. distance: 1.3570859644373092
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4924/5123 (96.1156%), train_poison_data_count: 403
Global model norm: 43.327657318067345.
Norm before scaling: 43.30385099205598. Distance: 1.4116974331334085
Total norm for 4 adversaries is: 43.30385099205598. distance: 1.4116974331334085
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5299/5503 (96.2929%), train_poison_data_count: 430
Global model norm: 43.327657318067345.
Norm before scaling: 43.30110809106463. Distance: 1.4679717579029687
Total norm for 4 adversaries is: 43.30110809106463. distance: 1.4679717579029687
___Train Local_ResNet_18, epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4890/5427 (90.1050%)
___Train Local_ResNet_18, epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4846/5427 (89.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9820, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18, epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3974/4196 (94.7092%)
___Train Local_ResNet_18, epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4027/4196 (95.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7652, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18, epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3725/4028 (92.4777%)
___Train Local_ResNet_18, epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3748/4028 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8936, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18, epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3502/3774 (92.7928%)
___Train Local_ResNet_18, epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3541/3774 (93.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9188, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4950/5298 (93.4315%)
___Train Local_ResNet_18, epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4935/5298 (93.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0482, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6254/6947 (90.0245%)
___Train Local_ResNet_18, epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6166/6947 (88.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2478, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18, epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3826/4175 (91.6407%)
___Train Local_ResNet_18, epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3783/4175 (90.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9574, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18, epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5459/5871 (92.9825%)
___Train Local_ResNet_18, epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5388/5871 (91.7731%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1138, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18, epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4091/4527 (90.3689%)
___Train Local_ResNet_18, epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4067/4527 (89.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9275, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18, epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4172/4397 (94.8829%)
___Train Local_ResNet_18, epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4220/4397 (95.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.6641, Accuracy: 6041/10000 (60.4100%)
___Train Local_ResNet_18, epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5098/5422 (94.0243%)
___Train Local_ResNet_18, epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5061/5422 (93.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7844, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18, epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4927/5362 (91.8874%)
___Train Local_ResNet_18, epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4827/5362 (90.0224%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0622, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5096/5652 (90.1628%)
___Train Local_ResNet_18, epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5058/5652 (89.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3005, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18, epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4475/4911 (91.1220%)
___Train Local_ResNet_18, epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4531/4911 (92.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0815, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18, epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5944/6664 (89.1957%)
___Train Local_ResNet_18, epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5620/6664 (84.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1431, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18, epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4601/5055 (91.0188%)
___Train Local_ResNet_18, epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0503, Accuracy: 5466/10000 (54.6600%)
time spent on training: 223.8053731918335
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.2052, Accuracy: 6840/10000 (68.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1982, Accuracy: 9345/9900 (94.3939%)
Done in 250.78685474395752 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 43.347760268697854.
Norm before scaling: 43.322302563622614. Distance: 1.3925066016021885
Total norm for 4 adversaries is: 43.322302563622614. distance: 1.3925066016021885
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 43.347760268697854.
Norm before scaling: 43.311956052681055. Distance: 1.3544965880088033
Total norm for 4 adversaries is: 43.311956052681055. distance: 1.3544965880088033
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4926/5123 (96.1546%), train_poison_data_count: 403
Global model norm: 43.347760268697854.
Norm before scaling: 43.32238427755549. Distance: 1.4008694605543788
Total norm for 4 adversaries is: 43.32238427755549. distance: 1.4008694605543788
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5296/5503 (96.2384%), train_poison_data_count: 430
Global model norm: 43.347760268697854.
Norm before scaling: 43.32222930272417. Distance: 1.4661232205189136
Total norm for 4 adversaries is: 43.32222930272417. distance: 1.4661232205189136
___Train Local_ResNet_18, epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3840/4161 (92.2855%)
___Train Local_ResNet_18, epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3798/4161 (91.2761%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1806, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4117/4368 (94.2537%)
___Train Local_ResNet_18, epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4009/4368 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0104, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18, epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4401/4818 (91.3450%)
___Train Local_ResNet_18, epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4331/4818 (89.8921%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1141, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18, epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3831/4111 (93.1890%)
___Train Local_ResNet_18, epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3773/4111 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0074, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18, epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4897/5353 (91.4814%)
___Train Local_ResNet_18, epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4858/5353 (90.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1787, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18, epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5033/5346 (94.1452%)
___Train Local_ResNet_18, epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4982/5346 (93.1912%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9898, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18, epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4857/5504 (88.2449%)
___Train Local_ResNet_18, epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4868/5504 (88.4448%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1291, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18, epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3502/3774 (92.7928%)
___Train Local_ResNet_18, epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3504/3774 (92.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0107, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18, epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3801/4175 (91.0419%)
___Train Local_ResNet_18, epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3674/4175 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0632, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5081/5422 (93.7108%)
___Train Local_ResNet_18, epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5040/5422 (92.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9360, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18, epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5544/6068 (91.3645%)
___Train Local_ResNet_18, epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5539/6068 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2179, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4561/4929 (92.5340%)
___Train Local_ResNet_18, epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4490/4929 (91.0935%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0612, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18, epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4376/4757 (91.9908%)
___Train Local_ResNet_18, epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4341/4757 (91.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2590, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18, epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4622/5055 (91.4342%)
___Train Local_ResNet_18, epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4568/5055 (90.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2482, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18, epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4469/4843 (92.2775%)
___Train Local_ResNet_18, epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4443/4843 (91.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0417, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18, epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4653/5035 (92.4131%)
___Train Local_ResNet_18, epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4681/5035 (92.9692%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9713, Accuracy: 5532/10000 (55.3200%)
time spent on training: 214.84971475601196
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.2089, Accuracy: 6824/10000 (68.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1834, Accuracy: 9387/9900 (94.8182%)
Done in 241.80075216293335 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5308 (96.9480%), train_poison_data_count: 415
Global model norm: 43.36829018707101.
Norm before scaling: 43.339704152828354. Distance: 1.3612487857417357
Total norm for 4 adversaries is: 43.339704152828354. distance: 1.3612487857417357
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5609/5777 (97.0919%), train_poison_data_count: 455
Global model norm: 43.36829018707101.
Norm before scaling: 43.33626495617224. Distance: 1.4145208638049156
Total norm for 4 adversaries is: 43.33626495617224. distance: 1.4145208638049156
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4927/5123 (96.1741%), train_poison_data_count: 403
Global model norm: 43.36829018707101.
Norm before scaling: 43.342391099372186. Distance: 1.3876697127190967
Total norm for 4 adversaries is: 43.342391099372186. distance: 1.3876697127190967
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5331/5503 (96.8744%), train_poison_data_count: 430
Global model norm: 43.36829018707101.
Norm before scaling: 43.34173205243057. Distance: 1.4428810906749705
Total norm for 4 adversaries is: 43.34173205243057. distance: 1.4428810906749705
___Train Local_ResNet_18, epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4386/4818 (91.0336%)
___Train Local_ResNet_18, epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4375/4818 (90.8053%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0234, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18, epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4060/4527 (89.6841%)
___Train Local_ResNet_18, epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4042/4527 (89.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0829, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4752/5068 (93.7648%)
___Train Local_ResNet_18, epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4621/5068 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1317, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4693/5035 (93.2075%)
___Train Local_ResNet_18, epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4664/5035 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1864, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18, epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4737/4993 (94.8728%)
___Train Local_ResNet_18, epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4647/4993 (93.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0906, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18, epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4633/5055 (91.6518%)
___Train Local_ResNet_18, epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4552/5055 (90.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0317, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18, epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4437/4748 (93.4499%)
___Train Local_ResNet_18, epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4469/4748 (94.1238%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0721, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18, epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3985/4313 (92.3951%)
___Train Local_ResNet_18, epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3989/4313 (92.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9529, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18, epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4414/4894 (90.1921%)
___Train Local_ResNet_18, epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4331/4894 (88.4961%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2448, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18, epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4895/5353 (91.4441%)
___Train Local_ResNet_18, epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4772/5353 (89.1463%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9661, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18, epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5219/5727 (91.1297%)
___Train Local_ResNet_18, epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5203/5727 (90.8504%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9855, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18, epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3920/4249 (92.2570%)
___Train Local_ResNet_18, epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3875/4249 (91.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0403, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18, epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4136/4587 (90.1679%)
___Train Local_ResNet_18, epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4143/4587 (90.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0561, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18, epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3668/3968 (92.4395%)
___Train Local_ResNet_18, epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9242, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18, epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5046/5559 (90.7717%)
___Train Local_ResNet_18, epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4936/5559 (88.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0206, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18, epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4943/5298 (93.2994%)
___Train Local_ResNet_18, epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4945/5298 (93.3371%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1983, Accuracy: 5170/10000 (51.7000%)
time spent on training: 219.33728671073914
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2078, Accuracy: 6837/10000 (68.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1854, Accuracy: 9382/9900 (94.7677%)
Done in 245.8118314743042 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5158/5308 (97.1741%), train_poison_data_count: 415
Global model norm: 43.388886353355225.
Norm before scaling: 43.36013090557312. Distance: 1.3638081666340789
Total norm for 4 adversaries is: 43.36013090557312. distance: 1.3638081666340789
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5600/5777 (96.9361%), train_poison_data_count: 455
Global model norm: 43.388886353355225.
Norm before scaling: 43.355412262610734. Distance: 1.3707483187965548
Total norm for 4 adversaries is: 43.355412262610734. distance: 1.3707483187965548
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4938/5123 (96.3888%), train_poison_data_count: 403
Global model norm: 43.388886353355225.
Norm before scaling: 43.361503326143165. Distance: 1.3854565100808391
Total norm for 4 adversaries is: 43.361503326143165. distance: 1.3854565100808391
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.388886353355225.
Norm before scaling: 43.36340634412413. Distance: 1.4633667684108316
Total norm for 4 adversaries is: 43.36340634412413. distance: 1.4633667684108316
___Train Local_ResNet_18, epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4420/4818 (91.7393%)
___Train Local_ResNet_18, epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4352/4818 (90.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9717, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18, epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4943/5298 (93.2994%)
___Train Local_ResNet_18, epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4931/5298 (93.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1909, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4952/5353 (92.5089%)
___Train Local_ResNet_18, epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4829/5353 (90.2111%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1157, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18, epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3526/3774 (93.4287%)
___Train Local_ResNet_18, epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3555/3774 (94.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8801, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18, epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3621/3910 (92.6087%)
___Train Local_ResNet_18, epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3628/3910 (92.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3339, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18, epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4218/4537 (92.9689%)
___Train Local_ResNet_18, epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4201/4537 (92.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0019, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18, epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5882/6664 (88.2653%)
___Train Local_ResNet_18, epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5614/6664 (84.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0883, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18, epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4774/5209 (91.6491%)
___Train Local_ResNet_18, epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4701/5209 (90.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0633, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18, epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4646/5123 (90.6890%)
___Train Local_ResNet_18, epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4232/5123 (82.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1055, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3815/4145 (92.0386%)
___Train Local_ResNet_18, epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3866/4145 (93.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8352, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18, epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5024/5526 (90.9157%)
___Train Local_ResNet_18, epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4912/5526 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3326, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18, epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6300/6812 (92.4839%)
___Train Local_ResNet_18, epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6242/6812 (91.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0604, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18, epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5398/5907 (91.3831%)
___Train Local_ResNet_18, epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5290/5907 (89.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4721, Accuracy: 4842/10000 (48.4200%)
___Train Local_ResNet_18, epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3838/4175 (91.9281%)
___Train Local_ResNet_18, epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3819/4175 (91.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0626, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4699/5075 (92.5911%)
___Train Local_ResNet_18, epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4618/5075 (90.9951%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1253, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18, epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3807/4111 (92.6052%)
___Train Local_ResNet_18, epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3813/4111 (92.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9722, Accuracy: 5570/10000 (55.7000%)
time spent on training: 224.32809805870056
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2194, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1634, Accuracy: 9442/9900 (95.3737%)
Done in 250.96173548698425 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5145/5308 (96.9292%), train_poison_data_count: 415
Global model norm: 43.4103332312711.
Norm before scaling: 43.38364467169627. Distance: 1.3727710604214927
Total norm for 4 adversaries is: 43.38364467169627. distance: 1.3727710604214927
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 43.4103332312711.
Norm before scaling: 43.376433862737464. Distance: 1.3822958891784216
Total norm for 4 adversaries is: 43.376433862737464. distance: 1.3822958891784216
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4948/5123 (96.5840%), train_poison_data_count: 403
Global model norm: 43.4103332312711.
Norm before scaling: 43.381472409745385. Distance: 1.3635177188613072
Total norm for 4 adversaries is: 43.381472409745385. distance: 1.3635177188613072
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.4103332312711.
Norm before scaling: 43.3807618989073. Distance: 1.3926288012343218
Total norm for 4 adversaries is: 43.3807618989073. distance: 1.3926288012343218
___Train Local_ResNet_18, epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4372/4714 (92.7450%)
___Train Local_ResNet_18, epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4414/4714 (93.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8910, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18, epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5128/5652 (90.7289%)
___Train Local_ResNet_18, epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5024/5652 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1666, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18, epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4664/5086 (91.7027%)
___Train Local_ResNet_18, epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4661/5086 (91.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9951, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18, epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4350/4737 (91.8303%)
___Train Local_ResNet_18, epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4299/4737 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3868, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18, epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6383/6812 (93.7023%)
___Train Local_ResNet_18, epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 6146/6812 (90.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2674, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18, epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4754/5075 (93.6749%)
___Train Local_ResNet_18, epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4657/5075 (91.7635%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0803, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5392/5907 (91.2815%)
___Train Local_ResNet_18, epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5307/5907 (89.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3718, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18, epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4479/4830 (92.7329%)
___Train Local_ResNet_18, epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4474/4830 (92.6294%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1405, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18, epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4294/4549 (94.3944%)
___Train Local_ResNet_18, epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4263/4549 (93.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8841, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18, epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5290/5696 (92.8722%)
___Train Local_ResNet_18, epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5252/5696 (92.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2212, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18, epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3597/3959 (90.8563%)
___Train Local_ResNet_18, epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3667/3959 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9286, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18, epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4365/4672 (93.4289%)
___Train Local_ResNet_18, epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4372/4672 (93.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9226, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18, epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4411/4732 (93.2164%)
___Train Local_ResNet_18, epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4408/4732 (93.1530%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9386, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18, epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4516/4929 (91.6210%)
___Train Local_ResNet_18, epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4464/4929 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1429, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18, epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5596/6068 (92.2215%)
___Train Local_ResNet_18, epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5504/6068 (90.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2040, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18, epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3631/3995 (90.8886%)
___Train Local_ResNet_18, epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3579/3995 (89.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0403, Accuracy: 5399/10000 (53.9900%)
time spent on training: 221.41111040115356
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2227, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1645, Accuracy: 9443/9900 (95.3838%)
Done in 248.39403080940247 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.43037542740824.
Norm before scaling: 43.40086556551537. Distance: 1.3572699372588601
Total norm for 4 adversaries is: 43.40086556551537. distance: 1.3572699372588601
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.43037542740824.
Norm before scaling: 43.39554375478475. Distance: 1.389336492680077
Total norm for 4 adversaries is: 43.39554375478475. distance: 1.389336492680077
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4911/5123 (95.8618%), train_poison_data_count: 403
Global model norm: 43.43037542740824.
Norm before scaling: 43.4027921701365. Distance: 1.4012920718380995
Total norm for 4 adversaries is: 43.4027921701365. distance: 1.4012920718380995
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5310/5503 (96.4928%), train_poison_data_count: 430
Global model norm: 43.43037542740824.
Norm before scaling: 43.40132683338653. Distance: 1.4145919904411186
Total norm for 4 adversaries is: 43.40132683338653. distance: 1.4145919904411186
___Train Local_ResNet_18, epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4733/4993 (94.7927%)
___Train Local_ResNet_18, epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4641/4993 (92.9501%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0436, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18, epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3824/4175 (91.5928%)
___Train Local_ResNet_18, epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3798/4175 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0119, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18, epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4090/4368 (93.6355%)
___Train Local_ResNet_18, epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4061/4368 (92.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1002, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18, epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4524/4911 (92.1197%)
___Train Local_ResNet_18, epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4572/4911 (93.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9189, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3675/3910 (93.9898%)
___Train Local_ResNet_18, epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3542/3910 (90.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1976, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18, epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3350/3589 (93.3408%)
___Train Local_ResNet_18, epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3141/3589 (87.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0647, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18, epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4405/4731 (93.1093%)
___Train Local_ResNet_18, epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4365/4731 (92.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0569, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3990/4196 (95.0906%)
___Train Local_ResNet_18, epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3999/4196 (95.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7483, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18, epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4699/5035 (93.3267%)
___Train Local_ResNet_18, epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4745/5035 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9046, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18, epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4369/4672 (93.5146%)
___Train Local_ResNet_18, epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4347/4672 (93.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8655, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18, epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4583/4979 (92.0466%)
___Train Local_ResNet_18, epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4520/4979 (90.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1411, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18, epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4327/4605 (93.9631%)
___Train Local_ResNet_18, epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4306/4605 (93.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9024, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18, epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4956/5702 (86.9169%)
___Train Local_ResNet_18, epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4445/5702 (77.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.5486, Accuracy: 4628/10000 (46.2800%)
___Train Local_ResNet_18, epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5056/5346 (94.5754%)
___Train Local_ResNet_18, epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4994/5346 (93.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1334, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18, epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5434/5871 (92.5566%)
___Train Local_ResNet_18, epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5374/5871 (91.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1653, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18, epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5039/5645 (89.2648%)
___Train Local_ResNet_18, epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5030/5645 (89.1054%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9895, Accuracy: 5496/10000 (54.9600%)
time spent on training: 218.5127055644989
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2216, Accuracy: 6799/10000 (67.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1648, Accuracy: 9434/9900 (95.2929%)
Done in 245.48995542526245 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.44914693225432.
Norm before scaling: 43.41662464884203. Distance: 1.2727544626050202
Total norm for 4 adversaries is: 43.41662464884203. distance: 1.2727544626050202
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.44914693225432.
Norm before scaling: 43.41472115187788. Distance: 1.3681777855391135
Total norm for 4 adversaries is: 43.41472115187788. distance: 1.3681777855391135
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.44914693225432.
Norm before scaling: 43.422144880413555. Distance: 1.3936025481636543
Total norm for 4 adversaries is: 43.422144880413555. distance: 1.3936025481636543
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5294/5503 (96.2021%), train_poison_data_count: 430
Global model norm: 43.44914693225432.
Norm before scaling: 43.42234869523915. Distance: 1.4671853029927306
Total norm for 4 adversaries is: 43.42234869523915. distance: 1.4671853029927306
___Train Local_ResNet_18, epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5820/6664 (87.3349%)
___Train Local_ResNet_18, epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5694/6664 (85.4442%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2448, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18, epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4896/5504 (88.9535%)
___Train Local_ResNet_18, epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4782/5504 (86.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1395, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18, epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4775/5075 (94.0887%)
___Train Local_ResNet_18, epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4708/5075 (92.7685%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9294, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18, epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4429/4894 (90.4986%)
___Train Local_ResNet_18, epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4319/4894 (88.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1280, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18, epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5052/5346 (94.5006%)
___Train Local_ResNet_18, epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5005/5346 (93.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9907, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18, epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3627/3910 (92.7621%)
___Train Local_ResNet_18, epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3548/3910 (90.7417%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0730, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18, epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5382/6080 (88.5197%)
___Train Local_ResNet_18, epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5334/6080 (87.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2284, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18, epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4065/4313 (94.2499%)
___Train Local_ResNet_18, epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4045/4313 (93.7862%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7889, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18, epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4312/4605 (93.6374%)
___Train Local_ResNet_18, epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9593, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18, epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4559/4929 (92.4934%)
___Train Local_ResNet_18, epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4494/4929 (91.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1409, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18, epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5086/5645 (90.0974%)
___Train Local_ResNet_18, epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4925/5645 (87.2453%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1454, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4930/5353 (92.0979%)
___Train Local_ResNet_18, epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4753/5353 (88.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0985, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18, epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5705/6419 (88.8768%)
___Train Local_ResNet_18, epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5509/6419 (85.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2306, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18, epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5004/5298 (94.4507%)
___Train Local_ResNet_18, epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4994/5298 (94.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0153, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18, epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4717/5209 (90.5548%)
___Train Local_ResNet_18, epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4715/5209 (90.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1422, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18, epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4342/4714 (92.1086%)
___Train Local_ResNet_18, epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4345/4714 (92.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1717, Accuracy: 5291/10000 (52.9100%)
time spent on training: 227.88168048858643
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2355, Accuracy: 6785/10000 (67.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1494, Accuracy: 9483/9900 (95.7879%)
Done in 254.76700735092163 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5161/5308 (97.2306%), train_poison_data_count: 415
Global model norm: 43.470697464912355.
Norm before scaling: 43.43853697053603. Distance: 1.298054032789591
Total norm for 4 adversaries is: 43.43853697053603. distance: 1.298054032789591
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 43.470697464912355.
Norm before scaling: 43.43547516638545. Distance: 1.3888312783478802
Total norm for 4 adversaries is: 43.43547516638545. distance: 1.3888312783478802
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.470697464912355.
Norm before scaling: 43.444175240240064. Distance: 1.4221050369807622
Total norm for 4 adversaries is: 43.444175240240064. distance: 1.4221050369807622
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5276/5503 (95.8750%), train_poison_data_count: 430
Global model norm: 43.470697464912355.
Norm before scaling: 43.446758792910835. Distance: 1.5022829484860738
Total norm for 4 adversaries is: 43.446758792910835. distance: 1.5022829484860738
___Train Local_ResNet_18, epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4407/4714 (93.4875%)
___Train Local_ResNet_18, epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4399/4714 (93.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8757, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18, epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4225/4537 (93.1232%)
___Train Local_ResNet_18, epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4182/4537 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0157, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18, epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5597/6235 (89.7674%)
___Train Local_ResNet_18, epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5553/6235 (89.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2845, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18, epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4123/4527 (91.0758%)
___Train Local_ResNet_18, epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4116/4527 (90.9211%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0601, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18, epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4684/5035 (93.0288%)
___Train Local_ResNet_18, epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4727/5035 (93.8828%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9207, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18, epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3820/4145 (92.1592%)
___Train Local_ResNet_18, epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3844/4145 (92.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0093, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18, epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3847/4175 (92.1437%)
___Train Local_ResNet_18, epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3722/4175 (89.1497%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0743, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18, epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4644/5123 (90.6500%)
___Train Local_ResNet_18, epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4340/5123 (84.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2771, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18, epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3813/4130 (92.3245%)
___Train Local_ResNet_18, epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3762/4130 (91.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0712, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18, epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4734/5209 (90.8812%)
___Train Local_ResNet_18, epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4723/5209 (90.6700%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1215, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18, epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3815/4111 (92.7998%)
___Train Local_ResNet_18, epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3767/4111 (91.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2006, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18, epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4680/5038 (92.8940%)
___Train Local_ResNet_18, epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4627/5038 (91.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9244, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18, epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3726/4028 (92.5025%)
___Train Local_ResNet_18, epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3701/4028 (91.8818%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0569, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18, epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4519/5050 (89.4851%)
___Train Local_ResNet_18, epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4488/5050 (88.8713%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1717, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18, epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4507/4889 (92.1865%)
___Train Local_ResNet_18, epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4436/4889 (90.7343%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9543, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18, epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4025/4364 (92.2319%)
___Train Local_ResNet_18, epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3942/4364 (90.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1284, Accuracy: 5283/10000 (52.8300%)
time spent on training: 215.9540946483612
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2342, Accuracy: 6792/10000 (67.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1501, Accuracy: 9481/9900 (95.7677%)
Done in 242.50209975242615 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5179/5308 (97.5697%), train_poison_data_count: 415
Global model norm: 43.49059535998128.
Norm before scaling: 43.45860548412708. Distance: 1.2669746831699435
Total norm for 4 adversaries is: 43.45860548412708. distance: 1.2669746831699435
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.49059535998128.
Norm before scaling: 43.45662657817203. Distance: 1.3857438649979936
Total norm for 4 adversaries is: 43.45662657817203. distance: 1.3857438649979936
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.49059535998128.
Norm before scaling: 43.46068120205751. Distance: 1.3486320169655057
Total norm for 4 adversaries is: 43.46068120205751. distance: 1.3486320169655057
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5340/5503 (97.0380%), train_poison_data_count: 430
Global model norm: 43.49059535998128.
Norm before scaling: 43.45973464203676. Distance: 1.3471551378115407
Total norm for 4 adversaries is: 43.45973464203676. distance: 1.3471551378115407
___Train Local_ResNet_18, epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4747/5193 (91.4115%)
___Train Local_ResNet_18, epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4640/5193 (89.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2669, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18, epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3505/3774 (92.8723%)
___Train Local_ResNet_18, epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3537/3774 (93.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8773, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18, epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4638/5086 (91.1915%)
___Train Local_ResNet_18, epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4642/5086 (91.2702%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0089, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18, epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5639/6235 (90.4411%)
___Train Local_ResNet_18, epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5492/6235 (88.0834%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2610, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18, epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4871/5504 (88.4993%)
___Train Local_ResNet_18, epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4827/5504 (87.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3165, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18, epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5103/5422 (94.1166%)
___Train Local_ResNet_18, epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5092/5422 (93.9137%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9447, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18, epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4218/4537 (92.9689%)
___Train Local_ResNet_18, epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4157/4537 (91.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9334, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18, epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4880/5362 (91.0108%)
___Train Local_ResNet_18, epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4878/5362 (90.9735%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2583, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18, epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4628/5038 (91.8618%)
___Train Local_ResNet_18, epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4569/5038 (90.6908%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1019, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18, epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4532/4911 (92.2826%)
___Train Local_ResNet_18, epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4508/4911 (91.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0684, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18, epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4625/4979 (92.8901%)
___Train Local_ResNet_18, epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4531/4979 (91.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2246, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18, epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4353/4741 (91.8161%)
___Train Local_ResNet_18, epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3670/4741 (77.4098%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.5697, Accuracy: 4579/10000 (45.7900%)
___Train Local_ResNet_18, epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4721/5068 (93.1531%)
___Train Local_ResNet_18, epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4577/5068 (90.3118%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0432, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18, epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3257/3552 (91.6948%)
___Train Local_ResNet_18, epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3275/3552 (92.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8560, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18, epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4626/5055 (91.5134%)
___Train Local_ResNet_18, epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4542/5055 (89.8516%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1711, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18, epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3602/3959 (90.9826%)
___Train Local_ResNet_18, epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3678/3959 (92.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8624, Accuracy: 5665/10000 (56.6500%)
time spent on training: 209.8166148662567
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2336, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1364, Accuracy: 9530/9900 (96.2626%)
Done in 237.01072120666504 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5155/5308 (97.1176%), train_poison_data_count: 415
Global model norm: 43.51026672576111.
Norm before scaling: 43.480631407756576. Distance: 1.3292807543032383
Total norm for 4 adversaries is: 43.480631407756576. distance: 1.3292807543032383
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.51026672576111.
Norm before scaling: 43.471753299826055. Distance: 1.3151374384633854
Total norm for 4 adversaries is: 43.471753299826055. distance: 1.3151374384633854
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4931/5123 (96.2522%), train_poison_data_count: 403
Global model norm: 43.51026672576111.
Norm before scaling: 43.4836844178006. Distance: 1.4025671310814116
Total norm for 4 adversaries is: 43.4836844178006. distance: 1.4025671310814116
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5321/5503 (96.6927%), train_poison_data_count: 430
Global model norm: 43.51026672576111.
Norm before scaling: 43.47875457748732. Distance: 1.3527319815314607
Total norm for 4 adversaries is: 43.47875457748732. distance: 1.3527319815314607
___Train Local_ResNet_18, epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3568/3929 (90.8119%)
___Train Local_ResNet_18, epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3537/3929 (90.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0359, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18, epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4362/4797 (90.9318%)
___Train Local_ResNet_18, epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4332/4797 (90.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0702, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18, epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4744/5224 (90.8116%)
___Train Local_ResNet_18, epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4735/5224 (90.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0762, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18, epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4031/4313 (93.4616%)
___Train Local_ResNet_18, epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4038/4313 (93.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8470, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18, epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3820/4108 (92.9893%)
___Train Local_ResNet_18, epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3793/4108 (92.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9514, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18, epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4756/5209 (91.3035%)
___Train Local_ResNet_18, epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4664/5209 (89.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9796, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18, epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3646/3910 (93.2481%)
___Train Local_ResNet_18, epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3526/3910 (90.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0634, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18, epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3849/4086 (94.1997%)
___Train Local_ResNet_18, epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3856/4086 (94.3710%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9835, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18, epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4591/5122 (89.6330%)
___Train Local_ResNet_18, epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4168/5122 (81.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.4329, Accuracy: 4768/10000 (47.6800%)
___Train Local_ResNet_18, epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4929/5362 (91.9247%)
___Train Local_ResNet_18, epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4861/5362 (90.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9320, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18, epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4387/4731 (92.7288%)
___Train Local_ResNet_18, epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4343/4731 (91.7988%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9703, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18, epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3652/3968 (92.0363%)
___Train Local_ResNet_18, epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3710/3968 (93.4980%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8814, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18, epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4434/4818 (92.0299%)
___Train Local_ResNet_18, epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4265/4818 (88.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0379, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3870/4161 (93.0065%)
___Train Local_ResNet_18, epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3786/4161 (90.9877%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1113, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4562/4911 (92.8935%)
___Train Local_ResNet_18, epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4552/4911 (92.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0779, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18, epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4736/5068 (93.4491%)
___Train Local_ResNet_18, epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4642/5068 (91.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1884, Accuracy: 5244/10000 (52.4400%)
time spent on training: 216.53574228286743
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2388, Accuracy: 6773/10000 (67.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1193, Accuracy: 9570/9900 (96.6667%)
Done in 243.65432286262512 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5160/5308 (97.2118%), train_poison_data_count: 415
Global model norm: 43.52925616844521.
Norm before scaling: 43.49957485648926. Distance: 1.3572188191200536
Total norm for 4 adversaries is: 43.49957485648926. distance: 1.3572188191200536
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 43.52925616844521.
Norm before scaling: 43.493136862056325. Distance: 1.3200617444885239
Total norm for 4 adversaries is: 43.493136862056325. distance: 1.3200617444885239
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.52925616844521.
Norm before scaling: 43.50174683319122. Distance: 1.3916068307877252
Total norm for 4 adversaries is: 43.50174683319122. distance: 1.3916068307877252
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5316/5503 (96.6019%), train_poison_data_count: 430
Global model norm: 43.52925616844521.
Norm before scaling: 43.49974743999958. Distance: 1.4292458440944749
Total norm for 4 adversaries is: 43.49974743999958. distance: 1.4292458440944749
___Train Local_ResNet_18, epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4424/4818 (91.8223%)
___Train Local_ResNet_18, epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4329/4818 (89.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0498, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5413/6080 (89.0296%)
___Train Local_ResNet_18, epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5355/6080 (88.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3177, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18, epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4845/5399 (89.7388%)
___Train Local_ResNet_18, epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4645/5399 (86.0345%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2593, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18, epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5600/6235 (89.8156%)
___Train Local_ResNet_18, epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5491/6235 (88.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2500, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18, epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5328/5696 (93.5393%)
___Train Local_ResNet_18, epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5201/5696 (91.3097%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0039, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18, epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4351/4605 (94.4843%)
___Train Local_ResNet_18, epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4355/4605 (94.5711%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8442, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18, epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4144/4485 (92.3969%)
___Train Local_ResNet_18, epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4064/4485 (90.6132%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2691, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18, epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5145/5615 (91.6296%)
___Train Local_ResNet_18, epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5077/5615 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0291, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18, epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3260/3552 (91.7793%)
___Train Local_ResNet_18, epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3320/3552 (93.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9426, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18, epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4043/4313 (93.7399%)
___Train Local_ResNet_18, epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4055/4313 (94.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8141, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18, epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3632/3995 (90.9136%)
___Train Local_ResNet_18, epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3605/3995 (90.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0085, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18, epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4260/4549 (93.6470%)
___Train Local_ResNet_18, epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4241/4549 (93.2293%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0337, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18, epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5023/5346 (93.9581%)
___Train Local_ResNet_18, epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4901/5346 (91.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1263, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18, epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4820/5361 (89.9086%)
___Train Local_ResNet_18, epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4753/5361 (88.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1077, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18, epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3862/4161 (92.8142%)
___Train Local_ResNet_18, epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3770/4161 (90.6032%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2620, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18, epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4402/4714 (93.3814%)
___Train Local_ResNet_18, epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4381/4714 (92.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9122, Accuracy: 5644/10000 (56.4400%)
time spent on training: 221.85638689994812
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2356, Accuracy: 6766/10000 (67.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1160, Accuracy: 9582/9900 (96.7879%)
Done in 248.87669825553894 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5160/5308 (97.2118%), train_poison_data_count: 415
Global model norm: 43.549324922114174.
Norm before scaling: 43.51983400874178. Distance: 1.348814535638719
Total norm for 4 adversaries is: 43.51983400874178. distance: 1.348814535638719
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.549324922114174.
Norm before scaling: 43.511320197755005. Distance: 1.330845906710404
Total norm for 4 adversaries is: 43.511320197755005. distance: 1.330845906710404
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.549324922114174.
Norm before scaling: 43.521006455844834. Distance: 1.3893557124272735
Total norm for 4 adversaries is: 43.521006455844834. distance: 1.3893557124272735
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5324/5503 (96.7472%), train_poison_data_count: 430
Global model norm: 43.549324922114174.
Norm before scaling: 43.52065584698331. Distance: 1.3961316923803686
Total norm for 4 adversaries is: 43.52065584698331. distance: 1.3961316923803686
___Train Local_ResNet_18, epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5090/5727 (88.8772%)
___Train Local_ResNet_18, epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4980/5727 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2355, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18, epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5922/6664 (88.8655%)
___Train Local_ResNet_18, epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0083, Accuracy: 5589/6664 (83.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2219, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18, epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4031/4364 (92.3694%)
___Train Local_ResNet_18, epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3949/4364 (90.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1958, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18, epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4936/5454 (90.5024%)
___Train Local_ResNet_18, epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4818/5454 (88.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0685, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4503/5050 (89.1683%)
___Train Local_ResNet_18, epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4485/5050 (88.8119%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2340, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18, epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4738/4993 (94.8928%)
___Train Local_ResNet_18, epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4672/4993 (93.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0681, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4456/4818 (92.4865%)
___Train Local_ResNet_18, epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4362/4818 (90.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0013, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18, epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4716/5035 (93.6643%)
___Train Local_ResNet_18, epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4659/5035 (92.5323%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0484, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18, epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6362/6812 (93.3940%)
___Train Local_ResNet_18, epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6230/6812 (91.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3107, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18, epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4462/4843 (92.1330%)
___Train Local_ResNet_18, epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4452/4843 (91.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9651, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3279/3552 (92.3142%)
___Train Local_ResNet_18, epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3326/3552 (93.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7677, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18, epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4650/5123 (90.7671%)
___Train Local_ResNet_18, epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4354/5123 (84.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1609, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4452/4903 (90.8016%)
___Train Local_ResNet_18, epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4427/4903 (90.2917%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0918, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5050/5422 (93.1391%)
___Train Local_ResNet_18, epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4984/5422 (91.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9347, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18, epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4802/5209 (92.1866%)
___Train Local_ResNet_18, epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4697/5209 (90.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1884, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18, epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5293/5696 (92.9249%)
___Train Local_ResNet_18, epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5214/5696 (91.5379%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0170, Accuracy: 5447/10000 (54.4700%)
time spent on training: 225.41325330734253
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2320, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1137, Accuracy: 9586/9900 (96.8283%)
Done in 252.00990557670593 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.57090014956944.
Norm before scaling: 43.5389790899524. Distance: 1.2673856474476837
Total norm for 4 adversaries is: 43.5389790899524. distance: 1.2673856474476837
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.57090014956944.
Norm before scaling: 43.53520374184264. Distance: 1.3775605721838151
Total norm for 4 adversaries is: 43.53520374184264. distance: 1.3775605721838151
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 43.57090014956944.
Norm before scaling: 43.54183176304426. Distance: 1.3658640532251738
Total norm for 4 adversaries is: 43.54183176304426. distance: 1.3658640532251738
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5337/5503 (96.9835%), train_poison_data_count: 430
Global model norm: 43.57090014956944.
Norm before scaling: 43.539012734360576. Distance: 1.364041223174352
Total norm for 4 adversaries is: 43.539012734360576. distance: 1.364041223174352
___Train Local_ResNet_18, epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4485/4818 (93.0884%)
___Train Local_ResNet_18, epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4309/4818 (89.4355%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1280, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18, epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4424/4851 (91.1977%)
___Train Local_ResNet_18, epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4429/4851 (91.3008%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2627, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4202/4587 (91.6067%)
___Train Local_ResNet_18, epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4124/4587 (89.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0427, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4061/4485 (90.5463%)
___Train Local_ResNet_18, epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4018/4485 (89.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9997, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5319/5696 (93.3813%)
___Train Local_ResNet_18, epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5235/5696 (91.9066%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9873, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4382/4672 (93.7928%)
___Train Local_ResNet_18, epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4353/4672 (93.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9335, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18, epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 6198/6947 (89.2184%)
___Train Local_ResNet_18, epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6082/6947 (87.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3507, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18, epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5102/5645 (90.3809%)
___Train Local_ResNet_18, epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4904/5645 (86.8733%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1434, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18, epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4911/5702 (86.1277%)
___Train Local_ResNet_18, epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4656/5702 (81.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3846, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18, epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4336/4741 (91.4575%)
___Train Local_ResNet_18, epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4129/4741 (87.0913%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3429, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18, epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3835/4145 (92.5211%)
___Train Local_ResNet_18, epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3766/4145 (90.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1488, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18, epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4657/5038 (92.4375%)
___Train Local_ResNet_18, epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4625/5038 (91.8023%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1239, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5381/6080 (88.5033%)
___Train Local_ResNet_18, epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5318/6080 (87.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2874, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18, epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4407/4894 (90.0490%)
___Train Local_ResNet_18, epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4293/4894 (87.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1723, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18, epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4437/4732 (93.7658%)
___Train Local_ResNet_18, epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4433/4732 (93.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8919, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18, epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3939/4249 (92.7042%)
___Train Local_ResNet_18, epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3871/4249 (91.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0452, Accuracy: 5507/10000 (55.0700%)
time spent on training: 223.6788146495819
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2318, Accuracy: 6792/10000 (67.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1144, Accuracy: 9587/9900 (96.8384%)
Done in 250.4227843284607 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5308 (97.5509%), train_poison_data_count: 415
Global model norm: 43.59336637376007.
Norm before scaling: 43.55922832271381. Distance: 1.2551344800989412
Total norm for 4 adversaries is: 43.55922832271381. distance: 1.2551344800989412
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 43.59336637376007.
Norm before scaling: 43.559022345943156. Distance: 1.4173323619285358
Total norm for 4 adversaries is: 43.559022345943156. distance: 1.4173323619285358
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4923/5123 (96.0960%), train_poison_data_count: 403
Global model norm: 43.59336637376007.
Norm before scaling: 43.56428075404422. Distance: 1.4042126201879142
Total norm for 4 adversaries is: 43.56428075404422. distance: 1.4042126201879142
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5333/5503 (96.9108%), train_poison_data_count: 430
Global model norm: 43.59336637376007.
Norm before scaling: 43.5633224343993. Distance: 1.422843016714642
Total norm for 4 adversaries is: 43.5633224343993. distance: 1.422843016714642
___Train Local_ResNet_18, epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5870/6664 (88.0852%)
___Train Local_ResNet_18, epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0102, Accuracy: 5376/6664 (80.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1963, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18, epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4389/4757 (92.2640%)
___Train Local_ResNet_18, epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4396/4757 (92.4112%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9029, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18, epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4654/5055 (92.0673%)
___Train Local_ResNet_18, epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4610/5055 (91.1968%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1150, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18, epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5077/5422 (93.6370%)
___Train Local_ResNet_18, epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4998/5422 (92.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0927, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18, epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4435/4869 (91.0865%)
___Train Local_ResNet_18, epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4226/4869 (86.7940%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2559, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18, epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3840/4111 (93.4079%)
___Train Local_ResNet_18, epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3806/4111 (92.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9903, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18, epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3869/4130 (93.6804%)
___Train Local_ResNet_18, epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3807/4130 (92.1792%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0050, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18, epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4005/4313 (92.8588%)
___Train Local_ResNet_18, epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4007/4313 (92.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8833, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18, epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4945/5353 (92.3781%)
___Train Local_ResNet_18, epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4801/5353 (89.6880%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0081, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18, epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4626/5122 (90.3163%)
___Train Local_ResNet_18, epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4258/5122 (83.1316%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4934, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18, epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4773/5068 (94.1792%)
___Train Local_ResNet_18, epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4704/5068 (92.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0581, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18, epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4847/5504 (88.0632%)
___Train Local_ResNet_18, epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4728/5504 (85.9012%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1628, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3564/3929 (90.7101%)
___Train Local_ResNet_18, epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3550/3929 (90.3538%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9828, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18, epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4658/5123 (90.9233%)
___Train Local_ResNet_18, epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4105/5123 (80.1288%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3990, Accuracy: 4833/10000 (48.3300%)
___Train Local_ResNet_18, epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3837/4161 (92.2134%)
___Train Local_ResNet_18, epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3782/4161 (90.8916%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0571, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18, epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4902/5454 (89.8790%)
___Train Local_ResNet_18, epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4836/5454 (88.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1079, Accuracy: 5311/10000 (53.1100%)
time spent on training: 217.45551466941833
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2348, Accuracy: 6775/10000 (67.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1172, Accuracy: 9583/9900 (96.7980%)
Done in 244.59017276763916 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.61444961069382.
Norm before scaling: 43.58179859695229. Distance: 1.2907612560105781
Total norm for 4 adversaries is: 43.58179859695229. distance: 1.2907612560105781
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.61444961069382.
Norm before scaling: 43.57470882316298. Distance: 1.3233011042580285
Total norm for 4 adversaries is: 43.57470882316298. distance: 1.3233011042580285
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.61444961069382.
Norm before scaling: 43.58408971145965. Distance: 1.338417383898281
Total norm for 4 adversaries is: 43.58408971145965. distance: 1.338417383898281
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5334/5503 (96.9289%), train_poison_data_count: 430
Global model norm: 43.61444961069382.
Norm before scaling: 43.583236859557026. Distance: 1.3738054808918958
Total norm for 4 adversaries is: 43.583236859557026. distance: 1.3738054808918958
___Train Local_ResNet_18, epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3703/3968 (93.3216%)
___Train Local_ResNet_18, epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3711/3968 (93.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8324, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18, epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4100/4368 (93.8645%)
___Train Local_ResNet_18, epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4105/4368 (93.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9482, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18, epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4596/4956 (92.7361%)
___Train Local_ResNet_18, epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4490/4956 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0202, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18, epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4444/4714 (94.2724%)
___Train Local_ResNet_18, epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4432/4714 (94.0178%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0203, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18, epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5424/5871 (92.3863%)
___Train Local_ResNet_18, epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5350/5871 (91.1259%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1419, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18, epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4677/5038 (92.8345%)
___Train Local_ResNet_18, epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4602/5038 (91.3458%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9665, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18, epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5138/5615 (91.5049%)
___Train Local_ResNet_18, epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5124/5615 (91.2556%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2435, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18, epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3835/4175 (91.8563%)
___Train Local_ResNet_18, epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3764/4175 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0242, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18, epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4860/5399 (90.0167%)
___Train Local_ResNet_18, epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4720/5399 (87.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4306, Accuracy: 4915/10000 (49.1500%)
___Train Local_ResNet_18, epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5896/6664 (88.4754%)
___Train Local_ResNet_18, epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0099, Accuracy: 5443/6664 (81.6777%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2610, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18, epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4421/4732 (93.4277%)
___Train Local_ResNet_18, epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4446/4732 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7917, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18, epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4484/4830 (92.8364%)
___Train Local_ResNet_18, epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4511/4830 (93.3954%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1607, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18, epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4921/5427 (90.6762%)
___Train Local_ResNet_18, epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4782/5427 (88.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1286, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18, epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5010/5497 (91.1406%)
___Train Local_ResNet_18, epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4929/5497 (89.6671%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1091, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5006/5489 (91.2006%)
___Train Local_ResNet_18, epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5040/5489 (91.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0524, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18, epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4680/5055 (92.5816%)
___Train Local_ResNet_18, epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4588/5055 (90.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1841, Accuracy: 5382/10000 (53.8200%)
time spent on training: 222.6610450744629
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2383, Accuracy: 6771/10000 (67.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1156, Accuracy: 9589/9900 (96.8586%)
Done in 249.69660186767578 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5152/5308 (97.0610%), train_poison_data_count: 415
Global model norm: 43.634507157108466.
Norm before scaling: 43.603300365160145. Distance: 1.3514131231945845
Total norm for 4 adversaries is: 43.603300365160145. distance: 1.3514131231945845
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 43.634507157108466.
Norm before scaling: 43.59389000873574. Distance: 1.2773461298089213
Total norm for 4 adversaries is: 43.59389000873574. distance: 1.2773461298089213
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.634507157108466.
Norm before scaling: 43.60653654323942. Distance: 1.4053205173391825
Total norm for 4 adversaries is: 43.60653654323942. distance: 1.4053205173391825
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.634507157108466.
Norm before scaling: 43.60121323883588. Distance: 1.334575963130485
Total norm for 4 adversaries is: 43.60121323883588. distance: 1.334575963130485
___Train Local_ResNet_18, epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4440/4731 (93.8491%)
___Train Local_ResNet_18, epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4417/4731 (93.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0127, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18, epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4166/4485 (92.8874%)
___Train Local_ResNet_18, epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3972/4485 (88.5619%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0645, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18, epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4409/4903 (89.9245%)
___Train Local_ResNet_18, epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4431/4903 (90.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2811, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18, epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4747/5224 (90.8691%)
___Train Local_ResNet_18, epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4739/5224 (90.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0257, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18, epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4886/5361 (91.1397%)
___Train Local_ResNet_18, epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4810/5361 (89.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9846, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5089/5645 (90.1506%)
___Train Local_ResNet_18, epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4954/5645 (87.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1326, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4684/5038 (92.9734%)
___Train Local_ResNet_18, epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5038 (91.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0127, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18, epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4648/5086 (91.3881%)
___Train Local_ResNet_18, epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4652/5086 (91.4668%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0668, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18, epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4506/4889 (92.1661%)
___Train Local_ResNet_18, epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4403/4889 (90.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0354, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18, epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4786/5209 (91.8794%)
___Train Local_ResNet_18, epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4649/5209 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2602, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18, epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4304/4736 (90.8784%)
___Train Local_ResNet_18, epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4286/4736 (90.4983%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1372, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18, epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4631/4956 (93.4423%)
___Train Local_ResNet_18, epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4556/4956 (91.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1148, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18, epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4441/4748 (93.5341%)
___Train Local_ResNet_18, epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4390/4748 (92.4600%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0398, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4559/5018 (90.8529%)
___Train Local_ResNet_18, epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4405/5018 (87.7840%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2424, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18, epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4350/4605 (94.4625%)
___Train Local_ResNet_18, epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4345/4605 (94.3540%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8315, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18, epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4930/5353 (92.0979%)
___Train Local_ResNet_18, epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4831/5353 (90.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0527, Accuracy: 5393/10000 (53.9300%)
time spent on training: 215.81363224983215
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2382, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1140, Accuracy: 9587/9900 (96.8384%)
Done in 242.63399076461792 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.65546846338741.
Norm before scaling: 43.620750766818965. Distance: 1.2628463572169162
Total norm for 4 adversaries is: 43.620750766818965. distance: 1.2628463572169162
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.65546846338741.
Norm before scaling: 43.61888696201093. Distance: 1.3722339899036442
Total norm for 4 adversaries is: 43.61888696201093. distance: 1.3722339899036442
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.65546846338741.
Norm before scaling: 43.62519307353407. Distance: 1.3271784382531655
Total norm for 4 adversaries is: 43.62519307353407. distance: 1.3271784382531655
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5348/5503 (97.1834%), train_poison_data_count: 430
Global model norm: 43.65546846338741.
Norm before scaling: 43.62451311511969. Distance: 1.3569187027593557
Total norm for 4 adversaries is: 43.62451311511969. distance: 1.3569187027593557
___Train Local_ResNet_18, epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4776/5068 (94.2384%)
___Train Local_ResNet_18, epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4725/5068 (93.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1241, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18, epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4778/5193 (92.0085%)
___Train Local_ResNet_18, epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4380/5193 (84.3443%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4553, Accuracy: 4715/10000 (47.1500%)
___Train Local_ResNet_18, epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4587/4911 (93.4026%)
___Train Local_ResNet_18, epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4541/4911 (92.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9851, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18, epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5051/5559 (90.8617%)
___Train Local_ResNet_18, epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4901/5559 (88.1633%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1585, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18, epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3841/4145 (92.6659%)
___Train Local_ResNet_18, epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3866/4145 (93.2690%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9029, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18, epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4297/4549 (94.4603%)
___Train Local_ResNet_18, epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4283/4549 (94.1526%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8696, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18, epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3612/3929 (91.9318%)
___Train Local_ResNet_18, epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3626/3929 (92.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7946, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18, epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4410/4714 (93.5511%)
___Train Local_ResNet_18, epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4398/4714 (93.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8693, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18, epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4437/4851 (91.4657%)
___Train Local_ResNet_18, epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4413/4851 (90.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8650, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18, epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4311/4736 (91.0262%)
___Train Local_ResNet_18, epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4265/4736 (90.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9809, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18, epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4498/4894 (91.9085%)
___Train Local_ResNet_18, epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4365/4894 (89.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1274, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18, epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4310/4605 (93.5939%)
___Train Local_ResNet_18, epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4275/4605 (92.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9645, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18, epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3341/3589 (93.0900%)
___Train Local_ResNet_18, epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0091, Accuracy: 2982/3589 (83.0872%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.6319, Accuracy: 4696/10000 (46.9600%)
___Train Local_ResNet_18, epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5456/5939 (91.8673%)
___Train Local_ResNet_18, epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5445/5939 (91.6821%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1304, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18, epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3518/3774 (93.2167%)
___Train Local_ResNet_18, epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3536/3774 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9204, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18, epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3270/3552 (92.0608%)
___Train Local_ResNet_18, epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3310/3552 (93.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8450, Accuracy: 5787/10000 (57.8700%)
time spent on training: 210.43869733810425
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2476, Accuracy: 6777/10000 (67.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0987, Accuracy: 9634/9900 (97.3131%)
Done in 237.09934067726135 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5190/5308 (97.7769%), train_poison_data_count: 415
Global model norm: 43.67369042514684.
Norm before scaling: 43.63900121173504. Distance: 1.2027844033610628
Total norm for 4 adversaries is: 43.63900121173504. distance: 1.2027844033610628
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.67369042514684.
Norm before scaling: 43.63436168355451. Distance: 1.3236575217358992
Total norm for 4 adversaries is: 43.63436168355451. distance: 1.3236575217358992
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.67369042514684.
Norm before scaling: 43.64237459570185. Distance: 1.2921261072854309
Total norm for 4 adversaries is: 43.64237459570185. distance: 1.2921261072854309
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 43.67369042514684.
Norm before scaling: 43.64028933812911. Distance: 1.3322225304690625
Total norm for 4 adversaries is: 43.64028933812911. distance: 1.3322225304690625
___Train Local_ResNet_18, epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4380/4741 (92.3856%)
___Train Local_ResNet_18, epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3715/4741 (78.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.5756, Accuracy: 4553/10000 (45.5300%)
___Train Local_ResNet_18, epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4451/4818 (92.3827%)
___Train Local_ResNet_18, epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4349/4818 (90.2657%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1601, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18, epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5772/6419 (89.9205%)
___Train Local_ResNet_18, epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5549/6419 (86.4465%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3231, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18, epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4529/4830 (93.7681%)
___Train Local_ResNet_18, epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4486/4830 (92.8778%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1377, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18, epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5025/5497 (91.4135%)
___Train Local_ResNet_18, epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4931/5497 (89.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1746, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18, epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4534/5018 (90.3547%)
___Train Local_ResNet_18, epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4449/5018 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4190, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18, epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5628/6235 (90.2646%)
___Train Local_ResNet_18, epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5512/6235 (88.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3606, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18, epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4386/4797 (91.4321%)
___Train Local_ResNet_18, epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4274/4797 (89.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1781, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18, epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4606/4979 (92.5085%)
___Train Local_ResNet_18, epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4559/4979 (91.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0622, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18, epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3795/4086 (92.8781%)
___Train Local_ResNet_18, epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3828/4086 (93.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9753, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18, epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5574/6068 (91.8589%)
___Train Local_ResNet_18, epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5557/6068 (91.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2431, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18, epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3975/4196 (94.7331%)
___Train Local_ResNet_18, epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3963/4196 (94.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8290, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18, epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5077/5652 (89.8266%)
___Train Local_ResNet_18, epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4985/5652 (88.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1881, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18, epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3875/4111 (94.2593%)
___Train Local_ResNet_18, epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3839/4111 (93.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8977, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18, epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4519/4889 (92.4320%)
___Train Local_ResNet_18, epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4404/4889 (90.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2458, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18, epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4097/4368 (93.7958%)
___Train Local_ResNet_18, epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1215, Accuracy: 5385/10000 (53.8500%)
time spent on training: 221.67109084129333
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2578, Accuracy: 6758/10000 (67.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0958, Accuracy: 9643/9900 (97.4040%)
Done in 248.54879570007324 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5180/5308 (97.5885%), train_poison_data_count: 415
Global model norm: 43.69426276564021.
Norm before scaling: 43.660754398079. Distance: 1.2797736990079955
Total norm for 4 adversaries is: 43.660754398079. distance: 1.2797736990079955
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5625/5777 (97.3689%), train_poison_data_count: 455
Global model norm: 43.69426276564021.
Norm before scaling: 43.65573130731591. Distance: 1.3297381309615
Total norm for 4 adversaries is: 43.65573130731591. distance: 1.3297381309615
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4953/5123 (96.6816%), train_poison_data_count: 403
Global model norm: 43.69426276564021.
Norm before scaling: 43.663624276518064. Distance: 1.3318642430473007
Total norm for 4 adversaries is: 43.663624276518064. distance: 1.3318642430473007
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5340/5503 (97.0380%), train_poison_data_count: 430
Global model norm: 43.69426276564021.
Norm before scaling: 43.66078375482897. Distance: 1.3596434054176227
Total norm for 4 adversaries is: 43.66078375482897. distance: 1.3596434054176227
___Train Local_ResNet_18, epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4397/4731 (92.9402%)
___Train Local_ResNet_18, epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4372/4731 (92.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9876, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18, epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5011/5346 (93.7336%)
___Train Local_ResNet_18, epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4956/5346 (92.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1692, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18, epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4830/5399 (89.4610%)
___Train Local_ResNet_18, epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4696/5399 (86.9791%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1940, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18, epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4490/4818 (93.1922%)
___Train Local_ResNet_18, epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4384/4818 (90.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9970, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18, epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5109/5652 (90.3928%)
___Train Local_ResNet_18, epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5032/5652 (89.0304%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.4240, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18, epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4424/4714 (93.8481%)
___Train Local_ResNet_18, epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4410/4714 (93.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9312, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18, epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5085/5422 (93.7846%)
___Train Local_ResNet_18, epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5035/5422 (92.8624%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9580, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18, epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3885/4130 (94.0678%)
___Train Local_ResNet_18, epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3890/4130 (94.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9510, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18, epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4460/4732 (94.2519%)
___Train Local_ResNet_18, epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4467/4732 (94.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8839, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18, epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5121/5645 (90.7174%)
___Train Local_ResNet_18, epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4992/5645 (88.4322%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1963, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18, epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5010/5702 (87.8639%)
___Train Local_ResNet_18, epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0113, Accuracy: 4472/5702 (78.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.4983, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18, epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4240/4736 (89.5270%)
___Train Local_ResNet_18, epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4213/4736 (88.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1312, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18, epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4146/4527 (91.5838%)
___Train Local_ResNet_18, epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4021/4527 (88.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2849, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18, epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3820/4111 (92.9214%)
___Train Local_ResNet_18, epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3782/4111 (91.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9951, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18, epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4975/5362 (92.7825%)
___Train Local_ResNet_18, epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4891/5362 (91.2160%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1883, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18, epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5517/5939 (92.8944%)
___Train Local_ResNet_18, epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5517/5939 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0146, Accuracy: 5518/10000 (55.1800%)
time spent on training: 219.82345461845398
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2667, Accuracy: 6756/10000 (67.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0896, Accuracy: 9657/9900 (97.5455%)
Done in 246.75492095947266 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5160/5308 (97.2118%), train_poison_data_count: 415
Global model norm: 43.71445821947099.
Norm before scaling: 43.68135239292621. Distance: 1.288844789558093
Total norm for 4 adversaries is: 43.68135239292621. distance: 1.288844789558093
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5629/5777 (97.4381%), train_poison_data_count: 455
Global model norm: 43.71445821947099.
Norm before scaling: 43.675340873204696. Distance: 1.3488766659007048
Total norm for 4 adversaries is: 43.675340873204696. distance: 1.3488766659007048
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4959/5123 (96.7988%), train_poison_data_count: 403
Global model norm: 43.71445821947099.
Norm before scaling: 43.6834720179047. Distance: 1.3437529719120251
Total norm for 4 adversaries is: 43.6834720179047. distance: 1.3437529719120251
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5313/5503 (96.5473%), train_poison_data_count: 430
Global model norm: 43.71445821947099.
Norm before scaling: 43.686037227388944. Distance: 1.4473712177340852
Total norm for 4 adversaries is: 43.686037227388944. distance: 1.4473712177340852
___Train Local_ResNet_18, epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4758/5075 (93.7537%)
___Train Local_ResNet_18, epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4619/5075 (91.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0061, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18, epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4653/5086 (91.4864%)
___Train Local_ResNet_18, epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4622/5086 (90.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0627, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18, epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5004/5497 (91.0315%)
___Train Local_ResNet_18, epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4919/5497 (89.4852%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1935, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18, epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4478/4748 (94.3134%)
___Train Local_ResNet_18, epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4363/4748 (91.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1935, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18, epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5077/5652 (89.8266%)
___Train Local_ResNet_18, epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4995/5652 (88.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2028, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18, epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4629/4979 (92.9705%)
___Train Local_ResNet_18, epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4570/4979 (91.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0942, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18, epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4055/4364 (92.9193%)
___Train Local_ResNet_18, epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4026/4364 (92.2548%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9446, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18, epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4523/4889 (92.5138%)
___Train Local_ResNet_18, epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4483/4889 (91.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0932, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18, epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4906/5427 (90.3999%)
___Train Local_ResNet_18, epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4871/5427 (89.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0718, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18, epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3657/3910 (93.5294%)
___Train Local_ResNet_18, epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3512/3910 (89.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1695, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18, epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3683/3968 (92.8175%)
___Train Local_ResNet_18, epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3681/3968 (92.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9764, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18, epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4736/5193 (91.1997%)
___Train Local_ResNet_18, epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4637/5193 (89.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3116, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18, epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5424/5907 (91.8233%)
___Train Local_ResNet_18, epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5377/5907 (91.0276%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2768, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4424/4869 (90.8605%)
___Train Local_ResNet_18, epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4061/4869 (83.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3477, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18, epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4407/4894 (90.0490%)
___Train Local_ResNet_18, epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4291/4894 (87.6788%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0955, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18, epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5193/5727 (90.6757%)
___Train Local_ResNet_18, epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5090/5727 (88.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0842, Accuracy: 5344/10000 (53.4400%)
time spent on training: 216.89045572280884
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2644, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0811, Accuracy: 9674/9900 (97.7172%)
Done in 243.540691614151 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.7360357178437.
Norm before scaling: 43.70077727650062. Distance: 1.2445582193540383
Total norm for 4 adversaries is: 43.70077727650062. distance: 1.2445582193540383
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.7360357178437.
Norm before scaling: 43.69767378632343. Distance: 1.3471497841769473
Total norm for 4 adversaries is: 43.69767378632343. distance: 1.3471497841769473
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4960/5123 (96.8183%), train_poison_data_count: 403
Global model norm: 43.7360357178437.
Norm before scaling: 43.702345698271735. Distance: 1.2928113582275012
Total norm for 4 adversaries is: 43.702345698271735. distance: 1.2928113582275012
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5344/5503 (97.1107%), train_poison_data_count: 430
Global model norm: 43.7360357178437.
Norm before scaling: 43.70332471128842. Distance: 1.3773284616990422
Total norm for 4 adversaries is: 43.70332471128842. distance: 1.3773284616990422
___Train Local_ResNet_18, epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4497/4843 (92.8557%)
___Train Local_ResNet_18, epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4423/4843 (91.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9517, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18, epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4422/4757 (92.9577%)
___Train Local_ResNet_18, epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4326/4757 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0735, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18, epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4550/4830 (94.2029%)
___Train Local_ResNet_18, epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4472/4830 (92.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1131, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18, epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4583/4979 (92.0466%)
___Train Local_ResNet_18, epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4575/4979 (91.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0898, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18, epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4224/4537 (93.1012%)
___Train Local_ResNet_18, epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4216/4537 (92.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0674, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18, epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6274/6812 (92.1022%)
___Train Local_ResNet_18, epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6262/6812 (91.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9554, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18, epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3759/4028 (93.3217%)
___Train Local_ResNet_18, epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3743/4028 (92.9245%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9904, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18, epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4119/4485 (91.8395%)
___Train Local_ResNet_18, epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3870/4485 (86.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1344, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18, epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4937/5427 (90.9711%)
___Train Local_ResNet_18, epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4839/5427 (89.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2560, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18, epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4657/5123 (90.9038%)
___Train Local_ResNet_18, epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4390/5123 (85.6920%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3829, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18, epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3951/4249 (92.9866%)
___Train Local_ResNet_18, epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3847/4249 (90.5390%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0417, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18, epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3582/3995 (89.6621%)
___Train Local_ResNet_18, epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3512/3995 (87.9099%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1752, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18, epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4359/4737 (92.0203%)
___Train Local_ResNet_18, epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4313/4737 (91.0492%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4261, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18, epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4667/5038 (92.6360%)
___Train Local_ResNet_18, epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4657/5038 (92.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9805, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18, epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4294/4736 (90.6672%)
___Train Local_ResNet_18, epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4233/4736 (89.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2308, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18, epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5490/5871 (93.5105%)
___Train Local_ResNet_18, epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5358/5871 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0038, Accuracy: 5481/10000 (54.8100%)
time spent on training: 218.64552235603333
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2592, Accuracy: 6770/10000 (67.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0883, Accuracy: 9660/9900 (97.5758%)
Done in 245.44648599624634 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5308 (97.5509%), train_poison_data_count: 415
Global model norm: 43.75628721564979.
Norm before scaling: 43.72083570346494. Distance: 1.2513385281794545
Total norm for 4 adversaries is: 43.72083570346494. distance: 1.2513385281794545
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 43.75628721564979.
Norm before scaling: 43.71648548906494. Distance: 1.2707519765775095
Total norm for 4 adversaries is: 43.71648548906494. distance: 1.2707519765775095
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4932/5123 (96.2717%), train_poison_data_count: 403
Global model norm: 43.75628721564979.
Norm before scaling: 43.72690657248049. Distance: 1.3765511866265912
Total norm for 4 adversaries is: 43.72690657248049. distance: 1.3765511866265912
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5325/5503 (96.7654%), train_poison_data_count: 430
Global model norm: 43.75628721564979.
Norm before scaling: 43.724025492553146. Distance: 1.4099792623009437
Total norm for 4 adversaries is: 43.724025492553146. distance: 1.4099792623009437
___Train Local_ResNet_18, epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4000/4196 (95.3289%)
___Train Local_ResNet_18, epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4014/4196 (95.6625%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8231, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18, epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3823/4145 (92.2316%)
___Train Local_ResNet_18, epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3799/4145 (91.6526%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0864, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18, epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4994/5298 (94.2620%)
___Train Local_ResNet_18, epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4938/5298 (93.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1196, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4304/4737 (90.8592%)
___Train Local_ResNet_18, epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4286/4737 (90.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1068, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18, epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4746/5193 (91.3923%)
___Train Local_ResNet_18, epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4618/5193 (88.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3716, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18, epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4498/4818 (93.3582%)
___Train Local_ResNet_18, epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4367/4818 (90.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0106, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3845/4111 (93.5296%)
___Train Local_ResNet_18, epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3793/4111 (92.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0566, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6299/6812 (92.4692%)
___Train Local_ResNet_18, epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6296/6812 (92.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0231, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18, epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4742/5035 (94.1807%)
___Train Local_ResNet_18, epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4699/5035 (93.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9427, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18, epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4935/5427 (90.9342%)
___Train Local_ResNet_18, epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4828/5427 (88.9626%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0305, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18, epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4275/4672 (91.5026%)
___Train Local_ResNet_18, epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4336/4672 (92.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9792, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18, epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4899/5361 (91.3822%)
___Train Local_ResNet_18, epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4894/5361 (91.2889%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9296, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18, epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4137/4368 (94.7115%)
___Train Local_ResNet_18, epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4042/4368 (92.5366%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0485, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4512/4843 (93.1654%)
___Train Local_ResNet_18, epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4447/4843 (91.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0696, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18, epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4929/5353 (92.0792%)
___Train Local_ResNet_18, epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4839/5353 (90.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0091, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18, epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4427/4714 (93.9118%)
___Train Local_ResNet_18, epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4388/4714 (93.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9226, Accuracy: 5631/10000 (56.3100%)
time spent on training: 221.71256303787231
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2585, Accuracy: 6790/10000 (67.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0896, Accuracy: 9655/9900 (97.5253%)
Done in 247.93803644180298 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 43.775638414016164.
Norm before scaling: 43.74348165727095. Distance: 1.3105328213752583
Total norm for 4 adversaries is: 43.74348165727095. distance: 1.3105328213752583
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.775638414016164.
Norm before scaling: 43.73596873212596. Distance: 1.346304439410929
Total norm for 4 adversaries is: 43.73596873212596. distance: 1.346304439410929
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4940/5123 (96.4279%), train_poison_data_count: 403
Global model norm: 43.775638414016164.
Norm before scaling: 43.74355002677895. Distance: 1.3291498605668164
Total norm for 4 adversaries is: 43.74355002677895. distance: 1.3291498605668164
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 43.775638414016164.
Norm before scaling: 43.7405821336505. Distance: 1.3245481458375852
Total norm for 4 adversaries is: 43.7405821336505. distance: 1.3245481458375852
___Train Local_ResNet_18, epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4303/4549 (94.5922%)
___Train Local_ResNet_18, epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3815/4549 (83.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2775, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18, epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5151/5652 (91.1359%)
___Train Local_ResNet_18, epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5053/5652 (89.4020%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2721, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18, epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3551/3774 (94.0911%)
___Train Local_ResNet_18, epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3527/3774 (93.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9921, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18, epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5158/5727 (90.0646%)
___Train Local_ResNet_18, epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5094/5727 (88.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0441, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18, epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5601/6068 (92.3039%)
___Train Local_ResNet_18, epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5581/6068 (91.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0197, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18, epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6296/6947 (90.6290%)
___Train Local_ResNet_18, epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6171/6947 (88.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2725, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18, epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6389/6812 (93.7904%)
___Train Local_ResNet_18, epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6244/6812 (91.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1207, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4423/4903 (90.2101%)
___Train Local_ResNet_18, epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4369/4903 (89.1087%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1450, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18, epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5480/5871 (93.3401%)
___Train Local_ResNet_18, epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5372/5871 (91.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0772, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18, epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4961/5427 (91.4133%)
___Train Local_ResNet_18, epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4831/5427 (89.0179%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0787, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18, epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3809/4108 (92.7215%)
___Train Local_ResNet_18, epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3708/4108 (90.2629%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2409, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18, epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5915/6664 (88.7605%)
___Train Local_ResNet_18, epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5702/6664 (85.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2484, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18, epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4979 (92.0064%)
___Train Local_ResNet_18, epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4556/4979 (91.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0518, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18, epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4765/5399 (88.2571%)
___Train Local_ResNet_18, epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4554/5399 (84.3490%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3970, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18, epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4416/4894 (90.2329%)
___Train Local_ResNet_18, epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4269/4894 (87.2293%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1678, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18, epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3645/3968 (91.8599%)
___Train Local_ResNet_18, epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3645/3968 (91.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9352, Accuracy: 5567/10000 (55.6700%)
time spent on training: 228.77276039123535
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2564, Accuracy: 6782/10000 (67.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0837, Accuracy: 9666/9900 (97.6364%)
Done in 255.61112427711487 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 43.798452522427944.
Norm before scaling: 43.76201704380395. Distance: 1.2030283901514445
Total norm for 4 adversaries is: 43.76201704380395. distance: 1.2030283901514445
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.798452522427944.
Norm before scaling: 43.75992911882256. Distance: 1.3567616126198068
Total norm for 4 adversaries is: 43.75992911882256. distance: 1.3567616126198068
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4943/5123 (96.4864%), train_poison_data_count: 403
Global model norm: 43.798452522427944.
Norm before scaling: 43.76756762245233. Distance: 1.3643084047694587
Total norm for 4 adversaries is: 43.76756762245233. distance: 1.3643084047694587
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 43.798452522427944.
Norm before scaling: 43.76347588216757. Distance: 1.343601750912197
Total norm for 4 adversaries is: 43.76347588216757. distance: 1.343601750912197
___Train Local_ResNet_18, epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6335/6812 (92.9977%)
___Train Local_ResNet_18, epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 6134/6812 (90.0470%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3395, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18, epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5139/5652 (90.9236%)
___Train Local_ResNet_18, epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5054/5652 (89.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1695, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18, epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4583/4956 (92.4738%)
___Train Local_ResNet_18, epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4539/4956 (91.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0571, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5505/5939 (92.6924%)
___Train Local_ResNet_18, epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5412/5939 (91.1265%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2837, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18, epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5399 (90.1278%)
___Train Local_ResNet_18, epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4772/5399 (88.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4381, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18, epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6333/6947 (91.1617%)
___Train Local_ResNet_18, epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6152/6947 (88.5562%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1715, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18, epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4368/4741 (92.1325%)
___Train Local_ResNet_18, epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4151/4741 (87.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3065, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18, epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3872/4108 (94.2551%)
___Train Local_ResNet_18, epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3765/4108 (91.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9691, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18, epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3550/3774 (94.0647%)
___Train Local_ResNet_18, epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3563/3774 (94.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8226, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18, epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4505/4889 (92.1456%)
___Train Local_ResNet_18, epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4419/4889 (90.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0537, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18, epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4385/4605 (95.2226%)
___Train Local_ResNet_18, epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4306/4605 (93.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9872, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18, epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4687/5038 (93.0329%)
___Train Local_ResNet_18, epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4642/5038 (92.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8130, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18, epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4628/5122 (90.3553%)
___Train Local_ResNet_18, epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0128, Accuracy: 3896/5122 (76.0640%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.7391, Accuracy: 4396/10000 (43.9600%)
___Train Local_ResNet_18, epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4977/5298 (93.9411%)
___Train Local_ResNet_18, epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4899/5298 (92.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1403, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5002/5461 (91.5949%)
___Train Local_ResNet_18, epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4967/5461 (90.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2335, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18, epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4558/4830 (94.3685%)
___Train Local_ResNet_18, epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4537/4830 (93.9337%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1068, Accuracy: 5492/10000 (54.9200%)
time spent on training: 224.16459274291992
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2607, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0774, Accuracy: 9690/9900 (97.8788%)
Done in 250.9077913761139 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 43.81923372379559.
Norm before scaling: 43.78396560992677. Distance: 1.239910317684908
Total norm for 4 adversaries is: 43.78396560992677. distance: 1.239910317684908
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.81923372379559.
Norm before scaling: 43.77968858743173. Distance: 1.3277941572215632
Total norm for 4 adversaries is: 43.77968858743173. distance: 1.3277941572215632
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4938/5123 (96.3888%), train_poison_data_count: 403
Global model norm: 43.81923372379559.
Norm before scaling: 43.78597711587795. Distance: 1.2987770472070046
Total norm for 4 adversaries is: 43.78597711587795. distance: 1.2987770472070046
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5369/5503 (97.5650%), train_poison_data_count: 430
Global model norm: 43.81923372379559.
Norm before scaling: 43.78393633576917. Distance: 1.2978184037748255
Total norm for 4 adversaries is: 43.78393633576917. distance: 1.2978184037748255
___Train Local_ResNet_18, epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5434/6080 (89.3750%)
___Train Local_ResNet_18, epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5325/6080 (87.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2270, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18, epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5078/5559 (91.3474%)
___Train Local_ResNet_18, epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4940/5559 (88.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2087, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18, epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5474/5871 (93.2379%)
___Train Local_ResNet_18, epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5406/5871 (92.0797%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0861, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3963/4249 (93.2690%)
___Train Local_ResNet_18, epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3873/4249 (91.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0553, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18, epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3605/3995 (90.2378%)
___Train Local_ResNet_18, epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3559/3995 (89.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1095, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18, epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5023/5454 (92.0975%)
___Train Local_ResNet_18, epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4905/5454 (89.9340%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1336, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3912/4161 (94.0159%)
___Train Local_ResNet_18, epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3840/4161 (92.2855%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1583, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18, epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4391/4732 (92.7937%)
___Train Local_ResNet_18, epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4409/4732 (93.1741%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0136, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18, epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4454/4851 (91.8161%)
___Train Local_ResNet_18, epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4417/4851 (91.0534%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0648, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18, epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4632/5122 (90.4334%)
___Train Local_ResNet_18, epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3930/5122 (76.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.4605, Accuracy: 4699/10000 (46.9900%)
___Train Local_ResNet_18, epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5533/5939 (93.1638%)
___Train Local_ResNet_18, epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5519/5939 (92.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0882, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4335/4672 (92.7868%)
___Train Local_ResNet_18, epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4328/4672 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9410, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18, epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6414/6812 (94.1574%)
___Train Local_ResNet_18, epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6200/6812 (91.0159%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2388, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18, epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5030/5461 (92.1077%)
___Train Local_ResNet_18, epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4960/5461 (90.8259%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1859, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18, epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4382/4894 (89.5382%)
___Train Local_ResNet_18, epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4204/4894 (85.9011%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2755, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18, epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3812/4175 (91.3054%)
___Train Local_ResNet_18, epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3716/4175 (89.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3096, Accuracy: 5083/10000 (50.8300%)
time spent on training: 224.1874978542328
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2613, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0776, Accuracy: 9691/9900 (97.8889%)
Done in 251.05943655967712 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5308 (97.5509%), train_poison_data_count: 415
Global model norm: 43.840321108345144.
Norm before scaling: 43.80372398953727. Distance: 1.2577470560996675
Total norm for 4 adversaries is: 43.80372398953727. distance: 1.2577470560996675
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 43.840321108345144.
Norm before scaling: 43.79959660871248. Distance: 1.3018883470134044
Total norm for 4 adversaries is: 43.79959660871248. distance: 1.3018883470134044
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4949/5123 (96.6036%), train_poison_data_count: 403
Global model norm: 43.840321108345144.
Norm before scaling: 43.81056633571689. Distance: 1.3711579571332142
Total norm for 4 adversaries is: 43.81056633571689. distance: 1.3711579571332142
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5343/5503 (97.0925%), train_poison_data_count: 430
Global model norm: 43.840321108345144.
Norm before scaling: 43.80760019632367. Distance: 1.385103730541634
Total norm for 4 adversaries is: 43.80760019632367. distance: 1.385103730541634
___Train Local_ResNet_18, epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4764/5224 (91.1945%)
___Train Local_ResNet_18, epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4736/5224 (90.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.3501, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18, epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4422/4797 (92.1826%)
___Train Local_ResNet_18, epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4307/4797 (89.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0236, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18, epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4953/5298 (93.4881%)
___Train Local_ResNet_18, epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4956/5298 (93.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0005, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18, epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3668/3910 (93.8107%)
___Train Local_ResNet_18, epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3563/3910 (91.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1689, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4200/4587 (91.5631%)
___Train Local_ResNet_18, epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4196/4587 (91.4759%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8950, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18, epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4450/4731 (94.0605%)
___Train Local_ResNet_18, epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4375/4731 (92.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9772, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18, epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6417/6812 (94.2014%)
___Train Local_ResNet_18, epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6241/6812 (91.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1578, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18, epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5002/5702 (87.7236%)
___Train Local_ResNet_18, epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4785/5702 (83.9179%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1702, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18, epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4537/4911 (92.3844%)
___Train Local_ResNet_18, epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4550/4911 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2308, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3812/4111 (92.7268%)
___Train Local_ResNet_18, epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3825/4111 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1209, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3871/4145 (93.3896%)
___Train Local_ResNet_18, epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3823/4145 (92.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0143, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18, epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4165/4397 (94.7237%)
___Train Local_ResNet_18, epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8410, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18, epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4647/4979 (93.3320%)
___Train Local_ResNet_18, epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4595/4979 (92.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0150, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18, epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4968/5353 (92.8078%)
___Train Local_ResNet_18, epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4838/5353 (90.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1230, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4119/4368 (94.2995%)
___Train Local_ResNet_18, epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4121/4368 (94.3452%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1002, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18, epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5020/5346 (93.9020%)
___Train Local_ResNet_18, epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4954/5346 (92.6674%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0329, Accuracy: 5537/10000 (55.3700%)
time spent on training: 220.95661854743958
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2598, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0825, Accuracy: 9675/9900 (97.7273%)
Done in 247.62954878807068 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 43.85869171403985.
Norm before scaling: 43.81930476087637. Distance: 1.1748666850003893
Total norm for 4 adversaries is: 43.81930476087637. distance: 1.1748666850003893
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5630/5777 (97.4554%), train_poison_data_count: 455
Global model norm: 43.85869171403985.
Norm before scaling: 43.81897603930074. Distance: 1.3367186822227939
Total norm for 4 adversaries is: 43.81897603930074. distance: 1.3367186822227939
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.85869171403985.
Norm before scaling: 43.82693848661317. Distance: 1.3293788152656991
Total norm for 4 adversaries is: 43.82693848661317. distance: 1.3293788152656991
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5345/5503 (97.1288%), train_poison_data_count: 430
Global model norm: 43.85869171403985.
Norm before scaling: 43.825893994019104. Distance: 1.3834789415886144
Total norm for 4 adversaries is: 43.825893994019104. distance: 1.3834789415886144
___Train Local_ResNet_18, epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5004/5489 (91.1641%)
___Train Local_ResNet_18, epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4914/5489 (89.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3757, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18, epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4492/4748 (94.6083%)
___Train Local_ResNet_18, epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4497/4748 (94.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8678, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18, epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5107/5645 (90.4694%)
___Train Local_ResNet_18, epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4837/5645 (85.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4790, Accuracy: 4740/10000 (47.4000%)
___Train Local_ResNet_18, epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4584/5018 (91.3511%)
___Train Local_ResNet_18, epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4463/5018 (88.9398%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1109, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18, epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3528/3774 (93.4817%)
___Train Local_ResNet_18, epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3572/3774 (94.6476%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9090, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18, epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4511/4830 (93.3954%)
___Train Local_ResNet_18, epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4473/4830 (92.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1465, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18, epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4159/4485 (92.7313%)
___Train Local_ResNet_18, epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3991/4485 (88.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2013, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4358/4605 (94.6363%)
___Train Local_ResNet_18, epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4396/4605 (95.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8201, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18, epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5630/6068 (92.7818%)
___Train Local_ResNet_18, epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5479/6068 (90.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2019, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6280/6947 (90.3987%)
___Train Local_ResNet_18, epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6037/6947 (86.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3720, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18, epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4916/5362 (91.6822%)
___Train Local_ResNet_18, epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4837/5362 (90.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0208, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18, epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4765/5224 (91.2136%)
___Train Local_ResNet_18, epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4649/5224 (88.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1886, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18, epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18, epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4104/4368 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0724, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3968/4249 (93.3867%)
___Train Local_ResNet_18, epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3924/4249 (92.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0824, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18, epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4991/5454 (91.5108%)
___Train Local_ResNet_18, epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4836/5454 (88.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1950, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18, epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5558/5939 (93.5848%)
___Train Local_ResNet_18, epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5451/5939 (91.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1130, Accuracy: 5403/10000 (54.0300%)
time spent on training: 223.07433700561523
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2639, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0801, Accuracy: 9683/9900 (97.8081%)
Done in 249.9432978630066 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 43.87897145264674.
Norm before scaling: 43.840549431024044. Distance: 1.1978907485590655
Total norm for 4 adversaries is: 43.840549431024044. distance: 1.1978907485590655
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 43.87897145264674.
Norm before scaling: 43.838041993013896. Distance: 1.2964050636502167
Total norm for 4 adversaries is: 43.838041993013896. distance: 1.2964050636502167
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 43.87897145264674.
Norm before scaling: 43.84816971442123. Distance: 1.356970447151014
Total norm for 4 adversaries is: 43.84816971442123. distance: 1.356970447151014
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5364/5503 (97.4741%), train_poison_data_count: 430
Global model norm: 43.87897145264674.
Norm before scaling: 43.84370545257894. Distance: 1.3168218392467292
Total norm for 4 adversaries is: 43.84370545257894. distance: 1.3168218392467292
___Train Local_ResNet_18, epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4178/4397 (95.0193%)
___Train Local_ResNet_18, epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4183/4397 (95.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7899, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18, epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3555/3774 (94.1971%)
___Train Local_ResNet_18, epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3565/3774 (94.4621%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8602, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18, epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4435/4894 (90.6212%)
___Train Local_ResNet_18, epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4303/4894 (87.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2204, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18, epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4886/5361 (91.1397%)
___Train Local_ResNet_18, epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4840/5361 (90.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0895, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18, epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5054/5526 (91.4586%)
___Train Local_ResNet_18, epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4844/5526 (87.6583%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2446, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5036/5298 (95.0547%)
___Train Local_ResNet_18, epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4942/5298 (93.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9929, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18, epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4962/5353 (92.6957%)
___Train Local_ResNet_18, epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4847/5353 (90.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9569, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18, epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4396/4797 (91.6406%)
___Train Local_ResNet_18, epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4361/4797 (90.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0625, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18, epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5515/5871 (93.9363%)
___Train Local_ResNet_18, epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5434/5871 (92.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0917, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18, epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6279/6947 (90.3843%)
___Train Local_ResNet_18, epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 6156/6947 (88.6138%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2184, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4391/4757 (92.3061%)
___Train Local_ResNet_18, epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4342/4757 (91.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0738, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18, epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5060/5559 (91.0236%)
___Train Local_ResNet_18, epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4885/5559 (87.8755%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1836, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18, epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4602/4956 (92.8571%)
___Train Local_ResNet_18, epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4510/4956 (91.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1566, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4734/5193 (91.1612%)
___Train Local_ResNet_18, epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4480/5193 (86.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3192, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18, epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3978/4249 (93.6220%)
___Train Local_ResNet_18, epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3928/4249 (92.4453%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0197, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18, epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4817/5399 (89.2202%)
___Train Local_ResNet_18, epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4694/5399 (86.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2112, Accuracy: 5213/10000 (52.1300%)
time spent on training: 227.40750360488892
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2631, Accuracy: 6770/10000 (67.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0786, Accuracy: 9682/9900 (97.7980%)
Done in 254.67139220237732 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 43.89994672281078.
Norm before scaling: 43.86226249624001. Distance: 1.1860150539285501
Total norm for 4 adversaries is: 43.86226249624001. distance: 1.1860150539285501
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 43.89994672281078.
Norm before scaling: 43.85875572906238. Distance: 1.3021919001776603
Total norm for 4 adversaries is: 43.85875572906238. distance: 1.3021919001776603
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.89994672281078.
Norm before scaling: 43.86609457120257. Distance: 1.3088959302309837
Total norm for 4 adversaries is: 43.86609457120257. distance: 1.3088959302309837
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.89994672281078.
Norm before scaling: 43.86492021634073. Distance: 1.3343016664602239
Total norm for 4 adversaries is: 43.86492021634073. distance: 1.3343016664602239
___Train Local_ResNet_18, epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3982/4249 (93.7162%)
___Train Local_ResNet_18, epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3908/4249 (91.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0039, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18, epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3606/3959 (91.0836%)
___Train Local_ResNet_18, epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3595/3959 (90.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9075, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18, epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4524/4843 (93.4132%)
___Train Local_ResNet_18, epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4439/4843 (91.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0759, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18, epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5347/5696 (93.8729%)
___Train Local_ResNet_18, epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5270/5696 (92.5211%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9389, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18, epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4676/5086 (91.9387%)
___Train Local_ResNet_18, epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4624/5086 (90.9162%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0533, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5079/5645 (89.9734%)
___Train Local_ResNet_18, epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4920/5645 (87.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1132, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18, epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5148/5422 (94.9465%)
___Train Local_ResNet_18, epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5096/5422 (93.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0805, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18, epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5006/5362 (93.3607%)
___Train Local_ResNet_18, epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4851/5362 (90.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1216, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18, epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5434/6080 (89.3750%)
___Train Local_ResNet_18, epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5297/6080 (87.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2056, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18, epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4296/4736 (90.7095%)
___Train Local_ResNet_18, epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4222/4736 (89.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1215, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18, epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3845/4086 (94.1018%)
___Train Local_ResNet_18, epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3831/4086 (93.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9425, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18, epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3712/3968 (93.5484%)
___Train Local_ResNet_18, epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3671/3968 (92.5151%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8134, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18, epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4619/5050 (91.4653%)
___Train Local_ResNet_18, epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4551/5050 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9752, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18, epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3338/3589 (93.0064%)
___Train Local_ResNet_18, epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3040/3589 (84.7033%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3233, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18, epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5432/5907 (91.9587%)
___Train Local_ResNet_18, epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5377/5907 (91.0276%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2137, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18, epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4668/4993 (93.4909%)
___Train Local_ResNet_18, epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4625/4993 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0810, Accuracy: 5545/10000 (55.4500%)
time spent on training: 215.09028959274292
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2718, Accuracy: 6752/10000 (67.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0778, Accuracy: 9687/9900 (97.8485%)
Done in 242.12490725517273 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5162/5308 (97.2494%), train_poison_data_count: 415
Global model norm: 43.91986276962993.
Norm before scaling: 43.88467691762197. Distance: 1.3028617922396986
Total norm for 4 adversaries is: 43.88467691762197. distance: 1.3028617922396986
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5622/5777 (97.3169%), train_poison_data_count: 455
Global model norm: 43.91986276962993.
Norm before scaling: 43.87935814581912. Distance: 1.3333714698264851
Total norm for 4 adversaries is: 43.87935814581912. distance: 1.3333714698264851
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4958/5123 (96.7792%), train_poison_data_count: 403
Global model norm: 43.91986276962993.
Norm before scaling: 43.886775596592024. Distance: 1.2818482560706987
Total norm for 4 adversaries is: 43.886775596592024. distance: 1.2818482560706987
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.91986276962993.
Norm before scaling: 43.88547384332457. Distance: 1.3686017378543365
Total norm for 4 adversaries is: 43.88547384332457. distance: 1.3686017378543365
___Train Local_ResNet_18, epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4053/4364 (92.8735%)
___Train Local_ResNet_18, epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4023/4364 (92.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0178, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18, epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4493/4869 (92.2777%)
___Train Local_ResNet_18, epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4317/4869 (88.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.4188, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18, epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4446/4903 (90.6792%)
___Train Local_ResNet_18, epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4406/4903 (89.8633%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2706, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18, epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4688/5035 (93.1082%)
___Train Local_ResNet_18, epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4660/5035 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9708, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18, epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4422/4731 (93.4686%)
___Train Local_ResNet_18, epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4403/4731 (93.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0146, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18, epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4500/4843 (92.9176%)
___Train Local_ResNet_18, epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4452/4843 (91.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0598, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18, epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5098/5645 (90.3100%)
___Train Local_ResNet_18, epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4941/5645 (87.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2762, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18, epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4333/4605 (94.0934%)
___Train Local_ResNet_18, epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4329/4605 (94.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9861, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18, epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4124/4368 (94.4139%)
___Train Local_ResNet_18, epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4094/4368 (93.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0136, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5026/5346 (94.0142%)
___Train Local_ResNet_18, epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5011/5346 (93.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1224, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3858/4111 (93.8458%)
___Train Local_ResNet_18, epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3849/4111 (93.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9220, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18, epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5604/6235 (89.8797%)
___Train Local_ResNet_18, epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5472/6235 (87.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3252, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18, epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4776/5209 (91.6875%)
___Train Local_ResNet_18, epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4660/5209 (89.4605%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2299, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18, epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4485/4748 (94.4608%)
___Train Local_ResNet_18, epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4442/4748 (93.5552%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9773, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18, epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4657/4993 (93.2706%)
___Train Local_ResNet_18, epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4560/4993 (91.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1721, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18, epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4574/4911 (93.1379%)
___Train Local_ResNet_18, epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4564/4911 (92.9342%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0355, Accuracy: 5487/10000 (54.8700%)
time spent on training: 221.73230814933777
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2713, Accuracy: 6750/10000 (67.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0786, Accuracy: 9684/9900 (97.8182%)
Done in 248.36900067329407 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 43.9385098901543.
Norm before scaling: 43.90167625198809. Distance: 1.2428297385904297
Total norm for 4 adversaries is: 43.90167625198809. distance: 1.2428297385904297
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 43.9385098901543.
Norm before scaling: 43.895226318526795. Distance: 1.2773106188662495
Total norm for 4 adversaries is: 43.895226318526795. distance: 1.2773106188662495
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4942/5123 (96.4669%), train_poison_data_count: 403
Global model norm: 43.9385098901543.
Norm before scaling: 43.90574260160552. Distance: 1.3214437841033149
Total norm for 4 adversaries is: 43.90574260160552. distance: 1.3214437841033149
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 43.9385098901543.
Norm before scaling: 43.90289689153496. Distance: 1.3194395260412444
Total norm for 4 adversaries is: 43.90289689153496. distance: 1.3194395260412444
___Train Local_ResNet_18, epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4703/5086 (92.4695%)
___Train Local_ResNet_18, epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4669/5086 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1572, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18, epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3896/4130 (94.3341%)
___Train Local_ResNet_18, epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3846/4130 (93.1235%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0733, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18, epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4438/4714 (94.1451%)
___Train Local_ResNet_18, epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4437/4714 (94.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9779, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18, epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3703/3968 (93.3216%)
___Train Local_ResNet_18, epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3709/3968 (93.4728%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7716, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18, epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5046/5497 (91.7955%)
___Train Local_ResNet_18, epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4905/5497 (89.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1023, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18, epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5446/5907 (92.1957%)
___Train Local_ResNet_18, epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5305/5907 (89.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.5105, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18, epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5107/5422 (94.1903%)
___Train Local_ResNet_18, epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5029/5422 (92.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0889, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18, epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5037/5489 (91.7653%)
___Train Local_ResNet_18, epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5065/5489 (92.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1407, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18, epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4556/4830 (94.3271%)
___Train Local_ResNet_18, epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4547/4830 (94.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1586, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18, epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5418/6080 (89.1118%)
___Train Local_ResNet_18, epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5307/6080 (87.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2214, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18, epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3363/3589 (93.7030%)
___Train Local_ResNet_18, epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3201/3589 (89.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1260, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18, epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5064/5526 (91.6395%)
___Train Local_ResNet_18, epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4962/5526 (89.7937%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1557, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18, epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3892/4175 (93.2216%)
___Train Local_ResNet_18, epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3761/4175 (90.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3492, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18, epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4456/4818 (92.4865%)
___Train Local_ResNet_18, epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4333/4818 (89.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1371, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3764/4028 (93.4459%)
___Train Local_ResNet_18, epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3738/4028 (92.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9785, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18, epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4830/5399 (89.4610%)
___Train Local_ResNet_18, epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4654/5399 (86.2011%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2281, Accuracy: 5279/10000 (52.7900%)
time spent on training: 215.8425087928772
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2855, Accuracy: 6722/10000 (67.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0703, Accuracy: 9705/9900 (98.0303%)
Done in 242.9020652770996 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 43.95792388484271.
Norm before scaling: 43.92111903476077. Distance: 1.2513872554926926
Total norm for 4 adversaries is: 43.92111903476077. distance: 1.2513872554926926
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.95792388484271.
Norm before scaling: 43.9162299600757. Distance: 1.2800187032793444
Total norm for 4 adversaries is: 43.9162299600757. distance: 1.2800187032793444
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.95792388484271.
Norm before scaling: 43.92268514683287. Distance: 1.288000559489798
Total norm for 4 adversaries is: 43.92268514683287. distance: 1.288000559489798
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5371/5503 (97.6013%), train_poison_data_count: 430
Global model norm: 43.95792388484271.
Norm before scaling: 43.91990307072851. Distance: 1.284357721439909
Total norm for 4 adversaries is: 43.91990307072851. distance: 1.284357721439909
___Train Local_ResNet_18, epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4248/4587 (92.6095%)
___Train Local_ResNet_18, epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4168/4587 (90.8655%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1428, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5055/5497 (91.9593%)
___Train Local_ResNet_18, epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4945/5497 (89.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2676, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18, epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5627/6068 (92.7324%)
___Train Local_ResNet_18, epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5547/6068 (91.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1479, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5158/5615 (91.8611%)
___Train Local_ResNet_18, epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5083/5615 (90.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1705, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18, epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4769/5224 (91.2902%)
___Train Local_ResNet_18, epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4729/5224 (90.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1857, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18, epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4608/4911 (93.8302%)
___Train Local_ResNet_18, epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4601/4911 (93.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0939, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18, epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5053/5652 (89.4020%)
___Train Local_ResNet_18, epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5019/5652 (88.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.6076, Accuracy: 4649/10000 (46.4900%)
___Train Local_ResNet_18, epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4453/4757 (93.6094%)
___Train Local_ResNet_18, epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4311/4757 (90.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0220, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18, epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5406/5907 (91.5185%)
___Train Local_ResNet_18, epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5353/5907 (90.6213%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4784, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18, epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3770/4028 (93.5948%)
___Train Local_ResNet_18, epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3703/4028 (91.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9425, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18, epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4651/5055 (92.0079%)
___Train Local_ResNet_18, epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4555/5055 (90.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1677, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3348/3589 (93.2850%)
___Train Local_ResNet_18, epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3124/3589 (87.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2650, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18, epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4519/4748 (95.1769%)
___Train Local_ResNet_18, epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4476/4748 (94.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9154, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18, epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4703/5086 (92.4695%)
___Train Local_ResNet_18, epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4621/5086 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2093, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18, epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6400/6812 (93.9518%)
___Train Local_ResNet_18, epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6205/6812 (91.0893%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1462, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18, epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4041/4364 (92.5985%)
___Train Local_ResNet_18, epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3863/4364 (88.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0703, Accuracy: 5353/10000 (53.5300%)
time spent on training: 210.60800743103027
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2852, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0677, Accuracy: 9719/9900 (98.1717%)
Done in 237.04423713684082 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5179/5308 (97.5697%), train_poison_data_count: 415
Global model norm: 43.97879627143489.
Norm before scaling: 43.94186722605789. Distance: 1.253666221961061
Total norm for 4 adversaries is: 43.94186722605789. distance: 1.253666221961061
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5642/5777 (97.6631%), train_poison_data_count: 455
Global model norm: 43.97879627143489.
Norm before scaling: 43.93801814461552. Distance: 1.3020863901738207
Total norm for 4 adversaries is: 43.93801814461552. distance: 1.3020863901738207
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4957/5123 (96.7597%), train_poison_data_count: 403
Global model norm: 43.97879627143489.
Norm before scaling: 43.94572152587425. Distance: 1.3096839576696953
Total norm for 4 adversaries is: 43.94572152587425. distance: 1.3096839576696953
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5373/5503 (97.6377%), train_poison_data_count: 430
Global model norm: 43.97879627143489.
Norm before scaling: 43.94074490151481. Distance: 1.2686576772088356
Total norm for 4 adversaries is: 43.94074490151481. distance: 1.2686576772088356
___Train Local_ResNet_18, epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5032/5454 (92.2626%)
___Train Local_ResNet_18, epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4784/5454 (87.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1077, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18, epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3304/3552 (93.0180%)
___Train Local_ResNet_18, epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3315/3552 (93.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8527, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18, epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4326/4549 (95.0978%)
___Train Local_ResNet_18, epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4269/4549 (93.8448%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0055, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18, epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4495/4748 (94.6714%)
___Train Local_ResNet_18, epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4444/4748 (93.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9719, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18, epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4965/5362 (92.5960%)
___Train Local_ResNet_18, epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4873/5362 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9305, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3836/4108 (93.3788%)
___Train Local_ResNet_18, epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3711/4108 (90.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1391, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18, epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5210/5727 (90.9726%)
___Train Local_ResNet_18, epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5034/5727 (87.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1487, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18, epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4597/4929 (93.2644%)
___Train Local_ResNet_18, epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4525/4929 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0982, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18, epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5483/5871 (93.3912%)
___Train Local_ResNet_18, epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5363/5871 (91.3473%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1624, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18, epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4475/4869 (91.9080%)
___Train Local_ResNet_18, epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4059/4869 (83.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.5232, Accuracy: 4806/10000 (48.0600%)
___Train Local_ResNet_18, epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4379/4672 (93.7286%)
___Train Local_ResNet_18, epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4379/4672 (93.7286%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9072, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18, epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3646/3995 (91.2641%)
___Train Local_ResNet_18, epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3583/3995 (89.6871%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0550, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18, epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6296/6947 (90.6290%)
___Train Local_ResNet_18, epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5991/6947 (86.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3162, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18, epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4391/4737 (92.6958%)
___Train Local_ResNet_18, epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4379/4737 (92.4425%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1199, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4794/5209 (92.0330%)
___Train Local_ResNet_18, epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4689/5209 (90.0173%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1998, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18, epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3677/3968 (92.6663%)
___Train Local_ResNet_18, epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3687/3968 (92.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8555, Accuracy: 5721/10000 (57.2100%)
time spent on training: 221.24949622154236
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2941, Accuracy: 6726/10000 (67.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0675, Accuracy: 9716/9900 (98.1414%)
Done in 248.38522624969482 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5308 (97.8335%), train_poison_data_count: 415
Global model norm: 43.99765424544316.
Norm before scaling: 43.95902216704567. Distance: 1.2143944893930576
Total norm for 4 adversaries is: 43.95902216704567. distance: 1.2143944893930576
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5629/5777 (97.4381%), train_poison_data_count: 455
Global model norm: 43.99765424544316.
Norm before scaling: 43.95679086205708. Distance: 1.3165137815844334
Total norm for 4 adversaries is: 43.95679086205708. distance: 1.3165137815844334
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 43.99765424544316.
Norm before scaling: 43.9605744331462. Distance: 1.2438707283505595
Total norm for 4 adversaries is: 43.9605744331462. distance: 1.2438707283505595
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 43.99765424544316.
Norm before scaling: 43.96210859578394. Distance: 1.3374146888834437
Total norm for 4 adversaries is: 43.96210859578394. distance: 1.3374146888834437
___Train Local_ResNet_18, epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4264/4587 (92.9584%)
___Train Local_ResNet_18, epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4199/4587 (91.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9836, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4067/4364 (93.1943%)
___Train Local_ResNet_18, epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3948/4364 (90.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8851, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18, epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4196/4397 (95.4287%)
___Train Local_ResNet_18, epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4213/4397 (95.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7805, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18, epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4993/5353 (93.2748%)
___Train Local_ResNet_18, epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4834/5353 (90.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9560, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4732/5075 (93.2414%)
___Train Local_ResNet_18, epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4671/5075 (92.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0181, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3709/4028 (92.0804%)
___Train Local_ResNet_18, epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3656/4028 (90.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9722, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18, epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5135/5422 (94.7068%)
___Train Local_ResNet_18, epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5054/5422 (93.2128%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0733, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18, epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5191/5615 (92.4488%)
___Train Local_ResNet_18, epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5148/5615 (91.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1107, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18, epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4542/4889 (92.9024%)
___Train Local_ResNet_18, epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4499/4889 (92.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2405, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18, epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4869 (92.7090%)
___Train Local_ResNet_18, epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4010/4869 (82.3578%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2250, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18, epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4321/4549 (94.9879%)
___Train Local_ResNet_18, epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3939/4549 (86.5905%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2798, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18, epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4488/4843 (92.6698%)
___Train Local_ResNet_18, epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4431/4843 (91.4929%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8907, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18, epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4918/5362 (91.7195%)
___Train Local_ResNet_18, epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4800/5362 (89.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2917, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18, epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5412/5907 (91.6201%)
___Train Local_ResNet_18, epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5378/5907 (91.0445%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.4902, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18, epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3903/4130 (94.5036%)
___Train Local_ResNet_18, epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3867/4130 (93.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9267, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18, epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4972/5454 (91.1624%)
___Train Local_ResNet_18, epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4845/5454 (88.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1914, Accuracy: 5154/10000 (51.5400%)
time spent on training: 222.16127967834473
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2893, Accuracy: 6732/10000 (67.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0669, Accuracy: 9718/9900 (98.1616%)
Done in 248.79159927368164 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.017533016863005.
Norm before scaling: 43.9771558240753. Distance: 1.166341304823403
Total norm for 4 adversaries is: 43.9771558240753. distance: 1.166341304823403
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 44.017533016863005.
Norm before scaling: 43.977119739097. Distance: 1.320057319494767
Total norm for 4 adversaries is: 43.977119739097. distance: 1.320057319494767
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 44.017533016863005.
Norm before scaling: 43.98401143277805. Distance: 1.2834262973174801
Total norm for 4 adversaries is: 43.98401143277805. distance: 1.2834262973174801
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.017533016863005.
Norm before scaling: 43.9803533907471. Distance: 1.2899020611009042
Total norm for 4 adversaries is: 43.9803533907471. distance: 1.2899020611009042
___Train Local_ResNet_18, epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5064/5645 (89.7077%)
___Train Local_ResNet_18, epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4780/5645 (84.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2374, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18, epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3679/3910 (94.0921%)
___Train Local_ResNet_18, epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3576/3910 (91.4578%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2536, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18, epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5057/5346 (94.5941%)
___Train Local_ResNet_18, epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4933/5346 (92.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0845, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18, epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5589/6235 (89.6391%)
___Train Local_ResNet_18, epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5532/6235 (88.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2390, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18, epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5000/5559 (89.9442%)
___Train Local_ResNet_18, epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4868/5559 (87.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1898, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18, epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4371/4605 (94.9186%)
___Train Local_ResNet_18, epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4346/4605 (94.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8249, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18, epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4436/4714 (94.1027%)
___Train Local_ResNet_18, epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4449/4714 (94.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8187, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18, epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5433/6080 (89.3586%)
___Train Local_ResNet_18, epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5328/6080 (87.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3091, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18, epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5163/5652 (91.3482%)
___Train Local_ResNet_18, epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5050/5652 (89.3489%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2514, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18, epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5032/5454 (92.2626%)
___Train Local_ResNet_18, epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4770/5454 (87.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1732, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18, epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4361/4672 (93.3433%)
___Train Local_ResNet_18, epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4338/4672 (92.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8720, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18, epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4918/5427 (90.6210%)
___Train Local_ResNet_18, epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4845/5427 (89.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0920, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18, epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4781/5068 (94.3370%)
___Train Local_ResNet_18, epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4642/5068 (91.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1230, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18, epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3667/3968 (92.4143%)
___Train Local_ResNet_18, epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3682/3968 (92.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8954, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18, epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5403/5907 (91.4678%)
___Train Local_ResNet_18, epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5397/5907 (91.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2918, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18, epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4459/4851 (91.9192%)
___Train Local_ResNet_18, epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4439/4851 (91.5069%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1169, Accuracy: 5436/10000 (54.3600%)
time spent on training: 214.33960890769958
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2904, Accuracy: 6719/10000 (67.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0734, Accuracy: 9703/9900 (98.0101%)
Done in 241.0208284854889 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5188/5308 (97.7393%), train_poison_data_count: 415
Global model norm: 44.038091643769036.
Norm before scaling: 44.000593701605325. Distance: 1.2410665288516767
Total norm for 4 adversaries is: 44.000593701605325. distance: 1.2410665288516767
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.038091643769036.
Norm before scaling: 43.99516685990917. Distance: 1.2843137257756845
Total norm for 4 adversaries is: 43.99516685990917. distance: 1.2843137257756845
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.038091643769036.
Norm before scaling: 43.99990567283923. Distance: 1.22745937917278
Total norm for 4 adversaries is: 43.99990567283923. distance: 1.22745937917278
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5365/5503 (97.4923%), train_poison_data_count: 430
Global model norm: 44.038091643769036.
Norm before scaling: 44.00124842866677. Distance: 1.31546589122588
Total norm for 4 adversaries is: 44.00124842866677. distance: 1.31546589122588
___Train Local_ResNet_18, epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6357/6812 (93.3206%)
___Train Local_ResNet_18, epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6215/6812 (91.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1600, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3824/4175 (91.5928%)
___Train Local_ResNet_18, epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3821/4175 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0654, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18, epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4459/4757 (93.7355%)
___Train Local_ResNet_18, epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4305/4757 (90.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1542, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18, epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3665/3910 (93.7340%)
___Train Local_ResNet_18, epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3246/3910 (83.0179%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3853, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18, epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5509/6080 (90.6086%)
___Train Local_ResNet_18, epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5279/6080 (86.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3164, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18, epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5069/5346 (94.8186%)
___Train Local_ResNet_18, epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4958/5346 (92.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0783, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3785/4028 (93.9672%)
___Train Local_ResNet_18, epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3743/4028 (92.9245%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9008, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18, epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5329/5696 (93.5569%)
___Train Local_ResNet_18, epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5162/5696 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9438, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18, epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4714/5123 (92.0164%)
___Train Local_ResNet_18, epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4531/5123 (88.4443%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1442, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18, epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3363/3589 (93.7030%)
___Train Local_ResNet_18, epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3338/3589 (93.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8512, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18, epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4454/4894 (91.0094%)
___Train Local_ResNet_18, epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4294/4894 (87.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1359, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3909/4108 (95.1558%)
___Train Local_ResNet_18, epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3836/4108 (93.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9826, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18, epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5039/5353 (94.1341%)
___Train Local_ResNet_18, epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4935/5353 (92.1913%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0234, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4878/5504 (88.6265%)
___Train Local_ResNet_18, epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4803/5504 (87.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1785, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18, epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3659/3995 (91.5895%)
___Train Local_ResNet_18, epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3532/3995 (88.4105%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0792, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18, epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5205/5615 (92.6981%)
___Train Local_ResNet_18, epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5132/5615 (91.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0836, Accuracy: 5520/10000 (55.2000%)
time spent on training: 198.71740245819092
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.2988, Accuracy: 6708/10000 (67.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0722, Accuracy: 9710/9900 (98.0808%)
Done in 225.19687342643738 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 44.05827218192118.
Norm before scaling: 44.02081777365043. Distance: 1.244474261476352
Total norm for 4 adversaries is: 44.02081777365043. distance: 1.244474261476352
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.05827218192118.
Norm before scaling: 44.01801971432055. Distance: 1.3329396212955298
Total norm for 4 adversaries is: 44.01801971432055. distance: 1.3329396212955298
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 44.05827218192118.
Norm before scaling: 44.022720019663566. Distance: 1.271972468809967
Total norm for 4 adversaries is: 44.022720019663566. distance: 1.271972468809967
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5363/5503 (97.4559%), train_poison_data_count: 430
Global model norm: 44.05827218192118.
Norm before scaling: 44.02147081343517. Distance: 1.3058720311068759
Total norm for 4 adversaries is: 44.02147081343517. distance: 1.3058720311068759
___Train Local_ResNet_18, epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4566/4911 (92.9750%)
___Train Local_ResNet_18, epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4492/4911 (91.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1724, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18, epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4726/5086 (92.9217%)
___Train Local_ResNet_18, epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4660/5086 (91.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9584, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18, epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5032/5489 (91.6743%)
___Train Local_ResNet_18, epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4988/5489 (90.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2866, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18, epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3898/4130 (94.3826%)
___Train Local_ResNet_18, epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3856/4130 (93.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0916, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18, epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4544/4843 (93.8261%)
___Train Local_ResNet_18, epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4491/4843 (92.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0725, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18, epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3670/3910 (93.8619%)
___Train Local_ResNet_18, epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3590/3910 (91.8159%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2644, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18, epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5507/6080 (90.5757%)
___Train Local_ResNet_18, epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5245/6080 (86.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2080, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18, epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4480/4732 (94.6746%)
___Train Local_ResNet_18, epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4460/4732 (94.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8337, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18, epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4604/4956 (92.8975%)
___Train Local_ResNet_18, epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4561/4956 (92.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3682, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18, epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4785/5075 (94.2857%)
___Train Local_ResNet_18, epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4662/5075 (91.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2037, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18, epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4571/5050 (90.5149%)
___Train Local_ResNet_18, epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4489/5050 (88.8911%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0119, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18, epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3871/4111 (94.1620%)
___Train Local_ResNet_18, epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3746/4111 (91.1214%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1629, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4704/5224 (90.0459%)
___Train Local_ResNet_18, epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4737/5224 (90.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3222, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18, epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4438/4894 (90.6825%)
___Train Local_ResNet_18, epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4279/4894 (87.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2188, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18, epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3848/4108 (93.6709%)
___Train Local_ResNet_18, epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3724/4108 (90.6524%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2112, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18, epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5957/6664 (89.3908%)
___Train Local_ResNet_18, epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5612/6664 (84.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3112, Accuracy: 5023/10000 (50.2300%)
time spent on training: 197.4003324508667
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3014, Accuracy: 6706/10000 (67.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0714, Accuracy: 9711/9900 (98.0909%)
Done in 224.26688504219055 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.077787130927696.
Norm before scaling: 44.038185889137736. Distance: 1.1575340152298699
Total norm for 4 adversaries is: 44.038185889137736. distance: 1.1575340152298699
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5632/5777 (97.4900%), train_poison_data_count: 455
Global model norm: 44.077787130927696.
Norm before scaling: 44.03582276423863. Distance: 1.3025422876855501
Total norm for 4 adversaries is: 44.03582276423863. distance: 1.3025422876855501
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4993/5123 (97.4624%), train_poison_data_count: 403
Global model norm: 44.077787130927696.
Norm before scaling: 44.04184051354249. Distance: 1.2599258675792593
Total norm for 4 adversaries is: 44.04184051354249. distance: 1.2599258675792593
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 44.077787130927696.
Norm before scaling: 44.04157165882807. Distance: 1.3080563480827274
Total norm for 4 adversaries is: 44.04157165882807. distance: 1.3080563480827274
___Train Local_ResNet_18, epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4093/4364 (93.7901%)
___Train Local_ResNet_18, epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3937/4364 (90.2154%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9916, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18, epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5125/5422 (94.5223%)
___Train Local_ResNet_18, epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5057/5422 (93.2682%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0145, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18, epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3376/3589 (94.0652%)
___Train Local_ResNet_18, epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3196/3589 (89.0499%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0147, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18, epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4996/5353 (93.3308%)
___Train Local_ResNet_18, epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4866/5353 (90.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9589, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4717/5075 (92.9458%)
___Train Local_ResNet_18, epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4646/5075 (91.5468%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3348, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18, epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3750/3968 (94.5060%)
___Train Local_ResNet_18, epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3693/3968 (93.0696%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8552, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18, epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5040/5489 (91.8200%)
___Train Local_ResNet_18, epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5015/5489 (91.3645%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2106, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18, epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4198/4587 (91.5195%)
___Train Local_ResNet_18, epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4196/4587 (91.4759%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0276, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18, epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3964/4196 (94.4709%)
___Train Local_ResNet_18, epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3989/4196 (95.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7771, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18, epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3271/3552 (92.0890%)
___Train Local_ResNet_18, epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3333/3552 (93.8345%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7544, Accuracy: 5985/10000 (59.8500%)
___Train Local_ResNet_18, epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3669/3995 (91.8398%)
___Train Local_ResNet_18, epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3591/3995 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2451, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5130/5526 (92.8339%)
___Train Local_ResNet_18, epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4834/5526 (87.4774%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3685, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18, epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4416/4757 (92.8316%)
___Train Local_ResNet_18, epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4347/4757 (91.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0685, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18, epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4620/4979 (92.7897%)
___Train Local_ResNet_18, epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4558/4979 (91.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0465, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18, epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4384/4741 (92.4699%)
___Train Local_ResNet_18, epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3991/4741 (84.1806%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.7071, Accuracy: 4605/10000 (46.0500%)
___Train Local_ResNet_18, epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4773/5193 (91.9122%)
___Train Local_ResNet_18, epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4370/5193 (84.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3299, Accuracy: 5086/10000 (50.8600%)
time spent on training: 193.92358088493347
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3104, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0705, Accuracy: 9718/9900 (98.1616%)
Done in 220.61956024169922 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 44.0968574494154.
Norm before scaling: 44.05739664595208. Distance: 1.1872078887642652
Total norm for 4 adversaries is: 44.05739664595208. distance: 1.1872078887642652
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 44.0968574494154.
Norm before scaling: 44.05341772531673. Distance: 1.2982736881268648
Total norm for 4 adversaries is: 44.05341772531673. distance: 1.2982736881268648
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4974/5123 (97.0915%), train_poison_data_count: 403
Global model norm: 44.0968574494154.
Norm before scaling: 44.061161881277314. Distance: 1.2837773494165805
Total norm for 4 adversaries is: 44.061161881277314. distance: 1.2837773494165805
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 44.0968574494154.
Norm before scaling: 44.05880137402316. Distance: 1.322042471735823
Total norm for 4 adversaries is: 44.05880137402316. distance: 1.322042471735823
___Train Local_ResNet_18, epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3687/3910 (94.2967%)
___Train Local_ResNet_18, epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3712/3910 (94.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9308, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18, epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3875/4086 (94.8360%)
___Train Local_ResNet_18, epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3855/4086 (94.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8927, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18, epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4596/4929 (93.2441%)
___Train Local_ResNet_18, epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4466/4929 (90.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1680, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18, epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4449/4732 (94.0194%)
___Train Local_ResNet_18, epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4478/4732 (94.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7659, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18, epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4125/4527 (91.1199%)
___Train Local_ResNet_18, epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4058/4527 (89.6399%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9619, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18, epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3770/4028 (93.5948%)
___Train Local_ResNet_18, epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3732/4028 (92.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9997, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18, epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3869/4175 (92.6707%)
___Train Local_ResNet_18, epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3827/4175 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1467, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18, epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5119/5422 (94.4117%)
___Train Local_ResNet_18, epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5069/5422 (93.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0140, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18, epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5079/5461 (93.0049%)
___Train Local_ResNet_18, epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4911/5461 (89.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3191, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18, epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4918/5504 (89.3532%)
___Train Local_ResNet_18, epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4879/5504 (88.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2463, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18, epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4412/4737 (93.1391%)
___Train Local_ResNet_18, epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4307/4737 (90.9225%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0610, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18, epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4443/4714 (94.2512%)
___Train Local_ResNet_18, epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4440/4714 (94.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8788, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18, epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4478/4818 (92.9431%)
___Train Local_ResNet_18, epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4372/4818 (90.7430%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0105, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18, epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4407/4797 (91.8699%)
___Train Local_ResNet_18, epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4358/4797 (90.8484%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9923, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18, epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4670/5055 (92.3838%)
___Train Local_ResNet_18, epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4599/5055 (90.9792%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1565, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18, epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5081/5497 (92.4322%)
___Train Local_ResNet_18, epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4977/5497 (90.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2136, Accuracy: 5161/10000 (51.6100%)
time spent on training: 194.67011880874634
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3119, Accuracy: 6686/10000 (66.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0679, Accuracy: 9720/9900 (98.1818%)
Done in 221.63068532943726 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5189/5308 (97.7581%), train_poison_data_count: 415
Global model norm: 44.11533844296675.
Norm before scaling: 44.07639824028204. Distance: 1.2264987418739406
Total norm for 4 adversaries is: 44.07639824028204. distance: 1.2264987418739406
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5650/5777 (97.8016%), train_poison_data_count: 455
Global model norm: 44.11533844296675.
Norm before scaling: 44.06997110863161. Distance: 1.259129137220036
Total norm for 4 adversaries is: 44.06997110863161. distance: 1.259129137220036
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 44.11533844296675.
Norm before scaling: 44.0809233979642. Distance: 1.3328750488344205
Total norm for 4 adversaries is: 44.0809233979642. distance: 1.3328750488344205
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.11533844296675.
Norm before scaling: 44.07821223626603. Distance: 1.2682479240811062
Total norm for 4 adversaries is: 44.07821223626603. distance: 1.2682479240811062
___Train Local_ResNet_18, epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3794/4028 (94.1907%)
___Train Local_ResNet_18, epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3795/4028 (94.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8085, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18, epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3894/4161 (93.5833%)
___Train Local_ResNet_18, epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3802/4161 (91.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0832, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18, epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4730/4993 (94.7326%)
___Train Local_ResNet_18, epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4615/4993 (92.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0916, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18, epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4481/4903 (91.3930%)
___Train Local_ResNet_18, epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4502/4903 (91.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9956, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18, epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5044/5497 (91.7591%)
___Train Local_ResNet_18, epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4921/5497 (89.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2526, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18, epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4842/5399 (89.6833%)
___Train Local_ResNet_18, epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4656/5399 (86.2382%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3675, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18, epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5644/6068 (93.0125%)
___Train Local_ResNet_18, epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5522/6068 (91.0020%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1267, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4588/4830 (94.9896%)
___Train Local_ResNet_18, epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4527/4830 (93.7267%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1361, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18, epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3353/3589 (93.4244%)
___Train Local_ResNet_18, epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3371/3589 (93.9259%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8946, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18, epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4745/5224 (90.8308%)
___Train Local_ResNet_18, epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4720/5224 (90.3522%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1300, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18, epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3719/3968 (93.7248%)
___Train Local_ResNet_18, epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3704/3968 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8327, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18, epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4718/5055 (93.3333%)
___Train Local_ResNet_18, epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4605/5055 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1954, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18, epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4658/4979 (93.5529%)
___Train Local_ResNet_18, epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4568/4979 (91.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9613, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4778/5068 (94.2778%)
___Train Local_ResNet_18, epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4668/5068 (92.1073%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2652, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18, epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3914/4086 (95.7905%)
___Train Local_ResNet_18, epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3853/4086 (94.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0881, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18, epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4959/5362 (92.4841%)
___Train Local_ResNet_18, epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4863/5362 (90.6938%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0660, Accuracy: 5415/10000 (54.1500%)
time spent on training: 196.43923950195312
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3160, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0674, Accuracy: 9725/9900 (98.2323%)
Done in 223.3257167339325 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5190/5308 (97.7769%), train_poison_data_count: 415
Global model norm: 44.13346180815499.
Norm before scaling: 44.094126504416664. Distance: 1.2258964722686925
Total norm for 4 adversaries is: 44.094126504416664. distance: 1.2258964722686925
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5656/5777 (97.9055%), train_poison_data_count: 455
Global model norm: 44.13346180815499.
Norm before scaling: 44.089843576958. Distance: 1.259738939579282
Total norm for 4 adversaries is: 44.089843576958. distance: 1.259738939579282
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4957/5123 (96.7597%), train_poison_data_count: 403
Global model norm: 44.13346180815499.
Norm before scaling: 44.098245695690665. Distance: 1.3309793206062253
Total norm for 4 adversaries is: 44.098245695690665. distance: 1.3309793206062253
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.13346180815499.
Norm before scaling: 44.095001311089675. Distance: 1.2554354745743415
Total norm for 4 adversaries is: 44.095001311089675. distance: 1.2554354745743415
___Train Local_ResNet_18, epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4521/4869 (92.8527%)
___Train Local_ResNet_18, epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4287/4869 (88.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1717, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18, epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4734/5035 (94.0218%)
___Train Local_ResNet_18, epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4684/5035 (93.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9102, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18, epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3777/4028 (93.7686%)
___Train Local_ResNet_18, epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3728/4028 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0481, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18, epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4796/5075 (94.5025%)
___Train Local_ResNet_18, epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4674/5075 (92.0985%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1741, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18, epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4729/4993 (94.7126%)
___Train Local_ResNet_18, epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/4993 (93.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1640, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18, epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4521/4851 (93.1973%)
___Train Local_ResNet_18, epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4452/4851 (91.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9608, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18, epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3317/3552 (93.3840%)
___Train Local_ResNet_18, epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3324/3552 (93.5811%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8653, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18, epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4447/4731 (93.9970%)
___Train Local_ResNet_18, epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4411/4731 (93.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1155, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18, epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4788/5224 (91.6539%)
___Train Local_ResNet_18, epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4731/5224 (90.5628%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1862, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18, epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3993/4196 (95.1621%)
___Train Local_ResNet_18, epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3978/4196 (94.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8789, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18, epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5467/6080 (89.9178%)
___Train Local_ResNet_18, epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5348/6080 (87.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2608, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4426/4797 (92.2660%)
___Train Local_ResNet_18, epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4348/4797 (90.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1742, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18, epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4443/4714 (94.2512%)
___Train Local_ResNet_18, epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4401/4714 (93.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9484, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18, epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5176/5652 (91.5782%)
___Train Local_ResNet_18, epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5003/5652 (88.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1412, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18, epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4330/4549 (95.1858%)
___Train Local_ResNet_18, epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4121/4549 (90.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0756, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18, epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4911/5504 (89.2260%)
___Train Local_ResNet_18, epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4827/5504 (87.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1899, Accuracy: 5168/10000 (51.6800%)
time spent on training: 196.16887092590332
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3100, Accuracy: 6696/10000 (66.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0673, Accuracy: 9725/9900 (98.2323%)
Done in 222.6582269668579 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5186/5308 (97.7016%), train_poison_data_count: 415
Global model norm: 44.15133719573932.
Norm before scaling: 44.11095518334986. Distance: 1.1930829865945227
Total norm for 4 adversaries is: 44.11095518334986. distance: 1.1930829865945227
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5646/5777 (97.7324%), train_poison_data_count: 455
Global model norm: 44.15133719573932.
Norm before scaling: 44.10806459486391. Distance: 1.2918107762495719
Total norm for 4 adversaries is: 44.10806459486391. distance: 1.2918107762495719
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4965/5123 (96.9159%), train_poison_data_count: 403
Global model norm: 44.15133719573932.
Norm before scaling: 44.11677868037072. Distance: 1.2991304662349605
Total norm for 4 adversaries is: 44.11677868037072. distance: 1.2991304662349605
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 44.15133719573932.
Norm before scaling: 44.11069228461649. Distance: 1.2239076103359705
Total norm for 4 adversaries is: 44.11069228461649. distance: 1.2239076103359705
___Train Local_ResNet_18, epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5005/5454 (91.7675%)
___Train Local_ResNet_18, epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4964/5454 (91.0158%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0017, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18, epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4246/4736 (89.6537%)
___Train Local_ResNet_18, epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4268/4736 (90.1182%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0058, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18, epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4481/4748 (94.3766%)
___Train Local_ResNet_18, epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4347/4748 (91.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0784, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18, epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5073/5346 (94.8934%)
___Train Local_ResNet_18, epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4982/5346 (93.1912%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1523, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18, epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5656/6068 (93.2103%)
___Train Local_ResNet_18, epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5505/6068 (90.7218%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2713, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18, epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4677/5055 (92.5223%)
___Train Local_ResNet_18, epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4614/5055 (91.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0692, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4105/4364 (94.0651%)
___Train Local_ResNet_18, epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3891/4364 (89.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0496, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4997/5362 (93.1928%)
___Train Local_ResNet_18, epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4826/5362 (90.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0821, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18, epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3873/4111 (94.2107%)
___Train Local_ResNet_18, epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3843/4111 (93.4809%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0318, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18, epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5065/5497 (92.1412%)
___Train Local_ResNet_18, epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4964/5497 (90.3038%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1062, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18, epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4810/5075 (94.7783%)
___Train Local_ResNet_18, epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4689/5075 (92.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9228, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18, epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4764/5209 (91.4571%)
___Train Local_ResNet_18, epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4671/5209 (89.6717%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1749, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18, epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4625/4929 (93.8324%)
___Train Local_ResNet_18, epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4484/4929 (90.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2139, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18, epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18, epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4050/4368 (92.7198%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0459, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18, epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4078/4313 (94.5514%)
___Train Local_ResNet_18, epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3940/4313 (91.3517%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0867, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18, epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3796/4028 (94.2403%)
___Train Local_ResNet_18, epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3746/4028 (92.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8921, Accuracy: 5753/10000 (57.5300%)
time spent on training: 196.63486242294312
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3149, Accuracy: 6677/10000 (66.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0695, Accuracy: 9721/9900 (98.1919%)
Done in 223.51709413528442 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5192/5308 (97.8146%), train_poison_data_count: 415
Global model norm: 44.17120069347363.
Norm before scaling: 44.1341076493885. Distance: 1.28235885274701
Total norm for 4 adversaries is: 44.1341076493885. distance: 1.28235885274701
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.17120069347363.
Norm before scaling: 44.12784936798699. Distance: 1.2897351446240826
Total norm for 4 adversaries is: 44.12784936798699. distance: 1.2897351446240826
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.17120069347363.
Norm before scaling: 44.1325130820521. Distance: 1.2211107717781031
Total norm for 4 adversaries is: 44.1325130820521. distance: 1.2211107717781031
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5386/5503 (97.8739%), train_poison_data_count: 430
Global model norm: 44.17120069347363.
Norm before scaling: 44.13130985780532. Distance: 1.2400931210315018
Total norm for 4 adversaries is: 44.13130985780532. distance: 1.2400931210315018
___Train Local_ResNet_18, epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5643/6235 (90.5052%)
___Train Local_ResNet_18, epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5402/6235 (86.6399%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2819, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18, epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4383/4737 (92.5269%)
___Train Local_ResNet_18, epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4267/4737 (90.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2362, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18, epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4719/5035 (93.7239%)
___Train Local_ResNet_18, epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4643/5035 (92.2145%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0899, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18, epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4648/4979 (93.3521%)
___Train Local_ResNet_18, epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4595/4979 (92.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1154, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18, epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4695/5038 (93.1917%)
___Train Local_ResNet_18, epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4608/5038 (91.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1527, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18, epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5513/5939 (92.8271%)
___Train Local_ResNet_18, epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5494/5939 (92.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0446, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18, epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4131/4368 (94.5742%)
___Train Local_ResNet_18, epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4080/4368 (93.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0648, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18, epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5245/5727 (91.5837%)
___Train Local_ResNet_18, epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5076/5727 (88.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1813, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18, epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3992/4196 (95.1382%)
___Train Local_ResNet_18, epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3993/4196 (95.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8447, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18, epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3300/3552 (92.9054%)
___Train Local_ResNet_18, epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3338/3552 (93.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8029, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18, epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6359/6947 (91.5359%)
___Train Local_ResNet_18, epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6086/6947 (87.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1805, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18, epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4439/4714 (94.1663%)
___Train Local_ResNet_18, epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4386/4714 (93.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9267, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18, epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5091/5497 (92.6142%)
___Train Local_ResNet_18, epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4939/5497 (89.8490%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2758, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18, epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4381/4736 (92.5042%)
___Train Local_ResNet_18, epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4295/4736 (90.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9540, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18, epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5036/5346 (94.2013%)
___Train Local_ResNet_18, epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4961/5346 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1728, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18, epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4631/4956 (93.4423%)
___Train Local_ResNet_18, epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4554/4956 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1837, Accuracy: 5367/10000 (53.6700%)
time spent on training: 201.23518204689026
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3174, Accuracy: 6678/10000 (66.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0700, Accuracy: 9719/9900 (98.1717%)
Done in 227.91432118415833 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5199/5308 (97.9465%), train_poison_data_count: 415
Global model norm: 44.18999175258749.
Norm before scaling: 44.15125563359934. Distance: 1.2403568237412232
Total norm for 4 adversaries is: 44.15125563359934. distance: 1.2403568237412232
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.18999175258749.
Norm before scaling: 44.14550996199599. Distance: 1.2522712577071045
Total norm for 4 adversaries is: 44.14550996199599. distance: 1.2522712577071045
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4968/5123 (96.9744%), train_poison_data_count: 403
Global model norm: 44.18999175258749.
Norm before scaling: 44.153767401901845. Distance: 1.3006602279680344
Total norm for 4 adversaries is: 44.153767401901845. distance: 1.3006602279680344
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 44.18999175258749.
Norm before scaling: 44.14964509607495. Distance: 1.24658719520082
Total norm for 4 adversaries is: 44.14964509607495. distance: 1.24658719520082
___Train Local_ResNet_18, epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3914/4111 (95.2080%)
___Train Local_ResNet_18, epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3892/4111 (94.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9591, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18, epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18, epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4439/4714 (94.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9433, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18, epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4810/5075 (94.7783%)
___Train Local_ResNet_18, epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4719/5075 (92.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0217, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18, epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4243/4587 (92.5005%)
___Train Local_ResNet_18, epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4171/4587 (90.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.4196, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18, epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4053/4313 (93.9717%)
___Train Local_ResNet_18, epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3981/4313 (92.3023%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8943, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18, epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4611/4929 (93.5484%)
___Train Local_ResNet_18, epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4454/4929 (90.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1290, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4481/4732 (94.6957%)
___Train Local_ResNet_18, epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4474/4732 (94.5478%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9105, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18, epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4890/5504 (88.8445%)
___Train Local_ResNet_18, epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4802/5504 (87.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1846, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18, epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4927/5361 (91.9045%)
___Train Local_ResNet_18, epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4828/5361 (90.0578%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0541, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18, epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4478/4903 (91.3318%)
___Train Local_ResNet_18, epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4434/4903 (90.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3624, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18, epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3810/4108 (92.7459%)
___Train Local_ResNet_18, epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3745/4108 (91.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9743, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18, epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4818/5068 (95.0671%)
___Train Local_ResNet_18, epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/5068 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1323, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5346/5696 (93.8553%)
___Train Local_ResNet_18, epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5279/5696 (92.6791%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0759, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18, epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4514/4731 (95.4132%)
___Train Local_ResNet_18, epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4475/4731 (94.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8935, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18, epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3710/3968 (93.4980%)
___Train Local_ResNet_18, epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3712/3968 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8429, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18, epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3942/4249 (92.7748%)
___Train Local_ResNet_18, epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3902/4249 (91.8334%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0278, Accuracy: 5443/10000 (54.4300%)
time spent on training: 194.9216492176056
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3301, Accuracy: 6652/10000 (66.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0642, Accuracy: 9737/9900 (98.3535%)
Done in 221.45208477973938 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.207692411608356.
Norm before scaling: 44.16723064326438. Distance: 1.1881536391417098
Total norm for 4 adversaries is: 44.16723064326438. distance: 1.1881536391417098
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.207692411608356.
Norm before scaling: 44.16279448803243. Distance: 1.2613447833858782
Total norm for 4 adversaries is: 44.16279448803243. distance: 1.2613447833858782
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 44.207692411608356.
Norm before scaling: 44.1701297961749. Distance: 1.2378330803566102
Total norm for 4 adversaries is: 44.1701297961749. distance: 1.2378330803566102
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 44.207692411608356.
Norm before scaling: 44.16980506734776. Distance: 1.3301025029887852
Total norm for 4 adversaries is: 44.16980506734776. distance: 1.3301025029887852
___Train Local_ResNet_18, epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5025/5702 (88.1270%)
___Train Local_ResNet_18, epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4652/5702 (81.5854%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2348, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18, epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3302/3552 (92.9617%)
___Train Local_ResNet_18, epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3317/3552 (93.3840%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8608, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18, epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4283/4549 (94.1526%)
___Train Local_ResNet_18, epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3973/4549 (87.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3456, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18, epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4187/4397 (95.2240%)
___Train Local_ResNet_18, epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8752, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18, epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4772/5068 (94.1594%)
___Train Local_ResNet_18, epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4712/5068 (92.9755%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1071, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3568/3929 (90.8119%)
___Train Local_ResNet_18, epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3576/3929 (91.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9510, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18, epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4872/5361 (90.8786%)
___Train Local_ResNet_18, epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4739/5361 (88.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2186, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18, epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4586/4830 (94.9482%)
___Train Local_ResNet_18, epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4498/4830 (93.1263%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0613, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18, epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4466/4757 (93.8827%)
___Train Local_ResNet_18, epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4384/4757 (92.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0312, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18, epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5054/5526 (91.4586%)
___Train Local_ResNet_18, epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4915/5526 (88.9432%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1616, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18, epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5603/6235 (89.8637%)
___Train Local_ResNet_18, epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5535/6235 (88.7731%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3299, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18, epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3943/4161 (94.7609%)
___Train Local_ResNet_18, epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3801/4161 (91.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0429, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18, epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4454/4797 (92.8497%)
___Train Local_ResNet_18, epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4368/4797 (91.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9730, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18, epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4643/5038 (92.1596%)
___Train Local_ResNet_18, epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4635/5038 (92.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9569, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18, epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3682/3910 (94.1688%)
___Train Local_ResNet_18, epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3415/3910 (87.3402%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.5042, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18, epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4934/5504 (89.6439%)
___Train Local_ResNet_18, epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4854/5504 (88.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0794, Accuracy: 5322/10000 (53.2200%)
time spent on training: 195.92725157737732
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3300, Accuracy: 6656/10000 (66.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0644, Accuracy: 9735/9900 (98.3333%)
Done in 222.51170110702515 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.226140890721375.
Norm before scaling: 44.184914174693155. Distance: 1.181619439053361
Total norm for 4 adversaries is: 44.184914174693155. distance: 1.181619439053361
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 44.226140890721375.
Norm before scaling: 44.180956408612154. Distance: 1.266991242851939
Total norm for 4 adversaries is: 44.180956408612154. distance: 1.266991242851939
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4982/5123 (97.2477%), train_poison_data_count: 403
Global model norm: 44.226140890721375.
Norm before scaling: 44.188400583114. Distance: 1.245824707069429
Total norm for 4 adversaries is: 44.188400583114. distance: 1.245824707069429
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.226140890721375.
Norm before scaling: 44.185294046333304. Distance: 1.2112264965127257
Total norm for 4 adversaries is: 44.185294046333304. distance: 1.2112264965127257
___Train Local_ResNet_18, epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4462/4869 (91.6410%)
___Train Local_ResNet_18, epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4142/4869 (85.0688%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3997, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18, epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3722/3968 (93.8004%)
___Train Local_ResNet_18, epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3719/3968 (93.7248%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7982, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18, epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5073/5526 (91.8024%)
___Train Local_ResNet_18, epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4818/5526 (87.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2734, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18, epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4444/4748 (93.5973%)
___Train Local_ResNet_18, epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4295/4748 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2506, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18, epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4500/4818 (93.3998%)
___Train Local_ResNet_18, epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4322/4818 (89.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2568, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18, epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3930/4161 (94.4484%)
___Train Local_ResNet_18, epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3877/4161 (93.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0017, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18, epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4254/4587 (92.7404%)
___Train Local_ResNet_18, epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4176/4587 (91.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0220, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4838/5224 (92.6110%)
___Train Local_ResNet_18, epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4705/5224 (90.0651%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1220, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18, epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5111/5422 (94.2641%)
___Train Local_ResNet_18, epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5014/5422 (92.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9017, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18, epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3856/4130 (93.3656%)
___Train Local_ResNet_18, epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3814/4130 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0394, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18, epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4007/4196 (95.4957%)
___Train Local_ResNet_18, epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3969/4196 (94.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8414, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18, epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4542/4830 (94.0373%)
___Train Local_ResNet_18, epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4488/4830 (92.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2419, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18, epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4672/5086 (91.8600%)
___Train Local_ResNet_18, epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5086 (91.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2183, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18, epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4412/4741 (93.0605%)
___Train Local_ResNet_18, epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4099/4741 (86.4586%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.5127, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18, epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4483/4714 (95.0997%)
___Train Local_ResNet_18, epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4431/4714 (93.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8759, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18, epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4669/5122 (91.1558%)
___Train Local_ResNet_18, epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4284/5122 (83.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2572, Accuracy: 4953/10000 (49.5300%)
time spent on training: 195.77372312545776
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3477, Accuracy: 6616/10000 (66.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0591, Accuracy: 9747/9900 (98.4545%)
Done in 222.72872853279114 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 44.24457615947123.
Norm before scaling: 44.20368697725126. Distance: 1.1913172454107057
Total norm for 4 adversaries is: 44.20368697725126. distance: 1.1913172454107057
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5632/5777 (97.4900%), train_poison_data_count: 455
Global model norm: 44.24457615947123.
Norm before scaling: 44.19985102977936. Distance: 1.3013648937559517
Total norm for 4 adversaries is: 44.19985102977936. distance: 1.3013648937559517
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 44.24457615947123.
Norm before scaling: 44.20611292481929. Distance: 1.2178153342081146
Total norm for 4 adversaries is: 44.20611292481929. distance: 1.2178153342081146
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.24457615947123.
Norm before scaling: 44.20684882909477. Distance: 1.3012141518322524
Total norm for 4 adversaries is: 44.20684882909477. distance: 1.3012141518322524
___Train Local_ResNet_18, epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3604/3959 (91.0331%)
___Train Local_ResNet_18, epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3638/3959 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9848, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18, epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3879/4145 (93.5826%)
___Train Local_ResNet_18, epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3873/4145 (93.4379%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0559, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18, epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5523/5939 (92.9955%)
___Train Local_ResNet_18, epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5359/5939 (90.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1864, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18, epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4485/4714 (95.1421%)
___Train Local_ResNet_18, epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4467/4714 (94.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8314, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18, epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4600/4929 (93.3252%)
___Train Local_ResNet_18, epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4418/4929 (89.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1740, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18, epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3901/4111 (94.8918%)
___Train Local_ResNet_18, epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3746/4111 (91.1214%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0758, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18, epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4965/5504 (90.2071%)
___Train Local_ResNet_18, epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4874/5504 (88.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1918, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4454/4757 (93.6304%)
___Train Local_ResNet_18, epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4346/4757 (91.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2299, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18, epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5054/5702 (88.6356%)
___Train Local_ResNet_18, epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4732/5702 (82.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4199, Accuracy: 4852/10000 (48.5200%)
___Train Local_ResNet_18, epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3376/3589 (94.0652%)
___Train Local_ResNet_18, epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3175/3589 (88.4648%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0691, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18, epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4010/4196 (95.5672%)
___Train Local_ResNet_18, epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4013/4196 (95.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9210, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18, epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4835/5224 (92.5536%)
___Train Local_ResNet_18, epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4796/5224 (91.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0898, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18, epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4897/5361 (91.3449%)
___Train Local_ResNet_18, epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4838/5361 (90.2444%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8990, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18, epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5224/5615 (93.0365%)
___Train Local_ResNet_18, epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5110/5615 (91.0062%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2131, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4251/4537 (93.6963%)
___Train Local_ResNet_18, epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4213/4537 (92.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8892, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18, epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4449/4732 (94.0194%)
___Train Local_ResNet_18, epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4485/4732 (94.7802%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9225, Accuracy: 5702/10000 (57.0200%)
time spent on training: 192.98947668075562
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3583, Accuracy: 6594/10000 (65.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0579, Accuracy: 9747/9900 (98.4545%)
Done in 219.7983717918396 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.26321334544141.
Norm before scaling: 44.22453032007519. Distance: 1.240261287847762
Total norm for 4 adversaries is: 44.22453032007519. distance: 1.240261287847762
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.26321334544141.
Norm before scaling: 44.21609146160055. Distance: 1.182692634828199
Total norm for 4 adversaries is: 44.21609146160055. distance: 1.182692634828199
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.26321334544141.
Norm before scaling: 44.22214678870263. Distance: 1.1827635418574862
Total norm for 4 adversaries is: 44.22214678870263. distance: 1.1827635418574862
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 44.26321334544141.
Norm before scaling: 44.22284102100124. Distance: 1.2505711204441026
Total norm for 4 adversaries is: 44.22284102100124. distance: 1.2505711204441026
___Train Local_ResNet_18, epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4380/4736 (92.4831%)
___Train Local_ResNet_18, epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4242/4736 (89.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0046, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18, epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4714/5123 (92.0164%)
___Train Local_ResNet_18, epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4271/5123 (83.3691%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.5035, Accuracy: 4902/10000 (49.0200%)
___Train Local_ResNet_18, epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5008/5353 (93.5550%)
___Train Local_ResNet_18, epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4842/5353 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0918, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18, epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5476/5871 (93.2720%)
___Train Local_ResNet_18, epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5321/5871 (90.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1851, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18, epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5014/5702 (87.9341%)
___Train Local_ResNet_18, epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4577/5702 (80.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2776, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18, epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4507/4903 (91.9233%)
___Train Local_ResNet_18, epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4469/4903 (91.1483%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1444, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18, epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4942/5504 (89.7892%)
___Train Local_ResNet_18, epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4794/5504 (87.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2788, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18, epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4655/5038 (92.3978%)
___Train Local_ResNet_18, epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5038 (91.8023%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9794, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18, epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5190/5727 (90.6234%)
___Train Local_ResNet_18, epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5021/5727 (87.6724%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2396, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18, epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5151/5422 (95.0018%)
___Train Local_ResNet_18, epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5018/5422 (92.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8958, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18, epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4814/5068 (94.9882%)
___Train Local_ResNet_18, epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4746/5068 (93.6464%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0354, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4449/4714 (94.3784%)
___Train Local_ResNet_18, epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4483/4714 (95.0997%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8255, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18, epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3544/3774 (93.9057%)
___Train Local_ResNet_18, epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3567/3774 (94.5151%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8770, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18, epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4855/5209 (93.2041%)
___Train Local_ResNet_18, epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4634/5209 (88.9614%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1256, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18, epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3299/3552 (92.8773%)
___Train Local_ResNet_18, epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3322/3552 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7826, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18, epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3693/3910 (94.4501%)
___Train Local_ResNet_18, epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3370/3910 (86.1893%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2446, Accuracy: 5146/10000 (51.4600%)
time spent on training: 199.06736636161804
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3491, Accuracy: 6609/10000 (66.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0547, Accuracy: 9756/9900 (98.5455%)
Done in 226.1796510219574 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 44.28234853303924.
Norm before scaling: 44.24032849153657. Distance: 1.1719245391547284
Total norm for 4 adversaries is: 44.24032849153657. distance: 1.1719245391547284
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.28234853303924.
Norm before scaling: 44.23376511854377. Distance: 1.1742610291809121
Total norm for 4 adversaries is: 44.23376511854377. distance: 1.1742610291809121
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.28234853303924.
Norm before scaling: 44.24470445228799. Distance: 1.249978971304441
Total norm for 4 adversaries is: 44.24470445228799. distance: 1.249978971304441
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.28234853303924.
Norm before scaling: 44.24292625310288. Distance: 1.2617220568539773
Total norm for 4 adversaries is: 44.24292625310288. distance: 1.2617220568539773
___Train Local_ResNet_18, epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4991/5298 (94.2054%)
___Train Local_ResNet_18, epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4976/5298 (93.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0359, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18, epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4604/4929 (93.4064%)
___Train Local_ResNet_18, epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4471/4929 (90.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0535, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18, epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4234/4587 (92.3043%)
___Train Local_ResNet_18, epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4193/4587 (91.4105%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0380, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18, epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4112/4527 (90.8328%)
___Train Local_ResNet_18, epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3990/4527 (88.1378%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1034, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18, epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4131/4485 (92.1070%)
___Train Local_ResNet_18, epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3857/4485 (85.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2170, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18, epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4441/4797 (92.5787%)
___Train Local_ResNet_18, epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4349/4797 (90.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1716, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4525/4889 (92.5547%)
___Train Local_ResNet_18, epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4424/4889 (90.4889%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2984, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18, epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5425/5907 (91.8402%)
___Train Local_ResNet_18, epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5296/5907 (89.6563%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5174, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18, epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5245/5727 (91.5837%)
___Train Local_ResNet_18, epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4987/5727 (87.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2689, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18, epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5655/6068 (93.1938%)
___Train Local_ResNet_18, epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5529/6068 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3496, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18, epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6366/6947 (91.6367%)
___Train Local_ResNet_18, epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6072/6947 (87.4046%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2625, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18, epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4941/5361 (92.1656%)
___Train Local_ResNet_18, epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4797/5361 (89.4796%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2321, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18, epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4428/4737 (93.4769%)
___Train Local_ResNet_18, epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4344/4737 (91.7036%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2688, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18, epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4590/4830 (95.0311%)
___Train Local_ResNet_18, epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4540/4830 (93.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1930, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18, epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4783/5086 (94.0425%)
___Train Local_ResNet_18, epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4656/5086 (91.5454%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1750, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5002/5362 (93.2861%)
___Train Local_ResNet_18, epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4886/5362 (91.1227%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2166, Accuracy: 5334/10000 (53.3400%)
time spent on training: 201.80837321281433
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3578, Accuracy: 6594/10000 (65.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0532, Accuracy: 9760/9900 (98.5859%)
Done in 228.66932702064514 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.303004701554244.
Norm before scaling: 44.260139639832815. Distance: 1.139770658161488
Total norm for 4 adversaries is: 44.260139639832815. distance: 1.139770658161488
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5656/5777 (97.9055%), train_poison_data_count: 455
Global model norm: 44.303004701554244.
Norm before scaling: 44.25522043932006. Distance: 1.2216285066686021
Total norm for 4 adversaries is: 44.25522043932006. distance: 1.2216285066686021
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.303004701554244.
Norm before scaling: 44.26489696718637. Distance: 1.2332182667297773
Total norm for 4 adversaries is: 44.26489696718637. distance: 1.2332182667297773
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.303004701554244.
Norm before scaling: 44.26236116850227. Distance: 1.2670597374193084
Total norm for 4 adversaries is: 44.26236116850227. distance: 1.2670597374193084
___Train Local_ResNet_18, epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4441/4797 (92.5787%)
___Train Local_ResNet_18, epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4342/4797 (90.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9829, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18, epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3885/4108 (94.5716%)
___Train Local_ResNet_18, epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3842/4108 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9374, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18, epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5197/5727 (90.7456%)
___Train Local_ResNet_18, epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5036/5727 (87.9343%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1494, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18, epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5048/5461 (92.4373%)
___Train Local_ResNet_18, epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4963/5461 (90.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1213, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18, epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4148/4368 (94.9634%)
___Train Local_ResNet_18, epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4044/4368 (92.5824%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0709, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4464/4894 (91.2137%)
___Train Local_ResNet_18, epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4364/4894 (89.1704%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0439, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4551/4748 (95.8509%)
___Train Local_ResNet_18, epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4428/4748 (93.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1430, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18, epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5468/5907 (92.5681%)
___Train Local_ResNet_18, epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5379/5907 (91.0615%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2922, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18, epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4015/4196 (95.6864%)
___Train Local_ResNet_18, epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3982/4196 (94.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9505, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18, epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4634/4929 (94.0150%)
___Train Local_ResNet_18, epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4526/4929 (91.8239%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1138, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18, epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4600/4956 (92.8168%)
___Train Local_ResNet_18, epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4516/4956 (91.1219%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0842, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18, epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5061/5454 (92.7943%)
___Train Local_ResNet_18, epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4827/5454 (88.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2398, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18, epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4854/5399 (89.9055%)
___Train Local_ResNet_18, epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4719/5399 (87.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2036, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18, epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4646/4979 (93.3119%)
___Train Local_ResNet_18, epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4556/4979 (91.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3774, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18, epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3944/4249 (92.8218%)
___Train Local_ResNet_18, epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3889/4249 (91.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0161, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4615/5050 (91.3861%)
___Train Local_ResNet_18, epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4545/5050 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0114, Accuracy: 5483/10000 (54.8300%)
time spent on training: 194.46523070335388
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3610, Accuracy: 6578/10000 (65.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0569, Accuracy: 9749/9900 (98.4747%)
Done in 221.39671993255615 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.32194231204788.
Norm before scaling: 44.27795010199066. Distance: 1.1201528927633937
Total norm for 4 adversaries is: 44.27795010199066. distance: 1.1201528927633937
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.32194231204788.
Norm before scaling: 44.27483330581621. Distance: 1.2115324466215995
Total norm for 4 adversaries is: 44.27483330581621. distance: 1.2115324466215995
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.32194231204788.
Norm before scaling: 44.283903248404634. Distance: 1.2494974079631833
Total norm for 4 adversaries is: 44.283903248404634. distance: 1.2494974079631833
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.32194231204788.
Norm before scaling: 44.28202876211819. Distance: 1.2326942300089125
Total norm for 4 adversaries is: 44.28202876211819. distance: 1.2326942300089125
___Train Local_ResNet_18, epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4294/4587 (93.6124%)
___Train Local_ResNet_18, epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4231/4587 (92.2389%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0248, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18, epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3671/3995 (91.8899%)
___Train Local_ResNet_18, epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3578/3995 (89.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2102, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18, epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3846/4145 (92.7865%)
___Train Local_ResNet_18, epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3833/4145 (92.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9856, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18, epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4392/4737 (92.7169%)
___Train Local_ResNet_18, epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4274/4737 (90.2259%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.4871, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18, epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3795/4028 (94.2155%)
___Train Local_ResNet_18, epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3754/4028 (93.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7839, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18, epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3930/4161 (94.4484%)
___Train Local_ResNet_18, epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3796/4161 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1634, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18, epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5827/6419 (90.7774%)
___Train Local_ResNet_18, epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5546/6419 (86.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2312, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18, epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5148/5645 (91.1957%)
___Train Local_ResNet_18, epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4895/5645 (86.7139%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2018, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18, epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4475/4748 (94.2502%)
___Train Local_ResNet_18, epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4259/4748 (89.7009%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1271, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18, epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3720/3968 (93.7500%)
___Train Local_ResNet_18, epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3683/3968 (92.8175%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7787, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18, epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4777/5075 (94.1281%)
___Train Local_ResNet_18, epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4575/5075 (90.1478%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3054, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18, epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5236/5615 (93.2502%)
___Train Local_ResNet_18, epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5099/5615 (90.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1842, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18, epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4461/4797 (92.9956%)
___Train Local_ResNet_18, epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4350/4797 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1264, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18, epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4180/4368 (95.6960%)
___Train Local_ResNet_18, epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4039/4368 (92.4679%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0798, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 6363/6812 (93.4087%)
___Train Local_ResNet_18, epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 6089/6812 (89.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3165, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18, epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4833/5068 (95.3631%)
___Train Local_ResNet_18, epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4710/5068 (92.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0837, Accuracy: 5450/10000 (54.5000%)
time spent on training: 196.53972125053406
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3682, Accuracy: 6569/10000 (65.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0541, Accuracy: 9760/9900 (98.5859%)
Done in 223.17974066734314 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5187/5308 (97.7204%), train_poison_data_count: 415
Global model norm: 44.33995920636232.
Norm before scaling: 44.299869001552224. Distance: 1.240088026167884
Total norm for 4 adversaries is: 44.299869001552224. distance: 1.240088026167884
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.33995920636232.
Norm before scaling: 44.290999389866165. Distance: 1.19362081857313
Total norm for 4 adversaries is: 44.290999389866165. distance: 1.19362081857313
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 44.33995920636232.
Norm before scaling: 44.30110760201854. Distance: 1.2566749689011747
Total norm for 4 adversaries is: 44.30110760201854. distance: 1.2566749689011747
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.33995920636232.
Norm before scaling: 44.29617090489806. Distance: 1.1865176102608965
Total norm for 4 adversaries is: 44.29617090489806. distance: 1.1865176102608965
___Train Local_ResNet_18, epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4631/5018 (92.2878%)
___Train Local_ResNet_18, epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4465/5018 (88.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3063, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18, epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4487/4889 (91.7775%)
___Train Local_ResNet_18, epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4401/4889 (90.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0294, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18, epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5063/5559 (91.0775%)
___Train Local_ResNet_18, epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4865/5559 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2698, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18, epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4450/4869 (91.3945%)
___Train Local_ResNet_18, epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4146/4869 (85.1510%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2502, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18, epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4238/4537 (93.4097%)
___Train Local_ResNet_18, epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4222/4537 (93.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9718, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18, epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4522/4748 (95.2401%)
___Train Local_ResNet_18, epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4470/4748 (94.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8347, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18, epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5550/5939 (93.4501%)
___Train Local_ResNet_18, epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5428/5939 (91.3959%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1283, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5080/5497 (92.4140%)
___Train Local_ResNet_18, epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4946/5497 (89.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1785, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18, epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4560/4911 (92.8528%)
___Train Local_ResNet_18, epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4542/4911 (92.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0694, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18, epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4486/4714 (95.1633%)
___Train Local_ResNet_18, epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4499/4714 (95.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8229, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18, epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3713/3968 (93.5736%)
___Train Local_ResNet_18, epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3695/3968 (93.1200%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9346, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18, epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4989/5298 (94.1676%)
___Train Local_ResNet_18, epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4953/5298 (93.4881%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0878, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18, epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3894/4108 (94.7907%)
___Train Local_ResNet_18, epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3862/4108 (94.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9152, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18, epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3338/3552 (93.9752%)
___Train Local_ResNet_18, epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3330/3552 (93.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8678, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18, epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3597/3929 (91.5500%)
___Train Local_ResNet_18, epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3509/3929 (89.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1763, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18, epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6402/6812 (93.9812%)
___Train Local_ResNet_18, epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6255/6812 (91.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1419, Accuracy: 5401/10000 (54.0100%)
time spent on training: 197.19545316696167
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3780, Accuracy: 6537/10000 (65.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0485, Accuracy: 9770/9900 (98.6869%)
Done in 223.78688621520996 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.35755599035524.
Norm before scaling: 44.31550534149278. Distance: 1.1738977395740182
Total norm for 4 adversaries is: 44.31550534149278. distance: 1.1738977395740182
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 44.35755599035524.
Norm before scaling: 44.31247107500819. Distance: 1.2680957836321984
Total norm for 4 adversaries is: 44.31247107500819. distance: 1.2680957836321984
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4985/5123 (97.3063%), train_poison_data_count: 403
Global model norm: 44.35755599035524.
Norm before scaling: 44.320091468909446. Distance: 1.2480748133151525
Total norm for 4 adversaries is: 44.320091468909446. distance: 1.2480748133151525
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5387/5503 (97.8921%), train_poison_data_count: 430
Global model norm: 44.35755599035524.
Norm before scaling: 44.31720488069504. Distance: 1.2582548797015594
Total norm for 4 adversaries is: 44.31720488069504. distance: 1.2582548797015594
___Train Local_ResNet_18, epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4718/5055 (93.3333%)
___Train Local_ResNet_18, epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4669/5055 (92.3640%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1263, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18, epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5455/5907 (92.3481%)
___Train Local_ResNet_18, epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5342/5907 (90.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3812, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18, epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5336/5696 (93.6798%)
___Train Local_ResNet_18, epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5159/5696 (90.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2152, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18, epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4774/5075 (94.0690%)
___Train Local_ResNet_18, epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4690/5075 (92.4138%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9887, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18, epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4674/5122 (91.2534%)
___Train Local_ResNet_18, epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0133, Accuracy: 3852/5122 (75.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.6596, Accuracy: 4383/10000 (43.8300%)
___Train Local_ResNet_18, epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4632/4929 (93.9744%)
___Train Local_ResNet_18, epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4500/4929 (91.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0920, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18, epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5544/5871 (94.4303%)
___Train Local_ResNet_18, epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5416/5871 (92.2500%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0478, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18, epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4290/4587 (93.5252%)
___Train Local_ResNet_18, epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4269/4587 (93.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8727, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18, epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5208/5615 (92.7516%)
___Train Local_ResNet_18, epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5125/5615 (91.2734%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0692, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18, epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4446/4714 (94.3148%)
___Train Local_ResNet_18, epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4445/4714 (94.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0564, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4554/4889 (93.1479%)
___Train Local_ResNet_18, epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4454/4889 (91.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0245, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18, epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4080/4313 (94.5977%)
___Train Local_ResNet_18, epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3993/4313 (92.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9138, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18, epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3863/4086 (94.5423%)
___Train Local_ResNet_18, epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3844/4086 (94.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9096, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18, epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3845/4145 (92.7624%)
___Train Local_ResNet_18, epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3813/4145 (91.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1216, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18, epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4240/4537 (93.4538%)
___Train Local_ResNet_18, epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4183/4537 (92.1975%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9178, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18, epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5051/5526 (91.4043%)
___Train Local_ResNet_18, epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4788/5526 (86.6450%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5753, Accuracy: 4927/10000 (49.2700%)
time spent on training: 198.34251880645752
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3851, Accuracy: 6536/10000 (65.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0502, Accuracy: 9767/9900 (98.6566%)
Done in 224.91648983955383 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.37651020757632.
Norm before scaling: 44.33614330899368. Distance: 1.184334048164582
Total norm for 4 adversaries is: 44.33614330899368. distance: 1.184334048164582
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 44.37651020757632.
Norm before scaling: 44.33115268784258. Distance: 1.292984792373571
Total norm for 4 adversaries is: 44.33115268784258. distance: 1.292984792373571
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.37651020757632.
Norm before scaling: 44.338615695541. Distance: 1.2541682364790883
Total norm for 4 adversaries is: 44.338615695541. distance: 1.2541682364790883
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5371/5503 (97.6013%), train_poison_data_count: 430
Global model norm: 44.37651020757632.
Norm before scaling: 44.33632364919945. Distance: 1.2621141882863378
Total norm for 4 adversaries is: 44.33632364919945. distance: 1.2621141882863378
___Train Local_ResNet_18, epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4512/4748 (95.0295%)
___Train Local_ResNet_18, epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4419/4748 (93.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1517, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18, epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4855/5209 (93.2041%)
___Train Local_ResNet_18, epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4731/5209 (90.8236%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0446, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18, epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4991/5427 (91.9661%)
___Train Local_ResNet_18, epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4846/5427 (89.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2992, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18, epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3862/4111 (93.9431%)
___Train Local_ResNet_18, epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3813/4111 (92.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1345, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18, epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3736/3968 (94.1532%)
___Train Local_ResNet_18, epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3740/3968 (94.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8271, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18, epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4908/5361 (91.5501%)
___Train Local_ResNet_18, epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4827/5361 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0916, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3898/4108 (94.8880%)
___Train Local_ResNet_18, epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3793/4108 (92.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9966, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18, epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4602/5050 (91.1287%)
___Train Local_ResNet_18, epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4559/5050 (90.2772%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1086, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18, epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3977/4161 (95.5780%)
___Train Local_ResNet_18, epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3848/4161 (92.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0685, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18, epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3990/4249 (93.9044%)
___Train Local_ResNet_18, epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3924/4249 (92.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0691, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18, epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3837/4145 (92.5694%)
___Train Local_ResNet_18, epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3833/4145 (92.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9810, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18, epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4998/5353 (93.3682%)
___Train Local_ResNet_18, epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4882/5353 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0190, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18, epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5030/5362 (93.8083%)
___Train Local_ResNet_18, epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4835/5362 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2168, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18, epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3717/3910 (95.0639%)
___Train Local_ResNet_18, epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3554/3910 (90.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1492, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18, epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4075/4364 (93.3776%)
___Train Local_ResNet_18, epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3999/4364 (91.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0351, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18, epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5232/5727 (91.3567%)
___Train Local_ResNet_18, epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5054/5727 (88.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2889, Accuracy: 4968/10000 (49.6800%)
time spent on training: 194.0327844619751
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3938, Accuracy: 6537/10000 (65.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0486, Accuracy: 9764/9900 (98.6263%)
Done in 220.57162404060364 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5217/5308 (98.2856%), train_poison_data_count: 415
Global model norm: 44.394906406520896.
Norm before scaling: 44.35005075479762. Distance: 1.1336140920652866
Total norm for 4 adversaries is: 44.35005075479762. distance: 1.1336140920652866
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.394906406520896.
Norm before scaling: 44.34875571861134. Distance: 1.243790318204594
Total norm for 4 adversaries is: 44.34875571861134. distance: 1.243790318204594
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.394906406520896.
Norm before scaling: 44.35470761813931. Distance: 1.1947823140255822
Total norm for 4 adversaries is: 44.35470761813931. distance: 1.1947823140255822
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.394906406520896.
Norm before scaling: 44.34985395577349. Distance: 1.1611194144615735
Total norm for 4 adversaries is: 44.34985395577349. distance: 1.1611194144615735
___Train Local_ResNet_18, epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4384/4741 (92.4699%)
___Train Local_ResNet_18, epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4035/4741 (85.1086%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2404, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18, epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4346/4736 (91.7652%)
___Train Local_ResNet_18, epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4230/4736 (89.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9891, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18, epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5170/5652 (91.4720%)
___Train Local_ResNet_18, epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4992/5652 (88.3227%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1807, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5457/6080 (89.7533%)
___Train Local_ResNet_18, epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5255/6080 (86.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3640, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18, epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4923/5298 (92.9219%)
___Train Local_ResNet_18, epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4828/5298 (91.1287%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2504, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18, epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4480/4731 (94.6946%)
___Train Local_ResNet_18, epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4438/4731 (93.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9470, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18, epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3743/3968 (94.3296%)
___Train Local_ResNet_18, epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3709/3968 (93.4728%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9491, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18, epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3680/3910 (94.1176%)
___Train Local_ResNet_18, epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3678/3910 (94.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0087, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18, epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4291/4537 (94.5779%)
___Train Local_ResNet_18, epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4200/4537 (92.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9753, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18, epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5059/5526 (91.5490%)
___Train Local_ResNet_18, epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4905/5526 (88.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2185, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3645/3995 (91.2390%)
___Train Local_ResNet_18, epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3578/3995 (89.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1634, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18, epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3858/4145 (93.0760%)
___Train Local_ResNet_18, epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3805/4145 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0208, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18, epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4732/5055 (93.6103%)
___Train Local_ResNet_18, epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1319, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5053/5454 (92.6476%)
___Train Local_ResNet_18, epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4885/5454 (89.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1898, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18, epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4519/4843 (93.3099%)
___Train Local_ResNet_18, epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4467/4843 (92.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9993, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18, epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3878/4130 (93.8983%)
___Train Local_ResNet_18, epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3777/4130 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1458, Accuracy: 5323/10000 (53.2300%)
time spent on training: 202.33703303337097
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3981, Accuracy: 6534/10000 (65.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0516, Accuracy: 9762/9900 (98.6061%)
Done in 229.13972282409668 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.41312870060566.
Norm before scaling: 44.369986237443634. Distance: 1.1546047464948155
Total norm for 4 adversaries is: 44.369986237443634. distance: 1.1546047464948155
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5666/5777 (98.0786%), train_poison_data_count: 455
Global model norm: 44.41312870060566.
Norm before scaling: 44.3656212580121. Distance: 1.2080163978512117
Total norm for 4 adversaries is: 44.3656212580121. distance: 1.2080163978512117
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 44.41312870060566.
Norm before scaling: 44.3725970410124. Distance: 1.1925999898995925
Total norm for 4 adversaries is: 44.3725970410124. distance: 1.1925999898995925
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.41312870060566.
Norm before scaling: 44.37117473609345. Distance: 1.226244891405887
Total norm for 4 adversaries is: 44.37117473609345. distance: 1.226244891405887
___Train Local_ResNet_18, epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4182/4397 (95.1103%)
___Train Local_ResNet_18, epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4161/4397 (94.6327%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0051, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18, epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3967/4161 (95.3377%)
___Train Local_ResNet_18, epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3811/4161 (91.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1832, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18, epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5617/6235 (90.0882%)
___Train Local_ResNet_18, epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5427/6235 (87.0409%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3473, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18, epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3845/4175 (92.0958%)
___Train Local_ResNet_18, epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1017, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4539/4869 (93.2224%)
___Train Local_ResNet_18, epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4319/4869 (88.7040%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1170, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18, epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5079/5346 (95.0056%)
___Train Local_ResNet_18, epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4984/5346 (93.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2485, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18, epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5441/6080 (89.4901%)
___Train Local_ResNet_18, epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5292/6080 (87.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1927, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3676/3959 (92.8517%)
___Train Local_ResNet_18, epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3648/3959 (92.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0605, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18, epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5234/5615 (93.2146%)
___Train Local_ResNet_18, epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5053/5615 (89.9911%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2816, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18, epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4518/4843 (93.2893%)
___Train Local_ResNet_18, epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4454/4843 (91.9678%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2289, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18, epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4359/4605 (94.6580%)
___Train Local_ResNet_18, epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4305/4605 (93.4853%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9286, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18, epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4440/4714 (94.1875%)
___Train Local_ResNet_18, epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4463/4714 (94.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9061, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18, epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4477/4797 (93.3292%)
___Train Local_ResNet_18, epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4381/4797 (91.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9824, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18, epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5178/5652 (91.6136%)
___Train Local_ResNet_18, epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5059/5652 (89.5081%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2318, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18, epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4908/5504 (89.1715%)
___Train Local_ResNet_18, epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4834/5504 (87.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2904, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18, epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4801/5075 (94.6010%)
___Train Local_ResNet_18, epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4628/5075 (91.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1128, Accuracy: 5397/10000 (53.9700%)
time spent on training: 198.1139054298401
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.4078, Accuracy: 6518/10000 (65.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0452, Accuracy: 9773/9900 (98.7172%)
Done in 225.0935833454132 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5308 (97.8335%), train_poison_data_count: 415
Global model norm: 44.43158529114593.
Norm before scaling: 44.39228041615879. Distance: 1.2393396228814002
Total norm for 4 adversaries is: 44.39228041615879. distance: 1.2393396228814002
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5677/5777 (98.2690%), train_poison_data_count: 455
Global model norm: 44.43158529114593.
Norm before scaling: 44.382590404962706. Distance: 1.2016800464532498
Total norm for 4 adversaries is: 44.382590404962706. distance: 1.2016800464532498
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.43158529114593.
Norm before scaling: 44.390193261716036. Distance: 1.1595428592052923
Total norm for 4 adversaries is: 44.390193261716036. distance: 1.1595428592052923
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.43158529114593.
Norm before scaling: 44.38816788562226. Distance: 1.199133407090889
Total norm for 4 adversaries is: 44.38816788562226. distance: 1.199133407090889
___Train Local_ResNet_18, epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3920/4175 (93.8922%)
___Train Local_ResNet_18, epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3742/4175 (89.6287%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2141, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18, epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5458/6080 (89.7697%)
___Train Local_ResNet_18, epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5354/6080 (88.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2719, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18, epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3754/3968 (94.6069%)
___Train Local_ResNet_18, epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3712/3968 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8389, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18, epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5517/5939 (92.8944%)
___Train Local_ResNet_18, epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5447/5939 (91.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0401, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18, epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4092/4527 (90.3910%)
___Train Local_ResNet_18, epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4002/4527 (88.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1320, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18, epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4492/4797 (93.6419%)
___Train Local_ResNet_18, epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4401/4797 (91.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0260, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18, epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4415/4757 (92.8106%)
___Train Local_ResNet_18, epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4278/4757 (89.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1622, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18, epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4657/4929 (94.4816%)
___Train Local_ResNet_18, epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4539/4929 (92.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0537, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6394/6812 (93.8638%)
___Train Local_ResNet_18, epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6228/6812 (91.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1677, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18, epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5974/6664 (89.6459%)
___Train Local_ResNet_18, epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0086, Accuracy: 5601/6664 (84.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3295, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18, epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3666/3995 (91.7647%)
___Train Local_ResNet_18, epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3567/3995 (89.2866%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2288, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18, epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4087/4364 (93.6526%)
___Train Local_ResNet_18, epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4044/4364 (92.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9549, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18, epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3602/3929 (91.6773%)
___Train Local_ResNet_18, epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3581/3929 (91.1428%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1216, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18, epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3860/4130 (93.4625%)
___Train Local_ResNet_18, epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3864/4130 (93.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0671, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18, epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4338/4741 (91.4997%)
___Train Local_ResNet_18, epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4209/4741 (88.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3942, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18, epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5554/5871 (94.6006%)
___Train Local_ResNet_18, epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5410/5871 (92.1478%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2990, Accuracy: 5165/10000 (51.6500%)
time spent on training: 201.11890983581543
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.4145, Accuracy: 6503/10000 (65.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0411, Accuracy: 9782/9900 (98.8081%)
Done in 228.3715488910675 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 44.45037612326807.
Norm before scaling: 44.40680940666293. Distance: 1.1705227488572558
Total norm for 4 adversaries is: 44.40680940666293. distance: 1.1705227488572558
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.45037612326807.
Norm before scaling: 44.40127825572353. Distance: 1.2178246335156127
Total norm for 4 adversaries is: 44.40127825572353. distance: 1.2178246335156127
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.45037612326807.
Norm before scaling: 44.409163785473375. Distance: 1.1917820572283582
Total norm for 4 adversaries is: 44.409163785473375. distance: 1.1917820572283582
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.45037612326807.
Norm before scaling: 44.40943178915868. Distance: 1.2749249249215016
Total norm for 4 adversaries is: 44.40943178915868. distance: 1.2749249249215016
___Train Local_ResNet_18, epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3586/3774 (95.0185%)
___Train Local_ResNet_18, epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3579/3774 (94.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8686, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18, epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4325/4549 (95.0758%)
___Train Local_ResNet_18, epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4214/4549 (92.6357%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0624, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18, epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4580/4911 (93.2600%)
___Train Local_ResNet_18, epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4533/4911 (92.3030%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0787, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18, epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4072/4313 (94.4122%)
___Train Local_ResNet_18, epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4024/4313 (93.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8007, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18, epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3801/3968 (95.7913%)
___Train Local_ResNet_18, epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3766/3968 (94.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7219, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18, epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5127/5559 (92.2288%)
___Train Local_ResNet_18, epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4932/5559 (88.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1952, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18, epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4703/5038 (93.3505%)
___Train Local_ResNet_18, epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4651/5038 (92.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1161, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18, epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4770/5193 (91.8544%)
___Train Local_ResNet_18, epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4673/5193 (89.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2519, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18, epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3293/3552 (92.7083%)
___Train Local_ResNet_18, epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3287/3552 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9694, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18, epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3705/3995 (92.7409%)
___Train Local_ResNet_18, epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3577/3995 (89.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0632, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18, epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4469/4732 (94.4421%)
___Train Local_ResNet_18, epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4435/4732 (93.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9010, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18, epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5687/6068 (93.7212%)
___Train Local_ResNet_18, epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5540/6068 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1717, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18, epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5416/5907 (91.6878%)
___Train Local_ResNet_18, epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5286/5907 (89.4870%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2480, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18, epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4396/4741 (92.7231%)
___Train Local_ResNet_18, epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3977/4741 (83.8853%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.5825, Accuracy: 4756/10000 (47.5600%)
___Train Local_ResNet_18, epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5533/5871 (94.2429%)
___Train Local_ResNet_18, epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5331/5871 (90.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1891, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18, epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3885/4111 (94.5026%)
___Train Local_ResNet_18, epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3774/4111 (91.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1626, Accuracy: 5399/10000 (53.9900%)
time spent on training: 218.19518518447876
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.4188, Accuracy: 6498/10000 (64.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0371, Accuracy: 9792/9900 (98.9091%)
Done in 245.31062746047974 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 44.467837251261585.
Norm before scaling: 44.424970488788034. Distance: 1.1923997582583485
Total norm for 4 adversaries is: 44.424970488788034. distance: 1.1923997582583485
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.467837251261585.
Norm before scaling: 44.42226108915931. Distance: 1.259259546634126
Total norm for 4 adversaries is: 44.42226108915931. distance: 1.259259546634126
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4991/5123 (97.4234%), train_poison_data_count: 403
Global model norm: 44.467837251261585.
Norm before scaling: 44.42703402815748. Distance: 1.2060037331879183
Total norm for 4 adversaries is: 44.42703402815748. distance: 1.2060037331879183
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.467837251261585.
Norm before scaling: 44.425232901577175. Distance: 1.2328590548661045
Total norm for 4 adversaries is: 44.425232901577175. distance: 1.2328590548661045
___Train Local_ResNet_18, epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4422/4672 (94.6490%)
___Train Local_ResNet_18, epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4395/4672 (94.0711%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8862, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18, epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3928/4108 (95.6183%)
___Train Local_ResNet_18, epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3839/4108 (93.4518%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0793, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18, epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4321/4736 (91.2373%)
___Train Local_ResNet_18, epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4275/4736 (90.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0359, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18, epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4491/4714 (95.2694%)
___Train Local_ResNet_18, epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4462/4714 (94.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9024, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18, epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5142/5645 (91.0895%)
___Train Local_ResNet_18, epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4749/5645 (84.1275%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.4691, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18, epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4668/4993 (93.4909%)
___Train Local_ResNet_18, epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4560/4993 (91.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2860, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18, epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4564/4911 (92.9342%)
___Train Local_ResNet_18, epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4520/4911 (92.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0259, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18, epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4464/4797 (93.0582%)
___Train Local_ResNet_18, epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4370/4797 (91.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2673, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18, epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3993/4196 (95.1621%)
___Train Local_ResNet_18, epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3909/4196 (93.1602%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8574, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18, epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4641/5050 (91.9010%)
___Train Local_ResNet_18, epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4523/5050 (89.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0154, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18, epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4456/4757 (93.6725%)
___Train Local_ResNet_18, epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4371/4757 (91.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0500, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18, epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4971/5427 (91.5976%)
___Train Local_ResNet_18, epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4825/5427 (88.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2196, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18, epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4805/5068 (94.8106%)
___Train Local_ResNet_18, epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4619/5068 (91.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3071, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18, epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5046/5353 (94.2649%)
___Train Local_ResNet_18, epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4922/5353 (91.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0976, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18, epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3894/4175 (93.2695%)
___Train Local_ResNet_18, epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3801/4175 (91.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0276, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18, epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3863/4111 (93.9674%)
___Train Local_ResNet_18, epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3884/4111 (94.4782%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0835, Accuracy: 5489/10000 (54.8900%)
time spent on training: 219.14138340950012
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4203, Accuracy: 6503/10000 (65.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0367, Accuracy: 9794/9900 (98.9293%)
Done in 245.80963897705078 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.485645507848936.
Norm before scaling: 44.441264619456575. Distance: 1.1171007456140383
Total norm for 4 adversaries is: 44.441264619456575. distance: 1.1171007456140383
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5659/5777 (97.9574%), train_poison_data_count: 455
Global model norm: 44.485645507848936.
Norm before scaling: 44.438740258272254. Distance: 1.2468739521528922
Total norm for 4 adversaries is: 44.438740258272254. distance: 1.2468739521528922
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4991/5123 (97.4234%), train_poison_data_count: 403
Global model norm: 44.485645507848936.
Norm before scaling: 44.44420494862772. Distance: 1.190586295712773
Total norm for 4 adversaries is: 44.44420494862772. distance: 1.190586295712773
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.485645507848936.
Norm before scaling: 44.44307058965998. Distance: 1.2691630137527272
Total norm for 4 adversaries is: 44.44307058965998. distance: 1.2691630137527272
___Train Local_ResNet_18, epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4255/4537 (93.7844%)
___Train Local_ResNet_18, epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4236/4537 (93.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0610, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18, epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4560/4889 (93.2706%)
___Train Local_ResNet_18, epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4520/4889 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2990, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18, epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3301/3552 (92.9336%)
___Train Local_ResNet_18, epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3328/3552 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9565, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18, epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4447/4894 (90.8664%)
___Train Local_ResNet_18, epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4334/4894 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0925, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4284/4549 (94.1745%)
___Train Local_ResNet_18, epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3673/4549 (80.7430%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4911, Accuracy: 4793/10000 (47.9300%)
___Train Local_ResNet_18, epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4445/4797 (92.6621%)
___Train Local_ResNet_18, epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4396/4797 (91.6406%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9874, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18, epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4493/4748 (94.6293%)
___Train Local_ResNet_18, epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4277/4748 (90.0800%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0431, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18, epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4379/4736 (92.4620%)
___Train Local_ResNet_18, epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4323/4736 (91.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4042, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18, epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3677/3929 (93.5862%)
___Train Local_ResNet_18, epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3651/3929 (92.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8828, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18, epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3634/3959 (91.7909%)
___Train Local_ResNet_18, epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3642/3959 (91.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1063, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18, epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5070/5454 (92.9593%)
___Train Local_ResNet_18, epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4834/5454 (88.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1131, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18, epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4946/5504 (89.8619%)
___Train Local_ResNet_18, epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4777/5504 (86.7914%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3494, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18, epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4490/4818 (93.1922%)
___Train Local_ResNet_18, epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4319/4818 (89.6430%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2989, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18, epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5428/6080 (89.2763%)
___Train Local_ResNet_18, epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5291/6080 (87.0230%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4252, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18, epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5141/5645 (91.0717%)
___Train Local_ResNet_18, epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4884/5645 (86.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2440, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18, epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4536/4869 (93.1608%)
___Train Local_ResNet_18, epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3902/4869 (80.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.5087, Accuracy: 4866/10000 (48.6600%)
time spent on training: 214.6606285572052
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4306, Accuracy: 6485/10000 (64.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0351, Accuracy: 9795/9900 (98.9394%)
Done in 241.58523678779602 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.50500048712925.
Norm before scaling: 44.46122235126639. Distance: 1.1432658416264443
Total norm for 4 adversaries is: 44.46122235126639. distance: 1.1432658416264443
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5649/5777 (97.7843%), train_poison_data_count: 455
Global model norm: 44.50500048712925.
Norm before scaling: 44.45677434493252. Distance: 1.2441172455368061
Total norm for 4 adversaries is: 44.45677434493252. distance: 1.2441172455368061
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.50500048712925.
Norm before scaling: 44.46541460172305. Distance: 1.2402941591767018
Total norm for 4 adversaries is: 44.46541460172305. distance: 1.2402941591767018
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5391/5503 (97.9647%), train_poison_data_count: 430
Global model norm: 44.50500048712925.
Norm before scaling: 44.459955263926126. Distance: 1.1662722102398246
Total norm for 4 adversaries is: 44.459955263926126. distance: 1.1662722102398246
___Train Local_ResNet_18, epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4718/5055 (93.3333%)
___Train Local_ResNet_18, epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4636/5055 (91.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0882, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18, epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5780/6419 (90.0452%)
___Train Local_ResNet_18, epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5642/6419 (87.8953%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.4158, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18, epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4500/4731 (95.1173%)
___Train Local_ResNet_18, epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4425/4731 (93.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9542, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18, epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4666/5038 (92.6161%)
___Train Local_ResNet_18, epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4656/5038 (92.4176%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9000, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18, epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5473/5907 (92.6528%)
___Train Local_ResNet_18, epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5371/5907 (90.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2205, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18, epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4984/5362 (92.9504%)
___Train Local_ResNet_18, epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4833/5362 (90.1343%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2376, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18, epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4467/4903 (91.1075%)
___Train Local_ResNet_18, epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4470/4903 (91.1687%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9146, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18, epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4296/4549 (94.4383%)
___Train Local_ResNet_18, epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4083/4549 (89.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1339, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3760/3968 (94.7581%)
___Train Local_ResNet_18, epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3784/3968 (95.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.7111, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18, epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3371/3589 (93.9259%)
___Train Local_ResNet_18, epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3132/3589 (87.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1386, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18, epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5097/5526 (92.2367%)
___Train Local_ResNet_18, epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4811/5526 (87.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3106, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18, epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3907/4130 (94.6005%)
___Train Local_ResNet_18, epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3890/4130 (94.1889%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8336, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18, epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4750/4993 (95.1332%)
___Train Local_ResNet_18, epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4608/4993 (92.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2590, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18, epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4817/5075 (94.9163%)
___Train Local_ResNet_18, epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4644/5075 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0785, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18, epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4810/5193 (92.6247%)
___Train Local_ResNet_18, epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4777/5193 (91.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3214, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18, epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4753/5035 (94.3992%)
___Train Local_ResNet_18, epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4700/5035 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0960, Accuracy: 5377/10000 (53.7700%)
time spent on training: 218.54484605789185
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4379, Accuracy: 6481/10000 (64.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0299, Accuracy: 9813/9900 (99.1212%)
Done in 245.31757354736328 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.52378089773697.
Norm before scaling: 44.48114505748475. Distance: 1.1678081389262305
Total norm for 4 adversaries is: 44.48114505748475. distance: 1.1678081389262305
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.52378089773697.
Norm before scaling: 44.4746721175203. Distance: 1.1928853843354494
Total norm for 4 adversaries is: 44.4746721175203. distance: 1.1928853843354494
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5004/5123 (97.6771%), train_poison_data_count: 403
Global model norm: 44.52378089773697.
Norm before scaling: 44.483295177006475. Distance: 1.2037672335142724
Total norm for 4 adversaries is: 44.483295177006475. distance: 1.2037672335142724
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5370/5503 (97.5831%), train_poison_data_count: 430
Global model norm: 44.52378089773697.
Norm before scaling: 44.48122052610728. Distance: 1.2505136864884405
Total norm for 4 adversaries is: 44.48122052610728. distance: 1.2505136864884405
___Train Local_ResNet_18, epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5514/6080 (90.6908%)
___Train Local_ResNet_18, epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5295/6080 (87.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4902, Accuracy: 4727/10000 (47.2700%)
___Train Local_ResNet_18, epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5147/5645 (91.1780%)
___Train Local_ResNet_18, epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4862/5645 (86.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3971, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18, epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4655/4956 (93.9266%)
___Train Local_ResNet_18, epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4498/4956 (90.7587%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3580, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18, epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5800/6419 (90.3568%)
___Train Local_ResNet_18, epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5515/6419 (85.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2804, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18, epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5114/5559 (91.9950%)
___Train Local_ResNet_18, epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4956/5559 (89.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1617, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18, epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5699/6235 (91.4034%)
___Train Local_ResNet_18, epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5461/6235 (87.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3706, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18, epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5035/5454 (92.3176%)
___Train Local_ResNet_18, epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4845/5454 (88.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1373, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18, epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3941/4161 (94.7128%)
___Train Local_ResNet_18, epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3775/4161 (90.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3863, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18, epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4647/4979 (93.3320%)
___Train Local_ResNet_18, epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4588/4979 (92.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2013, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18, epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4815/5224 (92.1708%)
___Train Local_ResNet_18, epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4729/5224 (90.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2201, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18, epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5440/5907 (92.0941%)
___Train Local_ResNet_18, epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5327/5907 (90.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.5777, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18, epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3869/4086 (94.6892%)
___Train Local_ResNet_18, epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3856/4086 (94.3710%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1857, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5553/5871 (94.5835%)
___Train Local_ResNet_18, epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5329/5871 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1900, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4554/4748 (95.9141%)
___Train Local_ResNet_18, epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4483/4748 (94.4187%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9433, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18, epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5006/5427 (92.2425%)
___Train Local_ResNet_18, epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4912/5427 (90.5104%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0829, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18, epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4051/4196 (96.5443%)
___Train Local_ResNet_18, epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4001/4196 (95.3527%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.7919, Accuracy: 6007/10000 (60.0700%)
time spent on training: 228.55654096603394
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4548, Accuracy: 6458/10000 (64.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0294, Accuracy: 9818/9900 (99.1717%)
Done in 255.63486647605896 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.54400584850054.
Norm before scaling: 44.500788649524935. Distance: 1.1811015767497857
Total norm for 4 adversaries is: 44.500788649524935. distance: 1.1811015767497857
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5661/5777 (97.9920%), train_poison_data_count: 455
Global model norm: 44.54400584850054.
Norm before scaling: 44.49438989829926. Distance: 1.194204777075969
Total norm for 4 adversaries is: 44.49438989829926. distance: 1.194204777075969
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5007/5123 (97.7357%), train_poison_data_count: 403
Global model norm: 44.54400584850054.
Norm before scaling: 44.501682892598986. Distance: 1.1397016785777558
Total norm for 4 adversaries is: 44.501682892598986. distance: 1.1397016785777558
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.54400584850054.
Norm before scaling: 44.501497736382426. Distance: 1.2389871889488093
Total norm for 4 adversaries is: 44.501497736382426. distance: 1.2389871889488093
___Train Local_ResNet_18, epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5152/5526 (93.2320%)
___Train Local_ResNet_18, epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4835/5526 (87.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4690, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18, epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4789/5086 (94.1604%)
___Train Local_ResNet_18, epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4656/5086 (91.5454%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0938, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18, epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4380/4672 (93.7500%)
___Train Local_ResNet_18, epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4317/4672 (92.4015%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1873, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18, epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4112/4368 (94.1392%)
___Train Local_ResNet_18, epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4030/4368 (92.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2157, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18, epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5152/5645 (91.2666%)
___Train Local_ResNet_18, epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4800/5645 (85.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4543, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18, epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3765/4028 (93.4707%)
___Train Local_ResNet_18, epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3745/4028 (92.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0312, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18, epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4729/4993 (94.7126%)
___Train Local_ResNet_18, epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4659/4993 (93.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1768, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18, epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4548/4818 (94.3960%)
___Train Local_ResNet_18, epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4403/4818 (91.3865%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1759, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18, epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5239/5615 (93.3037%)
___Train Local_ResNet_18, epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5103/5615 (90.8816%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2668, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18, epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3312/3552 (93.2432%)
___Train Local_ResNet_18, epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3334/3552 (93.8626%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7106, Accuracy: 6003/10000 (60.0300%)
___Train Local_ResNet_18, epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4672/4956 (94.2696%)
___Train Local_ResNet_18, epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4473/4956 (90.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2879, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18, epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5548/5939 (93.4164%)
___Train Local_ResNet_18, epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5412/5939 (91.1265%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3792, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18, epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4618/4929 (93.6904%)
___Train Local_ResNet_18, epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4493/4929 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1719, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18, epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5638/6235 (90.4250%)
___Train Local_ResNet_18, epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5438/6235 (87.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2214, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18, epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4005/4249 (94.2575%)
___Train Local_ResNet_18, epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3917/4249 (92.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0632, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4157/4485 (92.6867%)
___Train Local_ResNet_18, epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3801/4485 (84.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4847, Accuracy: 4798/10000 (47.9800%)
time spent on training: 222.58715510368347
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4564, Accuracy: 6460/10000 (64.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0294, Accuracy: 9816/9900 (99.1515%)
Done in 249.62864184379578 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.562510957221654.
Norm before scaling: 44.51936793232525. Distance: 1.203922304792746
Total norm for 4 adversaries is: 44.51936793232525. distance: 1.203922304792746
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5657/5777 (97.9228%), train_poison_data_count: 455
Global model norm: 44.562510957221654.
Norm before scaling: 44.51346273047978. Distance: 1.2193222169777818
Total norm for 4 adversaries is: 44.51346273047978. distance: 1.2193222169777818
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4982/5123 (97.2477%), train_poison_data_count: 403
Global model norm: 44.562510957221654.
Norm before scaling: 44.52173143884344. Distance: 1.2420279442381696
Total norm for 4 adversaries is: 44.52173143884344. distance: 1.2420279442381696
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.562510957221654.
Norm before scaling: 44.5198464017208. Distance: 1.2426302138931857
Total norm for 4 adversaries is: 44.5198464017208. distance: 1.2426302138931857
___Train Local_ResNet_18, epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5121/5497 (93.1599%)
___Train Local_ResNet_18, epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4989/5497 (90.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2336, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18, epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3756/4028 (93.2473%)
___Train Local_ResNet_18, epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3756/4028 (93.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8718, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18, epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4651/4956 (93.8458%)
___Train Local_ResNet_18, epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4567/4956 (92.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2849, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18, epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5085/5454 (93.2343%)
___Train Local_ResNet_18, epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4841/5454 (88.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2816, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18, epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4765/5193 (91.7581%)
___Train Local_ResNet_18, epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4587/5193 (88.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2137, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18, epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4950/5504 (89.9346%)
___Train Local_ResNet_18, epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4812/5504 (87.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3223, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18, epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4041/4313 (93.6935%)
___Train Local_ResNet_18, epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3987/4313 (92.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9423, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18, epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4646/5050 (92.0000%)
___Train Local_ResNet_18, epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4565/5050 (90.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0065, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18, epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4139/4368 (94.7573%)
___Train Local_ResNet_18, epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4073/4368 (93.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0182, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18, epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4435/4714 (94.0815%)
___Train Local_ResNet_18, epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4352/4714 (92.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0747, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4916/5361 (91.6993%)
___Train Local_ResNet_18, epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4788/5361 (89.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4202, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18, epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4170/4485 (92.9766%)
___Train Local_ResNet_18, epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3872/4485 (86.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3105, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18, epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3910/4130 (94.6731%)
___Train Local_ResNet_18, epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3892/4130 (94.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8753, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18, epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4197/4397 (95.4514%)
___Train Local_ResNet_18, epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4205/4397 (95.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7092, Accuracy: 6079/10000 (60.7900%)
___Train Local_ResNet_18, epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3762/3968 (94.8085%)
___Train Local_ResNet_18, epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3770/3968 (95.0101%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7462, Accuracy: 5944/10000 (59.4400%)
___Train Local_ResNet_18, epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4364/4605 (94.7666%)
___Train Local_ResNet_18, epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4355/4605 (94.5711%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8380, Accuracy: 5831/10000 (58.3100%)
time spent on training: 218.31517362594604
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4559, Accuracy: 6455/10000 (64.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0316, Accuracy: 9813/9900 (99.1212%)
Done in 245.14299154281616 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.57980220512915.
Norm before scaling: 44.53503136357588. Distance: 1.1400726234994976
Total norm for 4 adversaries is: 44.53503136357588. distance: 1.1400726234994976
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.57980220512915.
Norm before scaling: 44.5314884862035. Distance: 1.2341765232109005
Total norm for 4 adversaries is: 44.5314884862035. distance: 1.2341765232109005
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.57980220512915.
Norm before scaling: 44.53860821882867. Distance: 1.2003887321737792
Total norm for 4 adversaries is: 44.53860821882867. distance: 1.2003887321737792
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 44.57980220512915.
Norm before scaling: 44.53634428098093. Distance: 1.2408675852638873
Total norm for 4 adversaries is: 44.53634428098093. distance: 1.2408675852638873
___Train Local_ResNet_18, epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4951/5361 (92.3522%)
___Train Local_ResNet_18, epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4827/5361 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2946, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18, epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6369/6947 (91.6799%)
___Train Local_ResNet_18, epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6027/6947 (86.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3370, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18, epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3674/3959 (92.8012%)
___Train Local_ResNet_18, epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3651/3959 (92.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0662, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18, epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4638/4956 (93.5835%)
___Train Local_ResNet_18, epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4551/4956 (91.8281%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1684, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4922/5399 (91.1650%)
___Train Local_ResNet_18, epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4725/5399 (87.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4016, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18, epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4993/5504 (90.7158%)
___Train Local_ResNet_18, epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4771/5504 (86.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3179, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18, epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5331/5696 (93.5920%)
___Train Local_ResNet_18, epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5200/5696 (91.2921%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2611, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18, epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5871/6419 (91.4628%)
___Train Local_ResNet_18, epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5589/6419 (87.0696%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3619, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18, epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4396/4737 (92.8014%)
___Train Local_ResNet_18, epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4247/4737 (89.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1392, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18, epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4626/5018 (92.1881%)
___Train Local_ResNet_18, epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4470/5018 (89.0793%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1763, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4580/4830 (94.8240%)
___Train Local_ResNet_18, epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4535/4830 (93.8923%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2154, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18, epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3882/4108 (94.4985%)
___Train Local_ResNet_18, epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3788/4108 (92.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2474, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18, epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5045/5489 (91.9111%)
___Train Local_ResNet_18, epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5019/5489 (91.4374%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2919, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18, epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4777/5086 (93.9245%)
___Train Local_ResNet_18, epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4683/5086 (92.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0787, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18, epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4420/4714 (93.7633%)
___Train Local_ResNet_18, epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4371/4714 (92.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9695, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18, epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4501/4903 (91.8009%)
___Train Local_ResNet_18, epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4457/4903 (90.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2205, Accuracy: 5305/10000 (53.0500%)
time spent on training: 223.44594049453735
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4692, Accuracy: 6435/10000 (64.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0318, Accuracy: 9811/9900 (99.1010%)
Done in 250.44611978530884 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5199/5308 (97.9465%), train_poison_data_count: 415
Global model norm: 44.599209382443796.
Norm before scaling: 44.55605942675614. Distance: 1.2025133535075918
Total norm for 4 adversaries is: 44.55605942675614. distance: 1.2025133535075918
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5656/5777 (97.9055%), train_poison_data_count: 455
Global model norm: 44.599209382443796.
Norm before scaling: 44.55089341968562. Distance: 1.2395584306967007
Total norm for 4 adversaries is: 44.55089341968562. distance: 1.2395584306967007
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4989/5123 (97.3843%), train_poison_data_count: 403
Global model norm: 44.599209382443796.
Norm before scaling: 44.55852509007816. Distance: 1.2254324889153303
Total norm for 4 adversaries is: 44.55852509007816. distance: 1.2254324889153303
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 44.599209382443796.
Norm before scaling: 44.55643476431042. Distance: 1.253108641405899
Total norm for 4 adversaries is: 44.55643476431042. distance: 1.253108641405899
___Train Local_ResNet_18, epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3788/3968 (95.4637%)
___Train Local_ResNet_18, epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3765/3968 (94.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8643, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18, epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4298/4587 (93.6996%)
___Train Local_ResNet_18, epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4225/4587 (92.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0055, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18, epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4505/4851 (92.8675%)
___Train Local_ResNet_18, epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4395/4851 (90.5999%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2566, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18, epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4482/4797 (93.4334%)
___Train Local_ResNet_18, epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4416/4797 (92.0575%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1075, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18, epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4534/4889 (92.7388%)
___Train Local_ResNet_18, epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4450/4889 (91.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0999, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18, epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5043/5346 (94.3322%)
___Train Local_ResNet_18, epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4897/5346 (91.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2605, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18, epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5014/5559 (90.1961%)
___Train Local_ResNet_18, epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4891/5559 (87.9835%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4043, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18, epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4803/5193 (92.4899%)
___Train Local_ResNet_18, epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4485/5193 (86.3663%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3774, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18, epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4509/4869 (92.6063%)
___Train Local_ResNet_18, epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4126/4869 (84.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3955, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18, epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4047/4313 (93.8326%)
___Train Local_ResNet_18, epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4027/4313 (93.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9646, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18, epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4444/4903 (90.6384%)
___Train Local_ResNet_18, epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4395/4903 (89.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1869, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18, epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4800/5068 (94.7119%)
___Train Local_ResNet_18, epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4713/5068 (92.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0485, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18, epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4462/4714 (94.6542%)
___Train Local_ResNet_18, epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4432/4714 (94.0178%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0503, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18, epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4198/4397 (95.4742%)
___Train Local_ResNet_18, epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4188/4397 (95.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8423, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18, epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5004/5353 (93.4803%)
___Train Local_ResNet_18, epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4836/5353 (90.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2071, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18, epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4557/4818 (94.5828%)
___Train Local_ResNet_18, epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4345/4818 (90.1826%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0392, Accuracy: 5544/10000 (55.4400%)
time spent on training: 220.03047466278076
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4708, Accuracy: 6420/10000 (64.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0279, Accuracy: 9823/9900 (99.2222%)
Done in 246.94400596618652 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5192/5308 (97.8146%), train_poison_data_count: 415
Global model norm: 44.617185448038825.
Norm before scaling: 44.57371878416698. Distance: 1.2023915123329667
Total norm for 4 adversaries is: 44.57371878416698. distance: 1.2023915123329667
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5663/5777 (98.0267%), train_poison_data_count: 455
Global model norm: 44.617185448038825.
Norm before scaling: 44.568983465066545. Distance: 1.2409256578013437
Total norm for 4 adversaries is: 44.568983465066545. distance: 1.2409256578013437
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.617185448038825.
Norm before scaling: 44.5742185788384. Distance: 1.179013849382537
Total norm for 4 adversaries is: 44.5742185788384. distance: 1.179013849382537
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.617185448038825.
Norm before scaling: 44.5736201938714. Distance: 1.2110505574270416
Total norm for 4 adversaries is: 44.5736201938714. distance: 1.2110505574270416
___Train Local_ResNet_18, epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4782/5075 (94.2266%)
___Train Local_ResNet_18, epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4658/5075 (91.7833%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0145, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18, epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4630/4929 (93.9339%)
___Train Local_ResNet_18, epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4453/4929 (90.3429%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2738, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18, epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5592/5939 (94.1573%)
___Train Local_ResNet_18, epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5512/5939 (92.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0611, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18, epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3913/4145 (94.4029%)
___Train Local_ResNet_18, epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3836/4145 (92.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9811, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18, epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4808/5086 (94.5340%)
___Train Local_ResNet_18, epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4725/5086 (92.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0734, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18, epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4716/5055 (93.2938%)
___Train Local_ResNet_18, epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4661/5055 (92.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0808, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18, epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5068/5454 (92.9226%)
___Train Local_ResNet_18, epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4864/5454 (89.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1488, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18, epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4710/5123 (91.9383%)
___Train Local_ResNet_18, epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4090/5123 (79.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.8346, Accuracy: 4352/10000 (43.5200%)
___Train Local_ResNet_18, epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4749/4993 (95.1132%)
___Train Local_ResNet_18, epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4580/4993 (91.7284%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2267, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18, epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4821/5224 (92.2856%)
___Train Local_ResNet_18, epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4681/5224 (89.6057%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2667, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18, epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4161/4368 (95.2610%)
___Train Local_ResNet_18, epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4091/4368 (93.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0994, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18, epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3739/3910 (95.6266%)
___Train Local_ResNet_18, epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3468/3910 (88.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2524, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4281/4549 (94.1086%)
___Train Local_ResNet_18, epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4061/4549 (89.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3040, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18, epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5076/5489 (92.4759%)
___Train Local_ResNet_18, epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4962/5489 (90.3990%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0820, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18, epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3881/4086 (94.9829%)
___Train Local_ResNet_18, epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3848/4086 (94.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8905, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18, epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4804/5193 (92.5091%)
___Train Local_ResNet_18, epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4683/5193 (90.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2614, Accuracy: 5264/10000 (52.6400%)
time spent on training: 221.26319313049316
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4788, Accuracy: 6405/10000 (64.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0293, Accuracy: 9821/9900 (99.2020%)
Done in 248.05122900009155 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5234/5308 (98.6059%), train_poison_data_count: 415
Global model norm: 44.636415020680566.
Norm before scaling: 44.58858425318217. Distance: 1.0454788577415415
Total norm for 4 adversaries is: 44.58858425318217. distance: 1.0454788577415415
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.636415020680566.
Norm before scaling: 44.58669519791611. Distance: 1.2042114504677923
Total norm for 4 adversaries is: 44.58669519791611. distance: 1.2042114504677923
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.636415020680566.
Norm before scaling: 44.59356522605378. Distance: 1.1766058479419235
Total norm for 4 adversaries is: 44.59356522605378. distance: 1.1766058479419235
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.636415020680566.
Norm before scaling: 44.59242097923214. Distance: 1.2422033344915002
Total norm for 4 adversaries is: 44.59242097923214. distance: 1.2422033344915002
___Train Local_ResNet_18, epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4296/4587 (93.6560%)
___Train Local_ResNet_18, epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4223/4587 (92.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0701, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18, epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5022/5427 (92.5373%)
___Train Local_ResNet_18, epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4905/5427 (90.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0951, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4517/4748 (95.1348%)
___Train Local_ResNet_18, epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4480/4748 (94.3555%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0340, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18, epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3923/4175 (93.9641%)
___Train Local_ResNet_18, epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3885/4175 (93.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9769, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18, epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5063/5353 (94.5825%)
___Train Local_ResNet_18, epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4849/5353 (90.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0976, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18, epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4092/4364 (93.7672%)
___Train Local_ResNet_18, epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4044/4364 (92.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0143, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18, epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5015/5362 (93.5285%)
___Train Local_ResNet_18, epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4929/5362 (91.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9982, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18, epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4323/4549 (95.0319%)
___Train Local_ResNet_18, epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4144/4549 (91.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9953, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18, epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3937/4161 (94.6167%)
___Train Local_ResNet_18, epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3877/4161 (93.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0451, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18, epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4830/5209 (92.7241%)
___Train Local_ResNet_18, epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4737/5209 (90.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9848, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18, epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4586/4830 (94.9482%)
___Train Local_ResNet_18, epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4549/4830 (94.1822%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1181, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5045/5346 (94.3696%)
___Train Local_ResNet_18, epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4968/5346 (92.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1094, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18, epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5207/5615 (92.7337%)
___Train Local_ResNet_18, epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5093/5615 (90.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2019, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18, epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4762/5035 (94.5780%)
___Train Local_ResNet_18, epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4697/5035 (93.2870%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0106, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18, epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4489/4731 (94.8848%)
___Train Local_ResNet_18, epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4454/4731 (94.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0093, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18, epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5064/5702 (88.8109%)
___Train Local_ResNet_18, epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4672/5702 (81.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4374, Accuracy: 4824/10000 (48.2400%)
time spent on training: 221.43032383918762
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4752, Accuracy: 6408/10000 (64.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0301, Accuracy: 9818/9900 (99.1717%)
Done in 248.4181399345398 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5217/5308 (98.2856%), train_poison_data_count: 415
Global model norm: 44.65433647054897.
Norm before scaling: 44.60845555094488. Distance: 1.1085737854313833
Total norm for 4 adversaries is: 44.60845555094488. distance: 1.1085737854313833
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.65433647054897.
Norm before scaling: 44.604591468571094. Distance: 1.2014377702876327
Total norm for 4 adversaries is: 44.604591468571094. distance: 1.2014377702876327
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.65433647054897.
Norm before scaling: 44.611405382865655. Distance: 1.1755876857061993
Total norm for 4 adversaries is: 44.611405382865655. distance: 1.1755876857061993
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.65433647054897.
Norm before scaling: 44.610765083420446. Distance: 1.2411014439559134
Total norm for 4 adversaries is: 44.610765083420446. distance: 1.2411014439559134
___Train Local_ResNet_18, epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4356/4736 (91.9764%)
___Train Local_ResNet_18, epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4324/4736 (91.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0641, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18, epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4717/5038 (93.6284%)
___Train Local_ResNet_18, epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4669/5038 (92.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9846, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18, epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4042/4196 (96.3298%)
___Train Local_ResNet_18, epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3988/4196 (95.0429%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9078, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18, epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4408/4741 (92.9762%)
___Train Local_ResNet_18, epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3681/4741 (77.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6512, Accuracy: 4701/10000 (47.0100%)
___Train Local_ResNet_18, epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4586/5018 (91.3910%)
___Train Local_ResNet_18, epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4433/5018 (88.3420%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1638, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5252/5727 (91.7060%)
___Train Local_ResNet_18, epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5009/5727 (87.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1004, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18, epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4661/5122 (90.9996%)
___Train Local_ResNet_18, epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0132, Accuracy: 3869/5122 (75.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6301, Accuracy: 4506/10000 (45.0600%)
___Train Local_ResNet_18, epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4508/4903 (91.9437%)
___Train Local_ResNet_18, epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4376/4903 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3661, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18, epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4357/4605 (94.6145%)
___Train Local_ResNet_18, epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4345/4605 (94.3540%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9258, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18, epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4316/4549 (94.8780%)
___Train Local_ResNet_18, epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4259/4549 (93.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0261, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18, epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5060/5454 (92.7759%)
___Train Local_ResNet_18, epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4811/5454 (88.2105%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1446, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18, epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3363/3589 (93.7030%)
___Train Local_ResNet_18, epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3041/3589 (84.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3570, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18, epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4915/5361 (91.6807%)
___Train Local_ResNet_18, epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4781/5361 (89.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2483, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18, epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4470/4757 (93.9668%)
___Train Local_ResNet_18, epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4317/4757 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2356, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18, epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4503/4731 (95.1807%)
___Train Local_ResNet_18, epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4426/4731 (93.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0758, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18, epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5689/6235 (91.2430%)
___Train Local_ResNet_18, epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5540/6235 (88.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3991, Accuracy: 5076/10000 (50.7600%)
time spent on training: 220.91073274612427
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4730, Accuracy: 6394/10000 (63.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0346, Accuracy: 9807/9900 (99.0606%)
Done in 247.65903878211975 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.674133435828246.
Norm before scaling: 44.630804288139934. Distance: 1.199571240836636
Total norm for 4 adversaries is: 44.630804288139934. distance: 1.199571240836636
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5662/5777 (98.0093%), train_poison_data_count: 455
Global model norm: 44.674133435828246.
Norm before scaling: 44.62490836168812. Distance: 1.233278149366861
Total norm for 4 adversaries is: 44.62490836168812. distance: 1.233278149366861
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.674133435828246.
Norm before scaling: 44.63032290557901. Distance: 1.132701157984559
Total norm for 4 adversaries is: 44.63032290557901. distance: 1.132701157984559
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.674133435828246.
Norm before scaling: 44.62972664043552. Distance: 1.2045123040919605
Total norm for 4 adversaries is: 44.62972664043552. distance: 1.2045123040919605
___Train Local_ResNet_18, epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4374/4737 (92.3369%)
___Train Local_ResNet_18, epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4317/4737 (91.1336%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1758, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18, epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6070/6664 (91.0864%)
___Train Local_ResNet_18, epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0083, Accuracy: 5601/6664 (84.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.6910, Accuracy: 4645/10000 (46.4500%)
___Train Local_ResNet_18, epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4768/5193 (91.8159%)
___Train Local_ResNet_18, epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4599/5193 (88.5615%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4000, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18, epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3710/3995 (92.8661%)
___Train Local_ResNet_18, epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3693/3995 (92.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0060, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18, epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4678/5038 (92.8543%)
___Train Local_ResNet_18, epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4631/5038 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9853, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18, epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4598/4830 (95.1967%)
___Train Local_ResNet_18, epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4574/4830 (94.6998%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0317, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18, epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3899/4175 (93.3892%)
___Train Local_ResNet_18, epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3778/4175 (90.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0723, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18, epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4593/5018 (91.5305%)
___Train Local_ResNet_18, epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4392/5018 (87.5249%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2198, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5538/5871 (94.3281%)
___Train Local_ResNet_18, epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5405/5871 (92.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4193, Accuracy: 5009/10000 (50.0900%)
___Train Local_ResNet_18, epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4677/4956 (94.3705%)
___Train Local_ResNet_18, epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4586/4956 (92.5343%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1505, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18, epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5035/5353 (94.0594%)
___Train Local_ResNet_18, epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4915/5353 (91.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0546, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18, epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4491/4731 (94.9271%)
___Train Local_ResNet_18, epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4454/4731 (94.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0921, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18, epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4525/4903 (92.2904%)
___Train Local_ResNet_18, epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4534/4903 (92.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0045, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18, epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4548/4869 (93.4073%)
___Train Local_ResNet_18, epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3937/4869 (80.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.7957, Accuracy: 4445/10000 (44.4500%)
___Train Local_ResNet_18, epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4431/4797 (92.3702%)
___Train Local_ResNet_18, epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4372/4797 (91.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9956, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18, epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3744/3910 (95.7545%)
___Train Local_ResNet_18, epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3603/3910 (92.1483%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0166, Accuracy: 5724/10000 (57.2400%)
time spent on training: 222.07306694984436
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4745, Accuracy: 6405/10000 (64.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0299, Accuracy: 9818/9900 (99.1717%)
Done in 248.95018863677979 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.6921367240473.
Norm before scaling: 44.648588555081304. Distance: 1.176994838032386
Total norm for 4 adversaries is: 44.648588555081304. distance: 1.176994838032386
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5694/5777 (98.5633%), train_poison_data_count: 455
Global model norm: 44.6921367240473.
Norm before scaling: 44.63907313762168. Distance: 1.1127810776775269
Total norm for 4 adversaries is: 44.63907313762168. distance: 1.1127810776775269
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.6921367240473.
Norm before scaling: 44.650920616646445. Distance: 1.2053254552238408
Total norm for 4 adversaries is: 44.650920616646445. distance: 1.2053254552238408
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.6921367240473.
Norm before scaling: 44.648887929705204. Distance: 1.2267196943303498
Total norm for 4 adversaries is: 44.648887929705204. distance: 1.2267196943303498
___Train Local_ResNet_18, epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4667/5050 (92.4158%)
___Train Local_ResNet_18, epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4511/5050 (89.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0946, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18, epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4452/4714 (94.4421%)
___Train Local_ResNet_18, epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4382/4714 (92.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0992, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18, epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3885/4108 (94.5716%)
___Train Local_ResNet_18, epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3746/4108 (91.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0511, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18, epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4533/4869 (93.0992%)
___Train Local_ResNet_18, epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3893/4869 (79.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3458, Accuracy: 4861/10000 (48.6100%)
___Train Local_ResNet_18, epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5531/6080 (90.9704%)
___Train Local_ResNet_18, epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5296/6080 (87.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2112, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18, epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4826/5075 (95.0936%)
___Train Local_ResNet_18, epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4669/5075 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1673, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5111/5559 (91.9410%)
___Train Local_ResNet_18, epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4853/5559 (87.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3138, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18, epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4742/4993 (94.9730%)
___Train Local_ResNet_18, epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4655/4993 (93.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3360, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18, epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6345/6947 (91.3344%)
___Train Local_ResNet_18, epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6092/6947 (87.6925%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1083, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18, epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5150/5652 (91.1182%)
___Train Local_ResNet_18, epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4967/5652 (87.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2002, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18, epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4490/4731 (94.9059%)
___Train Local_ResNet_18, epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4423/4731 (93.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9660, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18, epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4495/4894 (91.8472%)
___Train Local_ResNet_18, epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4252/4894 (86.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2820, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18, epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5215/5615 (92.8762%)
___Train Local_ResNet_18, epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5113/5615 (91.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1929, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18, epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4636/5018 (92.3874%)
___Train Local_ResNet_18, epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4486/5018 (89.3982%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2194, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18, epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3786/4028 (93.9921%)
___Train Local_ResNet_18, epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3783/4028 (93.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9997, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18, epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4750/5123 (92.7191%)
___Train Local_ResNet_18, epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4473/5123 (87.3121%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4775, Accuracy: 4974/10000 (49.7400%)
time spent on training: 225.9732985496521
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4782, Accuracy: 6387/10000 (63.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0311, Accuracy: 9816/9900 (99.1515%)
Done in 252.90007138252258 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.71275100616224.
Norm before scaling: 44.667057168496676. Distance: 1.1201221894981492
Total norm for 4 adversaries is: 44.667057168496676. distance: 1.1201221894981492
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.71275100616224.
Norm before scaling: 44.66224701684578. Distance: 1.2032341845622447
Total norm for 4 adversaries is: 44.66224701684578. distance: 1.2032341845622447
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5015/5123 (97.8919%), train_poison_data_count: 403
Global model norm: 44.71275100616224.
Norm before scaling: 44.66973259115869. Distance: 1.1719173678050836
Total norm for 4 adversaries is: 44.66973259115869. distance: 1.1719173678050836
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.71275100616224.
Norm before scaling: 44.6676201410205. Distance: 1.216283062115989
Total norm for 4 adversaries is: 44.6676201410205. distance: 1.216283062115989
___Train Local_ResNet_18, epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4510/4903 (91.9845%)
___Train Local_ResNet_18, epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4391/4903 (89.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3064, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18, epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5547/5871 (94.4813%)
___Train Local_ResNet_18, epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5424/5871 (92.3863%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1298, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18, epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5451/5907 (92.2803%)
___Train Local_ResNet_18, epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5443/5907 (92.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4334, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18, epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4228/4537 (93.1893%)
___Train Local_ResNet_18, epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4153/4537 (91.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1626, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18, epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4710/5038 (93.4895%)
___Train Local_ResNet_18, epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4671/5038 (92.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9902, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18, epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4994/5298 (94.2620%)
___Train Local_ResNet_18, epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4919/5298 (92.8464%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3642, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18, epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4858/5209 (93.2617%)
___Train Local_ResNet_18, epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4713/5209 (90.4780%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1037, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18, epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4662/5122 (91.0191%)
___Train Local_ResNet_18, epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4264/5122 (83.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3179, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18, epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3632/3929 (92.4408%)
___Train Local_ResNet_18, epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3586/3929 (91.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9413, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18, epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5091/5559 (91.5812%)
___Train Local_ResNet_18, epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4832/5559 (86.9221%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3048, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18, epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4733/4993 (94.7927%)
___Train Local_ResNet_18, epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4566/4993 (91.4480%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2980, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18, epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6370/6947 (91.6943%)
___Train Local_ResNet_18, epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6015/6947 (86.5841%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2154, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18, epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4617/5018 (92.0088%)
___Train Local_ResNet_18, epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4394/5018 (87.5648%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3535, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18, epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4479/4797 (93.3709%)
___Train Local_ResNet_18, epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4421/4797 (92.1618%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8393, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18, epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5681/6235 (91.1147%)
___Train Local_ResNet_18, epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5382/6235 (86.3192%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4879, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18, epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5046/5461 (92.4007%)
___Train Local_ResNet_18, epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4947/5461 (90.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2973, Accuracy: 5201/10000 (52.0100%)
time spent on training: 228.53886485099792
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4827, Accuracy: 6381/10000 (63.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0339, Accuracy: 9809/9900 (99.0808%)
Done in 255.31524443626404 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 44.73277863463212.
Norm before scaling: 44.688076373031265. Distance: 1.154052605254713
Total norm for 4 adversaries is: 44.688076373031265. distance: 1.154052605254713
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.73277863463212.
Norm before scaling: 44.68326438624351. Distance: 1.210184515369929
Total norm for 4 adversaries is: 44.68326438624351. distance: 1.210184515369929
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5024/5123 (98.0675%), train_poison_data_count: 403
Global model norm: 44.73277863463212.
Norm before scaling: 44.687816869505944. Distance: 1.133103484566505
Total norm for 4 adversaries is: 44.687816869505944. distance: 1.133103484566505
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5412/5503 (98.3464%), train_poison_data_count: 430
Global model norm: 44.73277863463212.
Norm before scaling: 44.68570937190449. Distance: 1.146035829626402
Total norm for 4 adversaries is: 44.68570937190449. distance: 1.146035829626402
___Train Local_ResNet_18, epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3695/3995 (92.4906%)
___Train Local_ResNet_18, epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3635/3995 (90.9887%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0573, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18, epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6407/6812 (94.0546%)
___Train Local_ResNet_18, epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6269/6812 (92.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2828, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3931/4130 (95.1816%)
___Train Local_ResNet_18, epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3857/4130 (93.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9890, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18, epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4388/4737 (92.6325%)
___Train Local_ResNet_18, epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4316/4737 (91.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2548, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18, epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5323/5696 (93.4515%)
___Train Local_ResNet_18, epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5226/5696 (91.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1588, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18, epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4717/5055 (93.3136%)
___Train Local_ResNet_18, epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4594/5055 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0904, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18, epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4155/4368 (95.1236%)
___Train Local_ResNet_18, epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3962/4368 (90.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2359, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18, epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5230/5652 (92.5336%)
___Train Local_ResNet_18, epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5058/5652 (89.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2835, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18, epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3882/4175 (92.9820%)
___Train Local_ResNet_18, epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3783/4175 (90.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0620, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18, epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5048/5298 (95.2812%)
___Train Local_ResNet_18, epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4933/5298 (93.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0231, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18, epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5284/5615 (94.1051%)
___Train Local_ResNet_18, epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5226/5615 (93.0721%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0306, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18, epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4842/5224 (92.6876%)
___Train Local_ResNet_18, epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4722/5224 (90.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2286, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18, epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5697/6235 (91.3713%)
___Train Local_ResNet_18, epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5509/6235 (88.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2470, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18, epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4199/4485 (93.6232%)
___Train Local_ResNet_18, epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3865/4485 (86.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3321, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18, epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5482/6080 (90.1645%)
___Train Local_ResNet_18, epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5358/6080 (88.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3108, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18, epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3899/4108 (94.9124%)
___Train Local_ResNet_18, epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3808/4108 (92.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0186, Accuracy: 5559/10000 (55.5900%)
time spent on training: 224.7460355758667
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4915, Accuracy: 6372/10000 (63.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0351, Accuracy: 9808/9900 (99.0707%)
Done in 251.70916438102722 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5249/5308 (98.8885%), train_poison_data_count: 415
Global model norm: 44.75205809905911.
Norm before scaling: 44.704449364339006. Distance: 1.0353174048162792
Total norm for 4 adversaries is: 44.704449364339006. distance: 1.0353174048162792
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.75205809905911.
Norm before scaling: 44.701310420616444. Distance: 1.1781347299674882
Total norm for 4 adversaries is: 44.701310420616444. distance: 1.1781347299674882
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 44.75205809905911.
Norm before scaling: 44.708528706081346. Distance: 1.162293901939907
Total norm for 4 adversaries is: 44.708528706081346. distance: 1.162293901939907
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.75205809905911.
Norm before scaling: 44.70976417624357. Distance: 1.2733914419632841
Total norm for 4 adversaries is: 44.70976417624357. distance: 1.2733914419632841
___Train Local_ResNet_18, epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4591/4889 (93.9047%)
___Train Local_ResNet_18, epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4507/4889 (92.1865%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1106, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18, epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5101/5526 (92.3091%)
___Train Local_ResNet_18, epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4890/5526 (88.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3086, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18, epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3356/3589 (93.5079%)
___Train Local_ResNet_18, epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3244/3589 (90.3873%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1133, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18, epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4646/5122 (90.7068%)
___Train Local_ResNet_18, epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4337/5122 (84.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3505, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18, epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4619/4911 (94.0542%)
___Train Local_ResNet_18, epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4547/4911 (92.5881%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0733, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18, epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4527/4748 (95.3454%)
___Train Local_ResNet_18, epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4429/4748 (93.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1873, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18, epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4481/4894 (91.5611%)
___Train Local_ResNet_18, epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4334/4894 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0768, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18, epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4643/4929 (94.1976%)
___Train Local_ResNet_18, epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4503/4929 (91.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2349, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18, epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5152/5645 (91.2666%)
___Train Local_ResNet_18, epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4869/5645 (86.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1834, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18, epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4645/4979 (93.2918%)
___Train Local_ResNet_18, epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4644/4979 (93.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0498, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4610/5050 (91.2871%)
___Train Local_ResNet_18, epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4557/5050 (90.2376%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0653, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18, epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3675/3959 (92.8265%)
___Train Local_ResNet_18, epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3703/3959 (93.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1795, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18, epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3297/3552 (92.8209%)
___Train Local_ResNet_18, epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3336/3552 (93.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8991, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18, epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4845/5209 (93.0121%)
___Train Local_ResNet_18, epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4667/5209 (89.5949%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2948, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18, epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3928/4130 (95.1090%)
___Train Local_ResNet_18, epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3794/4130 (91.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9561, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18, epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3871/4086 (94.7381%)
___Train Local_ResNet_18, epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3839/4086 (93.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0121, Accuracy: 5652/10000 (56.5200%)
time spent on training: 218.81055212020874
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4978, Accuracy: 6364/10000 (63.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0356, Accuracy: 9804/9900 (99.0303%)
Done in 245.48225355148315 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5223/5308 (98.3986%), train_poison_data_count: 415
Global model norm: 44.76910844867321.
Norm before scaling: 44.72316785698507. Distance: 1.1414467451260806
Total norm for 4 adversaries is: 44.72316785698507. distance: 1.1414467451260806
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.76910844867321.
Norm before scaling: 44.71558885577545. Distance: 1.1347014890001244
Total norm for 4 adversaries is: 44.71558885577545. distance: 1.1347014890001244
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4984/5123 (97.2867%), train_poison_data_count: 403
Global model norm: 44.76910844867321.
Norm before scaling: 44.72592726077278. Distance: 1.2041691299378083
Total norm for 4 adversaries is: 44.72592726077278. distance: 1.2041691299378083
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.76910844867321.
Norm before scaling: 44.72370419360269. Distance: 1.221634703127384
Total norm for 4 adversaries is: 44.72370419360269. distance: 1.221634703127384
___Train Local_ResNet_18, epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4548/4748 (95.7877%)
___Train Local_ResNet_18, epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4467/4748 (94.0817%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1308, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18, epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4688/4929 (95.1106%)
___Train Local_ResNet_18, epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4525/4929 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0248, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18, epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3944/4175 (94.4671%)
___Train Local_ResNet_18, epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3830/4175 (91.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2506, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18, epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4428/4737 (93.4769%)
___Train Local_ResNet_18, epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4316/4737 (91.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1753, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4977/5362 (92.8198%)
___Train Local_ResNet_18, epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4855/5362 (90.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1022, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18, epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4485/4869 (92.1134%)
___Train Local_ResNet_18, epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4278/4869 (87.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4331, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18, epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5026/5346 (94.0142%)
___Train Local_ResNet_18, epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4998/5346 (93.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1945, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18, epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4817/5224 (92.2090%)
___Train Local_ResNet_18, epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4786/5224 (91.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2610, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18, epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4457/4797 (92.9122%)
___Train Local_ResNet_18, epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4421/4797 (92.1618%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1281, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18, epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4512/4843 (93.1654%)
___Train Local_ResNet_18, epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4435/4843 (91.5755%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2034, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18, epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5812/6419 (90.5437%)
___Train Local_ResNet_18, epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5563/6419 (86.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5565, Accuracy: 4902/10000 (49.0200%)
___Train Local_ResNet_18, epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4767/5086 (93.7279%)
___Train Local_ResNet_18, epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4734/5086 (93.0790%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0884, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18, epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4277/4537 (94.2693%)
___Train Local_ResNet_18, epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4194/4537 (92.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8619, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18, epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3979/4161 (95.6261%)
___Train Local_ResNet_18, epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3889/4161 (93.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9531, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18, epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4144/4368 (94.8718%)
___Train Local_ResNet_18, epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4115/4368 (94.2079%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0346, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18, epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4637/4911 (94.4207%)
___Train Local_ResNet_18, epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4555/4911 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0277, Accuracy: 5545/10000 (55.4500%)
time spent on training: 220.6587839126587
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5199, Accuracy: 6335/10000 (63.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0330, Accuracy: 9812/9900 (99.1111%)
Done in 247.58227968215942 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5240/5308 (98.7189%), train_poison_data_count: 415
Global model norm: 44.786592493596785.
Norm before scaling: 44.73881587064875. Distance: 1.0535594417638294
Total norm for 4 adversaries is: 44.73881587064875. distance: 1.0535594417638294
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.786592493596785.
Norm before scaling: 44.73422764558337. Distance: 1.1560679627507182
Total norm for 4 adversaries is: 44.73422764558337. distance: 1.1560679627507182
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5004/5123 (97.6771%), train_poison_data_count: 403
Global model norm: 44.786592493596785.
Norm before scaling: 44.742721562422865. Distance: 1.1672850684222809
Total norm for 4 adversaries is: 44.742721562422865. distance: 1.1672850684222809
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.786592493596785.
Norm before scaling: 44.74055253364251. Distance: 1.1884519876965736
Total norm for 4 adversaries is: 44.74055253364251. distance: 1.1884519876965736
___Train Local_ResNet_18, epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4809/5075 (94.7586%)
___Train Local_ResNet_18, epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4726/5075 (93.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1518, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18, epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5048/5298 (95.2812%)
___Train Local_ResNet_18, epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4963/5298 (93.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0432, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18, epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5136/5422 (94.7252%)
___Train Local_ResNet_18, epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5064/5422 (93.3973%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0579, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18, epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4813/5068 (94.9684%)
___Train Local_ResNet_18, epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4723/5068 (93.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9681, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18, epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4409/4737 (93.0758%)
___Train Local_ResNet_18, epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4389/4737 (92.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2486, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18, epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5071/5702 (88.9337%)
___Train Local_ResNet_18, epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0120, Accuracy: 4457/5702 (78.1656%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4006, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18, epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3677/3995 (92.0401%)
___Train Local_ResNet_18, epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3652/3995 (91.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0412, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18, epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4723/5122 (92.2101%)
___Train Local_ResNet_18, epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4124/5122 (80.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 3.0123, Accuracy: 4036/10000 (40.3600%)
___Train Local_ResNet_18, epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5394/5696 (94.6980%)
___Train Local_ResNet_18, epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5251/5696 (92.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2811, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18, epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4144/4368 (94.8718%)
___Train Local_ResNet_18, epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4099/4368 (93.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0999, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18, epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4305/4537 (94.8865%)
___Train Local_ResNet_18, epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4209/4537 (92.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9344, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18, epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3870/4111 (94.1377%)
___Train Local_ResNet_18, epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3643/4111 (88.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4385, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18, epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4293/4587 (93.5906%)
___Train Local_ResNet_18, epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4168/4587 (90.8655%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0418, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4892/5399 (90.6094%)
___Train Local_ResNet_18, epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4666/5399 (86.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3542, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18, epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5231/5615 (93.1612%)
___Train Local_ResNet_18, epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5109/5615 (90.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2948, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18, epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4501/4714 (95.4815%)
___Train Local_ResNet_18, epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4479/4714 (95.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8986, Accuracy: 5812/10000 (58.1200%)
time spent on training: 220.40485858917236
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5337, Accuracy: 6320/10000 (63.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0314, Accuracy: 9814/9900 (99.1313%)
Done in 247.48962020874023 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5223/5308 (98.3986%), train_poison_data_count: 415
Global model norm: 44.804621430858.
Norm before scaling: 44.75760726628631. Distance: 1.140501250778509
Total norm for 4 adversaries is: 44.75760726628631. distance: 1.140501250778509
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.804621430858.
Norm before scaling: 44.753975633019884. Distance: 1.2444669813478781
Total norm for 4 adversaries is: 44.753975633019884. distance: 1.2444669813478781
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.804621430858.
Norm before scaling: 44.76269760279967. Distance: 1.2218480958440074
Total norm for 4 adversaries is: 44.76269760279967. distance: 1.2218480958440074
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5411/5503 (98.3282%), train_poison_data_count: 430
Global model norm: 44.804621430858.
Norm before scaling: 44.76010137169807. Distance: 1.18082666026841
Total norm for 4 adversaries is: 44.76010137169807. distance: 1.18082666026841
___Train Local_ResNet_18, epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4500/4757 (94.5974%)
___Train Local_ResNet_18, epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4372/4757 (91.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0581, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18, epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5047/5489 (91.9475%)
___Train Local_ResNet_18, epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4992/5489 (90.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9848, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18, epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4500/4797 (93.8086%)
___Train Local_ResNet_18, epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4435/4797 (92.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0160, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18, epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5047/5454 (92.5376%)
___Train Local_ResNet_18, epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4802/5454 (88.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2834, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18, epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5172/5645 (91.6209%)
___Train Local_ResNet_18, epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4811/5645 (85.2259%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3194, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18, epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4506/4731 (95.2441%)
___Train Local_ResNet_18, epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4427/4731 (93.5743%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0057, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18, epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4223/4397 (96.0428%)
___Train Local_ResNet_18, epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4215/4397 (95.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.7996, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18, epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4730/5086 (93.0004%)
___Train Local_ResNet_18, epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4625/5086 (90.9359%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1467, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4748/5035 (94.2999%)
___Train Local_ResNet_18, epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4716/5035 (93.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9170, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18, epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4413/4672 (94.4563%)
___Train Local_ResNet_18, epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4311/4672 (92.2731%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0708, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18, epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3968/4161 (95.3617%)
___Train Local_ResNet_18, epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3849/4161 (92.5018%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0414, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18, epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4027/4196 (95.9724%)
___Train Local_ResNet_18, epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3985/4196 (94.9714%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8098, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18, epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5000/5504 (90.8430%)
___Train Local_ResNet_18, epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4803/5504 (87.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.4209, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18, epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5861/6419 (91.3071%)
___Train Local_ResNet_18, epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5515/6419 (85.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.4657, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18, epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4361/4605 (94.7014%)
___Train Local_ResNet_18, epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4310/4605 (93.5939%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9007, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18, epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4479/4732 (94.6534%)
___Train Local_ResNet_18, epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4472/4732 (94.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9518, Accuracy: 5796/10000 (57.9600%)
time spent on training: 223.76173639297485
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5214, Accuracy: 6340/10000 (63.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0318, Accuracy: 9815/9900 (99.1414%)
Done in 250.28165340423584 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.82126505110325.
Norm before scaling: 44.773982095143715. Distance: 1.083931036659287
Total norm for 4 adversaries is: 44.773982095143715. distance: 1.083931036659287
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.82126505110325.
Norm before scaling: 44.7698378253289. Distance: 1.1787052739093429
Total norm for 4 adversaries is: 44.7698378253289. distance: 1.1787052739093429
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.82126505110325.
Norm before scaling: 44.77676426634759. Distance: 1.1716944237501068
Total norm for 4 adversaries is: 44.77676426634759. distance: 1.1716944237501068
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.82126505110325.
Norm before scaling: 44.77619039805084. Distance: 1.2319788794069522
Total norm for 4 adversaries is: 44.77619039805084. distance: 1.2319788794069522
___Train Local_ResNet_18, epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5171/5422 (95.3707%)
___Train Local_ResNet_18, epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0027, Accuracy: 5132/5422 (94.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8735, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18, epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4491/4714 (95.2694%)
___Train Local_ResNet_18, epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4424/4714 (93.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0199, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18, epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4675/4979 (93.8944%)
___Train Local_ResNet_18, epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4543/4979 (91.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3378, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18, epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4853/5209 (93.1657%)
___Train Local_ResNet_18, epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4736/5209 (90.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1703, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18, epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4471/4851 (92.1666%)
___Train Local_ResNet_18, epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4383/4851 (90.3525%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2023, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18, epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4841/5224 (92.6685%)
___Train Local_ResNet_18, epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4862/5224 (93.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1659, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18, epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4373/4549 (96.1310%)
___Train Local_ResNet_18, epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3962/4549 (87.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3945, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18, epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3744/3968 (94.3548%)
___Train Local_ResNet_18, epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3756/3968 (94.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9217, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18, epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5550/5939 (93.4501%)
___Train Local_ResNet_18, epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5414/5939 (91.1601%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1342, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18, epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4993/5298 (94.2431%)
___Train Local_ResNet_18, epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4946/5298 (93.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0116, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18, epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4180/4397 (95.0648%)
___Train Local_ResNet_18, epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4216/4397 (95.8836%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8716, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18, epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4629/5122 (90.3749%)
___Train Local_ResNet_18, epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3791/5122 (74.0141%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.8812, Accuracy: 4140/10000 (41.4000%)
___Train Local_ResNet_18, epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4050/4196 (96.5205%)
___Train Local_ResNet_18, epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4042/4196 (96.3298%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8061, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18, epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5011/5427 (92.3346%)
___Train Local_ResNet_18, epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4853/5427 (89.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2811, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18, epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3707/3910 (94.8082%)
___Train Local_ResNet_18, epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3404/3910 (87.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2539, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18, epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3900/4086 (95.4479%)
___Train Local_ResNet_18, epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3877/4086 (94.8850%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0084, Accuracy: 5652/10000 (56.5200%)
time spent on training: 219.66467928886414
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5324, Accuracy: 6316/10000 (63.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0312, Accuracy: 9816/9900 (99.1515%)
Done in 246.42825722694397 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 44.83826730420958.
Norm before scaling: 44.79117671728161. Distance: 1.0980564894606428
Total norm for 4 adversaries is: 44.79117671728161. distance: 1.0980564894606428
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.83826730420958.
Norm before scaling: 44.78600648587821. Distance: 1.1558986851800641
Total norm for 4 adversaries is: 44.78600648587821. distance: 1.1558986851800641
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.83826730420958.
Norm before scaling: 44.79311301565021. Distance: 1.1460644864517957
Total norm for 4 adversaries is: 44.79311301565021. distance: 1.1460644864517957
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5405/5503 (98.2192%), train_poison_data_count: 430
Global model norm: 44.83826730420958.
Norm before scaling: 44.79244124814755. Distance: 1.1681796492707257
Total norm for 4 adversaries is: 44.79244124814755. distance: 1.1681796492707257
___Train Local_ResNet_18, epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4305/4587 (93.8522%)
___Train Local_ResNet_18, epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4247/4587 (92.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0688, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18, epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4470/4714 (94.8239%)
___Train Local_ResNet_18, epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4442/4714 (94.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9296, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18, epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4421/4672 (94.6276%)
___Train Local_ResNet_18, epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4429/4672 (94.7988%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8641, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18, epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4088/4364 (93.6755%)
___Train Local_ResNet_18, epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4052/4364 (92.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9500, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18, epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3629/3929 (92.3645%)
___Train Local_ResNet_18, epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3592/3929 (91.4228%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9603, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4521/4894 (92.3784%)
___Train Local_ResNet_18, epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4289/4894 (87.6379%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3654, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18, epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4961/5361 (92.5387%)
___Train Local_ResNet_18, epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4847/5361 (90.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0513, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18, epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4340/4549 (95.4056%)
___Train Local_ResNet_18, epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4197/4549 (92.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0063, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18, epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4262/4537 (93.9387%)
___Train Local_ResNet_18, epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4170/4537 (91.9110%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9589, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4822/5068 (95.1460%)
___Train Local_ResNet_18, epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4726/5068 (93.2518%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0258, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18, epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3701/3959 (93.4832%)
___Train Local_ResNet_18, epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3684/3959 (93.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8632, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18, epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5135/5461 (94.0304%)
___Train Local_ResNet_18, epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4988/5461 (91.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2683, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18, epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4395/4736 (92.7998%)
___Train Local_ResNet_18, epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4260/4736 (89.9493%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3001, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18, epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3894/4086 (95.3010%)
___Train Local_ResNet_18, epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3850/4086 (94.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0652, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18, epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3910/4130 (94.6731%)
___Train Local_ResNet_18, epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3868/4130 (93.6562%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9958, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18, epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4209/4368 (96.3599%)
___Train Local_ResNet_18, epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4141/4368 (94.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8867, Accuracy: 5763/10000 (57.6300%)
time spent on training: 214.88745379447937
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5281, Accuracy: 6320/10000 (63.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0333, Accuracy: 9810/9900 (99.0909%)
Done in 242.1740279197693 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.853944562027515.
Norm before scaling: 44.80659937616612. Distance: 1.1231854958605778
Total norm for 4 adversaries is: 44.80659937616612. distance: 1.1231854958605778
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.853944562027515.
Norm before scaling: 44.80351390681804. Distance: 1.2161358894851042
Total norm for 4 adversaries is: 44.80351390681804. distance: 1.2161358894851042
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5036/5123 (98.3018%), train_poison_data_count: 403
Global model norm: 44.853944562027515.
Norm before scaling: 44.80828165074161. Distance: 1.1273446022924003
Total norm for 4 adversaries is: 44.80828165074161. distance: 1.1273446022924003
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.853944562027515.
Norm before scaling: 44.80652581777988. Distance: 1.162834338849627
Total norm for 4 adversaries is: 44.80652581777988. distance: 1.162834338849627
___Train Local_ResNet_18, epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4936/5399 (91.4243%)
___Train Local_ResNet_18, epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4621/5399 (85.5899%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4899, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18, epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3993/4161 (95.9625%)
___Train Local_ResNet_18, epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3890/4161 (93.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9992, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18, epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4514/4731 (95.4132%)
___Train Local_ResNet_18, epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4445/4731 (93.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9753, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18, epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3937/4108 (95.8374%)
___Train Local_ResNet_18, epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3817/4108 (92.9163%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0134, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18, epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5084/5461 (93.0965%)
___Train Local_ResNet_18, epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4950/5461 (90.6427%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4459, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18, epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3789/4028 (94.0665%)
___Train Local_ResNet_18, epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3761/4028 (93.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8772, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18, epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4353/4736 (91.9130%)
___Train Local_ResNet_18, epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4290/4736 (90.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0723, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18, epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5014/5702 (87.9341%)
___Train Local_ResNet_18, epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4604/5702 (80.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5210, Accuracy: 4783/10000 (47.8300%)
___Train Local_ResNet_18, epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5261/5615 (93.6955%)
___Train Local_ResNet_18, epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5161/5615 (91.9145%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0910, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18, epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4172/4485 (93.0212%)
___Train Local_ResNet_18, epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4167/4485 (92.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9615, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18, epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3649/3929 (92.8735%)
___Train Local_ResNet_18, epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3576/3929 (91.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9472, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18, epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4667/4929 (94.6845%)
___Train Local_ResNet_18, epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4506/4929 (91.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3452, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18, epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3318/3552 (93.4122%)
___Train Local_ResNet_18, epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3297/3552 (92.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0046, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18, epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4407/4605 (95.7003%)
___Train Local_ResNet_18, epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4366/4605 (94.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8463, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18, epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4865/5209 (93.3960%)
___Train Local_ResNet_18, epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4694/5209 (90.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1164, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18, epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4531/4869 (93.0581%)
___Train Local_ResNet_18, epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4006/4869 (82.2756%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.8629, Accuracy: 4340/10000 (43.4000%)
time spent on training: 217.2903835773468
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5389, Accuracy: 6307/10000 (63.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0297, Accuracy: 9818/9900 (99.1717%)
Done in 244.40065574645996 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.870650141719864.
Norm before scaling: 44.82325315544935. Distance: 1.0812651748915376
Total norm for 4 adversaries is: 44.82325315544935. distance: 1.0812651748915376
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.870650141719864.
Norm before scaling: 44.81950836497568. Distance: 1.2331883001539037
Total norm for 4 adversaries is: 44.81950836497568. distance: 1.2331883001539037
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 44.870650141719864.
Norm before scaling: 44.825539366439166. Distance: 1.1679466015811242
Total norm for 4 adversaries is: 44.825539366439166. distance: 1.1679466015811242
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5416/5503 (98.4190%), train_poison_data_count: 430
Global model norm: 44.870650141719864.
Norm before scaling: 44.82395441779359. Distance: 1.1630421205045363
Total norm for 4 adversaries is: 44.82395441779359. distance: 1.1630421205045363
___Train Local_ResNet_18, epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4030/4196 (96.0439%)
___Train Local_ResNet_18, epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3981/4196 (94.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8615, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18, epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4784/4993 (95.8141%)
___Train Local_ResNet_18, epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4645/4993 (93.0302%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2317, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18, epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5139/5422 (94.7805%)
___Train Local_ResNet_18, epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4951/5422 (91.3132%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1456, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18, epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4221/4485 (94.1137%)
___Train Local_ResNet_18, epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3973/4485 (88.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2216, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18, epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4181/4527 (92.3570%)
___Train Local_ResNet_18, epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4147/4527 (91.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1272, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18, epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4433/4672 (94.8844%)
___Train Local_ResNet_18, epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4387/4672 (93.8998%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0846, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18, epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4219/4397 (95.9518%)
___Train Local_ResNet_18, epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4209/4397 (95.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8290, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18, epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4789/5075 (94.3645%)
___Train Local_ResNet_18, epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4693/5075 (92.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0357, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18, epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5094/5526 (92.1824%)
___Train Local_ResNet_18, epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4847/5526 (87.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2576, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18, epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5703/6235 (91.4675%)
___Train Local_ResNet_18, epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5470/6235 (87.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3344, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18, epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5976/6664 (89.6759%)
___Train Local_ResNet_18, epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5654/6664 (84.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3218, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18, epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4512/4797 (94.0588%)
___Train Local_ResNet_18, epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4429/4797 (92.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0567, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18, epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4498/4714 (95.4179%)
___Train Local_ResNet_18, epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4516/4714 (95.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8295, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18, epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4422/4737 (93.3502%)
___Train Local_ResNet_18, epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4422/4737 (93.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1094, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18, epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5123/5454 (93.9311%)
___Train Local_ResNet_18, epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4874/5454 (89.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2224, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18, epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4543/4869 (93.3046%)
___Train Local_ResNet_18, epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4206/4869 (86.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2861, Accuracy: 5229/10000 (52.2900%)
time spent on training: 222.69408249855042
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5470, Accuracy: 6275/10000 (62.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0265, Accuracy: 9825/9900 (99.2424%)
Done in 249.46384692192078 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.888638519831076.
Norm before scaling: 44.841966972392335. Distance: 1.1150692151059183
Total norm for 4 adversaries is: 44.841966972392335. distance: 1.1150692151059183
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5688/5777 (98.4594%), train_poison_data_count: 455
Global model norm: 44.888638519831076.
Norm before scaling: 44.83631117525936. Distance: 1.164465763979363
Total norm for 4 adversaries is: 44.83631117525936. distance: 1.164465763979363
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5039/5123 (98.3603%), train_poison_data_count: 403
Global model norm: 44.888638519831076.
Norm before scaling: 44.84210988943247. Distance: 1.093896474567092
Total norm for 4 adversaries is: 44.84210988943247. distance: 1.093896474567092
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.888638519831076.
Norm before scaling: 44.841837666106386. Distance: 1.1980429983558285
Total norm for 4 adversaries is: 44.841837666106386. distance: 1.1980429983558285
___Train Local_ResNet_18, epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4525/4903 (92.2904%)
___Train Local_ResNet_18, epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4439/4903 (90.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3240, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18, epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3924/4086 (96.0352%)
___Train Local_ResNet_18, epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3895/4086 (95.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8718, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18, epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5653/6068 (93.1608%)
___Train Local_ResNet_18, epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5571/6068 (91.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2443, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18, epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4022/4249 (94.6576%)
___Train Local_ResNet_18, epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3928/4249 (92.4453%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9096, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18, epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5701/6235 (91.4354%)
___Train Local_ResNet_18, epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5551/6235 (89.0297%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3332, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18, epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4500/4732 (95.0972%)
___Train Local_ResNet_18, epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4442/4732 (93.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9178, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18, epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5041/5298 (95.1491%)
___Train Local_ResNet_18, epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4983/5298 (94.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0904, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18, epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4711/5038 (93.5093%)
___Train Local_ResNet_18, epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4658/5038 (92.4573%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1687, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18, epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4849/5209 (93.0889%)
___Train Local_ResNet_18, epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4695/5209 (90.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1942, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18, epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5085/5461 (93.1148%)
___Train Local_ResNet_18, epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4924/5461 (90.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4535, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18, epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6345/6947 (91.3344%)
___Train Local_ResNet_18, epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5966/6947 (85.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.6422, Accuracy: 4657/10000 (46.5700%)
___Train Local_ResNet_18, epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5076/5702 (89.0214%)
___Train Local_ResNet_18, epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4710/5702 (82.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2446, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18, epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5142/5526 (93.0510%)
___Train Local_ResNet_18, epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4890/5526 (88.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2032, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18, epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5042/5362 (94.0321%)
___Train Local_ResNet_18, epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4913/5362 (91.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1340, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18, epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4434/4737 (93.6035%)
___Train Local_ResNet_18, epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4340/4737 (91.6192%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2778, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18, epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5279/5727 (92.1774%)
___Train Local_ResNet_18, epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5117/5727 (89.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2038, Accuracy: 5361/10000 (53.6100%)
time spent on training: 225.79907369613647
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5489, Accuracy: 6290/10000 (62.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0249, Accuracy: 9829/9900 (99.2828%)
Done in 252.62392592430115 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.9076376895018.
Norm before scaling: 44.85986072751661. Distance: 1.1210820533062518
Total norm for 4 adversaries is: 44.85986072751661. distance: 1.1210820533062518
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.9076376895018.
Norm before scaling: 44.85672313434813. Distance: 1.208334851538044
Total norm for 4 adversaries is: 44.85672313434813. distance: 1.208334851538044
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 44.9076376895018.
Norm before scaling: 44.865138083308906. Distance: 1.229244143528125
Total norm for 4 adversaries is: 44.865138083308906. distance: 1.229244143528125
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.9076376895018.
Norm before scaling: 44.86121992026493. Distance: 1.2130533744975456
Total norm for 4 adversaries is: 44.86121992026493. distance: 1.2130533744975456
___Train Local_ResNet_18, epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4527/4869 (92.9760%)
___Train Local_ResNet_18, epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0165, Accuracy: 3442/4869 (70.6921%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.6882, Accuracy: 4408/10000 (44.0800%)
___Train Local_ResNet_18, epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4619/4911 (94.0542%)
___Train Local_ResNet_18, epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4483/4911 (91.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1346, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18, epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4292/4537 (94.6000%)
___Train Local_ResNet_18, epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4163/4537 (91.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0837, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18, epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4534/4894 (92.6441%)
___Train Local_ResNet_18, epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4381/4894 (89.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1486, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18, epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4645/5050 (91.9802%)
___Train Local_ResNet_18, epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4538/5050 (89.8614%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9604, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18, epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4515/4732 (95.4142%)
___Train Local_ResNet_18, epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4480/4732 (94.6746%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7763, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18, epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4514/4851 (93.0530%)
___Train Local_ResNet_18, epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4466/4851 (92.0635%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1210, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18, epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5020/5454 (92.0425%)
___Train Local_ResNet_18, epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4919/5454 (90.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1832, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18, epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4511/4818 (93.6281%)
___Train Local_ResNet_18, epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4348/4818 (90.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0623, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18, epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4911/5399 (90.9613%)
___Train Local_ResNet_18, epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4652/5399 (86.1641%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3594, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18, epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4784/5193 (92.1240%)
___Train Local_ResNet_18, epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4476/5193 (86.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3060, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18, epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5356/5696 (94.0309%)
___Train Local_ResNet_18, epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5193/5696 (91.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2478, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18, epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5015/5362 (93.5285%)
___Train Local_ResNet_18, epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4870/5362 (90.8243%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3573, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18, epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5045/5461 (92.3823%)
___Train Local_ResNet_18, epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4943/5461 (90.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2292, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18, epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5122/5702 (89.8281%)
___Train Local_ResNet_18, epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0126, Accuracy: 4325/5702 (75.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4809, Accuracy: 4694/10000 (46.9400%)
___Train Local_ResNet_18, epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4631/4830 (95.8799%)
___Train Local_ResNet_18, epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4511/4830 (93.3954%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2063, Accuracy: 5378/10000 (53.7800%)
time spent on training: 224.13043427467346
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5649, Accuracy: 6274/10000 (62.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0230, Accuracy: 9835/9900 (99.3434%)
Done in 250.9761073589325 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.92738960716572.
Norm before scaling: 44.88076107692192. Distance: 1.149240641122866
Total norm for 4 adversaries is: 44.88076107692192. distance: 1.149240641122866
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5676/5777 (98.2517%), train_poison_data_count: 455
Global model norm: 44.92738960716572.
Norm before scaling: 44.87671779224376. Distance: 1.2048777409021818
Total norm for 4 adversaries is: 44.87671779224376. distance: 1.2048777409021818
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.92738960716572.
Norm before scaling: 44.883646777494306. Distance: 1.2059969127577557
Total norm for 4 adversaries is: 44.883646777494306. distance: 1.2059969127577557
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5413/5503 (98.3645%), train_poison_data_count: 430
Global model norm: 44.92738960716572.
Norm before scaling: 44.8802986948338. Distance: 1.1565854385026626
Total norm for 4 adversaries is: 44.8802986948338. distance: 1.1565854385026626
___Train Local_ResNet_18, epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4283/4537 (94.4016%)
___Train Local_ResNet_18, epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4188/4537 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0079, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18, epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4557/4869 (93.5921%)
___Train Local_ResNet_18, epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4069/4869 (83.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2745, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18, epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5266/5652 (93.1706%)
___Train Local_ResNet_18, epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5122/5652 (90.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4155, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18, epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4581/4889 (93.7001%)
___Train Local_ResNet_18, epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4442/4889 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1577, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18, epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4661/4956 (94.0476%)
___Train Local_ResNet_18, epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4488/4956 (90.5569%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4381, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18, epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4401/4737 (92.9069%)
___Train Local_ResNet_18, epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4337/4737 (91.5558%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1325, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18, epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4936/5361 (92.0724%)
___Train Local_ResNet_18, epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4809/5361 (89.7034%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2499, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18, epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5497/5907 (93.0591%)
___Train Local_ResNet_18, epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5432/5907 (91.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2357, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18, epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3894/4108 (94.7907%)
___Train Local_ResNet_18, epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3768/4108 (91.7235%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0466, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18, epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3967/4161 (95.3377%)
___Train Local_ResNet_18, epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3837/4161 (92.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0529, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18, epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5735/6068 (94.5122%)
___Train Local_ResNet_18, epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5597/6068 (92.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2720, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18, epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5258/5615 (93.6420%)
___Train Local_ResNet_18, epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5142/5615 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1786, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18, epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3663/3959 (92.5234%)
___Train Local_ResNet_18, epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3662/3959 (92.4981%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0212, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18, epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4580/4830 (94.8240%)
___Train Local_ResNet_18, epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4500/4830 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1705, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18, epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4441/4672 (95.0557%)
___Train Local_ResNet_18, epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4457/4672 (95.3981%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8581, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18, epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5097/5559 (91.6892%)
___Train Local_ResNet_18, epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4915/5559 (88.4152%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2336, Accuracy: 5192/10000 (51.9200%)
time spent on training: 220.66276001930237
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5684, Accuracy: 6261/10000 (62.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0231, Accuracy: 9838/9900 (99.3737%)
Done in 247.64874958992004 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.94557798570122.
Norm before scaling: 44.898250581436216. Distance: 1.1206271699287609
Total norm for 4 adversaries is: 44.898250581436216. distance: 1.1206271699287609
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.94557798570122.
Norm before scaling: 44.89354677447737. Distance: 1.1978317838808923
Total norm for 4 adversaries is: 44.89354677447737. distance: 1.1978317838808923
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5017/5123 (97.9309%), train_poison_data_count: 403
Global model norm: 44.94557798570122.
Norm before scaling: 44.90162723030968. Distance: 1.1366811005430084
Total norm for 4 adversaries is: 44.90162723030968. distance: 1.1366811005430084
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.94557798570122.
Norm before scaling: 44.89810376485501. Distance: 1.1895997406495562
Total norm for 4 adversaries is: 44.89810376485501. distance: 1.1895997406495562
___Train Local_ResNet_18, epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4674/5038 (92.7749%)
___Train Local_ResNet_18, epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4592/5038 (91.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0918, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18, epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4182/4368 (95.7418%)
___Train Local_ResNet_18, epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0629, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18, epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4943/5361 (92.2029%)
___Train Local_ResNet_18, epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4812/5361 (89.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2012, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18, epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5504/5907 (93.1776%)
___Train Local_ResNet_18, epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5375/5907 (90.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3556, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18, epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5852/6419 (91.1668%)
___Train Local_ResNet_18, epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5495/6419 (85.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2344, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18, epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5494/5871 (93.5786%)
___Train Local_ResNet_18, epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5314/5871 (90.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2906, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18, epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4380/4605 (95.1140%)
___Train Local_ResNet_18, epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4313/4605 (93.6591%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9874, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18, epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4262/4537 (93.9387%)
___Train Local_ResNet_18, epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4160/4537 (91.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1292, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18, epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4781/5086 (94.0031%)
___Train Local_ResNet_18, epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4679/5086 (91.9976%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9951, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18, epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4515/4851 (93.0736%)
___Train Local_ResNet_18, epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4457/4851 (91.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0758, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18, epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5032/5362 (93.8456%)
___Train Local_ResNet_18, epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4928/5362 (91.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1670, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18, epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4016/4249 (94.5164%)
___Train Local_ResNet_18, epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3894/4249 (91.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0913, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18, epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5148/5454 (94.3894%)
___Train Local_ResNet_18, epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4950/5454 (90.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9991, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18, epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5149/5645 (91.2135%)
___Train Local_ResNet_18, epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4935/5645 (87.4225%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.5418, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18, epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5554/6080 (91.3487%)
___Train Local_ResNet_18, epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5331/6080 (87.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3270, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18, epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5111/5489 (93.1135%)
___Train Local_ResNet_18, epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5007/5489 (91.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0899, Accuracy: 5527/10000 (55.2700%)
time spent on training: 229.58470582962036
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5756, Accuracy: 6240/10000 (62.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0229, Accuracy: 9838/9900 (99.3737%)
Done in 256.3120393753052 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.964551738963635.
Norm before scaling: 44.917439998464125. Distance: 1.1279953710413706
Total norm for 4 adversaries is: 44.917439998464125. distance: 1.1279953710413706
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5692/5777 (98.5286%), train_poison_data_count: 455
Global model norm: 44.964551738963635.
Norm before scaling: 44.91027975351592. Distance: 1.1362595302404535
Total norm for 4 adversaries is: 44.91027975351592. distance: 1.1362595302404535
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5016/5123 (97.9114%), train_poison_data_count: 403
Global model norm: 44.964551738963635.
Norm before scaling: 44.918418345269295. Distance: 1.1205304687933035
Total norm for 4 adversaries is: 44.918418345269295. distance: 1.1205304687933035
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.964551738963635.
Norm before scaling: 44.91760034009497. Distance: 1.1843434593812103
Total norm for 4 adversaries is: 44.91760034009497. distance: 1.1843434593812103
___Train Local_ResNet_18, epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4909/5209 (94.2407%)
___Train Local_ResNet_18, epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4798/5209 (92.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0412, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18, epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4631/4830 (95.8799%)
___Train Local_ResNet_18, epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4546/4830 (94.1201%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0646, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18, epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4508/4714 (95.6300%)
___Train Local_ResNet_18, epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4465/4714 (94.7179%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9982, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18, epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4483/4731 (94.7580%)
___Train Local_ResNet_18, epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4471/4731 (94.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8889, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18, epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4222/4397 (96.0200%)
___Train Local_ResNet_18, epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4209/4397 (95.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7970, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18, epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5528/5939 (93.0796%)
___Train Local_ResNet_18, epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5463/5939 (91.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0562, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18, epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0027, Accuracy: 6474/6812 (95.0382%)
___Train Local_ResNet_18, epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6313/6812 (92.6747%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2661, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18, epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5085/5454 (93.2343%)
___Train Local_ResNet_18, epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4956/5454 (90.8691%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1173, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18, epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5053/5353 (94.3957%)
___Train Local_ResNet_18, epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4849/5353 (90.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1348, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18, epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6376/6947 (91.7806%)
___Train Local_ResNet_18, epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6058/6947 (87.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.5320, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18, epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5068/5298 (95.6587%)
___Train Local_ResNet_18, epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4930/5298 (93.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1814, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4546/4748 (95.7456%)
___Train Local_ResNet_18, epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4476/4748 (94.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0917, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18, epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3941/4130 (95.4237%)
___Train Local_ResNet_18, epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3866/4130 (93.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0718, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18, epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4665/4929 (94.6439%)
___Train Local_ResNet_18, epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4532/4929 (91.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1763, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18, epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5674/6068 (93.5069%)
___Train Local_ResNet_18, epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5507/6068 (90.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4965, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18, epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4396/4736 (92.8209%)
___Train Local_ResNet_18, epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4289/4736 (90.5617%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1464, Accuracy: 5276/10000 (52.7600%)
time spent on training: 228.89587020874023
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.5829, Accuracy: 6239/10000 (62.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0229, Accuracy: 9837/9900 (99.3636%)
Done in 255.81710624694824 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.98195167578326.
Norm before scaling: 44.93306246561726. Distance: 1.0894953126285694
Total norm for 4 adversaries is: 44.93306246561726. distance: 1.0894953126285694
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.98195167578326.
Norm before scaling: 44.92948305139538. Distance: 1.175614557458149
Total norm for 4 adversaries is: 44.92948305139538. distance: 1.175614557458149
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5019/5123 (97.9699%), train_poison_data_count: 403
Global model norm: 44.98195167578326.
Norm before scaling: 44.93692410966175. Distance: 1.1666484502096799
Total norm for 4 adversaries is: 44.93692410966175. distance: 1.1666484502096799
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.98195167578326.
Norm before scaling: 44.93458787504343. Distance: 1.1718119286412632
Total norm for 4 adversaries is: 44.93458787504343. distance: 1.1718119286412632
___Train Local_ResNet_18, epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4685/4956 (94.5319%)
___Train Local_ResNet_18, epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4593/4956 (92.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1448, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4991/5504 (90.6795%)
___Train Local_ResNet_18, epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4805/5504 (87.3001%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2804, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4175/4485 (93.0881%)
___Train Local_ResNet_18, epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3877/4485 (86.4437%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2108, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18, epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5189/5559 (93.3441%)
___Train Local_ResNet_18, epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4937/5559 (88.8109%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1627, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18, epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5081/5346 (95.0430%)
___Train Local_ResNet_18, epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5021/5346 (93.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1992, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18, epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4978/5298 (93.9600%)
___Train Local_ResNet_18, epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4960/5298 (93.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0573, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18, epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4060/4364 (93.0339%)
___Train Local_ResNet_18, epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3932/4364 (90.1008%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0068, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18, epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4726/5055 (93.4916%)
___Train Local_ResNet_18, epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5055 (91.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1528, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18, epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5503/5907 (93.1607%)
___Train Local_ResNet_18, epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5293/5907 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4668, Accuracy: 4855/10000 (48.5500%)
___Train Local_ResNet_18, epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3672/3959 (92.7507%)
___Train Local_ResNet_18, epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3653/3959 (92.2708%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0078, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18, epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4508/4869 (92.5857%)
___Train Local_ResNet_18, epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0129, Accuracy: 3771/4869 (77.4492%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5736, Accuracy: 4676/10000 (46.7600%)
___Train Local_ResNet_18, epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4836/5224 (92.5727%)
___Train Local_ResNet_18, epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4767/5224 (91.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2413, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18, epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4040/4196 (96.2822%)
___Train Local_ResNet_18, epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3989/4196 (95.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7709, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18, epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4732/5038 (93.9262%)
___Train Local_ResNet_18, epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4699/5038 (93.2711%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0940, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18, epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5513/6080 (90.6743%)
___Train Local_ResNet_18, epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5371/6080 (88.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2374, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18, epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5866/6419 (91.3850%)
___Train Local_ResNet_18, epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5545/6419 (86.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4390, Accuracy: 4899/10000 (48.9900%)
time spent on training: 225.15991497039795
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.5932, Accuracy: 6221/10000 (62.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0217, Accuracy: 9842/9900 (99.4141%)
Done in 251.67203283309937 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5226/5308 (98.4552%), train_poison_data_count: 415
Global model norm: 45.00134410970063.
Norm before scaling: 44.95296750059305. Distance: 1.1054062572918488
Total norm for 4 adversaries is: 44.95296750059305. distance: 1.1054062572918488
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 45.00134410970063.
Norm before scaling: 44.94772897315002. Distance: 1.1418277199931588
Total norm for 4 adversaries is: 44.94772897315002. distance: 1.1418277199931588
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5024/5123 (98.0675%), train_poison_data_count: 403
Global model norm: 45.00134410970063.
Norm before scaling: 44.956422856525045. Distance: 1.154169065883819
Total norm for 4 adversaries is: 44.956422856525045. distance: 1.154169065883819
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 45.00134410970063.
Norm before scaling: 44.95390977330281. Distance: 1.1945307550123647
Total norm for 4 adversaries is: 44.95390977330281. distance: 1.1945307550123647
___Train Local_ResNet_18, epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4905/5361 (91.4941%)
___Train Local_ResNet_18, epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4727/5361 (88.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.4151, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18, epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5066/5353 (94.6385%)
___Train Local_ResNet_18, epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4858/5353 (90.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1637, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18, epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5046/5298 (95.2435%)
___Train Local_ResNet_18, epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4930/5298 (93.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1335, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18, epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4418/4737 (93.2658%)
___Train Local_ResNet_18, epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4332/4737 (91.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0960, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18, epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5128/5489 (93.4232%)
___Train Local_ResNet_18, epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5049/5489 (91.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1194, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18, epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4306/4537 (94.9085%)
___Train Local_ResNet_18, epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4198/4537 (92.5281%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1108, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18, epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4184/4527 (92.4232%)
___Train Local_ResNet_18, epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4084/4527 (90.2143%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0799, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18, epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5223/5727 (91.1996%)
___Train Local_ResNet_18, epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4960/5727 (86.6073%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1863, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18, epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4840/5075 (95.3695%)
___Train Local_ResNet_18, epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4725/5075 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1974, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18, epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4566/4843 (94.2804%)
___Train Local_ResNet_18, epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4477/4843 (92.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0336, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18, epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5116/5702 (89.7229%)
___Train Local_ResNet_18, epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0112, Accuracy: 4467/5702 (78.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.7410, Accuracy: 4559/10000 (45.5900%)
___Train Local_ResNet_18, epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3672/3959 (92.7507%)
___Train Local_ResNet_18, epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3641/3959 (91.9677%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9553, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18, epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6421/6812 (94.2601%)
___Train Local_ResNet_18, epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6200/6812 (91.0159%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3077, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18, epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4408/4741 (92.9762%)
___Train Local_ResNet_18, epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3585/4741 (75.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 3.0025, Accuracy: 4049/10000 (40.4900%)
___Train Local_ResNet_18, epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5200/5645 (92.1169%)
___Train Local_ResNet_18, epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4933/5645 (87.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1636, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18, epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3742/3910 (95.7033%)
___Train Local_ResNet_18, epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3631/3910 (92.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1432, Accuracy: 5527/10000 (55.2700%)
time spent on training: 226.3759331703186
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.5820, Accuracy: 6223/10000 (62.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0239, Accuracy: 9833/9900 (99.3232%)
Done in 253.00190234184265 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5233/5308 (98.5870%), train_poison_data_count: 415
Global model norm: 45.0203146962742.
Norm before scaling: 44.96994167548892. Distance: 1.033081797523236
Total norm for 4 adversaries is: 44.96994167548892. distance: 1.033081797523236
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 45.0203146962742.
Norm before scaling: 44.965313237330506. Distance: 1.136621058090659
Total norm for 4 adversaries is: 44.965313237330506. distance: 1.136621058090659
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5020/5123 (97.9895%), train_poison_data_count: 403
Global model norm: 45.0203146962742.
Norm before scaling: 44.974661920282955. Distance: 1.126635898521714
Total norm for 4 adversaries is: 44.974661920282955. distance: 1.126635898521714
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18, epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5410/5503 (98.3100%), train_poison_data_count: 430
Global model norm: 45.0203146962742.
Norm before scaling: 44.97205078226364. Distance: 1.156248298849968
Total norm for 4 adversaries is: 44.97205078226364. distance: 1.156248298849968
___Train Local_ResNet_18, epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5493/5907 (92.9914%)
___Train Local_ResNet_18, epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5377/5907 (91.0276%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.6358, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18, epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4482/4797 (93.4334%)
___Train Local_ResNet_18, epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4451/4797 (92.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9949, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18, epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4558/4843 (94.1152%)
___Train Local_ResNet_18, epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4462/4843 (92.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1957, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18, epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4676/4929 (94.8671%)
___Train Local_ResNet_18, epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4584/4929 (93.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0950, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18, epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4498/4757 (94.5554%)
___Train Local_ResNet_18, epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4350/4757 (91.4442%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2420, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18, epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5198/5652 (91.9674%)
___Train Local_ResNet_18, epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5083/5652 (89.9328%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2934, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18, epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4855/5068 (95.7972%)
___Train Local_ResNet_18, epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4710/5068 (92.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2370, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18, epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5031/5702 (88.2322%)
___Train Local_ResNet_18, epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4692/5702 (82.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3926, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18, epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5182/5422 (95.5736%)
___Train Local_ResNet_18, epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5023/5422 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1116, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18, epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4764/5086 (93.6689%)
___Train Local_ResNet_18, epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4631/5086 (91.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3213, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18, epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4154/4485 (92.6198%)
___Train Local_ResNet_18, epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4026/4485 (89.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1611, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18, epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3920/4130 (94.9153%)
___Train Local_ResNet_18, epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3851/4130 (93.2446%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9698, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18, epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3903/4111 (94.9404%)
___Train Local_ResNet_18, epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3782/4111 (91.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0009, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18, epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4747/5193 (91.4115%)
___Train Local_ResNet_18, epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4479/5193 (86.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5111, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18, epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4525/4731 (95.6457%)
___Train Local_ResNet_18, epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4427/4731 (93.5743%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9402, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18, epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5718/6235 (91.7081%)
___Train Local_ResNet_18, epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5429/6235 (87.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3774, Accuracy: 4952/10000 (49.5200%)
time spent on training: 219.97562670707703
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.5944, Accuracy: 6195/10000 (61.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0265, Accuracy: 9828/9900 (99.2727%)
Done in 246.6465620994568 sec.
Saving all the graphs.
This run has a label: Sep.15_15.31.26. Visdom environment: cifar100_CerP
