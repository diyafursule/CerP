current path: saved_models/model_cifar100_Dec.03_17.47.38_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4307/4885 (88.1679%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439887405231765. Distance: 2.2934310940856917
Total norm for 4 adversaries is: 42.439887405231765. distance: 2.2934310940856917
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4335, Accuracy: 8852/9900 (89.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43532676918858. Distance: 2.2509484940969644
Total norm for 4 adversaries is: 42.43532676918858. distance: 2.2509484940969644
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7209, Accuracy: 8323/9900 (84.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438669270066214. Distance: 2.1764731274485367
Total norm for 4 adversaries is: 42.438669270066214. distance: 2.1764731274485367
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4217, Accuracy: 8900/9900 (89.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44033323108603. Distance: 2.3039157415785008
Total norm for 4 adversaries is: 42.44033323108603. distance: 2.3039157415785008
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6094, Accuracy: 8481/9900 (85.6667%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3835/4356 (88.0395%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3705/4356 (85.0551%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4179, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3937/4465 (88.1747%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4084/4465 (91.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9700, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4042/4647 (86.9808%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9318, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4450/5055 (88.0317%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4531/5055 (89.6340%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1765, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4436/5116 (86.7084%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4491/5116 (87.7834%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0237, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3628/4126 (87.9302%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3769/4126 (91.3476%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9653, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3079/3472 (88.6809%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3221/3472 (92.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0385, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4455/4986 (89.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0978, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7848, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4034/4618 (87.3538%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4089/4618 (88.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0773, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4428/5083 (87.1139%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4437/5083 (87.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1514, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3976/4511 (88.1401%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4047/4511 (89.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1737, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3400/3797 (89.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9823, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5000/5582 (89.5736%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5039/5582 (90.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1157, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3202/3616 (88.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0870, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4828/5455 (88.5060%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4832/5455 (88.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9147, Accuracy: 5372/10000 (53.7200%)
time spent on training: 256.64282751083374
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 89 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 89 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 99 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 99 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 77 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 65 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 65 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 67 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 67 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 61 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 61 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 30 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 30 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 1 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 1 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 69 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 81 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 81 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 12 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 17 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 17 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 52 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 52 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 15 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 15 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 86 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 86 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 40 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1328, Accuracy: 6964/10000 (69.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.7269, Accuracy: 68/9900 (0.6869%)
Done in 283.1005713939667 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.46746370614582.
Norm before scaling: 42.47471961815199. Distance: 2.176501389499311
Total norm for 4 adversaries is: 42.47471961815199. distance: 2.176501389499311
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1941, Accuracy: 9396/9900 (94.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 42.46746370614582.
Norm before scaling: 42.47060823059357. Distance: 2.209801911327051
Total norm for 4 adversaries is: 42.47060823059357. distance: 2.209801911327051
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4717, Accuracy: 8737/9900 (88.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 42.46746370614582.
Norm before scaling: 42.47519812849244. Distance: 2.2155589407258662
Total norm for 4 adversaries is: 42.47519812849244. distance: 2.2155589407258662
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1805, Accuracy: 9452/9900 (95.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.46746370614582.
Norm before scaling: 42.47671984176303. Distance: 2.336728781701239
Total norm for 4 adversaries is: 42.47671984176303. distance: 2.336728781701239
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2313, Accuracy: 9293/9900 (93.8687%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3578/4025 (88.8944%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9101, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3328/3797 (87.6481%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3409/3797 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0695, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3936/4625 (85.1027%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4012/4625 (86.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1181, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3861/4481 (86.1638%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3863/4481 (86.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2593, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3840/4315 (88.9919%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3960/4315 (91.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9626, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3699/4235 (87.3436%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3845/4235 (90.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9444, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3346/3828 (87.4086%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3470/3828 (90.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9440, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3814/4416 (86.3678%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9768, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3143/3638 (86.3936%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3301/3638 (90.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9623, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4518/5265 (85.8120%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4562/5265 (86.6477%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1006, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3352/3781 (88.6538%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3338/3781 (88.2835%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1949, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3967/4441 (89.3267%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4022/4441 (90.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1922, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3961/4433 (89.3526%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4028/4433 (90.8640%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9688, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4405/5083 (86.6614%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0406, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4394/4928 (89.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9429, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4162/4793 (86.8350%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9935, Accuracy: 5468/10000 (54.6800%)
time spent on training: 254.02237033843994
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 78 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 78 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 52 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 52 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 95 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 95 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 7 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 20 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 20 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 73 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 98 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 98 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 74 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 74 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 76 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 9 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 9 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 79 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 79 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 48 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 48 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 33 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 33 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 12 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 16 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 16 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 84 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1381, Accuracy: 6983/10000 (69.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.4339, Accuracy: 77/9900 (0.7778%)
Done in 280.7347927093506 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.49816603350005.
Norm before scaling: 42.50068646044879. Distance: 2.1294801271025876
Total norm for 4 adversaries is: 42.50068646044879. distance: 2.1294801271025876
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2049, Accuracy: 9374/9900 (94.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.49816603350005.
Norm before scaling: 42.50175490402573. Distance: 2.1979488954998483
Total norm for 4 adversaries is: 42.50175490402573. distance: 2.1979488954998483
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0732, Accuracy: 9690/9900 (97.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.49816603350005.
Norm before scaling: 42.502256086717765. Distance: 2.105428550209054
Total norm for 4 adversaries is: 42.502256086717765. distance: 2.105428550209054
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1925, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.49816603350005.
Norm before scaling: 42.50440866380069. Distance: 2.2578378431752397
Total norm for 4 adversaries is: 42.50440866380069. distance: 2.2578378431752397
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1616, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3125/3616 (86.4215%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3289/3616 (90.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9157, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3390/3837 (88.3503%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3494/3837 (91.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9512, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4139/4679 (88.4591%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4249/4679 (90.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9885, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3076/3638 (84.5520%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1208, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3611/4046 (89.2486%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3637/4046 (89.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9598, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3962/4518 (87.6937%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0400, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3347/3797 (88.1485%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3402/3797 (89.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0898, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4398/5025 (87.5224%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4476/5025 (89.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.4249, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3900/4362 (89.4085%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3919/4362 (89.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1022, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3982/4558 (87.3629%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3999/4558 (87.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2217, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3202/3672 (87.2004%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3275/3672 (89.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0900, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4301/4874 (88.2437%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4351/4874 (89.2696%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1194, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3580/4025 (88.9441%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4025 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9001, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4100/4663 (87.9262%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4255/4663 (91.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0672, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3414/3911 (87.2923%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3456/3911 (88.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0619, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4434/5017 (88.3795%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4553/5017 (90.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8019, Accuracy: 5785/10000 (57.8500%)
time spent on training: 250.7307448387146
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 86 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 86 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 39 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 39 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 96 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 76 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 59 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 59 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 34 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 34 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 52 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 52 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 80 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 80 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 90 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 90 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 57 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 57 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 87 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 87 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 82 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 82 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 78 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 78 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 10 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 10 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 18 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 18 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 0 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 0 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1306, Accuracy: 6974/10000 (69.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3057, Accuracy: 75/9900 (0.7576%)
Done in 277.44460105895996 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.529723062230254.
Norm before scaling: 42.53580896074874. Distance: 2.144853077905235
Total norm for 4 adversaries is: 42.53580896074874. distance: 2.144853077905235
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.4934, Accuracy: 8774/9900 (88.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 42.529723062230254.
Norm before scaling: 42.530027306083994. Distance: 2.1480129862913127
Total norm for 4 adversaries is: 42.530027306083994. distance: 2.1480129862913127
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0972, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.529723062230254.
Norm before scaling: 42.531537012257154. Distance: 2.0815848324615276
Total norm for 4 adversaries is: 42.531537012257154. distance: 2.0815848324615276
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1500, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.529723062230254.
Norm before scaling: 42.53651923641613. Distance: 2.2697090959053323
Total norm for 4 adversaries is: 42.53651923641613. distance: 2.2697090959053323
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3206, Accuracy: 9078/9900 (91.6970%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5248/6124 (85.6956%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5323/6124 (86.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2305, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3583/4356 (82.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3686, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3479/4158 (83.6700%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3594/4158 (86.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0386, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4976/5455 (91.2191%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4979/5455 (91.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9075, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3919/4511 (86.8765%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4055/4511 (89.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9283, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4512/5232 (86.2385%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4558/5232 (87.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0058, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4468/5244 (85.2021%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4594/5244 (87.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0085, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4362/4918 (88.6946%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4402/4918 (89.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1273, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3598/4126 (87.2031%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3702/4126 (89.7237%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8381, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4313/4928 (87.5203%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4382/4928 (88.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0275, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3731/4223 (88.3495%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3846/4223 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9364, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4521/5195 (87.0260%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4600/5195 (88.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0965, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4102/4679 (87.6683%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4134/4679 (88.3522%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0047, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3187/3646 (87.4109%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3289/3646 (90.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8588, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3171/3616 (87.6936%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3227/3616 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9168, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4055/4716 (85.9839%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4131/4716 (87.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0481, Accuracy: 5382/10000 (53.8200%)
time spent on training: 258.98419427871704
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 53 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 55 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 91 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 91 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 40 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 17 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 17 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 22 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 22 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 11 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 11 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 3 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 3 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 61 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 61 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 19 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 19 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 27 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 54 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 54 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 96 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 2 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 2 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 86 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 86 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 28 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 28 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1398, Accuracy: 6956/10000 (69.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.4272, Accuracy: 79/9900 (0.7980%)
Done in 285.53853726387024 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.565775158497345.
Norm before scaling: 42.57057415844526. Distance: 2.1436839279803017
Total norm for 4 adversaries is: 42.57057415844526. distance: 2.1436839279803017
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1430, Accuracy: 9538/9900 (96.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 42.565775158497345.
Norm before scaling: 42.56106309523853. Distance: 2.1300015772782337
Total norm for 4 adversaries is: 42.56106309523853. distance: 2.1300015772782337
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.0976, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.565775158497345.
Norm before scaling: 42.56714451301834. Distance: 2.0819051679328195
Total norm for 4 adversaries is: 42.56714451301834. distance: 2.0819051679328195
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1809, Accuracy: 9442/9900 (95.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 42.565775158497345.
Norm before scaling: 42.57535541451034. Distance: 2.288005702084992
Total norm for 4 adversaries is: 42.57535541451034. distance: 2.288005702084992
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2223, Accuracy: 9324/9900 (94.1818%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5269/6124 (86.0385%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5354/6124 (87.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0668, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3946/4433 (89.0142%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3965/4433 (89.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0441, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3360/3781 (88.8654%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3156/3781 (83.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3057, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3555/3969 (89.5692%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3565/3969 (89.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9678, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4431/5025 (88.1791%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4514/5025 (89.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0933, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4137/4679 (88.4163%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4246/4679 (90.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0224, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4153/4707 (88.2303%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4201/4707 (89.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0018, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4386/4986 (87.9663%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4441/4986 (89.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9434, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3889/4315 (90.1275%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3974/4315 (92.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9557, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3802/4416 (86.0960%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3905/4416 (88.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0108, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4203/4804 (87.4896%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4162/4804 (86.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2076, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4254/4793 (88.7544%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4316/4793 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0561, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4521/5232 (86.4106%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4603/5232 (87.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0135, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4096/4662 (87.8593%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4225/4662 (90.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0402, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4237/4956 (85.4923%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4277/4956 (86.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1793, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3820/4368 (87.4542%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3827/4368 (87.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8993, Accuracy: 5407/10000 (54.0700%)
time spent on training: 260.60028886795044
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 53 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 33 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 33 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 79 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 79 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 24 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 24 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 80 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 80 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 96 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 47 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 1 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 1 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 20 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 20 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 74 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 74 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 94 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 94 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 84 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 22 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 22 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 44 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 44 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 46 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 46 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 50 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 50 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1354, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.5995, Accuracy: 70/9900 (0.7071%)
Done in 287.1506016254425 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.59537064735952.
Norm before scaling: 42.59936969989257. Distance: 2.160285821653652
Total norm for 4 adversaries is: 42.59936969989257. distance: 2.160285821653652
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2337, Accuracy: 9302/9900 (93.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.59537064735952.
Norm before scaling: 42.593555116942284. Distance: 2.147675757182518
Total norm for 4 adversaries is: 42.593555116942284. distance: 2.147675757182518
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2157, Accuracy: 9364/9900 (94.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 42.59537064735952.
Norm before scaling: 42.594211410743654. Distance: 2.0449281708803513
Total norm for 4 adversaries is: 42.594211410743654. distance: 2.0449281708803513
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1416, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 42.59537064735952.
Norm before scaling: 42.60418927006328. Distance: 2.2331574864217205
Total norm for 4 adversaries is: 42.60418927006328. distance: 2.2331574864217205
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1731, Accuracy: 9454/9900 (95.4949%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5279/6124 (86.2018%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5332/6124 (87.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1665, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5119/5902 (86.7333%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5205/5902 (88.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1966, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4145/4707 (88.0603%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4174/4707 (88.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0216, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4043/4647 (87.0024%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4159/4647 (89.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9457, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2952/3297 (89.5359%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3027/3297 (91.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7995, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5558/6263 (88.7434%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5669/6263 (90.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2509, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4187/4663 (89.7920%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4257/4663 (91.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1381, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4307/4956 (86.9048%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4322/4956 (87.2074%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1269, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3588/4046 (88.6802%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3702/4046 (91.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9305, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3667/4184 (87.6434%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3819/4184 (91.2763%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8149, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4866/5591 (87.0327%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4911/5591 (87.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1612, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4057/4634 (87.5486%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4178/4634 (90.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0040, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3352/3828 (87.5653%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3507/3828 (91.6144%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9433, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3139/3638 (86.2837%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3274/3638 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8886, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3364/3781 (88.9712%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3352/3781 (88.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1780, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3507/3837 (91.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9173, Accuracy: 5596/10000 (55.9600%)
time spent on training: 258.15929198265076
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 53 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 25 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 25 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 47 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 77 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 68 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 68 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 92 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 92 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 10 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 10 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 46 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 46 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 59 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 59 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 23 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 23 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 32 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 32 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 21 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 21 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 98 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 98 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 76 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 79 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 79 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 39 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 39 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1518, Accuracy: 6942/10000 (69.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.5769, Accuracy: 71/9900 (0.7172%)
Done in 284.96017694473267 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.61898125807986.
Norm before scaling: 42.62350076404814. Distance: 2.1213274242183755
Total norm for 4 adversaries is: 42.62350076404814. distance: 2.1213274242183755
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2724, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 42.61898125807986.
Norm before scaling: 42.62096182301322. Distance: 2.179002223426416
Total norm for 4 adversaries is: 42.62096182301322. distance: 2.179002223426416
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1716, Accuracy: 9469/9900 (95.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 42.61898125807986.
Norm before scaling: 42.62344491756415. Distance: 2.108321428328163
Total norm for 4 adversaries is: 42.62344491756415. distance: 2.108321428328163
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1954, Accuracy: 9419/9900 (95.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 42.61898125807986.
Norm before scaling: 42.623495036207. Distance: 2.207107947713226
Total norm for 4 adversaries is: 42.623495036207. distance: 2.207107947713226
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1832, Accuracy: 9451/9900 (95.4646%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3879/4501 (86.1808%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3902/4501 (86.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0739, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3674/4175 (88.0000%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3717/4175 (89.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0092, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3616 (87.1128%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3235/3616 (89.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8446, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4048/4634 (87.3543%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4105/4634 (88.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0404, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4015/4558 (88.0869%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3988/4558 (87.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1373, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4550/5167 (88.0588%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4623/5167 (89.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1206, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3877/4356 (89.0037%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3829/4356 (87.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2698, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4211/4716 (89.2918%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4237/4716 (89.8431%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0357, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5346/6124 (87.2959%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5276/6124 (86.1528%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9970, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4420/5055 (87.4382%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4530/5055 (89.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1197, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4478/5025 (89.1144%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4547/5025 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1262, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4334/4918 (88.1253%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4368/4918 (88.8166%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1707, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3717/4223 (88.0180%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3796/4223 (89.8887%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9950, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3883/4481 (86.6548%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3825/4481 (85.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1279, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3193/3638 (87.7680%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3298/3638 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8913, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3560/4013 (88.7117%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3676/4013 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9053, Accuracy: 5535/10000 (55.3500%)
time spent on training: 256.25519704818726
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 8 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 8 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 31 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 31 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 86 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 86 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 21 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 21 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 57 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 57 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 35 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 35 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 89 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 89 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 28 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 28 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 53 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 65 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 65 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 80 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 80 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 3 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 3 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 27 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 7 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 76 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 69 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1421, Accuracy: 6960/10000 (69.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.6643, Accuracy: 60/9900 (0.6061%)
Done in 282.6500418186188 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.64302965920251.
Norm before scaling: 42.64653191726512. Distance: 2.112993315932123
Total norm for 4 adversaries is: 42.64653191726512. distance: 2.112993315932123
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2795, Accuracy: 9226/9900 (93.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 42.64302965920251.
Norm before scaling: 42.643227178753136. Distance: 2.204780768051204
Total norm for 4 adversaries is: 42.643227178753136. distance: 2.204780768051204
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2511, Accuracy: 9301/9900 (93.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.64302965920251.
Norm before scaling: 42.64511931243568. Distance: 2.0583792471558953
Total norm for 4 adversaries is: 42.64511931243568. distance: 2.0583792471558953
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3605, Accuracy: 9028/9900 (91.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 42.64302965920251.
Norm before scaling: 42.649103682514536. Distance: 2.2260659182745828
Total norm for 4 adversaries is: 42.649103682514536. distance: 2.2260659182745828
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1584, Accuracy: 9467/9900 (95.6263%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3175/3646 (87.0817%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3281/3646 (89.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8629, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3903/4501 (86.7141%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4010/4501 (89.0913%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0921, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4075/4651 (87.6156%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4188/4651 (90.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0239, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4584/5167 (88.7169%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4655/5167 (90.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0420, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4963/5455 (90.9808%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4977/5455 (91.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0006, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4867/5591 (87.0506%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4906/5591 (87.7482%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9321, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4178/4679 (89.2926%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4174/4679 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0260, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4547/5017 (90.6319%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4580/5017 (91.2896%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9167, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4311/4793 (89.9437%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4364/4793 (91.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0514, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4008/4456 (89.9461%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4072/4456 (91.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9427, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4804/5424 (88.5693%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4915/5424 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2060, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3644/4175 (87.2814%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3647/4175 (87.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9946, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4530/5116 (88.5457%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4559/5116 (89.1126%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1066, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3288/3704 (88.7689%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3373/3704 (91.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8998, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4506/5232 (86.1239%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4637/5232 (88.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0063, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3080/3472 (88.7097%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3149/3472 (90.6970%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0311, Accuracy: 5470/10000 (54.7000%)
time spent on training: 259.8153042793274
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 2 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 2 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 8 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 8 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 93 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 93 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 35 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 35 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 40 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 32 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 32 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 96 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 0 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 0 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 84 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 66 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 66 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 42 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 42 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 31 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 31 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 67 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 67 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 4 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 4 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 22 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 22 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 30 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 30 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1342, Accuracy: 6984/10000 (69.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.6565, Accuracy: 59/9900 (0.5960%)
Done in 286.3999445438385 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.66282859069913.
Norm before scaling: 42.664772786387395. Distance: 2.0950632104919964
Total norm for 4 adversaries is: 42.664772786387395. distance: 2.0950632104919964
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3471, Accuracy: 9032/9900 (91.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 42.66282859069913.
Norm before scaling: 42.66268695708742. Distance: 2.169365180544774
Total norm for 4 adversaries is: 42.66268695708742. distance: 2.169365180544774
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1732, Accuracy: 9471/9900 (95.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 42.66282859069913.
Norm before scaling: 42.66502170570686. Distance: 2.0664469781622534
Total norm for 4 adversaries is: 42.66502170570686. distance: 2.0664469781622534
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1726, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.66282859069913.
Norm before scaling: 42.66988392462095. Distance: 2.2265985854052284
Total norm for 4 adversaries is: 42.66988392462095. distance: 2.2265985854052284
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3027, Accuracy: 9111/9900 (92.0303%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3207/3590 (89.3315%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3305/3590 (92.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9962, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3908/4368 (89.4689%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3917/4368 (89.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9126, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3262/3704 (88.0670%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3341/3704 (90.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9005, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4336/4928 (87.9870%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4340/4928 (88.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1113, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3889/4356 (89.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1664, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3448/3911 (88.1616%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3322/3911 (84.9399%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2395, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4094/4651 (88.0241%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4171/4651 (89.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1880, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3710/4184 (88.6711%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3767/4184 (90.0335%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8600, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3914/4346 (90.0598%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3995/4346 (91.9236%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9575, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4285/4793 (89.4012%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9713, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3389/3804 (89.0904%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3483/3804 (91.5615%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9090, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4450/4986 (89.2499%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4475/4986 (89.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9180, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5332/6124 (87.0673%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5315/6124 (86.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0712, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4116/4707 (87.4442%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4249/4707 (90.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9473, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3788/4235 (89.4451%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3728/4235 (88.0283%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1401, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3618/4046 (89.4217%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3702/4046 (91.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0624, Accuracy: 5311/10000 (53.1100%)
time spent on training: 254.80091047286987
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 63 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 63 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 50 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 50 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 4 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 4 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 19 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 19 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 55 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 18 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 18 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 93 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 93 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 23 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 23 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 29 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 29 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 84 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 60 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 60 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 1 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 1 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 53 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 47 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 73 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 59 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 59 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1226, Accuracy: 7009/10000 (70.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.3925, Accuracy: 53/9900 (0.5354%)
Done in 281.1914050579071 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 42.68551680285202.
Norm before scaling: 42.687693024362275. Distance: 2.096422567890453
Total norm for 4 adversaries is: 42.687693024362275. distance: 2.096422567890453
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1098, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4754/5305 (89.6136%), train_poison_data_count: 415
Global model norm: 42.68551680285202.
Norm before scaling: 42.689503121467844. Distance: 2.1839374415063006
Total norm for 4 adversaries is: 42.689503121467844. distance: 2.1839374415063006
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1092, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.68551680285202.
Norm before scaling: 42.68488908102462. Distance: 2.040887242710208
Total norm for 4 adversaries is: 42.68488908102462. distance: 2.040887242710208
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3963, Accuracy: 8979/9900 (90.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.68551680285202.
Norm before scaling: 42.69315310756076. Distance: 2.2464025135941856
Total norm for 4 adversaries is: 42.69315310756076. distance: 2.2464025135941856
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3226, Accuracy: 9076/9900 (91.6768%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4395/4986 (88.1468%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4482/4986 (89.8917%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9171, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4022/4634 (86.7933%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4117/4634 (88.8433%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9503, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4250/4716 (90.1187%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4276/4716 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9687, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5265/6124 (85.9732%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5396/6124 (88.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0802, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4385/4918 (89.1623%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4477/4918 (91.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0736, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3370/3797 (88.7543%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3421/3797 (90.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0669, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4966/5582 (88.9645%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5057/5582 (90.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0845, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4300/4956 (86.7635%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4317/4956 (87.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1371, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3976/4433 (89.6910%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4010/4433 (90.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8940, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3822/4354 (87.7814%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3359/4354 (77.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3984, Accuracy: 4765/10000 (47.6500%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4301/4928 (87.2768%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4394/4928 (89.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9894, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3452/3911 (88.2639%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3467/3911 (88.6474%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0498, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3834/4481 (85.5613%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3845/4481 (85.8067%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0546, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4556/5197 (87.6660%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4569/5197 (87.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1026, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4895/5455 (89.7342%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9796, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3807/4361 (87.2965%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3771/4361 (86.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2161, Accuracy: 5080/10000 (50.8000%)
time spent on training: 261.03254652023315
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 1 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 1 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 21 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 21 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 28 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 28 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 53 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 3 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 3 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 52 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 52 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 15 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 15 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 46 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 46 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 33 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 33 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 37 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 16 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 16 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 18 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 18 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 7 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 49 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 49 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 40 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 97 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 97 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1366, Accuracy: 6944/10000 (69.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.3033, Accuracy: 58/9900 (0.5859%)
Done in 287.4573848247528 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 42.71951295496444.
Norm before scaling: 42.72347752965063. Distance: 2.088779071306496
Total norm for 4 adversaries is: 42.72347752965063. distance: 2.088779071306496
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1624, Accuracy: 9503/9900 (95.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 42.71951295496444.
Norm before scaling: 42.72019588811304. Distance: 2.129104241079982
Total norm for 4 adversaries is: 42.72019588811304. distance: 2.129104241079982
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2493, Accuracy: 9280/9900 (93.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.71951295496444.
Norm before scaling: 42.719435802834525. Distance: 2.031163140420515
Total norm for 4 adversaries is: 42.719435802834525. distance: 2.031163140420515
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1936, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.71951295496444.
Norm before scaling: 42.726138945834435. Distance: 2.2492468951081848
Total norm for 4 adversaries is: 42.726138945834435. distance: 2.2492468951081848
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2520, Accuracy: 9279/9900 (93.7273%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4309/4928 (87.4391%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9833, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3753/4184 (89.6989%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3786/4184 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8627, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4201/4707 (89.2501%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4247/4707 (90.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0090, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3520/3828 (91.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9560, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3958/4503 (87.8970%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3970/4503 (88.1634%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0512, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4154/4662 (89.1034%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4232/4662 (90.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9793, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3720/4235 (87.8394%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3756/4235 (88.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0555, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4402/5244 (83.9436%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4503/5244 (85.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0184, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4269/4793 (89.0674%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4390/4793 (91.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9535, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3911/4481 (87.2796%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3854/4481 (86.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0934, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3913/4346 (90.0368%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4013/4346 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7918, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3931/4361 (90.1399%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3774/4361 (86.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1957, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4521/5055 (89.4362%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4541/5055 (89.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1062, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4548/5195 (87.5457%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4588/5195 (88.3157%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1389, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3910/4315 (90.6141%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3985/4315 (92.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9741, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4175/4663 (89.5346%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4267/4663 (91.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1124, Accuracy: 5279/10000 (52.7900%)
time spent on training: 255.58787989616394
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 19 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 19 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 23 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 23 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 47 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 98 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 98 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 64 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 64 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 44 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 44 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 73 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 11 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 11 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 84 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 7 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 29 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 29 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 97 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 97 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 65 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 65 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 54 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 54 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 20 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 20 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 10 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 10 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1299, Accuracy: 7004/10000 (70.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.5603, Accuracy: 41/9900 (0.4141%)
Done in 282.52300357818604 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 42.74677750783897.
Norm before scaling: 42.7521072671424. Distance: 2.0763357390281976
Total norm for 4 adversaries is: 42.7521072671424. distance: 2.0763357390281976
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2706, Accuracy: 9235/9900 (93.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.74677750783897.
Norm before scaling: 42.75105650193045. Distance: 2.173600533662463
Total norm for 4 adversaries is: 42.75105650193045. distance: 2.173600533662463
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3575, Accuracy: 9049/9900 (91.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 42.74677750783897.
Norm before scaling: 42.746184954040054. Distance: 2.0111597562261125
Total norm for 4 adversaries is: 42.746184954040054. distance: 2.0111597562261125
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2008, Accuracy: 9396/9900 (94.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4531/5066 (89.4394%), train_poison_data_count: 400
Global model norm: 42.74677750783897.
Norm before scaling: 42.75213439253282. Distance: 2.19417338836641
Total norm for 4 adversaries is: 42.75213439253282. distance: 2.19417338836641
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1886, Accuracy: 9419/9900 (95.1414%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3959/4315 (91.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9764, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3246/3590 (90.4178%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3209/3590 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2632, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4165/4679 (89.0147%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4241/4679 (90.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9720, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4621/5167 (89.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0780, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3381/3775 (89.5629%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3520/3775 (93.2450%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7950, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3388/3828 (88.5057%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3491/3828 (91.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8359, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3760/4235 (88.7839%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3851/4235 (90.9327%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8860, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4104/4647 (88.3150%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4191/4647 (90.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9451, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4345/4918 (88.3489%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4428/4918 (90.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0528, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3962/4433 (89.3751%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3977/4433 (89.7135%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9825, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3882/4481 (86.6324%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3876/4481 (86.4985%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2258, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3789/4295 (88.2189%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3741/4295 (87.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2890, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3977/4503 (88.3189%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4029/4503 (89.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9216, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3808/4354 (87.4598%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3691/4354 (84.7726%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4099, Accuracy: 4864/10000 (48.6400%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4429/4986 (88.8287%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4445/4986 (89.1496%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9798, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5579/6263 (89.0787%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5688/6263 (90.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0637, Accuracy: 5351/10000 (53.5100%)
time spent on training: 252.87132143974304
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 20 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 20 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 63 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 63 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 96 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 35 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 35 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 51 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 51 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 98 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 98 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 73 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 77 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 3 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 3 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 33 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 33 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 7 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 75 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 75 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 64 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 64 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 37 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 1 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 1 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 92 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 92 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1349, Accuracy: 6950/10000 (69.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.5843, Accuracy: 44/9900 (0.4444%)
Done in 279.37702345848083 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.78536577398939.
Norm before scaling: 42.787952017952726. Distance: 2.1206909696490954
Total norm for 4 adversaries is: 42.787952017952726. distance: 2.1206909696490954
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1942, Accuracy: 9422/9900 (95.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 42.78536577398939.
Norm before scaling: 42.78976215308035. Distance: 2.2592728587762108
Total norm for 4 adversaries is: 42.78976215308035. distance: 2.2592728587762108
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0718, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.78536577398939.
Norm before scaling: 42.78669957073401. Distance: 2.033611861158186
Total norm for 4 adversaries is: 42.78669957073401. distance: 2.033611861158186
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1335, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 42.78536577398939.
Norm before scaling: 42.789787828205135. Distance: 2.2070586886430426
Total norm for 4 adversaries is: 42.789787828205135. distance: 2.2070586886430426
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0814, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3713/4223 (87.9233%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3834/4223 (90.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9866, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4968/5455 (91.0724%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4844/5455 (88.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1238, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5066/5582 (90.7560%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5095/5582 (91.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2329, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4015/4465 (89.9216%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4054/4465 (90.7951%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8301, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4905/5591 (87.7303%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4945/5591 (88.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1488, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3461/3911 (88.4940%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3363/3911 (85.9882%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0526, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3904/4356 (89.6235%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0115, Accuracy: 3482/4356 (79.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.7767, Accuracy: 4416/10000 (44.1600%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4439/5037 (88.1279%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4524/5037 (89.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9737, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4176/4679 (89.2498%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4237/4679 (90.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0840, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3944/4362 (90.4172%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3941/4362 (90.3485%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0973, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4081/4518 (90.3276%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4129/4518 (91.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8989, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4465/5083 (87.8418%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4458/5083 (87.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2696, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3631/4013 (90.4809%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3729/4013 (92.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8665, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4581/5197 (88.1470%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4582/5197 (88.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1955, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2957/3297 (89.6876%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3055/3297 (92.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7534, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3991/4441 (89.8671%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4039/4441 (90.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1297, Accuracy: 5341/10000 (53.4100%)
time spent on training: 258.6842591762543
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 27 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 40 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 15 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 15 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 99 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 99 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 32 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 32 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 18 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 18 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 55 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 45 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 45 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 96 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 90 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 90 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 34 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 34 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 12 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 69 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 49 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 49 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 68 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 68 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 48 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 48 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1487, Accuracy: 6931/10000 (69.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.4905, Accuracy: 43/9900 (0.4343%)
Done in 285.100515127182 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.81270956837394.
Norm before scaling: 42.813881421599845. Distance: 2.0997293979139577
Total norm for 4 adversaries is: 42.813881421599845. distance: 2.0997293979139577
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2564, Accuracy: 9279/9900 (93.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 42.81270956837394.
Norm before scaling: 42.81296333006584. Distance: 2.162518001768122
Total norm for 4 adversaries is: 42.81296333006584. distance: 2.162518001768122
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2558, Accuracy: 9303/9900 (93.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 42.81270956837394.
Norm before scaling: 42.8119268894122. Distance: 2.0189234042023814
Total norm for 4 adversaries is: 42.8119268894122. distance: 2.0189234042023814
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3786, Accuracy: 8944/9900 (90.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 42.81270956837394.
Norm before scaling: 42.81521575556186. Distance: 2.203413924081765
Total norm for 4 adversaries is: 42.81521575556186. distance: 2.203413924081765
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2264, Accuracy: 9312/9900 (94.0606%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3986/4501 (88.5581%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4048/4501 (89.9356%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0739, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3985/4511 (88.3396%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4083/4511 (90.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9623, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3818/4354 (87.6895%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3455/4354 (79.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4136, Accuracy: 4640/10000 (46.4000%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3921/4346 (90.2209%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4026/4346 (92.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8885, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4170/4707 (88.5915%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4258/4707 (90.4610%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8896, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4894/5591 (87.5335%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4928/5591 (88.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9355, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4064/4647 (87.4543%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4171/4647 (89.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8434, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4094/4538 (90.2160%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4184/4538 (92.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8650, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4343/4934 (88.0219%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4358/4934 (88.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1041, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4284/4804 (89.1757%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4175/4804 (86.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1007, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5745/6263 (91.7292%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5697/6263 (90.9628%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2052, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3905/4481 (87.1457%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3953/4481 (88.2169%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9940, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4395/5063 (86.8062%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4382/5063 (86.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9816, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3699/4223 (87.5918%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9838, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4112/4441 (92.5918%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4166/4441 (93.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9237, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3374/3756 (89.8296%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3464/3756 (92.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8838, Accuracy: 5708/10000 (57.0800%)
time spent on training: 259.1053183078766
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 8 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 8 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 17 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 17 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 37 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 29 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 29 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 47 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 32 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 32 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 77 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 6 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 6 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 88 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 88 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 94 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 94 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 92 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 92 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 7 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 62 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 62 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 27 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 48 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 48 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 26 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 26 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1531, Accuracy: 6907/10000 (69.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.5890, Accuracy: 42/9900 (0.4242%)
Done in 285.47172021865845 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 42.83490232767988.
Norm before scaling: 42.83864820782091. Distance: 2.118252644636614
Total norm for 4 adversaries is: 42.83864820782091. distance: 2.118252644636614
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1747, Accuracy: 9472/9900 (95.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.83490232767988.
Norm before scaling: 42.83430814314109. Distance: 2.204167545465055
Total norm for 4 adversaries is: 42.83430814314109. distance: 2.204167545465055
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0646, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 42.83490232767988.
Norm before scaling: 42.836922778427954. Distance: 2.0353750744581665
Total norm for 4 adversaries is: 42.836922778427954. distance: 2.0353750744581665
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3180, Accuracy: 9089/9900 (91.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 42.83490232767988.
Norm before scaling: 42.83775629345931. Distance: 2.1647110941402206
Total norm for 4 adversaries is: 42.83775629345931. distance: 2.1647110941402206
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3560, Accuracy: 8993/9900 (90.8384%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4438/5244 (84.6301%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4523/5244 (86.2510%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9319, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4365/4928 (88.5755%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4433/4928 (89.9554%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8832, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3388/3804 (89.0641%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3457/3804 (90.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8949, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3689/4013 (91.9262%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8182, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3565/4158 (85.7383%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3616/4158 (86.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0487, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5018/5582 (89.8961%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5003/5582 (89.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0612, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4913/5455 (90.0642%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4944/5455 (90.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8782, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3840/4354 (88.1948%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3448/4354 (79.1915%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6392, Accuracy: 4632/10000 (46.3200%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3979/4433 (89.7586%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9200, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3199/3646 (87.7400%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3322/3646 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9204, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4059/4518 (89.8406%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4124/4518 (91.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0608, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3797/4235 (89.6576%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3726/4235 (87.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1652, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3960/4362 (90.7840%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3890/4362 (89.1793%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1176, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4797/5392 (88.9651%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4741/5392 (87.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2444, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4887/5591 (87.4083%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4917/5591 (87.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1245, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3471/3756 (92.4121%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3503/3756 (93.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9673, Accuracy: 5591/10000 (55.9100%)
time spent on training: 260.63636684417725
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 11 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 11 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 16 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 16 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 60 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 60 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 69 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 91 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 91 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 15 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 15 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 40 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 37 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 33 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 33 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 2 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 2 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 34 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 34 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 73 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 90 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 90 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 70 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 70 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 32 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 32 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 26 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 26 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1645, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.4456, Accuracy: 56/9900 (0.5657%)
Done in 286.9933307170868 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.85478779452843.
Norm before scaling: 42.85975665160005. Distance: 2.1255676408951345
Total norm for 4 adversaries is: 42.85975665160005. distance: 2.1255676408951345
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1492, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.85478779452843.
Norm before scaling: 42.85548851089919. Distance: 2.2065137408338904
Total norm for 4 adversaries is: 42.85548851089919. distance: 2.2065137408338904
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0182, Accuracy: 9843/9900 (99.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 42.85478779452843.
Norm before scaling: 42.85762761886369. Distance: 2.0414720818831684
Total norm for 4 adversaries is: 42.85762761886369. distance: 2.0414720818831684
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1648, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4502/5066 (88.8670%), train_poison_data_count: 400
Global model norm: 42.85478779452843.
Norm before scaling: 42.86085601706556. Distance: 2.2779644861174213
Total norm for 4 adversaries is: 42.86085601706556. distance: 2.2779644861174213
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1233, Accuracy: 9575/9900 (96.7172%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4132/4634 (89.1670%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4150/4634 (89.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1445, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4019/4503 (89.2516%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4028/4503 (89.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9593, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4326/4928 (87.7841%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4442/4928 (90.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8101, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3345/3804 (87.9338%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3443/3804 (90.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8980, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3235/3590 (90.1114%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3108/3590 (86.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2099, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4124/4647 (88.7454%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4246/4647 (91.3708%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8978, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4008/4625 (86.6595%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4053/4625 (87.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0750, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3875/4356 (88.9578%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3834/4356 (88.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1472, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3371/3797 (88.7806%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3498/3797 (92.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0004, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3967/4456 (89.0260%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9162, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3577/4025 (88.8696%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3721/4025 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8314, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3225/3472 (92.8859%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3195/3472 (92.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9288, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3005/3297 (91.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9749, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3871/4416 (87.6585%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3986/4416 (90.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9181, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3911/4356 (89.7842%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4028/4356 (92.4702%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9798, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3158/3638 (86.8059%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3316/3638 (91.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8373, Accuracy: 5623/10000 (56.2300%)
time spent on training: 250.8268060684204
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 21 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 21 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 64 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 64 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 16 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 16 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 60 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 60 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 63 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 63 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 77 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 95 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 95 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 55 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 52 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 52 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 66 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 66 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 78 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 78 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 30 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 30 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 68 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 68 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 74 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 74 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 89 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 89 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 76 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1616, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.2727, Accuracy: 65/9900 (0.6566%)
Done in 277.6513686180115 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 42.87647763033217.
Norm before scaling: 42.88325016286954. Distance: 2.1796600449449772
Total norm for 4 adversaries is: 42.88325016286954. distance: 2.1796600449449772
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2334, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 42.87647763033217.
Norm before scaling: 42.87985121971624. Distance: 2.1895558097505647
Total norm for 4 adversaries is: 42.87985121971624. distance: 2.1895558097505647
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1998, Accuracy: 9400/9900 (94.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.87647763033217.
Norm before scaling: 42.87333440186773. Distance: 2.0106856276573475
Total norm for 4 adversaries is: 42.87333440186773. distance: 2.0106856276573475
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1614, Accuracy: 9487/9900 (95.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 42.87647763033217.
Norm before scaling: 42.883059442038125. Distance: 2.2110108272402984
Total norm for 4 adversaries is: 42.883059442038125. distance: 2.2110108272402984
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1337, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3717/4175 (89.0299%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3751/4175 (89.8443%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9638, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4302/4956 (86.8039%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4458/4956 (89.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1162, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4453/5037 (88.4058%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4552/5037 (90.3713%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9495, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4272/4793 (89.1300%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4340/4793 (90.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0562, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3343/3804 (87.8812%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3399/3804 (89.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0678, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4804/5392 (89.0950%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4778/5392 (88.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1765, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4022/4465 (90.0784%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4080/4465 (91.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8689, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4118/4596 (89.5997%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4166/4596 (90.6440%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0369, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5291/6124 (86.3978%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5390/6124 (88.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0683, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2880/3271 (88.0465%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2945/3271 (90.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0295, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3217/3590 (89.6100%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3222/3590 (89.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1468, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3928/4501 (87.2695%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3974/4501 (88.2915%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1656, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4596/5232 (87.8440%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4608/5232 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0206, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3246/3672 (88.3987%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3280/3672 (89.3246%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0706, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3782/4223 (89.5572%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3818/4223 (90.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1427, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3839/4354 (88.1718%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0139, Accuracy: 3232/4354 (74.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5904, Accuracy: 4621/10000 (46.2100%)
time spent on training: 255.84591221809387
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 31 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 31 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 46 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 46 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 45 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 45 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 84 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 60 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 60 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 70 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 70 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 99 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 99 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 5 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 5 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 53 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 83 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 83 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 63 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 63 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 8 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 8 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 22 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 22 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 87 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 87 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 27 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 37 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2319, Accuracy: 6821/10000 (68.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 8.7533, Accuracy: 172/9900 (1.7374%)
Done in 282.21818804740906 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 42.927345107842534.
Norm before scaling: 42.929321398575446. Distance: 2.071411301865021
Total norm for 4 adversaries is: 42.929321398575446. distance: 2.071411301865021
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2519, Accuracy: 9290/9900 (93.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.927345107842534.
Norm before scaling: 42.927993454974256. Distance: 2.167379213199341
Total norm for 4 adversaries is: 42.927993454974256. distance: 2.167379213199341
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1228, Accuracy: 9576/9900 (96.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 42.927345107842534.
Norm before scaling: 42.93173689944451. Distance: 2.155661350562023
Total norm for 4 adversaries is: 42.93173689944451. distance: 2.155661350562023
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0973, Accuracy: 9630/9900 (97.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 42.927345107842534.
Norm before scaling: 42.93433707191352. Distance: 2.2137755386369977
Total norm for 4 adversaries is: 42.93433707191352. distance: 2.2137755386369977
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1342, Accuracy: 9563/9900 (96.5960%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5007/5582 (89.6990%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5005/5582 (89.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0049, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4057/4647 (87.3036%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4218/4647 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0051, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3998/4465 (89.5409%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4093/4465 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9740, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4464/5083 (87.8222%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4441/5083 (87.3697%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1363, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3792/4416 (85.8696%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3920/4416 (88.7681%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9285, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4270/4956 (86.1582%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4359/4956 (87.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1709, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3964/4362 (90.8757%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3930/4362 (90.0963%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9046, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3857/4356 (88.5445%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3784/4356 (86.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2635, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3344/3781 (88.4422%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3430/3781 (90.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1094, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3222/3590 (89.7493%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3207/3590 (89.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1297, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4116/4651 (88.4971%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4233/4651 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0041, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4158/4662 (89.1892%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4223/4662 (90.5834%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9756, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3181/3472 (91.6187%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3248/3472 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8394, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4831/5424 (89.0671%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4929/5424 (90.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1878, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2890/3271 (88.3522%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0073, Accuracy: 2790/3271 (85.2950%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0848, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4423/5037 (87.8102%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4525/5037 (89.8352%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8925, Accuracy: 5615/10000 (56.1500%)
time spent on training: 254.9660358428955
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 15 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 15 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 77 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 99 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 99 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 12 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 74 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 74 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 46 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 46 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 90 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 90 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 55 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 79 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 79 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 63 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 63 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 93 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 93 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 44 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 44 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 30 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 30 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 42 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 42 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 83 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 83 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 45 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 45 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2141, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.9865, Accuracy: 126/9900 (1.2727%)
Done in 281.44435572624207 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 42.957778428813825.
Norm before scaling: 42.96029888482432. Distance: 2.0980728843836753
Total norm for 4 adversaries is: 42.96029888482432. distance: 2.0980728843836753
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2230, Accuracy: 9321/9900 (94.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 42.957778428813825.
Norm before scaling: 42.96131185620674. Distance: 2.205691959167869
Total norm for 4 adversaries is: 42.96131185620674. distance: 2.205691959167869
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1751, Accuracy: 9441/9900 (95.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 42.957778428813825.
Norm before scaling: 42.95229088177006. Distance: 1.9588242652705026
Total norm for 4 adversaries is: 42.95229088177006. distance: 1.9588242652705026
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3408, Accuracy: 9072/9900 (91.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.957778428813825.
Norm before scaling: 42.96395427783039. Distance: 2.2090457870621782
Total norm for 4 adversaries is: 42.96395427783039. distance: 2.2090457870621782
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.5548, Accuracy: 8559/9900 (86.4545%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4340/4989 (86.9914%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4431/4989 (88.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0685, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3657/4013 (91.1288%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3742/4013 (93.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7932, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4567/5195 (87.9115%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4476/5195 (86.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2327, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3523/3969 (88.7629%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3570/3969 (89.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9110, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3915/4356 (89.8760%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3769/4356 (86.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2834, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4059/4441 (91.3983%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4110/4441 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9129, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4024/4518 (89.0660%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4128/4518 (91.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8617, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3445/3911 (88.0849%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3245/3911 (82.9711%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2452, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3947/4362 (90.4860%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3859/4362 (88.4686%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2061, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3393/3804 (89.1956%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3498/3804 (91.9558%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9740, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3768/4223 (89.2257%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3867/4223 (91.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9962, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4126/4634 (89.0375%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4168/4634 (89.9439%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8271, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3942/4354 (90.5374%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0149, Accuracy: 3198/4354 (73.4497%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.7033, Accuracy: 4371/10000 (43.7100%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4439/5244 (84.6491%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4535/5244 (86.4798%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8696, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4532/5037 (89.9742%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4624/5037 (91.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9520, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3224/3704 (87.0410%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3356/3704 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9617, Accuracy: 5491/10000 (54.9100%)
time spent on training: 255.59209537506104
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 56 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 56 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 69 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 54 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 54 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 24 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 24 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 55 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 48 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 48 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 34 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 34 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 18 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 18 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 90 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 90 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 60 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 60 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 27 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 27 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 21 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 21 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 37 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 37 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 11 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 11 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 45 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 45 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 4 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 4 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2051, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.0078, Accuracy: 119/9900 (1.2020%)
Done in 282.43387508392334 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.981583310835.
Norm before scaling: 42.986237918555105. Distance: 2.1033310946509554
Total norm for 4 adversaries is: 42.986237918555105. distance: 2.1033310946509554
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2093, Accuracy: 9401/9900 (94.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 42.981583310835.
Norm before scaling: 42.98529369020075. Distance: 2.204045637686332
Total norm for 4 adversaries is: 42.98529369020075. distance: 2.204045637686332
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1110, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 42.981583310835.
Norm before scaling: 42.97843214779726. Distance: 1.97333664443838
Total norm for 4 adversaries is: 42.97843214779726. distance: 1.97333664443838
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2133, Accuracy: 9329/9900 (94.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 42.981583310835.
Norm before scaling: 42.98538030449277. Distance: 2.175421584037986
Total norm for 4 adversaries is: 42.98538030449277. distance: 2.175421584037986
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2858, Accuracy: 9203/9900 (92.9596%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3840/4416 (86.9565%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3961/4416 (89.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9288, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4575/5197 (88.0316%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4597/5197 (88.4549%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0808, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4339/4918 (88.2269%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4438/4918 (90.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0947, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5700/6263 (91.0107%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5675/6263 (90.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0245, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3211/3646 (88.0691%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3314/3646 (90.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7531, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4212/4707 (89.4837%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4267/4707 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8870, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4393/5063 (86.7667%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4211/5063 (83.1720%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2334, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3791/4295 (88.2654%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3854/4295 (89.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9688, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4307/4793 (89.8602%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9860, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4074/4538 (89.7752%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4207/4538 (92.7060%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9416, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4483/5083 (88.1959%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4569/5083 (89.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9643, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3245/3638 (89.1974%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3275/3638 (90.0220%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8107, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5354/6124 (87.4265%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5395/6124 (88.0960%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2007, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4109/4618 (88.9779%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4092/4618 (88.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0364, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3545/3969 (89.3172%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3581/3969 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9036, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3575/4158 (85.9788%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3639/4158 (87.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9924, Accuracy: 5395/10000 (53.9500%)
time spent on training: 258.6663148403168
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 74 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 74 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 49 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 49 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 3 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 3 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 92 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 92 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 2 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 2 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 47 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 62 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 62 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 75 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 75 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 84 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 6 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 6 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 12 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 76 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 76 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 53 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 53 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 81 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 81 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 24 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 24 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 91 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 91 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1919, Accuracy: 6911/10000 (69.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.0797, Accuracy: 98/9900 (0.9899%)
Done in 285.17336988449097 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 43.01387829045339.
Norm before scaling: 43.01840454831876. Distance: 2.0665848479943816
Total norm for 4 adversaries is: 43.01840454831876. distance: 2.0665848479943816
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3862, Accuracy: 8963/9900 (90.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 43.01387829045339.
Norm before scaling: 43.018465557319104. Distance: 2.235444566517619
Total norm for 4 adversaries is: 43.018465557319104. distance: 2.235444566517619
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1973, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 43.01387829045339.
Norm before scaling: 43.01197825533604. Distance: 2.0182926947326862
Total norm for 4 adversaries is: 43.01197825533604. distance: 2.0182926947326862
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3359, Accuracy: 9032/9900 (91.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 43.01387829045339.
Norm before scaling: 43.02112716808452. Distance: 2.267322930064343
Total norm for 4 adversaries is: 43.02112716808452. distance: 2.267322930064343
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3489, Accuracy: 9043/9900 (91.3434%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4240/4716 (89.9067%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4256/4716 (90.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0051, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3898/4481 (86.9895%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3903/4481 (87.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1034, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3930/4361 (90.1169%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3844/4361 (88.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0412, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4307/4793 (89.8602%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0495, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3863/4295 (89.9418%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3732/4295 (86.8917%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9445, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4493/5244 (85.6789%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4579/5244 (87.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9343, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4374/4989 (87.6729%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4437/4989 (88.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9947, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4576/5197 (88.0508%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4633/5197 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1281, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3869/4356 (88.8200%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3671/4356 (84.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2934, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4081/4647 (87.8201%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4184/4647 (90.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9060, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3706/4013 (92.3499%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3745/4013 (93.3217%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7871, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4080/4538 (89.9074%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4186/4538 (92.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8667, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4203/4707 (89.2925%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4249/4707 (90.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8781, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5666/6263 (90.4678%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5695/6263 (90.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2342, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3793/4235 (89.5632%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3719/4235 (87.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0151, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3441/3861 (89.1220%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3477/3861 (90.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1080, Accuracy: 5281/10000 (52.8100%)
time spent on training: 260.062682390213
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 28 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 28 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 7 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 97 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 97 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 84 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 75 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 75 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 11 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 11 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 56 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 56 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 49 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 49 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 89 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 89 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 77 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 77 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 69 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 6 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 6 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 47 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 47 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 92 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 92 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 73 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 14 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 14 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1934, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.8304, Accuracy: 130/9900 (1.3131%)
Done in 286.4529433250427 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 43.04082449538098.
Norm before scaling: 43.04436670323786. Distance: 2.138091878759901
Total norm for 4 adversaries is: 43.04436670323786. distance: 2.138091878759901
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1655, Accuracy: 9483/9900 (95.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 43.04082449538098.
Norm before scaling: 43.044650294145875. Distance: 2.20101243044971
Total norm for 4 adversaries is: 43.044650294145875. distance: 2.20101243044971
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1790, Accuracy: 9457/9900 (95.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 43.04082449538098.
Norm before scaling: 43.040149485955986. Distance: 2.0143546899427944
Total norm for 4 adversaries is: 43.040149485955986. distance: 2.0143546899427944
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2314, Accuracy: 9315/9900 (94.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4506/5066 (88.9459%), train_poison_data_count: 400
Global model norm: 43.04082449538098.
Norm before scaling: 43.04866432306582. Distance: 2.2558714234662016
Total norm for 4 adversaries is: 43.04866432306582. distance: 2.2558714234662016
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1978, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4516/5055 (89.3373%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4578/5055 (90.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9783, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3401/3828 (88.8454%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0243, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3884/4361 (89.0621%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3912/4361 (89.7042%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0557, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3668/4013 (91.4029%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3753/4013 (93.5211%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8126, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4059/4518 (89.8406%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4167/4518 (92.2311%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8534, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4023/4558 (88.2624%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4026/4558 (88.3282%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1176, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3662/4126 (88.7542%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3754/4126 (90.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9540, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4204/4679 (89.8483%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3852/4679 (82.3253%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1718, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3836/4235 (90.5785%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3764/4235 (88.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9300, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4495/5037 (89.2396%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4663/5037 (92.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8844, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3247/3672 (88.4259%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3339/3672 (90.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8027, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4345/4928 (88.1696%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4422/4928 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9219, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3896/4356 (89.4399%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3812/4356 (87.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1949, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4028/4456 (90.3950%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4137/4456 (92.8411%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9488, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4291/4793 (89.5264%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4418/4793 (92.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9145, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4507/5025 (89.6915%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4558/5025 (90.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9731, Accuracy: 5476/10000 (54.7600%)
time spent on training: 257.36606526374817
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 65 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 65 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 98 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 98 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 97 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 97 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 69 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 69 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 34 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 34 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 57 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 57 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 61 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 61 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 96 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 96 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 73 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 73 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 45 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 45 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 87 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 87 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 16 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 16 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 55 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 66 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 66 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 84 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 84 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 80 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 80 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1936, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.0196, Accuracy: 111/9900 (1.1212%)
Done in 283.7207455635071 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 43.06966558669802.
Norm before scaling: 43.07599542478314. Distance: 2.1359173319603233
Total norm for 4 adversaries is: 43.07599542478314. distance: 2.1359173319603233
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1536, Accuracy: 9510/9900 (96.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 43.06966558669802.
Norm before scaling: 43.07253942297517. Distance: 2.187317540869905
Total norm for 4 adversaries is: 43.07253942297517. distance: 2.187317540869905
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1742, Accuracy: 9450/9900 (95.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 43.06966558669802.
Norm before scaling: 43.06858855723623. Distance: 1.984083499674144
Total norm for 4 adversaries is: 43.06858855723623. distance: 1.984083499674144
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.3355, Accuracy: 9060/9900 (91.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 43.06966558669802.
Norm before scaling: 43.0759160772982. Distance: 2.2190966268219063
Total norm for 4 adversaries is: 43.0759160772982. distance: 2.2190966268219063
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2595, Accuracy: 9251/9900 (93.4444%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3928/4346 (90.3820%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4019/4346 (92.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8842, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3735/4184 (89.2686%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3819/4184 (91.2763%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0339, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3854/4356 (88.4757%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3624/4356 (83.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3496, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3273/3646 (89.7696%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3338/3646 (91.5524%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7393, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4520/5083 (88.9239%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4543/5083 (89.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9903, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3889/4356 (89.2792%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3917/4356 (89.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0977, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4000/4558 (87.7578%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4035/4558 (88.5257%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0633, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3697/4175 (88.5509%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3701/4175 (88.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9704, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3185/3472 (91.7339%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3184/3472 (91.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0132, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4006/4501 (89.0024%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4051/4501 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0657, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4831/5424 (89.0671%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4925/5424 (90.8001%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2202, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3945/4481 (88.0384%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3948/4481 (88.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0557, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4933/5455 (90.4308%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4950/5455 (90.7424%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2841, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4579/5232 (87.5191%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4670/5232 (89.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0959, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5506/6391 (86.1524%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5576/6391 (87.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1069, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3431/3775 (90.8874%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3541/3775 (93.8013%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8895, Accuracy: 5671/10000 (56.7100%)
time spent on training: 258.6448276042938
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 13 (index 0), confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for agent 13 (index 0).
Validation completed, confusion matrix created.
Validation completed for user 36 (index 1), confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for agent 36 (index 1).
Validation completed, confusion matrix created.
Validation completed for user 58 (index 2), confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for agent 58 (index 2).
Validation completed, confusion matrix created.
Validation completed for user 71 (index 3), confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for agent 71 (index 3).
Validation completed, confusion matrix created.
Validation completed for user 29 (index 4), confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for agent 29 (index 4).
Validation completed, confusion matrix created.
Validation completed for user 23 (index 5), confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for agent 23 (index 5).
Validation completed, confusion matrix created.
Validation completed for user 55 (index 6), confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for agent 55 (index 6).
Validation completed, confusion matrix created.
Validation completed for user 2 (index 7), confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for agent 2 (index 7).
Validation completed, confusion matrix created.
Validation completed for user 12 (index 8), confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for agent 12 (index 8).
Validation completed, confusion matrix created.
Validation completed for user 89 (index 9), confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for agent 89 (index 9).
Validation completed, confusion matrix created.
Validation completed for user 57 (index 10), confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for agent 57 (index 10).
Validation completed, confusion matrix created.
Validation completed for user 31 (index 11), confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for agent 31 (index 11).
Validation completed, confusion matrix created.
Validation completed for user 30 (index 12), confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for agent 30 (index 12).
Validation completed, confusion matrix created.
Validation completed for user 8 (index 13), confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for agent 8 (index 13).
Validation completed, confusion matrix created.
Validation completed for user 42 (index 14), confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for agent 42 (index 14).
Validation completed, confusion matrix created.
Validation completed for user 7 (index 15), confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for agent 7 (index 15).
Validation completed, confusion matrix created.
Validation completed for user 40 (index 16), confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for agent 40 (index 16).
Validation completed, confusion matrix created.
Validation completed for user 22 (index 17), confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for agent 22 (index 17).
Validation completed, confusion matrix created.
Validation completed for user 85 (index 18), confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for agent 85 (index 18).
Validation completed, confusion matrix created.
Validation completed for user 51 (index 19), confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for agent 51 (index 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.2149, Accuracy: 6845/10000 (68.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.8871, Accuracy: 128/9900 (1.2929%)
Done in 285.0271236896515 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 43.08901493429401.
Norm before scaling: 43.08966368180352. Distance: 2.13797646281719
Total norm for 4 adversaries is: 43.08966368180352. distance: 2.13797646281719
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1875, Accuracy: 9413/9900 (95.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 43.08901493429401.
Norm before scaling: 43.087004888183806. Distance: 2.1283029803942344
Total norm for 4 adversaries is: 43.087004888183806. distance: 2.1283029803942344
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0769, Accuracy: 9684/9900 (97.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 43.08901493429401.
Norm before scaling: 43.08550756245147. Distance: 1.9938762612856906
Total norm for 4 adversaries is: 43.08550756245147. distance: 1.9938762612856906
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1288, Accuracy: 9563/9900 (96.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
