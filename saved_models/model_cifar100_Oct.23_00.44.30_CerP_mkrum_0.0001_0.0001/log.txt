current path: saved_models/model_cifar100_Oct.23_00.44.30_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4313/4885 (88.2907%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439983761538926. Distance: 2.2942172912746823
Total norm for 4 adversaries is: 42.439983761538926. distance: 2.2942172912746823
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4367, Accuracy: 8835/9900 (89.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435306632843336. Distance: 2.2514678617517996
Total norm for 4 adversaries is: 42.435306632843336. distance: 2.2514678617517996
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7310, Accuracy: 8305/9900 (83.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43870234857859. Distance: 2.178375286679942
Total norm for 4 adversaries is: 42.43870234857859. distance: 2.178375286679942
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4202, Accuracy: 8900/9900 (89.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.4403260403836. Distance: 2.3037337059069856
Total norm for 4 adversaries is: 42.4403260403836. distance: 2.3037337059069856
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5986, Accuracy: 8513/9900 (85.9899%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3829/4356 (87.9017%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3675/4356 (84.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4018, Accuracy: 4683/10000 (46.8300%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3936/4465 (88.1523%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4112/4465 (92.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0025, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4032/4647 (86.7657%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4158/4647 (89.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8973, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4443/5055 (87.8932%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4519/5055 (89.3966%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1428, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4438/5116 (86.7475%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4483/5116 (87.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9928, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3636/4126 (88.1241%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3756/4126 (91.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0002, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3086/3472 (88.8825%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3222/3472 (92.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0778, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4439/4986 (89.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0565, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3542/4013 (88.2631%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8406, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4034/4618 (87.3538%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4081/4618 (88.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0576, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4437/5083 (87.2910%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4446/5083 (87.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2243, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3968/4511 (87.9628%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4030/4511 (89.3372%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1104, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3331/3797 (87.7272%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3384/3797 (89.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9727, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4998/5582 (89.5378%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5073/5582 (90.8814%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1406, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3205/3616 (88.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0571, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4827/5455 (88.4876%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4867/5455 (89.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9588, Accuracy: 5290/10000 (52.9000%)
time spent on training: 259.9190938472748
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1509, Accuracy: 6996/10000 (69.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8603, Accuracy: 64/9900 (0.6465%)
Done in 288.3418905735016 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4370/4885 (89.4575%), train_poison_data_count: 385
Global model norm: 42.464814824120865.
Norm before scaling: 42.47139863659351. Distance: 2.155421553976832
Total norm for 4 adversaries is: 42.47139863659351. distance: 2.155421553976832
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1954, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.464814824120865.
Norm before scaling: 42.46800697243676. Distance: 2.208129285586334
Total norm for 4 adversaries is: 42.46800697243676. distance: 2.208129285586334
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4162, Accuracy: 8870/9900 (89.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.464814824120865.
Norm before scaling: 42.47303544879239. Distance: 2.2101996710494243
Total norm for 4 adversaries is: 42.47303544879239. distance: 2.2101996710494243
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1723, Accuracy: 9465/9900 (95.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.464814824120865.
Norm before scaling: 42.475692439820065. Distance: 2.3510259985806616
Total norm for 4 adversaries is: 42.475692439820065. distance: 2.3510259985806616
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1855, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3591/4025 (89.2174%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3694/4025 (91.7764%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9008, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3313/3797 (87.2531%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3402/3797 (89.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0336, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3929/4625 (84.9514%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4033/4625 (87.2000%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2586, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3854/4481 (86.0076%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3861/4481 (86.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2040, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3843/4315 (89.0614%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3963/4315 (91.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9418, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3709/4235 (87.5797%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3819/4235 (90.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0790, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3371/3828 (88.0617%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3491/3828 (91.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9592, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3812/4416 (86.3225%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3965/4416 (89.7871%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9588, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3151/3638 (86.6135%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0057, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4545/5265 (86.3248%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4519/5265 (85.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9557, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3347/3781 (88.5216%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3302/3781 (87.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2053, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3965/4441 (89.2817%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4001/4441 (90.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1531, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4016/4433 (90.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9170, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4397/5083 (86.5040%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4440/5083 (87.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0752, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4296/4928 (87.1753%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4404/4928 (89.3669%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0278, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4139/4793 (86.3551%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4339/4793 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0056, Accuracy: 5446/10000 (54.4600%)
time spent on training: 257.13834524154663
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1676, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.5069, Accuracy: 67/9900 (0.6768%)
Done in 285.40624475479126 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.50128818130472.
Norm before scaling: 42.503038724087126. Distance: 2.111325076063074
Total norm for 4 adversaries is: 42.503038724087126. distance: 2.111325076063074
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1955, Accuracy: 9383/9900 (94.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 42.50128818130472.
Norm before scaling: 42.504868172473785. Distance: 2.2010239125763515
Total norm for 4 adversaries is: 42.504868172473785. distance: 2.2010239125763515
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0798, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 42.50128818130472.
Norm before scaling: 42.50431101756768. Distance: 2.094278638917357
Total norm for 4 adversaries is: 42.50431101756768. distance: 2.094278638917357
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1658, Accuracy: 9449/9900 (95.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.50128818130472.
Norm before scaling: 42.507594967050444. Distance: 2.254877631510668
Total norm for 4 adversaries is: 42.507594967050444. distance: 2.254877631510668
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1734, Accuracy: 9437/9900 (95.3232%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3128/3616 (86.5044%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3271/3616 (90.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8042, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3478/3837 (90.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9840, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4151/4679 (88.7155%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4263/4679 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9758, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3111/3638 (85.5140%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3279/3638 (90.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0234, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3614/4046 (89.3228%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3653/4046 (90.2867%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0249, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3978/4518 (88.0478%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4097/4518 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0420, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3367/3797 (88.6753%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3422/3797 (90.1238%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1281, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4412/5025 (87.8010%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4514/5025 (89.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2147, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3890/4362 (89.1793%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3927/4362 (90.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0461, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3980/4558 (87.3190%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4014/4558 (88.0649%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1921, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3205/3672 (87.2821%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3280/3672 (89.3246%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0862, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4294/4874 (88.1001%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4342/4874 (89.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1874, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3605/4025 (89.5652%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3710/4025 (92.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9570, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4091/4663 (87.7332%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4264/4663 (91.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1016, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3444/3911 (88.0593%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3483/3911 (89.0565%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0127, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4427/5017 (88.2400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4552/5017 (90.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8509, Accuracy: 5654/10000 (56.5400%)
time spent on training: 251.67643451690674
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.2106, Accuracy: 6831/10000 (68.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3816, Accuracy: 59/9900 (0.5960%)
Done in 279.9793589115143 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.52928104369683.
Norm before scaling: 42.533063884906056. Distance: 2.1172487594919764
Total norm for 4 adversaries is: 42.533063884906056. distance: 2.1172487594919764
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5635, Accuracy: 8636/9900 (87.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.52928104369683.
Norm before scaling: 42.528374030243036. Distance: 2.144785270168801
Total norm for 4 adversaries is: 42.528374030243036. distance: 2.144785270168801
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0987, Accuracy: 9648/9900 (97.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 42.52928104369683.
Norm before scaling: 42.53131744805453. Distance: 2.0927079297741478
Total norm for 4 adversaries is: 42.53131744805453. distance: 2.0927079297741478
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1435, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 42.52928104369683.
Norm before scaling: 42.5362566510361. Distance: 2.270479355500433
Total norm for 4 adversaries is: 42.5362566510361. distance: 2.270479355500433
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2671, Accuracy: 9202/9900 (92.9495%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5253/6124 (85.7773%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5280/6124 (86.2182%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1649, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3860/4356 (88.6134%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3686/4356 (84.6189%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2670, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3518/4158 (84.6080%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3590/4158 (86.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1625, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4867/5455 (89.2209%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4875/5455 (89.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9816, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3911/4511 (86.6992%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4026/4511 (89.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0547, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4492/5232 (85.8563%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4529/5232 (86.5635%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2236, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4460/5244 (85.0496%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4529/5244 (86.3654%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0274, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4355/4918 (88.5523%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4417/4918 (89.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0313, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3573/4126 (86.5972%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3716/4126 (90.0630%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8406, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4358/4928 (88.4334%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0991, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3707/4223 (87.7812%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3854/4223 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9897, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4516/5195 (86.9297%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4616/5195 (88.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1049, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4127/4679 (88.2026%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4196/4679 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0018, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3172/3646 (86.9995%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3296/3646 (90.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9689, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3168/3616 (87.6106%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3209/3616 (88.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8818, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4050/4716 (85.8779%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4146/4716 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9854, Accuracy: 5368/10000 (53.6800%)
time spent on training: 262.60797786712646
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2556, Accuracy: 6735/10000 (67.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.5983, Accuracy: 47/9900 (0.4747%)
Done in 290.9893786907196 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.56780264784201.
Norm before scaling: 42.57245948545403. Distance: 2.137923269024368
Total norm for 4 adversaries is: 42.57245948545403. distance: 2.137923269024368
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1310, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 42.56780264784201.
Norm before scaling: 42.562917295586516. Distance: 2.1476045970734683
Total norm for 4 adversaries is: 42.562917295586516. distance: 2.1476045970734683
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1154, Accuracy: 9597/9900 (96.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 42.56780264784201.
Norm before scaling: 42.57010962398896. Distance: 2.0997768601440105
Total norm for 4 adversaries is: 42.57010962398896. distance: 2.0997768601440105
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1660, Accuracy: 9454/9900 (95.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.56780264784201.
Norm before scaling: 42.576886449875886. Distance: 2.29756185421372
Total norm for 4 adversaries is: 42.576886449875886. distance: 2.29756185421372
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1792, Accuracy: 9434/9900 (95.2929%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5223/6124 (85.2874%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5316/6124 (86.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9887, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3929/4433 (88.6307%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4002/4433 (90.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0176, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3355/3781 (88.7331%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3317/3781 (87.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1682, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3548/3969 (89.3928%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3543/3969 (89.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9436, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4444/5025 (88.4378%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4545/5025 (90.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1446, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4153/4679 (88.7583%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4244/4679 (90.7031%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9833, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4156/4707 (88.2940%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4222/4707 (89.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9152, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4379/4986 (87.8259%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4401/4986 (88.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9079, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3871/4315 (89.7103%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3931/4315 (91.1008%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8423, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3816/4416 (86.4130%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3954/4416 (89.5380%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9169, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4257/4804 (88.6137%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4005/4804 (83.3680%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3647, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4150/4793 (86.5846%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4282/4793 (89.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9926, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4511/5232 (86.2194%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4582/5232 (87.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0015, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4081/4662 (87.5375%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4222/4662 (90.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9801, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4195/4956 (84.6449%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4347/4956 (87.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1001, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3817/4368 (87.3855%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3865/4368 (88.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0501, Accuracy: 5324/10000 (53.2400%)
time spent on training: 264.12052965164185
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2529, Accuracy: 6785/10000 (67.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.6700, Accuracy: 51/9900 (0.5152%)
Done in 292.5076913833618 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4364/4885 (89.3347%), train_poison_data_count: 385
Global model norm: 42.60633383215678.
Norm before scaling: 42.6103733954355. Distance: 2.163315186074215
Total norm for 4 adversaries is: 42.6103733954355. distance: 2.163315186074215
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2156, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.60633383215678.
Norm before scaling: 42.60518492186793. Distance: 2.167538491933574
Total norm for 4 adversaries is: 42.60518492186793. distance: 2.167538491933574
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1995, Accuracy: 9399/9900 (94.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 42.60633383215678.
Norm before scaling: 42.60450874073145. Distance: 2.053246518607621
Total norm for 4 adversaries is: 42.60450874073145. distance: 2.053246518607621
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1958, Accuracy: 9384/9900 (94.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 42.60633383215678.
Norm before scaling: 42.61628737019158. Distance: 2.2860907836335818
Total norm for 4 adversaries is: 42.61628737019158. distance: 2.2860907836335818
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1940, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5279/6124 (86.2018%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5347/6124 (87.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1773, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5080/5902 (86.0725%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5155/5902 (87.3433%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0941, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4178/4707 (88.7614%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4203/4707 (89.2925%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9295, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4068/4647 (87.5403%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4174/4647 (89.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9202, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2924/3297 (88.6867%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3037/3297 (92.1140%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7757, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5535/6263 (88.3762%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5682/6263 (90.7233%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1203, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4141/4663 (88.8055%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4262/4663 (91.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0906, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4305/4956 (86.8644%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4332/4956 (87.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1449, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3607/4046 (89.1498%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3670/4046 (90.7069%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9417, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3676/4184 (87.8585%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3795/4184 (90.7027%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8575, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4824/5591 (86.2815%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4871/5591 (87.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2394, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4061/4634 (87.6349%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4191/4634 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9086, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3358/3828 (87.7220%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3483/3828 (90.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8445, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3108/3638 (85.4316%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3247/3638 (89.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8015, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3367/3781 (89.0505%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3370/3781 (89.1299%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1322, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3371/3837 (87.8551%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9608, Accuracy: 5513/10000 (55.1300%)
time spent on training: 260.0330948829651
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2367, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.5981, Accuracy: 67/9900 (0.6768%)
Done in 288.48393154144287 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.653222191075436.
Norm before scaling: 42.655574628353094. Distance: 2.111852589556352
Total norm for 4 adversaries is: 42.655574628353094. distance: 2.111852589556352
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1929, Accuracy: 9452/9900 (95.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 42.653222191075436.
Norm before scaling: 42.65422957669321. Distance: 2.168401011770069
Total norm for 4 adversaries is: 42.65422957669321. distance: 2.168401011770069
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1557, Accuracy: 9516/9900 (96.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4191/4717 (88.8488%), train_poison_data_count: 370
Global model norm: 42.653222191075436.
Norm before scaling: 42.6544141660809. Distance: 2.089071369936936
Total norm for 4 adversaries is: 42.6544141660809. distance: 2.089071369936936
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1527, Accuracy: 9499/9900 (95.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4483/5066 (88.4919%), train_poison_data_count: 400
Global model norm: 42.653222191075436.
Norm before scaling: 42.65819735710608. Distance: 2.23787058313404
Total norm for 4 adversaries is: 42.65819735710608. distance: 2.23787058313404
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1912, Accuracy: 9417/9900 (95.1212%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3872/4501 (86.0253%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3936/4501 (87.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0441, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3650/4175 (87.4251%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3710/4175 (88.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9295, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3124/3616 (86.3938%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3242/3616 (89.6571%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8898, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4044/4634 (87.2680%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4135/4634 (89.2318%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9812, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3982/4558 (87.3629%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3991/4558 (87.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1486, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4553/5167 (88.1169%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4624/5167 (89.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1026, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3925/4356 (90.1056%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3875/4356 (88.9578%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1048, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4121/4716 (87.3834%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4147/4716 (87.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9802, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5460/6124 (89.1574%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5408/6124 (88.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9929, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4417/5055 (87.3788%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4537/5055 (89.7527%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0335, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4483/5025 (89.2139%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4529/5025 (90.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1123, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4338/4918 (88.2066%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4379/4918 (89.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1074, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3692/4223 (87.4260%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3806/4223 (90.1255%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8511, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3986/4481 (88.9534%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0557, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3261/3638 (89.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9948, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3560/4013 (88.7117%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8344, Accuracy: 5651/10000 (56.5100%)
time spent on training: 262.3335933685303
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2436, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.3006, Accuracy: 102/9900 (1.0303%)
Done in 290.88950634002686 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.6907398340451.
Norm before scaling: 42.69276710733622. Distance: 2.093557548218495
Total norm for 4 adversaries is: 42.69276710733622. distance: 2.093557548218495
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2203, Accuracy: 9356/9900 (94.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.6907398340451.
Norm before scaling: 42.690278036892515. Distance: 2.170202805319595
Total norm for 4 adversaries is: 42.690278036892515. distance: 2.170202805319595
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2068, Accuracy: 9411/9900 (95.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 42.6907398340451.
Norm before scaling: 42.693048744881324. Distance: 2.047057049059276
Total norm for 4 adversaries is: 42.693048744881324. distance: 2.047057049059276
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3102, Accuracy: 9130/9900 (92.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.6907398340451.
Norm before scaling: 42.69752467393455. Distance: 2.2494608974988255
Total norm for 4 adversaries is: 42.69752467393455. distance: 2.2494608974988255
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1155, Accuracy: 9594/9900 (96.9091%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3183/3646 (87.3012%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3301/3646 (90.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8006, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3920/4501 (87.0918%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4071/4501 (90.4466%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9015, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4054/4651 (87.1641%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4159/4651 (89.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9396, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4540/5167 (87.8653%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4604/5167 (89.1039%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0468, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4914/5455 (90.0825%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2286, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4844/5591 (86.6392%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4878/5591 (87.2474%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0899, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4181/4679 (89.3567%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4195/4679 (89.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1442, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4435/5017 (88.3994%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4530/5017 (90.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9051, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4205/4793 (87.7321%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4292/4793 (89.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0391, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3997/4456 (89.6993%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4105/4456 (92.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0051, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4793/5424 (88.3665%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4933/5424 (90.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1957, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3633/4175 (87.0180%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3617/4175 (86.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0685, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4482/5116 (87.6075%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4544/5116 (88.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9684, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3226/3704 (87.0950%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3333/3704 (89.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8877, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4432/5232 (84.7095%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4616/5232 (88.2263%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0166, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3085/3472 (88.8537%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3157/3472 (90.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9425, Accuracy: 5579/10000 (55.7900%)
time spent on training: 263.1595914363861
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2345, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.1846, Accuracy: 110/9900 (1.1111%)
Done in 291.75758123397827 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.730215748234.
Norm before scaling: 42.73329237659731. Distance: 2.1034327697020636
Total norm for 4 adversaries is: 42.73329237659731. distance: 2.1034327697020636
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2991, Accuracy: 9182/9900 (92.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 42.730215748234.
Norm before scaling: 42.73011290446264. Distance: 2.1648878596206007
Total norm for 4 adversaries is: 42.73011290446264. distance: 2.1648878596206007
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2353, Accuracy: 9353/9900 (94.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4208/4717 (89.2092%), train_poison_data_count: 370
Global model norm: 42.730215748234.
Norm before scaling: 42.7310156357841. Distance: 2.04921687450025
Total norm for 4 adversaries is: 42.7310156357841. distance: 2.04921687450025
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1618, Accuracy: 9485/9900 (95.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.730215748234.
Norm before scaling: 42.73685436134865. Distance: 2.2336117167649197
Total norm for 4 adversaries is: 42.73685436134865. distance: 2.2336117167649197
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3642, Accuracy: 8977/9900 (90.6768%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3205/3590 (89.2758%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3339/3590 (93.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9197, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3825/4368 (87.5687%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3876/4368 (88.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9091, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3246/3704 (87.6350%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9154, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4317/4928 (87.6015%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0316, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3981/4356 (91.3912%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3901/4356 (89.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0790, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3538/3911 (90.4628%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3472/3911 (88.7752%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1243, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4093/4651 (88.0026%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4171/4651 (89.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2759, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3691/4184 (88.2170%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3763/4184 (89.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9014, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3898/4346 (89.6917%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4025/4346 (92.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7707, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4162/4793 (86.8350%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0278, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3379/3804 (88.8275%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3482/3804 (91.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9576, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4446/4986 (89.1697%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4496/4986 (90.1725%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9530, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5445/6124 (88.9125%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5338/6124 (87.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0285, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4150/4707 (88.1666%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4238/4707 (90.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9595, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3763/4235 (88.8548%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3750/4235 (88.5478%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0647, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3634/4046 (89.8171%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3715/4046 (91.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9238, Accuracy: 5516/10000 (55.1600%)
time spent on training: 258.7116837501526
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2488, Accuracy: 6772/10000 (67.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.2606, Accuracy: 89/9900 (0.8990%)
Done in 287.39998984336853 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 42.77546870177169.
Norm before scaling: 42.77832663267917. Distance: 2.1344106646081187
Total norm for 4 adversaries is: 42.77832663267917. distance: 2.1344106646081187
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1280, Accuracy: 9567/9900 (96.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 42.77546870177169.
Norm before scaling: 42.7794038361701. Distance: 2.1975551024592597
Total norm for 4 adversaries is: 42.7794038361701. distance: 2.1975551024592597
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0724, Accuracy: 9726/9900 (98.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.77546870177169.
Norm before scaling: 42.77456120099305. Distance: 2.035003714968128
Total norm for 4 adversaries is: 42.77456120099305. distance: 2.035003714968128
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3995, Accuracy: 8966/9900 (90.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.77546870177169.
Norm before scaling: 42.781404081168844. Distance: 2.2558767078609008
Total norm for 4 adversaries is: 42.781404081168844. distance: 2.2558767078609008
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2652, Accuracy: 9214/9900 (93.0707%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4407/4986 (88.3875%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4473/4986 (89.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0842, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4048/4634 (87.3543%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4179/4634 (90.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9155, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4141/4716 (87.8075%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4232/4716 (89.7371%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0487, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5526/6124 (90.2351%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5600/6124 (91.4435%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9962, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4368/4918 (88.8166%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4478/4918 (91.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0963, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3354/3797 (88.3329%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3408/3797 (89.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0561, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4961/5582 (88.8750%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5003/5582 (89.6274%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1179, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4290/4956 (86.5617%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4362/4956 (88.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0350, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3940/4433 (88.8789%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4020/4433 (90.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8752, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3847/4354 (88.3555%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3540/4354 (81.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3026, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4290/4928 (87.0536%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9273, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3544/3911 (90.6162%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3551/3911 (90.7952%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9015, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4036/4481 (90.0692%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3997/4481 (89.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0126, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4575/5197 (88.0316%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4618/5197 (88.8590%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1602, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4799/5455 (87.9743%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4886/5455 (89.5692%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0092, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3795/4361 (87.0213%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3737/4361 (85.6914%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2435, Accuracy: 4989/10000 (49.8900%)
time spent on training: 251.50847625732422
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.3169, Accuracy: 6677/10000 (66.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.7060, Accuracy: 57/9900 (0.5758%)
Done in 275.75145411491394 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 42.81750512485738.
Norm before scaling: 42.82025619750905. Distance: 2.113656114763769
Total norm for 4 adversaries is: 42.82025619750905. distance: 2.113656114763769
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1671, Accuracy: 9503/9900 (95.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.81750512485738.
Norm before scaling: 42.81657143049289. Distance: 2.1678503055693623
Total norm for 4 adversaries is: 42.81657143049289. distance: 2.1678503055693623
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.3104, Accuracy: 9146/9900 (92.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4208/4717 (89.2092%), train_poison_data_count: 370
Global model norm: 42.81750512485738.
Norm before scaling: 42.81623358492007. Distance: 2.0627457443413477
Total norm for 4 adversaries is: 42.81623358492007. distance: 2.0627457443413477
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1986, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4462/5066 (88.0774%), train_poison_data_count: 400
Global model norm: 42.81750512485738.
Norm before scaling: 42.82193668808955. Distance: 2.2768620133638247
Total norm for 4 adversaries is: 42.82193668808955. distance: 2.2768620133638247
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2003, Accuracy: 9390/9900 (94.8485%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4276/4928 (86.7695%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4404/4928 (89.3669%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9809, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3706/4184 (88.5755%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3766/4184 (90.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9694, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4154/4707 (88.2515%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4257/4707 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9593, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3366/3828 (87.9310%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3514/3828 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8422, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3929/4503 (87.2529%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3986/4503 (88.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0629, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4129/4662 (88.5671%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4222/4662 (90.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9912, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3705/4235 (87.4852%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3795/4235 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0659, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4394/5244 (83.7910%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4513/5244 (86.0603%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8965, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4188/4793 (87.3774%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4338/4793 (90.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0221, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4079/4481 (91.0288%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4005/4481 (89.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0655, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3873/4346 (89.1164%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4008/4346 (92.2227%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7451, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3798/4361 (87.0901%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3737/4361 (85.6914%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0967, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4459/5055 (88.2097%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8973, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4477/5195 (86.1790%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4528/5195 (87.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2570, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3881/4315 (89.9421%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3978/4315 (92.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9247, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4151/4663 (89.0199%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2495, Accuracy: 5076/10000 (50.7600%)
time spent on training: 233.4893662929535
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.2990, Accuracy: 6690/10000 (66.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.7857, Accuracy: 56/9900 (0.5657%)
Done in 257.8570623397827 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.85119715546171.
Norm before scaling: 42.8526513934122. Distance: 2.087503823830763
Total norm for 4 adversaries is: 42.8526513934122. distance: 2.087503823830763
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1836, Accuracy: 9452/9900 (95.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4731/5305 (89.1800%), train_poison_data_count: 415
Global model norm: 42.85119715546171.
Norm before scaling: 42.853698243267175. Distance: 2.195753820187315
Total norm for 4 adversaries is: 42.853698243267175. distance: 2.195753820187315
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2696, Accuracy: 9243/9900 (93.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 42.85119715546171.
Norm before scaling: 42.84870589270681. Distance: 2.0394913379572217
Total norm for 4 adversaries is: 42.84870589270681. distance: 2.0394913379572217
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1949, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 42.85119715546171.
Norm before scaling: 42.858238569512515. Distance: 2.256566426498659
Total norm for 4 adversaries is: 42.858238569512515. distance: 2.256566426498659
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1775, Accuracy: 9437/9900 (95.3232%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3910/4315 (90.6141%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3955/4315 (91.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8764, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3217/3590 (89.6100%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3165/3590 (88.1616%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2699, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4158/4679 (88.8651%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4240/4679 (90.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1411, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4556/5167 (88.1750%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4652/5167 (90.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0894, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3370/3775 (89.2715%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3516/3775 (93.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7746, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3368/3828 (87.9833%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3485/3828 (91.0397%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9146, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3737/4235 (88.2409%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3892/4235 (91.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8646, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4091/4647 (88.0353%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8605, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4307/4918 (87.5763%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4438/4918 (90.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0253, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9135, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4075/4481 (90.9395%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4047/4481 (90.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0826, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3756/4295 (87.4505%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3746/4295 (87.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0617, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3947/4503 (87.6527%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4056/4503 (90.0733%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0167, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3908/4354 (89.7565%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3749/4354 (86.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5465, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4986 (88.3273%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4426/4986 (88.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9555, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5567/6263 (88.8871%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5688/6263 (90.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1458, Accuracy: 5238/10000 (52.3800%)
time spent on training: 234.4454424381256
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3684, Accuracy: 6618/10000 (66.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.2231, Accuracy: 129/9900 (1.3030%)
Done in 258.6921796798706 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 42.886529289874346.
Norm before scaling: 42.887199601378. Distance: 2.127222245550312
Total norm for 4 adversaries is: 42.887199601378. distance: 2.127222245550312
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1741, Accuracy: 9475/9900 (95.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4708/5305 (88.7465%), train_poison_data_count: 415
Global model norm: 42.886529289874346.
Norm before scaling: 42.8908797237427. Distance: 2.3053449307281086
Total norm for 4 adversaries is: 42.8908797237427. distance: 2.3053449307281086
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0607, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 42.886529289874346.
Norm before scaling: 42.888016484885526. Distance: 2.0815313429734865
Total norm for 4 adversaries is: 42.888016484885526. distance: 2.0815313429734865
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1472, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 42.886529289874346.
Norm before scaling: 42.891046218332384. Distance: 2.2567277566293864
Total norm for 4 adversaries is: 42.891046218332384. distance: 2.2567277566293864
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0795, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3695/4223 (87.4970%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9561, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4834/5455 (88.6159%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4864/5455 (89.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0700, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5124/5582 (91.7951%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1358, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3966/4465 (88.8242%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4100/4465 (91.8253%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8007, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5018/5591 (89.7514%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5042/5591 (90.1806%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2700, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3525/3911 (90.1304%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3431/3911 (87.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0011, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3548/4356 (81.4509%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2465, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4369/5037 (86.7381%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4528/5037 (89.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9092, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4146/4679 (88.6087%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4263/4679 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9685, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3911/4362 (89.6607%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3921/4362 (89.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1323, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4069/4518 (90.0620%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9786, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4456/5083 (87.6648%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4532/5083 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0725, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3565/4013 (88.8363%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3688/4013 (91.9013%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8128, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4562/5197 (87.7814%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4656/5197 (89.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0821, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2915/3297 (88.4137%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3061/3297 (92.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8750, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3942/4441 (88.7638%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4034/4441 (90.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0921, Accuracy: 5334/10000 (53.3400%)
time spent on training: 247.0017294883728
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4240, Accuracy: 6588/10000 (65.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 8.7037, Accuracy: 190/9900 (1.9192%)
Done in 275.8195261955261 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 42.92555783708582.
Norm before scaling: 42.927662173562396. Distance: 2.129937550341153
Total norm for 4 adversaries is: 42.927662173562396. distance: 2.129937550341153
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2346, Accuracy: 9359/9900 (94.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4727/5305 (89.1046%), train_poison_data_count: 415
Global model norm: 42.92555783708582.
Norm before scaling: 42.924134507782306. Distance: 2.1871414980715516
Total norm for 4 adversaries is: 42.924134507782306. distance: 2.1871414980715516
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2346, Accuracy: 9342/9900 (94.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 42.92555783708582.
Norm before scaling: 42.925415648468096. Distance: 2.0471353146955344
Total norm for 4 adversaries is: 42.925415648468096. distance: 2.0471353146955344
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3894, Accuracy: 8947/9900 (90.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.92555783708582.
Norm before scaling: 42.92921618826813. Distance: 2.2667960461922814
Total norm for 4 adversaries is: 42.92921618826813. distance: 2.2667960461922814
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2774, Accuracy: 9187/9900 (92.7980%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3960/4501 (87.9804%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4040/4501 (89.7578%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0160, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3922/4511 (86.9430%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4085/4511 (90.5564%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9301, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4005/4354 (91.9844%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3604/4354 (82.7745%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5189, Accuracy: 4538/10000 (45.3800%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3880/4346 (89.2775%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4015/4346 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9248, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4126/4707 (87.6567%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4255/4707 (90.3973%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9232, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4967/5591 (88.8392%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4939/5591 (88.3384%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0556, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4052/4647 (87.1960%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4201/4647 (90.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.7884, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4028/4538 (88.7616%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4203/4538 (92.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8811, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4310/4934 (87.3531%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4369/4934 (88.5488%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0258, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4330/4804 (90.1332%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4322/4804 (89.9667%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9703, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5580/6263 (89.0947%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5590/6263 (89.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2263, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4026/4481 (89.8460%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4030/4481 (89.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9946, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4349/5063 (85.8977%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4406/5063 (87.0235%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0102, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3662/4223 (86.7156%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9478, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3967/4441 (89.3267%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4095/4441 (92.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9450, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3324/3756 (88.4984%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3455/3756 (91.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8873, Accuracy: 5706/10000 (57.0600%)
time spent on training: 243.4139587879181
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4553, Accuracy: 6496/10000 (64.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.1217, Accuracy: 171/9900 (1.7273%)
Done in 267.62266397476196 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4354/4885 (89.1300%), train_poison_data_count: 385
Global model norm: 42.96560641909919.
Norm before scaling: 42.96946590312707. Distance: 2.1823428807284526
Total norm for 4 adversaries is: 42.96946590312707. distance: 2.1823428807284526
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1254, Accuracy: 9577/9900 (96.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 42.96560641909919.
Norm before scaling: 42.96565045638929. Distance: 2.270489961287352
Total norm for 4 adversaries is: 42.96565045638929. distance: 2.270489961287352
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0701, Accuracy: 9723/9900 (98.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.96560641909919.
Norm before scaling: 42.96928550802669. Distance: 2.1152305426875486
Total norm for 4 adversaries is: 42.96928550802669. distance: 2.1152305426875486
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2076, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4462/5066 (88.0774%), train_poison_data_count: 400
Global model norm: 42.96560641909919.
Norm before scaling: 42.97148002691. Distance: 2.2876314761207346
Total norm for 4 adversaries is: 42.97148002691. distance: 2.2876314761207346
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2225, Accuracy: 9313/9900 (94.0707%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4410/5244 (84.0961%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4574/5244 (87.2235%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0321, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4275/4928 (86.7492%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4452/4928 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8144, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3399/3804 (89.3533%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8721, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3572/4013 (89.0107%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8968, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3544/4158 (85.2333%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3577/4158 (86.0269%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8941, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4991/5582 (89.4124%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5030/5582 (90.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0084, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4794/5455 (87.8827%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4944/5455 (90.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9067, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4071/4354 (93.5002%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3636/4354 (83.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5453, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3937/4433 (88.8112%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4005/4433 (90.3451%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0636, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3156/3646 (86.5606%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3304/3646 (90.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8891, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4023/4518 (89.0438%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4101/4518 (90.7703%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9987, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3750/4235 (88.5478%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3714/4235 (87.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3169, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3904/4362 (89.5002%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3971/4362 (91.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9436, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4738/5392 (87.8709%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4743/5392 (87.9636%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2873, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4915/5591 (87.9091%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1446, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3303/3756 (87.9393%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3427/3756 (91.2407%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0371, Accuracy: 5450/10000 (54.5000%)
time spent on training: 235.43494200706482
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.4678, Accuracy: 6463/10000 (64.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.5033, Accuracy: 136/9900 (1.3737%)
Done in 259.7757251262665 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.00219720948861.
Norm before scaling: 43.00544597826027. Distance: 2.144674327642584
Total norm for 4 adversaries is: 43.00544597826027. distance: 2.144674327642584
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1422, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 43.00219720948861.
Norm before scaling: 43.00275217164522. Distance: 2.2670243775714938
Total norm for 4 adversaries is: 43.00275217164522. distance: 2.2670243775714938
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0130, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4162/4717 (88.2340%), train_poison_data_count: 370
Global model norm: 43.00219720948861.
Norm before scaling: 43.00577666048917. Distance: 2.165134536227955
Total norm for 4 adversaries is: 43.00577666048917. distance: 2.165134536227955
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1320, Accuracy: 9579/9900 (96.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4438/5066 (87.6036%), train_poison_data_count: 400
Global model norm: 43.00219720948861.
Norm before scaling: 43.00939129141231. Distance: 2.3611322389542484
Total norm for 4 adversaries is: 43.00939129141231. distance: 2.3611322389542484
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1223, Accuracy: 9587/9900 (96.8384%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4195/4634 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8953, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3970/4503 (88.1634%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3991/4503 (88.6298%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9393, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4264/4928 (86.5260%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7765, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3320/3804 (87.2766%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3460/3804 (90.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9605, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3155/3590 (87.8830%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3138/3590 (87.4095%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1183, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4076/4647 (87.7125%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8240, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3958/4625 (85.5784%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4009/4625 (86.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2433, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3999/4356 (91.8044%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3994/4356 (91.6896%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0397, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3346/3797 (88.1222%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3462/3797 (91.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9335, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3983/4456 (89.3851%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4051/4456 (90.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9491, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3568/4025 (88.6460%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4025 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8790, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3066/3472 (88.3065%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3186/3472 (91.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9384, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2870/3297 (87.0488%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3025/3297 (91.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8605, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3819/4416 (86.4810%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4012/4416 (90.8514%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9969, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3930/4356 (90.2204%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4081/4356 (93.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1968, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3117/3638 (85.6789%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3298/3638 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9688, Accuracy: 5423/10000 (54.2300%)
time spent on training: 226.34766030311584
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.5552, Accuracy: 6337/10000 (63.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 11.0417, Accuracy: 26/9900 (0.2626%)
Done in 250.66702580451965 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4353/4885 (89.1095%), train_poison_data_count: 385
Global model norm: 43.02561719896139.
Norm before scaling: 43.0297408050525. Distance: 2.2397925582267524
Total norm for 4 adversaries is: 43.0297408050525. distance: 2.2397925582267524
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1112, Accuracy: 9628/9900 (97.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4699/5305 (88.5768%), train_poison_data_count: 415
Global model norm: 43.02561719896139.
Norm before scaling: 43.02787693297655. Distance: 2.2645447358951336
Total norm for 4 adversaries is: 43.02787693297655. distance: 2.2645447358951336
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1841, Accuracy: 9438/9900 (95.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4194/4717 (88.9124%), train_poison_data_count: 370
Global model norm: 43.02561719896139.
Norm before scaling: 43.022554381938725. Distance: 2.0990066585862244
Total norm for 4 adversaries is: 43.022554381938725. distance: 2.0990066585862244
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1427, Accuracy: 9534/9900 (96.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 43.02561719896139.
Norm before scaling: 43.03279460054637. Distance: 2.322734762918407
Total norm for 4 adversaries is: 43.03279460054637. distance: 2.322734762918407
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0940, Accuracy: 9672/9900 (97.6970%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3624/4175 (86.8024%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3683/4175 (88.2156%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9160, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4182/4956 (84.3826%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4359/4956 (87.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1382, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4358/5037 (86.5198%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4571/5037 (90.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9304, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4120/4793 (85.9587%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4307/4793 (89.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9775, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3315/3804 (87.1451%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0823, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4732/5392 (87.7596%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4814/5392 (89.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9805, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3931/4465 (88.0403%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4069/4465 (91.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0507, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4098/4596 (89.1645%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4225/4596 (91.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0105, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5416/6124 (88.4389%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5467/6124 (89.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9936, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2832/3271 (86.5790%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2944/3271 (90.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0037, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3151/3590 (87.7716%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3180/3590 (88.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0553, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3837/4501 (85.2477%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1905, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4495/5232 (85.9136%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4609/5232 (88.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1572, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3216/3672 (87.5817%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3321/3672 (90.4412%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9653, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3691/4223 (87.4023%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3846/4223 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9373, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4118/4354 (94.5797%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3348/4354 (76.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.8299, Accuracy: 4285/10000 (42.8500%)
time spent on training: 250.23409581184387
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.6221, Accuracy: 6211/10000 (62.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.7392, Accuracy: 100/9900 (1.0101%)
Done in 278.980836391449 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4358/4885 (89.2119%), train_poison_data_count: 385
Global model norm: 43.07369145438794.
Norm before scaling: 43.079604163941376. Distance: 2.1818210455485536
Total norm for 4 adversaries is: 43.079604163941376. distance: 2.1818210455485536
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3864, Accuracy: 8997/9900 (90.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4723/5305 (89.0292%), train_poison_data_count: 415
Global model norm: 43.07369145438794.
Norm before scaling: 43.07341513969928. Distance: 2.221984869149209
Total norm for 4 adversaries is: 43.07341513969928. distance: 2.221984869149209
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1629, Accuracy: 9482/9900 (95.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4153/4717 (88.0432%), train_poison_data_count: 370
Global model norm: 43.07369145438794.
Norm before scaling: 43.07819584234291. Distance: 2.2305006034968264
Total norm for 4 adversaries is: 43.07819584234291. distance: 2.2305006034968264
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0939, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4440/5066 (87.6431%), train_poison_data_count: 400
Global model norm: 43.07369145438794.
Norm before scaling: 43.08367726959147. Distance: 2.337728878790263
Total norm for 4 adversaries is: 43.08367726959147. distance: 2.337728878790263
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1290, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4937/5582 (88.4450%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5002/5582 (89.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1338, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3981/4647 (85.6682%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4215/4647 (90.7037%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9778, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3913/4465 (87.6372%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4086/4465 (91.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9457, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4382/5083 (86.2089%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4513/5083 (88.7861%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1400, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3747/4416 (84.8505%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3979/4416 (90.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9460, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4226/4956 (85.2704%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4342/4956 (87.6110%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2315, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3869/4362 (88.6978%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3761/4362 (86.2219%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1206, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3943/4356 (90.5188%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3851/4356 (88.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1544, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3263/3781 (86.2999%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3415/3781 (90.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1857, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3147/3590 (87.6602%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3240/3590 (90.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9488, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4079/4651 (87.7016%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4251/4651 (91.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9784, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4027/4662 (86.3792%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4193/4662 (89.9399%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9481, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3049/3472 (87.8168%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3218/3472 (92.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9129, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4778/5424 (88.0900%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4934/5424 (90.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1263, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2815/3271 (86.0593%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2868/3271 (87.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9561, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4315/5037 (85.6661%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4532/5037 (89.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8308, Accuracy: 5692/10000 (56.9200%)
time spent on training: 258.7687392234802
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.5709, Accuracy: 6274/10000 (62.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.4071, Accuracy: 159/9900 (1.6061%)
Done in 287.60450625419617 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4356/4885 (89.1709%), train_poison_data_count: 385
Global model norm: 43.10717192630914.
Norm before scaling: 43.11144346478308. Distance: 2.175896961689736
Total norm for 4 adversaries is: 43.11144346478308. distance: 2.175896961689736
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2169, Accuracy: 9348/9900 (94.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4719/5305 (88.9538%), train_poison_data_count: 415
Global model norm: 43.10717192630914.
Norm before scaling: 43.1092758924196. Distance: 2.280129980765792
Total norm for 4 adversaries is: 43.1092758924196. distance: 2.280129980765792
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1296, Accuracy: 9557/9900 (96.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4188/4717 (88.7852%), train_poison_data_count: 370
Global model norm: 43.10717192630914.
Norm before scaling: 43.10451987656355. Distance: 2.073201937830566
Total norm for 4 adversaries is: 43.10451987656355. distance: 2.073201937830566
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3660, Accuracy: 9071/9900 (91.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4402/5066 (86.8930%), train_poison_data_count: 400
Global model norm: 43.10717192630914.
Norm before scaling: 43.115992039279924. Distance: 2.3568074991033083
Total norm for 4 adversaries is: 43.115992039279924. distance: 2.3568074991033083
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.5180, Accuracy: 8607/9900 (86.9394%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4248/4989 (85.1473%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4445/4989 (89.0960%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9901, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3555/4013 (88.5871%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8613, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4408/5195 (84.8508%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4494/5195 (86.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1135, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3480/3969 (87.6795%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3583/3969 (90.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8966, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4056/4356 (93.1129%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4034/4356 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0362, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3941/4441 (88.7413%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4031/4441 (90.7678%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9725, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4040/4518 (89.4201%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4127/4518 (91.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9601, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3423/3911 (87.5224%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3290/3911 (84.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9882, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3845/4362 (88.1476%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3874/4362 (88.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0752, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3337/3804 (87.7234%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3444/3804 (90.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0615, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3661/4223 (86.6919%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3852/4223 (91.2148%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0233, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4070/4634 (87.8291%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4195/4634 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8779, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4158/4354 (95.4984%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3467/4354 (79.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.5708, Accuracy: 4589/10000 (45.8900%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4326/5244 (82.4943%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4569/5244 (87.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9334, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4356/5037 (86.4800%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4550/5037 (90.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9071, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3128/3704 (84.4492%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3327/3704 (89.8218%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9714, Accuracy: 5503/10000 (55.0300%)
time spent on training: 258.6061990261078
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5780, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.5814, Accuracy: 145/9900 (1.4646%)
Done in 287.3891110420227 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4345/4885 (88.9458%), train_poison_data_count: 385
Global model norm: 43.15053450340665.
Norm before scaling: 43.153255858752274. Distance: 2.185788165997842
Total norm for 4 adversaries is: 43.153255858752274. distance: 2.185788165997842
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1935, Accuracy: 9416/9900 (95.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4693/5305 (88.4637%), train_poison_data_count: 415
Global model norm: 43.15053450340665.
Norm before scaling: 43.153772104823005. Distance: 2.2905086597078244
Total norm for 4 adversaries is: 43.153772104823005. distance: 2.2905086597078244
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1327, Accuracy: 9594/9900 (96.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4175/4717 (88.5096%), train_poison_data_count: 370
Global model norm: 43.15053450340665.
Norm before scaling: 43.149009677312556. Distance: 2.1339083919722492
Total norm for 4 adversaries is: 43.149009677312556. distance: 2.1339083919722492
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1187, Accuracy: 9578/9900 (96.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4444/5066 (87.7221%), train_poison_data_count: 400
Global model norm: 43.15053450340665.
Norm before scaling: 43.15719048803238. Distance: 2.3342806959189994
Total norm for 4 adversaries is: 43.15719048803238. distance: 2.3342806959189994
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2302, Accuracy: 9328/9900 (94.2222%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3797/4416 (85.9828%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3928/4416 (88.9493%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9613, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4490/5197 (86.3960%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4590/5197 (88.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9244, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4241/4918 (86.2342%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4446/4918 (90.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3259, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5523/6263 (88.1846%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5629/6263 (89.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1012, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3134/3646 (85.9572%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3291/3646 (90.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8162, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4115/4707 (87.4230%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4234/4707 (89.9511%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9148, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4328/5063 (85.4829%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4313/5063 (85.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1764, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3646/4295 (84.8894%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3898/4295 (90.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9805, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4120/4793 (85.9587%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9950, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3997/4538 (88.0784%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4154/4538 (91.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9307, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4403/5083 (86.6221%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4528/5083 (89.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9246, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3095/3638 (85.0742%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3244/3638 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8542, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5433/6124 (88.7165%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5510/6124 (89.9739%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9581, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4000/4618 (86.6176%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4091/4618 (88.5881%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9325, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3479/3969 (87.6543%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3548/3969 (89.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8567, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3470/4158 (83.4536%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3662/4158 (88.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9247, Accuracy: 5458/10000 (54.5800%)
time spent on training: 264.3292374610901
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.5298, Accuracy: 6354/10000 (63.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.5987, Accuracy: 167/9900 (1.6869%)
Done in 293.0035057067871 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4330/4885 (88.6387%), train_poison_data_count: 385
Global model norm: 43.1881246563002.
Norm before scaling: 43.19286298783559. Distance: 2.1683065615190493
Total norm for 4 adversaries is: 43.19286298783559. distance: 2.1683065615190493
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2586, Accuracy: 9244/9900 (93.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4675/5305 (88.1244%), train_poison_data_count: 415
Global model norm: 43.1881246563002.
Norm before scaling: 43.190527096336474. Distance: 2.301054493039603
Total norm for 4 adversaries is: 43.190527096336474. distance: 2.301054493039603
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2078, Accuracy: 9355/9900 (94.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4177/4717 (88.5520%), train_poison_data_count: 370
Global model norm: 43.1881246563002.
Norm before scaling: 43.18445997124211. Distance: 2.0986726880445623
Total norm for 4 adversaries is: 43.18445997124211. distance: 2.0986726880445623
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1678, Accuracy: 9466/9900 (95.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4438/5066 (87.6036%), train_poison_data_count: 400
Global model norm: 43.1881246563002.
Norm before scaling: 43.19288135792749. Distance: 2.3243357909409457
Total norm for 4 adversaries is: 43.19288135792749. distance: 2.3243357909409457
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2289, Accuracy: 9308/9900 (94.0202%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4040/4716 (85.6658%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4164/4716 (88.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0859, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3961/4481 (88.3954%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4024/4481 (89.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9748, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3862/4361 (88.5577%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3759/4361 (86.1958%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1365, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4149/4793 (86.5637%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4321/4793 (90.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0260, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3735/4295 (86.9616%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3724/4295 (86.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0642, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4394/5244 (83.7910%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4605/5244 (87.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9387, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4298/4989 (86.1495%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4458/4989 (89.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8894, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4550/5197 (87.5505%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4643/5197 (89.3400%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9598, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3961/4356 (90.9320%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3796/4356 (87.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2773, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4046/4647 (87.0669%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4213/4647 (90.6606%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9268, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3563/4013 (88.7864%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3711/4013 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7160, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4012/4538 (88.4090%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4165/4538 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8561, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4106/4707 (87.2318%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4258/4707 (90.4610%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9017, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5517/6263 (88.0888%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5718/6263 (91.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2005, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3720/4235 (87.8394%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3768/4235 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0299, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3342/3861 (86.5579%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3474/3861 (89.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9665, Accuracy: 5468/10000 (54.6800%)
time spent on training: 252.64950108528137
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.5397, Accuracy: 6321/10000 (63.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 9.4448, Accuracy: 208/9900 (2.1010%)
Done in 276.8804500102997 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4292/4885 (87.8608%), train_poison_data_count: 385
Global model norm: 43.217560879339025.
Norm before scaling: 43.22208840143255. Distance: 2.2317323863138956
Total norm for 4 adversaries is: 43.22208840143255. distance: 2.2317323863138956
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1294, Accuracy: 9564/9900 (96.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4692/5305 (88.4449%), train_poison_data_count: 415
Global model norm: 43.217560879339025.
Norm before scaling: 43.221546140568016. Distance: 2.2633776864419146
Total norm for 4 adversaries is: 43.221546140568016. distance: 2.2633776864419146
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2197, Accuracy: 9375/9900 (94.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4167/4717 (88.3400%), train_poison_data_count: 370
Global model norm: 43.217560879339025.
Norm before scaling: 43.21906916458434. Distance: 2.132584108972502
Total norm for 4 adversaries is: 43.21906916458434. distance: 2.132584108972502
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2021, Accuracy: 9423/9900 (95.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4422/5066 (87.2878%), train_poison_data_count: 400
Global model norm: 43.217560879339025.
Norm before scaling: 43.22350615550525. Distance: 2.3543325945238083
Total norm for 4 adversaries is: 43.22350615550525. distance: 2.3543325945238083
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1472, Accuracy: 9512/9900 (96.0808%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4442/5055 (87.8734%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4562/5055 (90.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9260, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3325/3828 (86.8600%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3490/3828 (91.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8700, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3820/4361 (87.5946%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3934/4361 (90.2087%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9577, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3516/4013 (87.6153%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3697/4013 (92.1256%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9973, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3996/4518 (88.4462%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9420, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3963/4558 (86.9460%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3983/4558 (87.3848%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1015, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3594/4126 (87.1062%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3758/4126 (91.0810%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8640, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4159/4679 (88.8865%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3953/4679 (84.4839%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1024, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3729/4235 (88.0519%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3756/4235 (88.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9798, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4328/5037 (85.9242%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4581/5037 (90.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8948, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3179/3672 (86.5741%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3367/3672 (91.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8974, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4241/4928 (86.0593%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4379/4928 (88.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9395, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3988/4356 (91.5519%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3856/4356 (88.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0507, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3934/4456 (88.2855%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4114/4456 (92.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0527, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4138/4793 (86.3342%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9506, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4447/5025 (88.4975%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4546/5025 (90.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9678, Accuracy: 5467/10000 (54.6700%)
time spent on training: 236.80538702011108
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.5407, Accuracy: 6341/10000 (63.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.5564, Accuracy: 172/9900 (1.7374%)
Done in 265.8168456554413 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4351/4885 (89.0686%), train_poison_data_count: 385
Global model norm: 43.25497566664296.
Norm before scaling: 43.259849176589256. Distance: 2.177267282797348
Total norm for 4 adversaries is: 43.259849176589256. distance: 2.177267282797348
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1089, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4707/5305 (88.7276%), train_poison_data_count: 415
Global model norm: 43.25497566664296.
Norm before scaling: 43.25765941028536. Distance: 2.278727665476281
Total norm for 4 adversaries is: 43.25765941028536. distance: 2.278727665476281
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1381, Accuracy: 9532/9900 (96.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 43.25497566664296.
Norm before scaling: 43.2530424778853. Distance: 2.062430178298515
Total norm for 4 adversaries is: 43.2530424778853. distance: 2.062430178298515
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2429, Accuracy: 9285/9900 (93.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4413/5066 (87.1101%), train_poison_data_count: 400
Global model norm: 43.25497566664296.
Norm before scaling: 43.2626553580893. Distance: 2.3405058724782606
Total norm for 4 adversaries is: 43.2626553580893. distance: 2.3405058724782606
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2865, Accuracy: 9189/9900 (92.8182%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3865/4346 (88.9324%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4009/4346 (92.2457%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8977, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3692/4184 (88.2409%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3788/4184 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9274, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3975/4356 (91.2534%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3800/4356 (87.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1589, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3312/3646 (90.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7792, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4437/5083 (87.2910%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4559/5083 (89.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1924, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4049/4356 (92.9522%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3892/4356 (89.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0754, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3951/4558 (86.6828%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4079/4558 (89.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0627, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3604/4175 (86.3234%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3743/4175 (89.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8901, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3038/3472 (87.5000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3171/3472 (91.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0670, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3908/4501 (86.8251%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4016/4501 (89.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1026, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4770/5424 (87.9425%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4942/5424 (91.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1826, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3993/4481 (89.1096%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4019/4481 (89.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9610, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4762/5455 (87.2961%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4876/5455 (89.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0639, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4479/5232 (85.6078%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4630/5232 (88.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9324, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5447/6391 (85.2292%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5558/6391 (86.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0470, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3355/3775 (88.8742%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8443, Accuracy: 5736/10000 (57.3600%)
time spent on training: 262.3175389766693
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.4996, Accuracy: 6396/10000 (63.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.7540, Accuracy: 120/9900 (1.2121%)
Done in 291.1538248062134 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 43.30211590889642.
Norm before scaling: 43.299537821851374. Distance: 2.1920104256402895
Total norm for 4 adversaries is: 43.299537821851374. distance: 2.1920104256402895
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1731, Accuracy: 9430/9900 (95.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 43.30211590889642.
Norm before scaling: 43.29662266481864. Distance: 2.179740659003987
Total norm for 4 adversaries is: 43.29662266481864. distance: 2.179740659003987
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1091, Accuracy: 9608/9900 (97.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4209/4717 (89.2304%), train_poison_data_count: 370
Global model norm: 43.30211590889642.
Norm before scaling: 43.298842882020246. Distance: 2.071188687307406
Total norm for 4 adversaries is: 43.298842882020246. distance: 2.071188687307406
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1446, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4399/5066 (86.8338%), train_poison_data_count: 400
Global model norm: 43.30211590889642.
Norm before scaling: 43.3062935217706. Distance: 2.3193754108483073
Total norm for 4 adversaries is: 43.3062935217706. distance: 2.3193754108483073
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2163, Accuracy: 9337/9900 (94.3131%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3568/4025 (88.6460%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3717/4025 (92.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7847, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3716/4223 (87.9943%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3809/4223 (90.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0234, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3169/3638 (87.1083%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8391, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4434/5063 (87.5765%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4473/5063 (88.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1411, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4239/4874 (86.9717%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4221/4874 (86.6024%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2319, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4339/4804 (90.3206%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4175/4804 (86.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.4184, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3495/4158 (84.0548%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3629/4158 (87.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8280, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4002/4518 (88.5790%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4166/4518 (92.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0549, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3737/4235 (88.2409%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3720/4235 (87.8394%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9710, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4245/4934 (86.0357%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4120/4934 (83.5022%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1529, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5589/6391 (87.4511%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5721/6391 (89.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0507, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3729/4295 (86.8219%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3782/4295 (88.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0787, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3332/3756 (88.7114%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3515/3756 (93.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8763, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4019/4481 (89.6898%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3983/4481 (88.8864%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0371, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3618/4175 (86.6587%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3671/4175 (87.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8932, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3156/3590 (87.9109%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3114/3590 (86.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0831, Accuracy: 5375/10000 (53.7500%)
time spent on training: 260.2459261417389
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5169, Accuracy: 6351/10000 (63.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.8916, Accuracy: 97/9900 (0.9798%)
Done in 289.00290179252625 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 43.342058760714025.
Norm before scaling: 43.34360214241183. Distance: 2.1900292080189976
Total norm for 4 adversaries is: 43.34360214241183. distance: 2.1900292080189976
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2180, Accuracy: 9347/9900 (94.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 43.342058760714025.
Norm before scaling: 43.342101007295. Distance: 2.1951534987459627
Total norm for 4 adversaries is: 43.342101007295. distance: 2.1951534987459627
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2828, Accuracy: 9217/9900 (93.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 43.342058760714025.
Norm before scaling: 43.343127586554886. Distance: 2.0899629648021003
Total norm for 4 adversaries is: 43.343127586554886. distance: 2.0899629648021003
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1222, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4448/5066 (87.8010%), train_poison_data_count: 400
Global model norm: 43.342058760714025.
Norm before scaling: 43.349686417550934. Distance: 2.3211195855386455
Total norm for 4 adversaries is: 43.349686417550934. distance: 2.3211195855386455
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1846, Accuracy: 9424/9900 (95.1919%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3368/3828 (87.9833%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3535/3828 (92.3459%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8765, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3489/3911 (89.2099%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3382/3911 (86.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1728, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3939/4362 (90.3026%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3943/4362 (90.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9415, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4627/5197 (89.0321%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4587/5197 (88.2625%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1186, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4279/4679 (91.4512%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1877, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4135/4793 (86.2716%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4321/4793 (90.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0640, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4431/5116 (86.6106%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4564/5116 (89.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0559, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3942/4625 (85.2324%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1364, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4100/4618 (88.7830%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4084/4618 (88.4366%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9960, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2874/3271 (87.8630%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 2988/3271 (91.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9141, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3619/4175 (86.6826%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3703/4175 (88.6946%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9531, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3105/3616 (85.8684%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3299/3616 (91.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8837, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3919/4481 (87.4582%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4013/4481 (89.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1161, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3806/4368 (87.1337%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9539, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4984/5740 (86.8293%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5206/5740 (90.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0708, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4061/4647 (87.3897%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4204/4647 (90.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9164, Accuracy: 5552/10000 (55.5200%)
time spent on training: 244.68082857131958
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5285, Accuracy: 6370/10000 (63.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.3790, Accuracy: 307/9900 (3.1010%)
Done in 269.16537141799927 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 43.3763058160789.
Norm before scaling: 43.37474811931549. Distance: 2.10106099891626
Total norm for 4 adversaries is: 43.37474811931549. distance: 2.10106099891626
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3436, Accuracy: 9029/9900 (91.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 43.3763058160789.
Norm before scaling: 43.367724421329456. Distance: 2.1317319263592633
Total norm for 4 adversaries is: 43.367724421329456. distance: 2.1317319263592633
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2256, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4182/4717 (88.6580%), train_poison_data_count: 370
Global model norm: 43.3763058160789.
Norm before scaling: 43.376360693264566. Distance: 2.0931650739622683
Total norm for 4 adversaries is: 43.376360693264566. distance: 2.0931650739622683
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1306, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.3763058160789.
Norm before scaling: 43.381613103580534. Distance: 2.259667713414702
Total norm for 4 adversaries is: 43.381613103580534. distance: 2.259667713414702
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1620, Accuracy: 9470/9900 (95.6566%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4932/5591 (88.2132%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5011/5591 (89.6262%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0416, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4283/4956 (86.4205%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4350/4956 (87.7724%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0254, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3945/4511 (87.4529%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4073/4511 (90.2904%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9334, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3585/4013 (89.3347%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3715/4013 (92.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9775, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3162/3590 (88.0780%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3311/3590 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9257, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4184/4793 (87.2940%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4339/4793 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8944, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3365/3804 (88.4595%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3450/3804 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8917, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3343/3837 (87.1254%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3521/3837 (91.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0010, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3886/4361 (89.1080%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3832/4361 (87.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0729, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4445/5063 (87.7938%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4484/5063 (88.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1379, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3768/4368 (86.2637%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3892/4368 (89.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0927, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4266/4679 (91.1733%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4160/4679 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1769, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4639/5265 (88.1102%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4663/5265 (88.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0515, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4102/4767 (86.0499%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4259/4767 (89.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1814, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5090/5902 (86.2420%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4962/5902 (84.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2602, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3707/4223 (87.7812%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3864/4223 (91.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9811, Accuracy: 5488/10000 (54.8800%)
time spent on training: 234.40417861938477
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.5362, Accuracy: 6326/10000 (63.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.4389, Accuracy: 325/9900 (3.2828%)
Done in 258.956857919693 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 43.4239946406002.
Norm before scaling: 43.4210850278986. Distance: 2.05207594920216
Total norm for 4 adversaries is: 43.4210850278986. distance: 2.05207594920216
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3230, Accuracy: 9102/9900 (91.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4722/5305 (89.0104%), train_poison_data_count: 415
Global model norm: 43.4239946406002.
Norm before scaling: 43.42246255000112. Distance: 2.2005891747932056
Total norm for 4 adversaries is: 43.42246255000112. distance: 2.2005891747932056
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2205, Accuracy: 9315/9900 (94.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 43.4239946406002.
Norm before scaling: 43.419544400390706. Distance: 2.0528263612239437
Total norm for 4 adversaries is: 43.419544400390706. distance: 2.0528263612239437
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2369, Accuracy: 9316/9900 (94.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.4239946406002.
Norm before scaling: 43.427847117643736. Distance: 2.280806824996194
Total norm for 4 adversaries is: 43.427847117643736. distance: 2.280806824996194
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2048, Accuracy: 9386/9900 (94.8081%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3366/3797 (88.6489%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3464/3797 (91.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9651, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3374/3861 (87.3867%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3458/3861 (89.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9134, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4141/4707 (87.9754%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4249/4707 (90.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0314, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4014/4518 (88.8446%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4144/4518 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0665, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3566/4013 (88.8612%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3672/4013 (91.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8894, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4597/5167 (88.9685%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0793, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3493/3969 (88.0071%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3621/3969 (91.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9557, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3934/4441 (88.5837%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4110/4441 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9727, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4000/4558 (87.7578%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4041/4558 (88.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0405, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3933/4465 (88.0851%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4142/4465 (92.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8441, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3178/3638 (87.3557%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8434, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4025/4538 (88.6955%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4147/4538 (91.3839%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8950, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5037/5740 (87.7526%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5220/5740 (90.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1628, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3348/3837 (87.2557%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3507/3837 (91.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8603, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3879/4361 (88.9475%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3730/4361 (85.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0193, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4170/4793 (87.0019%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4330/4793 (90.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1328, Accuracy: 5216/10000 (52.1600%)
time spent on training: 230.2344388961792
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.4711, Accuracy: 6439/10000 (64.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.5099, Accuracy: 302/9900 (3.0505%)
Done in 254.6326141357422 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 43.45550998039547.
Norm before scaling: 43.45365734796166. Distance: 2.10556545283201
Total norm for 4 adversaries is: 43.45365734796166. distance: 2.10556545283201
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2336, Accuracy: 9283/9900 (93.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4735/5305 (89.2554%), train_poison_data_count: 415
Global model norm: 43.45550998039547.
Norm before scaling: 43.45282581477369. Distance: 2.178624156965968
Total norm for 4 adversaries is: 43.45282581477369. distance: 2.178624156965968
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1458, Accuracy: 9537/9900 (96.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 43.45550998039547.
Norm before scaling: 43.45154758238983. Distance: 2.0317458501233387
Total norm for 4 adversaries is: 43.45154758238983. distance: 2.0317458501233387
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2188, Accuracy: 9374/9900 (94.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 43.45550998039547.
Norm before scaling: 43.45749174615566. Distance: 2.225416457388027
Total norm for 4 adversaries is: 43.45749174615566. distance: 2.225416457388027
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3486, Accuracy: 8993/9900 (90.8384%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4130/4767 (86.6373%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4250/4767 (89.1546%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1069, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3967/4441 (89.3267%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4105/4441 (92.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9600, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4022/4356 (92.3324%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3949/4356 (90.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2763, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5567/6391 (87.1069%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5632/6391 (88.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1502, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3698/4184 (88.3843%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3757/4184 (89.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0644, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3896/4346 (89.6457%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4003/4346 (92.1077%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7626, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4394/5037 (87.2345%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4580/5037 (90.9271%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0884, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4073/4634 (87.8938%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4205/4634 (90.7423%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8994, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4399/4934 (89.1569%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4375/4934 (88.6704%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1614, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4784/5424 (88.2006%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4931/5424 (90.9108%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9940, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3353/3781 (88.6802%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3337/3781 (88.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1005, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3398/3861 (88.0083%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3504/3861 (90.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9242, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4519/5055 (89.3966%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4646/5055 (91.9090%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8250, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4067/4433 (91.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8059, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4573/5167 (88.5040%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4677/5167 (90.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0815, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3198/3590 (89.0808%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3187/3590 (88.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0544, Accuracy: 5491/10000 (54.9100%)
time spent on training: 234.37858176231384
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7513, Accuracy: 6072/10000 (60.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.1328, Accuracy: 1350/9900 (13.6364%)
Done in 259.075923204422 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4377/4885 (89.6008%), train_poison_data_count: 385
Global model norm: 43.4868663385316.
Norm before scaling: 43.487036165426645. Distance: 2.1569584221791955
Total norm for 4 adversaries is: 43.487036165426645. distance: 2.1569584221791955
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2616, Accuracy: 9250/9900 (93.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 43.4868663385316.
Norm before scaling: 43.484735726584994. Distance: 2.1593156113579934
Total norm for 4 adversaries is: 43.484735726584994. distance: 2.1593156113579934
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2225, Accuracy: 9340/9900 (94.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 43.4868663385316.
Norm before scaling: 43.48540804558036. Distance: 2.0617080092647235
Total norm for 4 adversaries is: 43.48540804558036. distance: 2.0617080092647235
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1752, Accuracy: 9459/9900 (95.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 43.4868663385316.
Norm before scaling: 43.49176999866972. Distance: 2.283113319582213
Total norm for 4 adversaries is: 43.49176999866972. distance: 2.283113319582213
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2027, Accuracy: 9397/9900 (94.9192%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3814/4368 (87.3168%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3935/4368 (90.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9210, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3360/3828 (87.7743%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3529/3828 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8184, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4114/4356 (94.4444%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3791/4356 (87.0294%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1493, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3380/3861 (87.5421%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3490/3861 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8774, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9624, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4063/4538 (89.5328%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4222/4538 (93.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8414, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4744/5392 (87.9822%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4844/5392 (89.8368%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9316, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3729/4295 (86.8219%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3720/4295 (86.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9890, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3724/4235 (87.9339%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3845/4235 (90.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8927, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3993/4456 (89.6095%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4079/4456 (91.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9178, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4564/5265 (86.6857%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4635/5265 (88.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0143, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3998/4441 (90.0248%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4441 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0734, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3577/4013 (89.1353%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3694/4013 (92.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7668, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3934/4465 (88.1075%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4071/4465 (91.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8419, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5555/6263 (88.6955%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5720/6263 (91.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9704, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4391/4986 (88.0666%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4540/4986 (91.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8319, Accuracy: 5716/10000 (57.1600%)
time spent on training: 241.96059656143188
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6481481481481481.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 11 to 2 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7791, Accuracy: 5996/10000 (59.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 6.4860, Accuracy: 1074/9900 (10.8485%)
Done in 266.55139994621277 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4350/4885 (89.0481%), train_poison_data_count: 385
Global model norm: 43.519432901165686.
Norm before scaling: 43.52189278245131. Distance: 2.1833395494367718
Total norm for 4 adversaries is: 43.52189278245131. distance: 2.1833395494367718
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1845, Accuracy: 9440/9900 (95.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 43.519432901165686.
Norm before scaling: 43.52050718797332. Distance: 2.215980628221583
Total norm for 4 adversaries is: 43.52050718797332. distance: 2.215980628221583
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1521, Accuracy: 9550/9900 (96.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 43.519432901165686.
Norm before scaling: 43.515232269322944. Distance: 2.0432600174778144
Total norm for 4 adversaries is: 43.515232269322944. distance: 2.0432600174778144
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1838, Accuracy: 9429/9900 (95.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4465/5066 (88.1366%), train_poison_data_count: 400
Global model norm: 43.519432901165686.
Norm before scaling: 43.52271177706747. Distance: 2.288635318201757
Total norm for 4 adversaries is: 43.52271177706747. distance: 2.288635318201757
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1516, Accuracy: 9511/9900 (96.0707%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3552/4158 (85.4257%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3624/4158 (87.1573%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0345, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4535/5167 (87.7685%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4662/5167 (90.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1297, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3331/3828 (87.0167%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3448/3828 (90.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8759, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4125/4663 (88.4624%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4240/4663 (90.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9628, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3938/4433 (88.8337%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4107/4433 (92.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8686, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3684/4184 (88.0497%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3800/4184 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8567, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4095/4716 (86.8321%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4219/4716 (89.4614%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0172, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3731/4223 (88.3495%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3890/4223 (92.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8649, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4234/4679 (90.4894%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4236/4679 (90.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0381, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3180/3704 (85.8531%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3364/3704 (90.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8229, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3375/3837 (87.9593%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3525/3837 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7985, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3364/3861 (87.1277%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3446/3861 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0605, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4805/5424 (88.5878%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4932/5424 (90.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2296, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4045/4576 (88.3960%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4181/4576 (91.3680%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8381, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3558/4025 (88.3975%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3756/4025 (93.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7500, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3357/3775 (88.9272%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3546/3775 (93.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7761, Accuracy: 5786/10000 (57.8600%)
time spent on training: 230.06719946861267
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7201, Accuracy: 6091/10000 (60.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 6.7057, Accuracy: 859/9900 (8.6768%)
Done in 254.44120502471924 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4382/4885 (89.7032%), train_poison_data_count: 385
Global model norm: 43.5500859396576.
Norm before scaling: 43.54790516138879. Distance: 2.1220017767493373
Total norm for 4 adversaries is: 43.54790516138879. distance: 2.1220017767493373
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1789, Accuracy: 9445/9900 (95.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 43.5500859396576.
Norm before scaling: 43.54905582985554. Distance: 2.2213021227936416
Total norm for 4 adversaries is: 43.54905582985554. distance: 2.2213021227936416
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2412, Accuracy: 9265/9900 (93.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4231/4717 (89.6968%), train_poison_data_count: 370
Global model norm: 43.5500859396576.
Norm before scaling: 43.54715111367433. Distance: 2.016605109334048
Total norm for 4 adversaries is: 43.54715111367433. distance: 2.016605109334048
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2174, Accuracy: 9345/9900 (94.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 43.5500859396576.
Norm before scaling: 43.55233527841102. Distance: 2.2765073205338777
Total norm for 4 adversaries is: 43.55233527841102. distance: 2.2765073205338777
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0634, Accuracy: 9708/9900 (98.0606%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4053/4576 (88.5708%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4192/4576 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0116, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3222/3672 (87.7451%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3368/3672 (91.7211%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8685, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4618 (89.2594%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4119/4618 (89.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0546, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4043/4538 (89.0921%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4217/4538 (92.9264%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8680, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4613/5025 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1152, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3177/3590 (88.4958%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3231/3590 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0232, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4133/4707 (87.8054%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4258/4707 (90.4610%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0267, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4341/4918 (88.2676%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4474/4918 (90.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9807, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3841/4336 (88.5839%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3937/4336 (90.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8902, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5234/5902 (88.6818%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5190/5902 (87.9363%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1619, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3984/4441 (89.7095%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4090/4441 (92.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0527, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4506/5232 (86.1239%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4641/5232 (88.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0132, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4299/4804 (89.4879%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4278/4804 (89.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1024, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3534/3969 (89.0401%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3620/3969 (91.2069%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9465, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4776/5392 (88.5757%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4842/5392 (89.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0686, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3353/3828 (87.5914%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3517/3828 (91.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9253, Accuracy: 5610/10000 (56.1000%)
time spent on training: 235.47876381874084
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7130, Accuracy: 6087/10000 (60.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 6.7920, Accuracy: 779/9900 (7.8687%)
Done in 259.90603518486023 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 43.58017681840492.
Norm before scaling: 43.57812219881669. Distance: 2.0851209092245
Total norm for 4 adversaries is: 43.57812219881669. distance: 2.0851209092245
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1909, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4714/5305 (88.8596%), train_poison_data_count: 415
Global model norm: 43.58017681840492.
Norm before scaling: 43.57966142191145. Distance: 2.239215755608377
Total norm for 4 adversaries is: 43.57966142191145. distance: 2.239215755608377
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1774, Accuracy: 9442/9900 (95.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 43.58017681840492.
Norm before scaling: 43.574547742202675. Distance: 2.0313032876874453
Total norm for 4 adversaries is: 43.574547742202675. distance: 2.0313032876874453
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2371, Accuracy: 9291/9900 (93.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 43.58017681840492.
Norm before scaling: 43.58064179044622. Distance: 2.2473450997918842
Total norm for 4 adversaries is: 43.58064179044622. distance: 2.2473450997918842
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1768, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4502/5232 (86.0474%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4607/5232 (88.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0745, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4286/4956 (86.4810%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4409/4956 (88.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2084, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4433/5063 (87.5568%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4480/5063 (88.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9750, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3597/4025 (89.3665%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3732/4025 (92.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8044, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3981/4441 (89.6420%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4070/4441 (91.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0228, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3996/4625 (86.4000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2076, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4945/5591 (88.4457%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4953/5591 (88.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2214, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5021/5582 (89.9498%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5035/5582 (90.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2266, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5217/5902 (88.3938%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5242/5902 (88.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1277, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4086/4538 (90.0397%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4231/4538 (93.2349%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8010, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4463/5025 (88.8159%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4615/5025 (91.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9569, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3700/4223 (87.6154%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3863/4223 (91.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8330, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3931/4361 (90.1399%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3910/4361 (89.6583%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0182, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4122/4354 (94.6716%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3854/4354 (88.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1539, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3247/3672 (88.4259%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3357/3672 (91.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0598, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4035/4356 (92.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2488, Accuracy: 5098/10000 (50.9800%)
time spent on training: 237.08660888671875
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6111111111111112.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Misclassification from 11 to 2 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7528, Accuracy: 6018/10000 (60.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 6.5947, Accuracy: 899/9900 (9.0808%)
Done in 262.37878370285034 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4354/4885 (89.1300%), train_poison_data_count: 385
Global model norm: 43.61191237915608.
Norm before scaling: 43.61163247695146. Distance: 2.1559418167798703
Total norm for 4 adversaries is: 43.61163247695146. distance: 2.1559418167798703
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0981, Accuracy: 9665/9900 (97.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 43.61191237915608.
Norm before scaling: 43.60856323142709. Distance: 2.1689680665946813
Total norm for 4 adversaries is: 43.60856323142709. distance: 2.1689680665946813
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1560, Accuracy: 9513/9900 (96.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 43.61191237915608.
Norm before scaling: 43.609759884990915. Distance: 2.034110183004545
Total norm for 4 adversaries is: 43.609759884990915. distance: 2.034110183004545
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.4831, Accuracy: 8785/9900 (88.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4435/5066 (87.5444%), train_poison_data_count: 400
Global model norm: 43.61191237915608.
Norm before scaling: 43.617319737171925. Distance: 2.340988770599352
Total norm for 4 adversaries is: 43.617319737171925. distance: 2.340988770599352
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1732, Accuracy: 9480/9900 (95.7576%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3371/3828 (88.0617%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9214, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3786/4235 (89.3979%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3839/4235 (90.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0044, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3209/3704 (86.6361%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3294/3704 (88.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9167, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3603/4046 (89.0509%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3770/4046 (93.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8021, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4351/4928 (88.2914%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4448/4928 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8004, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4975/5740 (86.6725%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5167/5740 (90.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0767, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4410/5083 (86.7598%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4562/5083 (89.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9495, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4052/4576 (88.5490%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4135/4576 (90.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0233, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4094/4647 (88.0998%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4229/4647 (91.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9960, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4834/5424 (89.1224%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1813, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3898/4503 (86.5645%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4058/4503 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0012, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5593/6391 (87.5137%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5701/6391 (89.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0274, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3964/4511 (87.8741%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4067/4511 (90.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9773, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4008/4456 (89.9461%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4103/4456 (92.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9188, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4390/4804 (91.3822%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4251/4804 (88.4888%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0916, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3331/3804 (87.5657%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3463/3804 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9375, Accuracy: 5512/10000 (55.1200%)
time spent on training: 235.656968832016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7140, Accuracy: 6077/10000 (60.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 6.6682, Accuracy: 836/9900 (8.4444%)
Done in 260.09481596946716 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 43.65556493288542.
Norm before scaling: 43.65526014446885. Distance: 2.1416574480424875
Total norm for 4 adversaries is: 43.65526014446885. distance: 2.1416574480424875
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1523, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 43.65556493288542.
Norm before scaling: 43.653189484256906. Distance: 2.212083283744903
Total norm for 4 adversaries is: 43.653189484256906. distance: 2.212083283744903
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1808, Accuracy: 9432/9900 (95.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4211/4717 (89.2728%), train_poison_data_count: 370
Global model norm: 43.65556493288542.
Norm before scaling: 43.65031472493569. Distance: 2.037759298663498
Total norm for 4 adversaries is: 43.65031472493569. distance: 2.037759298663498
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1413, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 43.65556493288542.
Norm before scaling: 43.658003163616804. Distance: 2.2677555984059574
Total norm for 4 adversaries is: 43.658003163616804. distance: 2.2677555984059574
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1445, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4367/4928 (88.6161%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4427/4928 (89.8336%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9060, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4383/5037 (87.0161%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4541/5037 (90.1529%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9863, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4804/5392 (89.0950%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4872/5392 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0636, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3971/4501 (88.2248%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4101/4501 (91.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0371, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3348/3804 (88.0126%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3484/3804 (91.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8844, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3376/3837 (87.9854%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9303, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4457/5063 (88.0308%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4301/5063 (84.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2494, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4058/4481 (90.5601%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4083/4481 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9701, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4040/4518 (89.4201%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4162/4518 (92.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9512, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3302/3638 (90.7642%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8025, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4147/4663 (88.9342%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4295/4663 (92.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9757, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3953/4625 (85.4703%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4066/4625 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1579, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4557/5197 (87.6852%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4653/5197 (89.5324%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0663, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4468/5083 (87.9008%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4594/5083 (90.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0801, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3359/3828 (87.7482%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3496/3828 (91.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0093, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3180/3704 (85.8531%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3337/3704 (90.0918%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0183, Accuracy: 5466/10000 (54.6600%)
time spent on training: 233.12470698356628
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.6460, Accuracy: 6190/10000 (61.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 7.3848, Accuracy: 603/9900 (6.0909%)
Done in 257.6155869960785 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 43.6935098468225.
Norm before scaling: 43.69067965002662. Distance: 2.1420902333064666
Total norm for 4 adversaries is: 43.69067965002662. distance: 2.1420902333064666
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2073, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 43.6935098468225.
Norm before scaling: 43.69279183794222. Distance: 2.2131121289736218
Total norm for 4 adversaries is: 43.69279183794222. distance: 2.2131121289736218
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0964, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 43.6935098468225.
Norm before scaling: 43.69138232704977. Distance: 2.0746038909075395
Total norm for 4 adversaries is: 43.69138232704977. distance: 2.0746038909075395
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2564, Accuracy: 9275/9900 (93.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4453/5066 (87.8997%), train_poison_data_count: 400
Global model norm: 43.6935098468225.
Norm before scaling: 43.694310259156595. Distance: 2.263112431038016
Total norm for 4 adversaries is: 43.694310259156595. distance: 2.263112431038016
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1870, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3409/3861 (88.2932%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3514/3861 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9009, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3736/4184 (89.2925%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3856/4184 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8363, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4390/5037 (87.1551%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4584/5037 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9510, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4594/5197 (88.3972%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4563/5197 (87.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0763, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4434/5025 (88.2388%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4531/5025 (90.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9622, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4541/5116 (88.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0410, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4091/4481 (91.2966%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4120/4481 (91.9438%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9513, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4052/4576 (88.5490%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4116/4576 (89.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0016, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4599/5232 (87.9014%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4661/5232 (89.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9755, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4123/4354 (94.6945%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4040/4354 (92.7882%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9901, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2887/3271 (88.2605%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2901/3271 (88.6885%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1044, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4814/5455 (88.2493%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4891/5455 (89.6609%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0330, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3672/4126 (88.9966%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3788/4126 (91.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8717, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3340/3797 (87.9642%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3448/3797 (90.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8967, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3213/3704 (86.7441%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3391/3704 (91.5497%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9546, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4437/4934 (89.9270%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4441/4934 (90.0081%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0511, Accuracy: 5398/10000 (53.9800%)
time spent on training: 233.2733759880066
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7812, Accuracy: 6000/10000 (60.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 7.0147, Accuracy: 730/9900 (7.3737%)
Done in 257.68523263931274 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 43.72232104339699.
Norm before scaling: 43.71978029968958. Distance: 2.0957760473755713
Total norm for 4 adversaries is: 43.71978029968958. distance: 2.0957760473755713
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2800, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 43.72232104339699.
Norm before scaling: 43.72134524775556. Distance: 2.2255919365594883
Total norm for 4 adversaries is: 43.72134524775556. distance: 2.2255919365594883
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2231, Accuracy: 9349/9900 (94.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 43.72232104339699.
Norm before scaling: 43.71701881847618. Distance: 2.0714904888651997
Total norm for 4 adversaries is: 43.71701881847618. distance: 2.0714904888651997
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2928, Accuracy: 9162/9900 (92.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 43.72232104339699.
Norm before scaling: 43.72179755058897. Distance: 2.2664231571591236
Total norm for 4 adversaries is: 43.72179755058897. distance: 2.2664231571591236
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2140, Accuracy: 9339/9900 (94.3333%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4121/4618 (89.2378%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4061/4618 (87.9385%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9584, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3905/4625 (84.4324%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4005/4625 (86.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0388, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5016/5740 (87.3868%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5120/5740 (89.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3140, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3847/4416 (87.1150%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4025/4416 (91.1458%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8639, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3689/4126 (89.4086%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3803/4126 (92.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8215, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3133/3616 (86.6427%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3314/3616 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8213, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3530/4158 (84.8966%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3673/4158 (88.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8650, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3882/4346 (89.3235%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4038/4346 (92.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9135, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4194/4874 (86.0484%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4334/4874 (88.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1612, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4612/5265 (87.5973%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4697/5265 (89.2118%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9913, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3572/4025 (88.7453%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3703/4025 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9602, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4074/4651 (87.5941%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4217/4651 (90.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9970, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3348/3837 (87.2557%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3455/3837 (90.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0529, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3135/3638 (86.1737%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3308/3638 (90.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7919, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3214/3472 (92.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8787, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4038/4456 (90.6194%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4149/4456 (93.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8425, Accuracy: 5813/10000 (58.1300%)
time spent on training: 231.14322876930237
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7919, Accuracy: 5997/10000 (59.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 6.8568, Accuracy: 773/9900 (7.8081%)
Done in 255.57174253463745 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 43.7570683464219.
Norm before scaling: 43.75693025467509. Distance: 2.180440902395456
Total norm for 4 adversaries is: 43.75693025467509. distance: 2.180440902395456
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1411, Accuracy: 9535/9900 (96.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 43.7570683464219.
Norm before scaling: 43.752930984410206. Distance: 2.179888972333605
Total norm for 4 adversaries is: 43.752930984410206. distance: 2.179888972333605
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1237, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4216/4717 (89.3788%), train_poison_data_count: 370
Global model norm: 43.7570683464219.
Norm before scaling: 43.754461268073854. Distance: 2.04994786359037
Total norm for 4 adversaries is: 43.754461268073854. distance: 2.04994786359037
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2286, Accuracy: 9319/9900 (94.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4430/5066 (87.4457%), train_poison_data_count: 400
Global model norm: 43.7570683464219.
Norm before scaling: 43.76190128303671. Distance: 2.35229318615741
Total norm for 4 adversaries is: 43.76190128303671. distance: 2.35229318615741
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1745, Accuracy: 9444/9900 (95.3939%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4799/5424 (88.4771%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4936/5424 (91.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0480, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4380/4986 (87.8460%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4516/4986 (90.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8808, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4578/5167 (88.6007%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4693/5167 (90.8264%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1545, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4186/4716 (88.7617%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4272/4716 (90.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0704, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3809/4368 (87.2024%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3874/4368 (88.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9717, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4019/4356 (92.2635%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3866/4356 (88.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2363, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4384/4804 (91.2573%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4245/4804 (88.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1861, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4101/4481 (91.5198%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4072/4481 (90.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1383, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3580/4025 (88.9441%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8917, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4425/5017 (88.2001%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4592/5017 (91.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9731, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3184/3616 (88.0531%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3346/3616 (92.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7245, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3681/4184 (87.9780%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7619, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4483/5195 (86.2945%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4623/5195 (88.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0670, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3963/4361 (90.8737%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4031/4361 (92.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0008, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3368/3756 (89.6699%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3512/3756 (93.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8980, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4929/5591 (88.1595%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4949/5591 (88.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0137, Accuracy: 5512/10000 (55.1200%)
time spent on training: 235.10739302635193
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8098, Accuracy: 5982/10000 (59.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 6.9312, Accuracy: 723/9900 (7.3030%)
Done in 259.63231587409973 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4381/4885 (89.6827%), train_poison_data_count: 385
Global model norm: 43.78903671386395.
Norm before scaling: 43.787044863196265. Distance: 2.154133628823063
Total norm for 4 adversaries is: 43.787044863196265. distance: 2.154133628823063
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4354, Accuracy: 8827/9900 (89.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4730/5305 (89.1612%), train_poison_data_count: 415
Global model norm: 43.78903671386395.
Norm before scaling: 43.784874493082654. Distance: 2.2252048569572254
Total norm for 4 adversaries is: 43.784874493082654. distance: 2.2252048569572254
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2136, Accuracy: 9373/9900 (94.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 43.78903671386395.
Norm before scaling: 43.786530507751465. Distance: 2.086775136490724
Total norm for 4 adversaries is: 43.786530507751465. distance: 2.086775136490724
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1607, Accuracy: 9486/9900 (95.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 43.78903671386395.
Norm before scaling: 43.790525315664745. Distance: 2.267792815593075
Total norm for 4 adversaries is: 43.790525315664745. distance: 2.267792815593075
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3360, Accuracy: 9049/9900 (91.4040%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3649/4175 (87.4012%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3762/4175 (90.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0857, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4796/5455 (87.9193%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0421, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3186/3704 (86.0151%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3346/3704 (90.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9274, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4306/4989 (86.3099%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4440/4989 (88.9958%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9523, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4300/4928 (87.2565%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4464/4928 (90.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9836, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3335/3804 (87.6709%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3451/3804 (90.7203%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0672, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3839/4336 (88.5378%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3967/4336 (91.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9769, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3584/4046 (88.5813%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3684/4046 (91.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9244, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4347/4793 (90.6948%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9537, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3334/3756 (88.7646%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3483/3756 (92.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0268, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5686/6391 (88.9689%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5749/6391 (89.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0401, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3196/3672 (87.0370%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3361/3672 (91.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9171, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3987/4558 (87.4726%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4117/4558 (90.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1663, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4053/4576 (88.5708%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4135/4576 (90.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0039, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4001/4456 (89.7890%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4114/4456 (92.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0604, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4128/4356 (94.7658%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4034/4356 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9420, Accuracy: 5609/10000 (56.0900%)
time spent on training: 234.20382618904114
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7886, Accuracy: 5974/10000 (59.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 6.6356, Accuracy: 805/9900 (8.1313%)
Done in 259.1410377025604 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 43.821349465133004.
Norm before scaling: 43.820244946685314. Distance: 2.1394656863704866
Total norm for 4 adversaries is: 43.820244946685314. distance: 2.1394656863704866
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1701, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4714/5305 (88.8596%), train_poison_data_count: 415
Global model norm: 43.821349465133004.
Norm before scaling: 43.81883257106041. Distance: 2.221179438013893
Total norm for 4 adversaries is: 43.81883257106041. distance: 2.221179438013893
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2310, Accuracy: 9337/9900 (94.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 43.821349465133004.
Norm before scaling: 43.81625981326381. Distance: 2.086768052844415
Total norm for 4 adversaries is: 43.81625981326381. distance: 2.086768052844415
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1418, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 43.821349465133004.
Norm before scaling: 43.82460296677327. Distance: 2.2535459339512522
Total norm for 4 adversaries is: 43.82460296677327. distance: 2.2535459339512522
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2306, Accuracy: 9294/9900 (93.8788%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4435/5116 (86.6888%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4566/5116 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0412, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5019/5582 (89.9140%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5160/5582 (92.4400%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0744, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4257/4928 (86.3839%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9959, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3734/4126 (90.4993%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3834/4126 (92.9229%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7306, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3529/4158 (84.8725%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3679/4158 (88.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8060, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4540/5063 (89.6702%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4390/5063 (86.7075%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2148, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5455/6124 (89.0758%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5533/6124 (90.3494%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9761, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4167/4354 (95.7051%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4023/4354 (92.3978%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1754, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4444/5025 (88.4378%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4580/5025 (91.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0151, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4259/4679 (91.0237%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4150/4679 (88.6942%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2562, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4207/4793 (87.7738%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4372/4793 (91.2164%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9081, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4038/4518 (89.3758%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4104/4518 (90.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9791, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5167 (88.3491%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4713/5167 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0189, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3940/4433 (88.8789%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4049/4433 (91.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8550, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3980/4503 (88.3855%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4068/4503 (90.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1350, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4131/4707 (87.7629%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4284/4707 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8675, Accuracy: 5708/10000 (57.0800%)
time spent on training: 243.12489652633667
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8303, Accuracy: 5963/10000 (59.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 6.8949, Accuracy: 768/9900 (7.7576%)
Done in 268.60354447364807 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4368/4885 (89.4166%), train_poison_data_count: 385
Global model norm: 43.84840634798273.
Norm before scaling: 43.84886429989521. Distance: 2.1793919297948188
Total norm for 4 adversaries is: 43.84886429989521. distance: 2.1793919297948188
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2556, Accuracy: 9271/9900 (93.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4732/5305 (89.1989%), train_poison_data_count: 415
Global model norm: 43.84840634798273.
Norm before scaling: 43.84474116841152. Distance: 2.2072653317166897
Total norm for 4 adversaries is: 43.84474116841152. distance: 2.2072653317166897
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1819, Accuracy: 9434/9900 (95.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 43.84840634798273.
Norm before scaling: 43.84479963551122. Distance: 2.0918649186893528
Total norm for 4 adversaries is: 43.84479963551122. distance: 2.0918649186893528
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1775, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 43.84840634798273.
Norm before scaling: 43.847099279591745. Distance: 2.272118569268814
Total norm for 4 adversaries is: 43.847099279591745. distance: 2.272118569268814
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1764, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3220/3704 (86.9330%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8862, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4677/5392 (86.7396%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4813/5392 (89.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9772, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3919/4362 (89.8441%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4029/4362 (92.3659%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9143, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4070/4538 (89.6871%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4227/4538 (93.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8827, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3694/4184 (88.2887%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3775/4184 (90.2247%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8464, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3365/3756 (89.5900%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3473/3756 (92.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8617, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4201/4679 (89.7841%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4152/4679 (88.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0391, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3055/3472 (87.9896%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3146/3472 (90.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1197, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5661/6391 (88.5777%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5731/6391 (89.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0012, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4621/5265 (87.7683%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4544/5265 (86.3058%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2428, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5245/5902 (88.8682%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5231/5902 (88.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0199, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5409/6124 (88.3246%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5464/6124 (89.2227%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9173, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4444/5083 (87.4287%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4525/5083 (89.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0421, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3968/4465 (88.8690%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4096/4465 (91.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8617, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3346/3804 (87.9600%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3436/3804 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9345, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4330/4918 (88.0439%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4462/4918 (90.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9705, Accuracy: 5554/10000 (55.5400%)
time spent on training: 240.56747794151306
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7829, Accuracy: 6001/10000 (60.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 7.3931, Accuracy: 573/9900 (5.7879%)
Done in 266.4762554168701 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.88871981002066.
Norm before scaling: 43.88767956919971. Distance: 2.1915796656679487
Total norm for 4 adversaries is: 43.88767956919971. distance: 2.1915796656679487
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3560, Accuracy: 9041/9900 (91.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4724/5305 (89.0481%), train_poison_data_count: 415
Global model norm: 43.88871981002066.
Norm before scaling: 43.886854868780894. Distance: 2.224764556429055
Total norm for 4 adversaries is: 43.886854868780894. distance: 2.224764556429055
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2284, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 43.88871981002066.
Norm before scaling: 43.886686589051415. Distance: 2.041607784538017
Total norm for 4 adversaries is: 43.886686589051415. distance: 2.041607784538017
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1433, Accuracy: 9552/9900 (96.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 43.88871981002066.
Norm before scaling: 43.894800831522886. Distance: 2.310887470438899
Total norm for 4 adversaries is: 43.894800831522886. distance: 2.310887470438899
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2604, Accuracy: 9243/9900 (93.3636%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4055/4538 (89.3565%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4201/4538 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9553, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4287/4989 (85.9290%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4497/4989 (90.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8780, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4163/4793 (86.8558%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4320/4793 (90.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9678, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3516/4158 (84.5599%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3631/4158 (87.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9823, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3398/3861 (88.0083%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3495/3861 (90.5206%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0336, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4549/5232 (86.9457%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4697/5232 (89.7745%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0714, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4147/4663 (88.9342%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4340/4663 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9282, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4643/5197 (89.3400%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4698/5197 (90.3983%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0218, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4616/5167 (89.3362%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0362, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3854/4416 (87.2736%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3959/4416 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8526, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4232/4354 (97.1980%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3889/4354 (89.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2051, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4976/5455 (91.2191%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9140, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4034/4456 (90.5296%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4119/4456 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8898, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2877/3271 (87.9548%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2956/3271 (90.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8437, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2938/3297 (89.1113%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3048/3297 (92.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7322, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4998/5591 (89.3937%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5021/5591 (89.8050%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0964, Accuracy: 5271/10000 (52.7100%)
time spent on training: 239.31963992118835
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8782, Accuracy: 5871/10000 (58.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 6.9333, Accuracy: 902/9900 (9.1111%)
Done in 265.75187253952026 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 43.92036583586537.
Norm before scaling: 43.916310568903384. Distance: 2.145457361363472
Total norm for 4 adversaries is: 43.916310568903384. distance: 2.145457361363472
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1439, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 43.92036583586537.
Norm before scaling: 43.91989334288051. Distance: 2.2335659242853483
Total norm for 4 adversaries is: 43.91989334288051. distance: 2.2335659242853483
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3841, Accuracy: 8967/9900 (90.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 43.92036583586537.
Norm before scaling: 43.91764754201891. Distance: 2.103146434748392
Total norm for 4 adversaries is: 43.91764754201891. distance: 2.103146434748392
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1743, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 43.92036583586537.
Norm before scaling: 43.924035821535824. Distance: 2.315215501085652
Total norm for 4 adversaries is: 43.924035821535824. distance: 2.315215501085652
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1778, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4559/5167 (88.2330%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4701/5167 (90.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0946, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3379/3775 (89.5099%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3527/3775 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9374, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4495/5195 (86.5255%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4631/5195 (89.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0618, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3621/4126 (87.7605%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3801/4126 (92.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8391, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3481/3911 (89.0054%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3352/3911 (85.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1863, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3931/4433 (88.6758%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4053/4433 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9154, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2803/3271 (85.6924%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0063, Accuracy: 2886/3271 (88.2299%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9629, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3199/3590 (89.1086%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3192/3590 (88.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0684, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4302/4918 (87.4746%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4497/4918 (91.4396%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0429, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4384/4986 (87.9262%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4467/4986 (89.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9338, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3112/3616 (86.0619%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9003, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3758/4295 (87.4971%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3892/4295 (90.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0410, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4073/4356 (93.5032%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4013/4356 (92.1258%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9817, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4338/4793 (90.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9645, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3868/4315 (89.6408%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3934/4315 (91.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9160, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4413/4804 (91.8609%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4437/4804 (92.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0272, Accuracy: 5594/10000 (55.9400%)
time spent on training: 241.26877546310425
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9025, Accuracy: 5828/10000 (58.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 6.4974, Accuracy: 1045/9900 (10.5556%)
Done in 270.79741072654724 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 43.951066984346355.
Norm before scaling: 43.94782840020369. Distance: 2.1381656970912646
Total norm for 4 adversaries is: 43.94782840020369. distance: 2.1381656970912646
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1457, Accuracy: 9522/9900 (96.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 43.951066984346355.
Norm before scaling: 43.94738675660221. Distance: 2.2123638175820983
Total norm for 4 adversaries is: 43.94738675660221. distance: 2.2123638175820983
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1139, Accuracy: 9600/9900 (96.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.951066984346355.
Norm before scaling: 43.94754230454048. Distance: 2.0618335918837185
Total norm for 4 adversaries is: 43.94754230454048. distance: 2.0618335918837185
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0883, Accuracy: 9665/9900 (97.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 43.951066984346355.
Norm before scaling: 43.9533666230472. Distance: 2.3254105277277475
Total norm for 4 adversaries is: 43.9533666230472. distance: 2.3254105277277475
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1925, Accuracy: 9400/9900 (94.9495%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3967/4503 (88.0968%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4055/4503 (90.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8724, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4329/4934 (87.7381%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4334/4934 (87.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2688, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4448/4804 (92.5895%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4268/4804 (88.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1193, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3978/4456 (89.2729%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4075/4456 (91.4497%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8784, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4042/4651 (86.9060%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4140/4651 (89.0131%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0285, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3689/4184 (88.1692%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3805/4184 (90.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9220, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4232/4928 (85.8766%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4431/4928 (89.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9048, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3376/3775 (89.4305%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3553/3775 (94.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8797, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4431/5083 (87.1729%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4514/5083 (88.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0344, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4882/5455 (89.4959%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4964/5455 (90.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0649, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3146/3638 (86.4761%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8679, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3527/3911 (90.1815%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3596/3911 (91.9458%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9652, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3385/3837 (88.2200%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3546/3837 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9437, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4003/4501 (88.9358%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4054/4501 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0674, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4611/5197 (88.7243%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4705/5197 (90.5330%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1255, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3406/3861 (88.2155%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3435/3861 (88.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9761, Accuracy: 5509/10000 (55.0900%)
time spent on training: 260.6497714519501
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9612, Accuracy: 5807/10000 (58.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 6.5725, Accuracy: 1051/9900 (10.6162%)
Done in 290.0975706577301 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 43.98458731076646.
Norm before scaling: 43.98403086011018. Distance: 2.1557001712087454
Total norm for 4 adversaries is: 43.98403086011018. distance: 2.1557001712087454
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2402, Accuracy: 9286/9900 (93.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 43.98458731076646.
Norm before scaling: 43.98352574668583. Distance: 2.240657590152903
Total norm for 4 adversaries is: 43.98352574668583. distance: 2.240657590152903
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1654, Accuracy: 9507/9900 (96.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 43.98458731076646.
Norm before scaling: 43.97748475116628. Distance: 1.9928718737747775
Total norm for 4 adversaries is: 43.97748475116628. distance: 1.9928718737747775
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1268, Accuracy: 9568/9900 (96.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 43.98458731076646.
Norm before scaling: 43.985041069557106. Distance: 2.302686229716953
Total norm for 4 adversaries is: 43.985041069557106. distance: 2.302686229716953
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1540, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2858/3271 (87.3739%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2931/3271 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9301, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3861/4511 (85.5908%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4043/4511 (89.6254%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1637, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3155/3638 (86.7235%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3291/3638 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9008, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4985/5582 (89.3049%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5149/5582 (92.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9668, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3961/4456 (88.8914%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4113/4456 (92.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9595, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5352/5902 (90.6811%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5296/5902 (89.7323%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0338, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3806/4416 (86.1866%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3977/4416 (90.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9958, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4483/4934 (90.8593%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4407/4934 (89.3190%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1560, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4079/4596 (88.7511%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4250/4596 (92.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0258, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3373/3837 (87.9072%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8911, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5650/6391 (88.4056%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5754/6391 (90.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0732, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3828/4368 (87.6374%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3888/4368 (89.0110%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0605, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3353/3804 (88.1441%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3499/3804 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8952, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5512/6263 (88.0089%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5689/6263 (90.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2255, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9801, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4824/5424 (88.9381%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4964/5424 (91.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1136, Accuracy: 5311/10000 (53.1100%)
time spent on training: 255.42292857170105
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9430, Accuracy: 5844/10000 (58.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 6.7866, Accuracy: 874/9900 (8.8283%)
Done in 282.11427903175354 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 44.01849254060019.
Norm before scaling: 44.01708929939172. Distance: 2.191299952684593
Total norm for 4 adversaries is: 44.01708929939172. distance: 2.191299952684593
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3520, Accuracy: 9007/9900 (90.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 44.01849254060019.
Norm before scaling: 44.01424801493617. Distance: 2.2037062723600136
Total norm for 4 adversaries is: 44.01424801493617. distance: 2.2037062723600136
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2328, Accuracy: 9331/9900 (94.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 44.01849254060019.
Norm before scaling: 44.014669573851315. Distance: 2.1092950876428245
Total norm for 4 adversaries is: 44.014669573851315. distance: 2.1092950876428245
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1402, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 44.01849254060019.
Norm before scaling: 44.02013144751217. Distance: 2.3302908430184033
Total norm for 4 adversaries is: 44.02013144751217. distance: 2.3302908430184033
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3402, Accuracy: 9060/9900 (91.5152%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4452/5055 (88.0712%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5055 (90.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9036, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3706/4184 (88.5755%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3804/4184 (90.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9123, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3428/3861 (88.7853%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3508/3861 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9936, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4372/4804 (91.0075%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4084/4804 (85.0125%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2511, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3080/3472 (88.7097%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3151/3472 (90.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9323, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3483/3969 (87.7551%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3566/3969 (89.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9139, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4409/4989 (88.3744%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0444, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4980/5582 (89.2153%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5056/5582 (90.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0707, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0079, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4094/4662 (87.8164%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4217/4662 (90.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0399, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4516/4934 (91.5282%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4436/4934 (89.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1090, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4387/4986 (87.9864%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4493/4986 (90.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0527, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3934/4433 (88.7435%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4039/4433 (91.1121%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8902, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4148/4716 (87.9559%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4271/4716 (90.5640%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9267, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4078/4596 (88.7293%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4249/4596 (92.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0828, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4217/4354 (96.8535%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4008/4354 (92.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1420, Accuracy: 5305/10000 (53.0500%)
time spent on training: 236.89639163017273
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9043, Accuracy: 5881/10000 (58.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 6.7969, Accuracy: 851/9900 (8.5960%)
Done in 262.0833218097687 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4394/4885 (89.9488%), train_poison_data_count: 385
Global model norm: 44.05436399841323.
Norm before scaling: 44.05352579267209. Distance: 2.1761955264053663
Total norm for 4 adversaries is: 44.05352579267209. distance: 2.1761955264053663
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1024, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4693/5305 (88.4637%), train_poison_data_count: 415
Global model norm: 44.05436399841323.
Norm before scaling: 44.05171355119884. Distance: 2.2817923541267016
Total norm for 4 adversaries is: 44.05171355119884. distance: 2.2817923541267016
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1425, Accuracy: 9548/9900 (96.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 44.05436399841323.
Norm before scaling: 44.04912668286895. Distance: 2.0789474351337787
Total norm for 4 adversaries is: 44.04912668286895. distance: 2.0789474351337787
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2075, Accuracy: 9317/9900 (94.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 44.05436399841323.
Norm before scaling: 44.05610409032087. Distance: 2.302817720906063
Total norm for 4 adversaries is: 44.05610409032087. distance: 2.302817720906063
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.3849, Accuracy: 8977/9900 (90.6768%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4461/5116 (87.1970%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4566/5116 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9006, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4091/4662 (87.7520%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4229/4662 (90.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9368, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5311/5902 (89.9864%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5347/5902 (90.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1365, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4505/5063 (88.9789%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4572/5063 (90.3022%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1941, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4217/4354 (96.8535%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3757/4354 (86.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.5357, Accuracy: 4691/10000 (46.9100%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4549/5195 (87.5650%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4599/5195 (88.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0307, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4066/4356 (93.3425%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3883/4356 (89.1414%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2101, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3778/4295 (87.9627%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3859/4295 (89.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0674, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5578/6263 (89.0627%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5684/6263 (90.7552%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1237, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3924/4511 (86.9874%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4074/4511 (90.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9686, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4166/4663 (89.3416%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4341/4663 (93.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9387, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3857/4336 (88.9530%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4001/4336 (92.2740%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0578, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4252/4928 (86.2825%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0036, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3597/4046 (88.9026%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3709/4046 (91.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0644, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3216/3672 (87.5817%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3325/3672 (90.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9827, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3990/4356 (91.5978%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4078/4356 (93.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9209, Accuracy: 5633/10000 (56.3300%)
time spent on training: 239.90930891036987
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9811, Accuracy: 5706/10000 (57.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 7.2380, Accuracy: 518/9900 (5.2323%)
Done in 265.12275886535645 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 44.09422063001851.
Norm before scaling: 44.09456529411037. Distance: 2.179069841712522
Total norm for 4 adversaries is: 44.09456529411037. distance: 2.179069841712522
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1521, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4693/5305 (88.4637%), train_poison_data_count: 415
Global model norm: 44.09422063001851.
Norm before scaling: 44.09509681899522. Distance: 2.3429715707627756
Total norm for 4 adversaries is: 44.09509681899522. distance: 2.3429715707627756
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1672, Accuracy: 9475/9900 (95.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4205/4717 (89.1456%), train_poison_data_count: 370
Global model norm: 44.09422063001851.
Norm before scaling: 44.092057074606. Distance: 2.163827931605569
Total norm for 4 adversaries is: 44.092057074606. distance: 2.163827931605569
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1575, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4451/5066 (87.8602%), train_poison_data_count: 400
Global model norm: 44.09422063001851.
Norm before scaling: 44.09789137178217. Distance: 2.388518358913471
Total norm for 4 adversaries is: 44.09789137178217. distance: 2.388518358913471
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2399, Accuracy: 9291/9900 (93.8485%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4369/5037 (86.7381%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4639/5037 (92.0985%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9167, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4083/4647 (87.8631%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4178/4647 (89.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9402, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4150/4663 (88.9985%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4279/4663 (91.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9308, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3835/4336 (88.4456%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3977/4336 (91.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9656, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3331/3756 (88.6848%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3474/3756 (92.4920%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0101, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4019/4625 (86.8973%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4150/4625 (89.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0202, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3847/4362 (88.1935%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4037/4362 (92.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0042, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4266/4874 (87.5256%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4354/4874 (89.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1420, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4090/4767 (85.7982%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4240/4767 (88.9448%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1978, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3331/3775 (88.2384%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3491/3775 (92.4768%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8814, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4141/4662 (88.8245%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4247/4662 (91.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0048, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5441/6124 (88.8472%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5486/6124 (89.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9706, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3907/4511 (86.6105%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4070/4511 (90.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0388, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3576/3911 (91.4344%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3546/3911 (90.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8067, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4927/5591 (88.1238%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5030/5591 (89.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1424, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3629/4126 (87.9544%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3785/4126 (91.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9552, Accuracy: 5522/10000 (55.2200%)
time spent on training: 254.01127338409424
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9130, Accuracy: 5808/10000 (58.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 7.3515, Accuracy: 511/9900 (5.1616%)
Done in 285.220974445343 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 44.1241783519464.
Norm before scaling: 44.12287806955282. Distance: 2.2106570008614552
Total norm for 4 adversaries is: 44.12287806955282. distance: 2.2106570008614552
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1462, Accuracy: 9529/9900 (96.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4719/5305 (88.9538%), train_poison_data_count: 415
Global model norm: 44.1241783519464.
Norm before scaling: 44.1249585029904. Distance: 2.336265413367145
Total norm for 4 adversaries is: 44.1249585029904. distance: 2.336265413367145
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1498, Accuracy: 9510/9900 (96.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4197/4717 (88.9760%), train_poison_data_count: 370
Global model norm: 44.1241783519464.
Norm before scaling: 44.12017916963776. Distance: 2.1307459170785643
Total norm for 4 adversaries is: 44.12017916963776. distance: 2.1307459170785643
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0537, Accuracy: 9752/9900 (98.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 44.1241783519464.
Norm before scaling: 44.127802341076595. Distance: 2.33693283462477
Total norm for 4 adversaries is: 44.127802341076595. distance: 2.33693283462477
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2166, Accuracy: 9339/9900 (94.3333%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4485/5025 (89.2537%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4558/5025 (90.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2048, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4441/5116 (86.8061%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4584/5116 (89.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9832, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4580/5167 (88.6394%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4670/5167 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0134, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4010/4558 (87.9772%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4092/4558 (89.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9236, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4051/4651 (87.0995%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4207/4651 (90.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0577, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3871/4336 (89.2758%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3960/4336 (91.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0228, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4456/5055 (88.1503%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4621/5055 (91.4144%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0346, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3373/3775 (89.3510%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3490/3775 (92.4503%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8874, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4568/5265 (86.7616%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4651/5265 (88.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9585, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3561/4025 (88.4720%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3727/4025 (92.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8227, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4328/4989 (86.7509%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4450/4989 (89.1962%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8942, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4190/4793 (87.4192%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4314/4793 (90.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9298, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3355/3804 (88.1966%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3474/3804 (91.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9314, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3341/3797 (87.9905%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3447/3797 (90.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9180, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3949/4433 (89.0819%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4073/4433 (91.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9101, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4160/4707 (88.3790%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4282/4707 (90.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8607, Accuracy: 5618/10000 (56.1800%)
time spent on training: 264.90611958503723
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8933, Accuracy: 5837/10000 (58.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 7.7100, Accuracy: 394/9900 (3.9798%)
Done in 295.26204085350037 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 44.15949679544099.
Norm before scaling: 44.15807039108551. Distance: 2.1307968284315506
Total norm for 4 adversaries is: 44.15807039108551. distance: 2.1307968284315506
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2526, Accuracy: 9278/9900 (93.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4730/5305 (89.1612%), train_poison_data_count: 415
Global model norm: 44.15949679544099.
Norm before scaling: 44.15682086724046. Distance: 2.2659941273922084
Total norm for 4 adversaries is: 44.15682086724046. distance: 2.2659941273922084
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0934, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 44.15949679544099.
Norm before scaling: 44.1525343447293. Distance: 2.0157260130181647
Total norm for 4 adversaries is: 44.1525343447293. distance: 2.0157260130181647
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.3277, Accuracy: 9117/9900 (92.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 44.15949679544099.
Norm before scaling: 44.16216150494745. Distance: 2.3230580741595697
Total norm for 4 adversaries is: 44.16216150494745. distance: 2.3230580741595697
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1111, Accuracy: 9605/9900 (97.0202%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4761/5392 (88.2975%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4818/5392 (89.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9873, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4142/4663 (88.8269%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4305/4663 (92.3225%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0636, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3382/3797 (89.0703%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3390/3797 (89.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0689, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4962/5582 (88.8929%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5047/5582 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0640, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4541/5167 (87.8847%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4670/5167 (90.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0551, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3362/3781 (88.9183%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3386/3781 (89.5530%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9643, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3504/3969 (88.2842%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3613/3969 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0051, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3346/3837 (87.2035%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0048, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5325/5902 (90.2237%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5283/5902 (89.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1295, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4864/5455 (89.1659%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4935/5455 (90.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9731, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4395/5037 (87.2543%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4503/5037 (89.3985%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8956, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4436/5017 (88.4194%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5017 (91.2498%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9368, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4401/4986 (88.2671%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4545/4986 (91.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9400, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4580/5197 (88.1278%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4629/5197 (89.0706%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1406, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3899/4361 (89.4061%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3806/4361 (87.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1520, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5581/6263 (89.1106%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5729/6263 (91.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1588, Accuracy: 5364/10000 (53.6400%)
time spent on training: 271.57071256637573
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8375, Accuracy: 5911/10000 (59.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 7.9752, Accuracy: 319/9900 (3.2222%)
Done in 300.77870512008667 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 44.1908439439276.
Norm before scaling: 44.188093944912076. Distance: 2.159125249306673
Total norm for 4 adversaries is: 44.188093944912076. distance: 2.159125249306673
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1085, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 44.1908439439276.
Norm before scaling: 44.186747197883754. Distance: 2.24771277416598
Total norm for 4 adversaries is: 44.186747197883754. distance: 2.24771277416598
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1093, Accuracy: 9623/9900 (97.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 44.1908439439276.
Norm before scaling: 44.18257409336429. Distance: 2.0354002588470403
Total norm for 4 adversaries is: 44.18257409336429. distance: 2.0354002588470403
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1287, Accuracy: 9547/9900 (96.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 44.1908439439276.
Norm before scaling: 44.18849727039408. Distance: 2.265405052295142
Total norm for 4 adversaries is: 44.18849727039408. distance: 2.265405052295142
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2589, Accuracy: 9271/9900 (93.6465%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4489/5017 (89.4758%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4548/5017 (90.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7535, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4306/4928 (87.3782%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4422/4928 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9232, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3745/4184 (89.5076%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3843/4184 (91.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8798, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4171/4793 (87.0227%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0099, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5073/5740 (88.3798%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5153/5740 (89.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0816, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3377/3756 (89.9095%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3497/3756 (93.1044%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8700, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3747/4235 (88.4770%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3817/4235 (90.1299%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9736, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3698/4223 (87.5681%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3879/4223 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8519, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4482/5063 (88.5246%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4400/5063 (86.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9634, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4382/4989 (87.8332%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4436/4989 (88.9156%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9043, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4308/4928 (87.4188%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9225, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5307/5902 (89.9187%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5229/5902 (88.5971%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0520, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4016/4456 (90.1257%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4114/4456 (92.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8345, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5460/6124 (89.1574%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5497/6124 (89.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9383, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3510/3828 (91.6928%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9186, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3164/3616 (87.5000%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3283/3616 (90.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7833, Accuracy: 5791/10000 (57.9100%)
time spent on training: 270.9043891429901
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7765, Accuracy: 6031/10000 (60.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.3301, Accuracy: 327/9900 (3.3030%)
Done in 301.46622824668884 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 44.22603324515508.
Norm before scaling: 44.2230701290698. Distance: 2.1106909144091737
Total norm for 4 adversaries is: 44.2230701290698. distance: 2.1106909144091737
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2367, Accuracy: 9366/9900 (94.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4710/5305 (88.7842%), train_poison_data_count: 415
Global model norm: 44.22603324515508.
Norm before scaling: 44.22007092770841. Distance: 2.26507719586255
Total norm for 4 adversaries is: 44.22007092770841. distance: 2.26507719586255
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2187, Accuracy: 9345/9900 (94.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 44.22603324515508.
Norm before scaling: 44.21915166557854. Distance: 2.064628774051135
Total norm for 4 adversaries is: 44.21915166557854. distance: 2.064628774051135
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1876, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 44.22603324515508.
Norm before scaling: 44.228560086710374. Distance: 2.2882229564114356
Total norm for 4 adversaries is: 44.228560086710374. distance: 2.2882229564114356
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2446, Accuracy: 9289/9900 (93.8283%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3692/4223 (87.4260%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3816/4223 (90.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9347, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3883/4362 (89.0188%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3979/4362 (91.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1023, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5694/6391 (89.0940%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5687/6391 (88.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1118, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4155/4793 (86.6889%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4330/4793 (90.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0638, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3347/3756 (89.1108%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3481/3756 (92.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9912, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4133/4618 (89.4976%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4094/4618 (88.6531%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0109, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3545/4025 (88.0745%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3699/4025 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8381, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3164/3638 (86.9709%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3324/3638 (91.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7769, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3893/4315 (90.2202%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3992/4315 (92.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7950, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3834/4295 (89.2666%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3715/4295 (86.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9557, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4459/4928 (90.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8493, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4384/4986 (87.9262%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4488/4986 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8488, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3653/4126 (88.5361%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3746/4126 (90.7901%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8806, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4372/4918 (88.8979%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4461/4918 (90.7076%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1494, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4537/5195 (87.3340%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4562/5195 (87.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0232, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5096/5740 (88.7805%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5217/5740 (90.8885%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1295, Accuracy: 5394/10000 (53.9400%)
time spent on training: 262.07538771629333
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7898, Accuracy: 6009/10000 (60.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 8.3086, Accuracy: 330/9900 (3.3333%)
Done in 291.9747095108032 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 44.26869280977176.
Norm before scaling: 44.262548703993964. Distance: 2.1000075703439043
Total norm for 4 adversaries is: 44.262548703993964. distance: 2.1000075703439043
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1159, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 44.26869280977176.
Norm before scaling: 44.26274727011912. Distance: 2.231460804958528
Total norm for 4 adversaries is: 44.26274727011912. distance: 2.231460804958528
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1815, Accuracy: 9446/9900 (95.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 44.26869280977176.
Norm before scaling: 44.26033407975546. Distance: 2.0276516072403163
Total norm for 4 adversaries is: 44.26033407975546. distance: 2.0276516072403163
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.4222, Accuracy: 8921/9900 (90.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 44.26869280977176.
Norm before scaling: 44.27072089446506. Distance: 2.306128617067099
Total norm for 4 adversaries is: 44.27072089446506. distance: 2.306128617067099
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1090, Accuracy: 9631/9900 (97.2828%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2916/3297 (88.4440%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3060/3297 (92.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7460, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3368/3828 (87.9833%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0365, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4612/5063 (91.0922%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4528/5063 (89.4331%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9450, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3985/4501 (88.5359%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4039/4501 (89.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0121, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4208/4793 (87.7947%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4359/4793 (90.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9585, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3728/4223 (88.2785%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3888/4223 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0185, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3389/3756 (90.2290%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3510/3756 (93.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8864, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3166/3638 (87.0258%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8549, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3195/3646 (87.6303%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3376/3646 (92.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8565, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4377/4874 (89.8030%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4381/4874 (89.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9277, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5671/6263 (90.5477%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5750/6263 (91.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0801, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4381/5037 (86.9764%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4553/5037 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0199, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3935/4362 (90.2109%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3951/4362 (90.5777%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9740, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4045/4356 (92.8604%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4086/4356 (93.8017%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9401, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4500/5116 (87.9593%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4537/5116 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9421, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3930/4346 (90.4280%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4072/4346 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7992, Accuracy: 5826/10000 (58.2600%)
time spent on training: 262.2924199104309
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8406, Accuracy: 5947/10000 (59.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 8.2987, Accuracy: 360/9900 (3.6364%)
Done in 292.91088914871216 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 44.30033606408223.
Norm before scaling: 44.29598902332679. Distance: 2.133373591917372
Total norm for 4 adversaries is: 44.29598902332679. distance: 2.133373591917372
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2396, Accuracy: 9311/9900 (94.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 44.30033606408223.
Norm before scaling: 44.29743027650207. Distance: 2.2413028473801386
Total norm for 4 adversaries is: 44.29743027650207. distance: 2.2413028473801386
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2443, Accuracy: 9311/9900 (94.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 44.30033606408223.
Norm before scaling: 44.29333236495294. Distance: 2.025267726954816
Total norm for 4 adversaries is: 44.29333236495294. distance: 2.025267726954816
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2701, Accuracy: 9194/9900 (92.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4521/5066 (89.2420%), train_poison_data_count: 400
Global model norm: 44.30033606408223.
Norm before scaling: 44.299480467908. Distance: 2.246253815628063
Total norm for 4 adversaries is: 44.299480467908. distance: 2.246253815628063
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2836, Accuracy: 9177/9900 (92.6970%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4045/4518 (89.5308%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4139/4518 (91.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9003, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4008/4558 (87.9333%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4112/4558 (90.2150%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9883, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3371/3804 (88.6172%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0417, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3383/3775 (89.6159%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3555/3775 (94.1722%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8055, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4431/5083 (87.1729%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4516/5083 (88.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9859, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4362/4928 (88.5146%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4486/4928 (91.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8662, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4519/5244 (86.1747%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4548/5244 (86.7277%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0194, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4515/4989 (90.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9014, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4422/4986 (88.6883%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4504/4986 (90.3329%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8477, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3770/4175 (90.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9908, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4594/5232 (87.8058%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4593/5232 (87.7867%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1866, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4685/5063 (92.5341%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4581/5063 (90.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0692, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3982/4441 (89.6645%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4064/4441 (91.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9959, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3210/3646 (88.0417%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3353/3646 (91.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7694, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4567/5167 (88.3878%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4731/5167 (91.5618%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0681, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4041/4538 (89.0480%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4189/4538 (92.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8185, Accuracy: 5677/10000 (56.7700%)
time spent on training: 265.3495399951935
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8279, Accuracy: 5952/10000 (59.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 8.2477, Accuracy: 353/9900 (3.5657%)
Done in 294.98974609375 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.33642552044185.
Norm before scaling: 44.33029630961694. Distance: 2.0814208089483826
Total norm for 4 adversaries is: 44.33029630961694. distance: 2.0814208089483826
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2167, Accuracy: 9409/9900 (95.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 44.33642552044185.
Norm before scaling: 44.32932976640931. Distance: 2.1695071698817814
Total norm for 4 adversaries is: 44.32932976640931. distance: 2.1695071698817814
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1045, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4209/4717 (89.2304%), train_poison_data_count: 370
Global model norm: 44.33642552044185.
Norm before scaling: 44.33174195456978. Distance: 2.1000126792888247
Total norm for 4 adversaries is: 44.33174195456978. distance: 2.1000126792888247
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1753, Accuracy: 9483/9900 (95.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 44.33642552044185.
Norm before scaling: 44.333592311322604. Distance: 2.2428749439550106
Total norm for 4 adversaries is: 44.333592311322604. distance: 2.2428749439550106
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0918, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4072/4356 (93.4803%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3939/4356 (90.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9989, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4346/4928 (88.1899%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4383/4928 (88.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0738, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4449/5037 (88.3264%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4566/5037 (90.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8733, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4474/4804 (93.1307%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4516/4804 (94.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9674, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3426/3775 (90.7550%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3578/3775 (94.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7454, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4610/5167 (89.2201%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4713/5167 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2775, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3787/4235 (89.4215%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3894/4235 (91.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9464, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4956 (88.2365%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4406/4956 (88.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0639, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5071/5740 (88.3449%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5209/5740 (90.7491%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0494, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4235/4679 (90.5108%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4331/4679 (92.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9919, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3232/3704 (87.2570%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3389/3704 (91.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8052, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3120/3472 (89.8618%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3197/3472 (92.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9174, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4128/4651 (88.7551%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4252/4651 (91.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0115, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4089/4634 (88.2391%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4247/4634 (91.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7948, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5311/5902 (89.9864%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5277/5902 (89.4104%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9896, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3388/3837 (88.2981%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8494, Accuracy: 5663/10000 (56.6300%)
time spent on training: 265.7163665294647
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8208, Accuracy: 5955/10000 (59.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 7.9701, Accuracy: 424/9900 (4.2828%)
Done in 294.5526535511017 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 44.3737524582558.
Norm before scaling: 44.370111416463395. Distance: 2.1010917505042146
Total norm for 4 adversaries is: 44.370111416463395. distance: 2.1010917505042146
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2793, Accuracy: 9229/9900 (93.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.3737524582558.
Norm before scaling: 44.36808374799108. Distance: 2.219381000894197
Total norm for 4 adversaries is: 44.36808374799108. distance: 2.219381000894197
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1599, Accuracy: 9506/9900 (96.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 44.3737524582558.
Norm before scaling: 44.36527732395291. Distance: 2.0392686293904885
Total norm for 4 adversaries is: 44.36527732395291. distance: 2.0392686293904885
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2546, Accuracy: 9305/9900 (93.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 44.3737524582558.
Norm before scaling: 44.37413896611826. Distance: 2.316865769299214
Total norm for 4 adversaries is: 44.37413896611826. distance: 2.316865769299214
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1558, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3520/3969 (88.6873%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3610/3969 (90.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8908, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4185/4707 (88.9101%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4276/4707 (90.8434%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8083, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3512/3861 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8166, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4120/4596 (89.6432%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4243/4596 (92.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0280, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3976/4503 (88.2967%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4052/4503 (89.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0290, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4393/4928 (89.1437%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4538/4928 (92.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8560, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4465/5025 (88.8557%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4591/5025 (91.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0108, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4075/4576 (89.0516%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4200/4576 (91.7832%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9685, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4366/4918 (88.7759%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4496/4918 (91.4193%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8345, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3944/4315 (91.4021%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3972/4315 (92.0510%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8689, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3236/3590 (90.1393%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9736, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3992/4456 (89.5871%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4119/4456 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9552, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4221/4354 (96.9453%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3967/4354 (91.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1671, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3992/4501 (88.6914%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4084/4501 (90.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9083, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3580/3911 (91.5367%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3635/3911 (92.9430%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8625, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4006/4558 (87.8894%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4122/4558 (90.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0644, Accuracy: 5387/10000 (53.8700%)
time spent on training: 261.20301818847656
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7936, Accuracy: 5970/10000 (59.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 8.1499, Accuracy: 399/9900 (4.0303%)
Done in 290.06958508491516 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 44.40129200198247.
Norm before scaling: 44.39724491953653. Distance: 2.1165300875876576
Total norm for 4 adversaries is: 44.39724491953653. distance: 2.1165300875876576
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1476, Accuracy: 9535/9900 (96.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 44.40129200198247.
Norm before scaling: 44.39483216599512. Distance: 2.1965672718343057
Total norm for 4 adversaries is: 44.39483216599512. distance: 2.1965672718343057
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1731, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 44.40129200198247.
Norm before scaling: 44.39326621190355. Distance: 2.0365648428795313
Total norm for 4 adversaries is: 44.39326621190355. distance: 2.0365648428795313
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1414, Accuracy: 9551/9900 (96.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 44.40129200198247.
Norm before scaling: 44.39897432259486. Distance: 2.249824834998825
Total norm for 4 adversaries is: 44.39897432259486. distance: 2.249824834998825
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2100, Accuracy: 9359/9900 (94.5354%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4485/5116 (87.6661%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4590/5116 (89.7185%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2288, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4849/5392 (89.9295%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4810/5392 (89.2062%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0499, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4151/4767 (87.0778%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4232/4767 (88.7770%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1835, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4144/4618 (89.7358%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4191/4618 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8828, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3635/4046 (89.8418%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3741/4046 (92.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8621, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4037/4625 (87.2865%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4132/4625 (89.3405%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9494, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3195/3638 (87.8230%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3361/3638 (92.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8468, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3858/4416 (87.3641%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3979/4416 (90.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9338, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4327/4874 (88.7772%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4372/4874 (89.7005%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0834, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3219/3646 (88.2885%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3331/3646 (91.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7935, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4696/5063 (92.7513%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4717/5063 (93.1661%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0065, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3678/4126 (89.1420%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3842/4126 (93.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8191, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4477/4934 (90.7377%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4461/4934 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0558, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4039/4511 (89.5367%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4113/4511 (91.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9014, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4041/4518 (89.4422%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9369, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2953/3297 (89.5663%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3008/3297 (91.2345%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8096, Accuracy: 5769/10000 (57.6900%)
time spent on training: 260.169851064682
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7467, Accuracy: 6056/10000 (60.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 8.0310, Accuracy: 469/9900 (4.7374%)
Done in 288.7206223011017 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 44.432674612746275.
Norm before scaling: 44.429105714276005. Distance: 2.1665287218441587
Total norm for 4 adversaries is: 44.429105714276005. distance: 2.1665287218441587
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0547, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.432674612746275.
Norm before scaling: 44.428543840784386. Distance: 2.23045357132806
Total norm for 4 adversaries is: 44.428543840784386. distance: 2.23045357132806
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0918, Accuracy: 9691/9900 (97.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 44.432674612746275.
Norm before scaling: 44.42250977826444. Distance: 2.0546493236635786
Total norm for 4 adversaries is: 44.42250977826444. distance: 2.0546493236635786
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2556, Accuracy: 9247/9900 (93.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 44.432674612746275.
Norm before scaling: 44.4289422359246. Distance: 2.2494142617638513
Total norm for 4 adversaries is: 44.4289422359246. distance: 2.2494142617638513
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1676, Accuracy: 9470/9900 (95.6566%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5529/6124 (90.2841%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5560/6124 (90.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9679, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4421/5025 (87.9801%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5025 (91.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0996, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3123/3472 (89.9482%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3161/3472 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9515, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4431/5037 (87.9690%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4540/5037 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9501, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5049/5582 (90.4515%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5122/5582 (91.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1473, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4491/5116 (87.7834%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4568/5116 (89.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0766, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4032/4518 (89.2430%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9652, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4302/4928 (87.2971%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4422/4928 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0009, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4037/4558 (88.5695%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4063/4558 (89.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0755, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2940/3297 (89.1720%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3025/3297 (91.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7622, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3402/3756 (90.5751%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3520/3756 (93.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9840, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4159/4651 (89.4216%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4208/4651 (90.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0558, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3938/4441 (88.6737%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4101/4441 (92.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1699, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3171/3638 (87.1633%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3315/3638 (91.1215%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8542, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4127/4596 (89.7955%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4191/4596 (91.1880%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9207, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2901/3271 (88.6885%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2974/3271 (90.9202%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8180, Accuracy: 5704/10000 (57.0400%)
time spent on training: 257.98361802101135
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7444, Accuracy: 6058/10000 (60.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 8.2829, Accuracy: 429/9900 (4.3333%)
Done in 286.3848361968994 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 44.466960171288974.
Norm before scaling: 44.461801657609705. Distance: 2.122341624934805
Total norm for 4 adversaries is: 44.461801657609705. distance: 2.122341624934805
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2134, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 44.466960171288974.
Norm before scaling: 44.45943908365031. Distance: 2.219562972586298
Total norm for 4 adversaries is: 44.45943908365031. distance: 2.219562972586298
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1067, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 44.466960171288974.
Norm before scaling: 44.45913843333421. Distance: 2.0749004845712538
Total norm for 4 adversaries is: 44.45913843333421. distance: 2.0749004845712538
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1479, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 44.466960171288974.
Norm before scaling: 44.4605002669153. Distance: 2.1913340075547625
Total norm for 4 adversaries is: 44.4605002669153. distance: 2.1913340075547625
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2533, Accuracy: 9251/9900 (93.4444%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4410/4989 (88.3945%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4494/4989 (90.0782%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9750, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4021/4465 (90.0560%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4147/4465 (92.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8536, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3892/4315 (90.1970%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3955/4315 (91.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8251, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4111/4767 (86.2387%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4255/4767 (89.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2110, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5866/6391 (91.7853%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5831/6391 (91.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9548, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3266/3672 (88.9434%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3335/3672 (90.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8694, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3575/3969 (90.0731%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3606/3969 (90.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8184, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3242/3590 (90.3064%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3210/3590 (89.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9999, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5467/5902 (92.6296%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5357/5902 (90.7658%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0261, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3647/4013 (90.8796%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3777/4013 (94.1191%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7731, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4469/4804 (93.0266%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4142/4804 (86.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2500, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3672/4175 (87.9521%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8770, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3199/3616 (88.4679%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8456, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3998/4361 (91.6762%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3994/4361 (91.5845%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0070, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4804/5424 (88.5693%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4968/5424 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2549, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3416/3837 (89.0279%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3586/3837 (93.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9183, Accuracy: 5660/10000 (56.6000%)
time spent on training: 259.8900203704834
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8813, Accuracy: 5891/10000 (58.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.0235, Accuracy: 227/9900 (2.2929%)
Done in 288.54885816574097 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 44.49937729989179.
Norm before scaling: 44.492251289462615. Distance: 2.0808296672690467
Total norm for 4 adversaries is: 44.492251289462615. distance: 2.0808296672690467
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1709, Accuracy: 9472/9900 (95.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 44.49937729989179.
Norm before scaling: 44.49423077507493. Distance: 2.2454210949295654
Total norm for 4 adversaries is: 44.49423077507493. distance: 2.2454210949295654
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3030, Accuracy: 9160/9900 (92.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 44.49937729989179.
Norm before scaling: 44.490256625134364. Distance: 2.007587346021163
Total norm for 4 adversaries is: 44.490256625134364. distance: 2.007587346021163
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3279, Accuracy: 9078/9900 (91.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 44.49937729989179.
Norm before scaling: 44.492642255138655. Distance: 2.2208892824760738
Total norm for 4 adversaries is: 44.492642255138655. distance: 2.2208892824760738
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1259, Accuracy: 9536/9900 (96.3232%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3841/4416 (86.9792%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3977/4416 (90.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9067, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5073/5740 (88.3798%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0926, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4430/5037 (87.9492%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4620/5037 (91.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9188, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4624/5116 (90.3831%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4645/5116 (90.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9569, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4389/4918 (89.2436%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4465/4918 (90.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9854, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3391/3837 (88.3763%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9433, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4119/4651 (88.5616%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4220/4651 (90.7332%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0291, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3450/3861 (89.3551%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3554/3861 (92.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8094, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3719/4223 (88.0654%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3896/4223 (92.2567%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8598, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4163/4662 (89.2964%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4299/4662 (92.2136%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9051, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5672/6263 (90.5636%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5701/6263 (91.0267%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0863, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3389/3781 (89.6324%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3306/3781 (87.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0992, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3374/3804 (88.6961%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3471/3804 (91.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9534, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3417/3828 (89.2633%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3528/3828 (92.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7804, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3899/4315 (90.3592%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3992/4315 (92.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8657, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4330/4956 (87.3688%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0212, Accuracy: 5527/10000 (55.2700%)
time spent on training: 260.2673330307007
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8451, Accuracy: 5898/10000 (58.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 9.7000, Accuracy: 126/9900 (1.2727%)
Done in 289.020325422287 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 44.52643066026908.
Norm before scaling: 44.516542253185925. Distance: 2.0963740061577387
Total norm for 4 adversaries is: 44.516542253185925. distance: 2.0963740061577387
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1163, Accuracy: 9607/9900 (97.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 44.52643066026908.
Norm before scaling: 44.51856315988098. Distance: 2.197163192056816
Total norm for 4 adversaries is: 44.51856315988098. distance: 2.197163192056816
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0880, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 44.52643066026908.
Norm before scaling: 44.52145451475474. Distance: 2.066120899595865
Total norm for 4 adversaries is: 44.52145451475474. distance: 2.066120899595865
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1318, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 44.52643066026908.
Norm before scaling: 44.523076278364485. Distance: 2.223010740521045
Total norm for 4 adversaries is: 44.523076278364485. distance: 2.223010740521045
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1948, Accuracy: 9420/9900 (95.1515%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4153/4662 (89.0819%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4243/4662 (91.0124%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0353, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3184/3616 (88.0531%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9479, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3380/3828 (88.2968%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8836, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2915/3297 (88.4137%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3011/3297 (91.3254%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8519, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3985/4361 (91.3781%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3925/4361 (90.0023%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8948, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4065/4576 (88.8330%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4209/4576 (91.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9524, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3770/4295 (87.7765%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3733/4295 (86.9150%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1223, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4454/5083 (87.6254%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4622/5083 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1205, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4610/5116 (90.1095%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4686/5116 (91.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8993, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3609/4046 (89.1992%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4046 (92.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8543, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5417/5902 (91.7824%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5265/5902 (89.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1241, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4650/5197 (89.4747%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4717/5197 (90.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1102, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4010/4465 (89.8096%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4164/4465 (93.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7524, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3239/3704 (87.4460%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3397/3704 (91.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7618, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3464/3861 (89.7177%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3523/3861 (91.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9599, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3686/4126 (89.3359%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3806/4126 (92.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8561, Accuracy: 5708/10000 (57.0800%)
time spent on training: 259.3672378063202
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8304, Accuracy: 5947/10000 (59.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.1625, Accuracy: 175/9900 (1.7677%)
Done in 287.78222012519836 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 44.55604572824546.
Norm before scaling: 44.545444557882405. Distance: 2.0722369768210025
Total norm for 4 adversaries is: 44.545444557882405. distance: 2.0722369768210025
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2594, Accuracy: 9265/9900 (93.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 44.55604572824546.
Norm before scaling: 44.547953281846326. Distance: 2.2271456841452877
Total norm for 4 adversaries is: 44.547953281846326. distance: 2.2271456841452877
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2023, Accuracy: 9395/9900 (94.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 44.55604572824546.
Norm before scaling: 44.54836293989938. Distance: 1.9983548908592705
Total norm for 4 adversaries is: 44.54836293989938. distance: 1.9983548908592705
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3523, Accuracy: 9090/9900 (91.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 44.55604572824546.
Norm before scaling: 44.55158937917858. Distance: 2.236782883961452
Total norm for 4 adversaries is: 44.55158937917858. distance: 2.236782883961452
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3134, Accuracy: 9148/9900 (92.4040%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3990/4511 (88.4505%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4093/4511 (90.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9176, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5136/5740 (89.4774%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5192/5740 (90.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9312, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4199/4662 (90.0686%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4278/4662 (91.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9478, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3769/4235 (88.9965%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3881/4235 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9165, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4758/5265 (90.3704%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4803/5265 (91.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9268, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4433 (90.5256%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7606, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4152/4596 (90.3394%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4285/4596 (93.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8903, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4584/5055 (90.6825%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4611/5055 (91.2166%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8988, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4426/5037 (87.8698%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9507, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4109/4538 (90.5465%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4264/4538 (93.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7618, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8755, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3632/4025 (90.2360%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3722/4025 (92.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8941, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4616/5244 (88.0244%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4651/5244 (88.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9445, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4189/4663 (89.8349%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4322/4663 (92.6871%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9457, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3414/3837 (88.9758%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3529/3837 (91.9729%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8751, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4077/4481 (90.9842%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4078/4481 (91.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9872, Accuracy: 5688/10000 (56.8800%)
time spent on training: 262.5023560523987
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8111, Accuracy: 5988/10000 (59.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.2411, Accuracy: 190/9900 (1.9192%)
Done in 290.93030285835266 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 44.584396739410835.
Norm before scaling: 44.580900226880374. Distance: 2.1654171886618405
Total norm for 4 adversaries is: 44.580900226880374. distance: 2.1654171886618405
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2079, Accuracy: 9424/9900 (95.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 44.584396739410835.
Norm before scaling: 44.574607456295254. Distance: 2.1860609498247934
Total norm for 4 adversaries is: 44.574607456295254. distance: 2.1860609498247934
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2314, Accuracy: 9340/9900 (94.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 44.584396739410835.
Norm before scaling: 44.57883696417085. Distance: 2.066519548450587
Total norm for 4 adversaries is: 44.57883696417085. distance: 2.066519548450587
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1704, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 44.584396739410835.
Norm before scaling: 44.580523726209464. Distance: 2.2772850172998353
Total norm for 4 adversaries is: 44.580523726209464. distance: 2.2772850172998353
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1532, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3969/4362 (90.9904%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3906/4362 (89.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1286, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5008/5591 (89.5725%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5022/5591 (89.8229%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1385, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3910/4315 (90.6141%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4002/4315 (92.7462%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9036, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3479/3781 (92.0127%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3500/3781 (92.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9520, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3608/4158 (86.7725%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3717/4158 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0569, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3983/4511 (88.2953%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4061/4511 (90.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9162, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4220/4793 (88.0451%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4393/4793 (91.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9197, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4888/5424 (90.1180%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5011/5424 (92.3857%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1587, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4150/4618 (89.8657%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4232/4618 (91.6414%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0147, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3903/4368 (89.3544%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3945/4368 (90.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0462, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4584/4934 (92.9064%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4222/4934 (85.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2991, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4641/5232 (88.7041%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4687/5232 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0056, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5448/5902 (92.3077%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5474/5902 (92.7482%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0351, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4753/5392 (88.1491%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4838/5392 (89.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0803, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4561/5017 (90.9109%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4551/5017 (90.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9681, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4519/5195 (86.9875%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4596/5195 (88.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1056, Accuracy: 5379/10000 (53.7900%)
time spent on training: 265.6983366012573
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6382978723404256.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8241, Accuracy: 5968/10000 (59.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 8.9185, Accuracy: 254/9900 (2.5657%)
Done in 294.375203371048 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 44.62201550331546.
Norm before scaling: 44.61526203492828. Distance: 2.0967547363722616
Total norm for 4 adversaries is: 44.61526203492828. distance: 2.0967547363722616
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3149, Accuracy: 9145/9900 (92.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 44.62201550331546.
Norm before scaling: 44.61594194220968. Distance: 2.242797343296024
Total norm for 4 adversaries is: 44.61594194220968. distance: 2.242797343296024
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1518, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 44.62201550331546.
Norm before scaling: 44.612309721767794. Distance: 2.051690878995094
Total norm for 4 adversaries is: 44.612309721767794. distance: 2.051690878995094
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.3872, Accuracy: 8979/9900 (90.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 44.62201550331546.
Norm before scaling: 44.61798160188964. Distance: 2.229030593093942
Total norm for 4 adversaries is: 44.61798160188964. distance: 2.229030593093942
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1771, Accuracy: 9437/9900 (95.3232%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4750/5265 (90.2184%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4788/5265 (90.9402%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8509, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3696/4126 (89.5783%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3817/4126 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7878, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4049/4501 (89.9578%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4044/4501 (89.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9822, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5494/6124 (89.7126%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5520/6124 (90.1372%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0004, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2897/3271 (88.5662%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2915/3271 (89.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9225, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4217/4663 (90.4353%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4316/4663 (92.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9661, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3629/4025 (90.1615%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3764/4025 (93.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8191, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4102/4651 (88.1961%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0132, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4522/4804 (94.1299%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4404/4804 (91.6736%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9669, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3194/3616 (88.3296%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3320/3616 (91.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7482, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3561/3911 (91.0509%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3475/3911 (88.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1874, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4605/5197 (88.6088%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4673/5197 (89.9173%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0382, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4084/4538 (89.9956%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4218/4538 (92.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7870, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5753/6391 (90.0172%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5786/6391 (90.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0766, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3254/3704 (87.8510%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3381/3704 (91.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8480, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3760/4235 (88.7839%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3777/4235 (89.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1242, Accuracy: 5367/10000 (53.6700%)
time spent on training: 263.08494877815247
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9256, Accuracy: 5822/10000 (58.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 9.0555, Accuracy: 189/9900 (1.9091%)
Done in 291.665593624115 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 44.649675316393676.
Norm before scaling: 44.64722152215564. Distance: 2.192908114093404
Total norm for 4 adversaries is: 44.64722152215564. distance: 2.192908114093404
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0891, Accuracy: 9658/9900 (97.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 44.649675316393676.
Norm before scaling: 44.641303153756894. Distance: 2.2262741169809277
Total norm for 4 adversaries is: 44.641303153756894. distance: 2.2262741169809277
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0845, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 44.649675316393676.
Norm before scaling: 44.64214262821062. Distance: 2.077858699859259
Total norm for 4 adversaries is: 44.64214262821062. distance: 2.077858699859259
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.3180, Accuracy: 9153/9900 (92.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 44.649675316393676.
Norm before scaling: 44.64512988076429. Distance: 2.2886964681085002
Total norm for 4 adversaries is: 44.64512988076429. distance: 2.2886964681085002
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1581, Accuracy: 9493/9900 (95.8889%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4585/5116 (89.6208%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4657/5116 (91.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9359, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5015/5582 (89.8424%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5158/5582 (92.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0494, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3830/4235 (90.4368%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3787/4235 (89.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9517, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4091/4625 (88.4541%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4118/4625 (89.0378%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1568, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4121/4481 (91.9661%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4107/4481 (91.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8580, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4638/5232 (88.6468%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4699/5232 (89.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9517, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4177/4662 (89.5967%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4325/4662 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9239, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4030/4441 (90.7453%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4142/4441 (93.2673%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9975, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4052/4518 (89.6857%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8977, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4366/4928 (88.5958%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4504/4928 (91.3961%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8088, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4119/4634 (88.8865%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4208/4634 (90.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9488, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4656/4934 (94.3656%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4641/4934 (94.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9490, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3435/3861 (88.9666%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9594, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3193/3616 (88.3020%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3334/3616 (92.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8576, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3895/4416 (88.2020%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4016/4416 (90.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9732, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3363/3797 (88.5699%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3468/3797 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8938, Accuracy: 5738/10000 (57.3800%)
time spent on training: 262.8422529697418
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.6808510638297872.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8414, Accuracy: 5943/10000 (59.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 8.9776, Accuracy: 224/9900 (2.2626%)
Done in 291.5902235507965 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 44.679276996933936.
Norm before scaling: 44.67555156040675. Distance: 2.1563934057342573
Total norm for 4 adversaries is: 44.67555156040675. distance: 2.1563934057342573
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1977, Accuracy: 9408/9900 (95.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 44.679276996933936.
Norm before scaling: 44.67118091450992. Distance: 2.21345511472943
Total norm for 4 adversaries is: 44.67118091450992. distance: 2.21345511472943
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1239, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 44.679276996933936.
Norm before scaling: 44.66917511078669. Distance: 2.024973047336123
Total norm for 4 adversaries is: 44.66917511078669. distance: 2.024973047336123
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3172, Accuracy: 9107/9900 (91.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 44.679276996933936.
Norm before scaling: 44.67065624430511. Distance: 2.1743835671857243
Total norm for 4 adversaries is: 44.67065624430511. distance: 2.1743835671857243
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.4016, Accuracy: 8924/9900 (90.1414%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5626/6263 (89.8292%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5744/6263 (91.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1627, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3891/4295 (90.5937%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3832/4295 (89.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9237, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4376/4989 (87.7130%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4494/4989 (90.0782%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8463, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3752/4223 (88.8468%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3921/4223 (92.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8218, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5518/6124 (90.1045%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5527/6124 (90.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0140, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4133/4481 (92.2339%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4111/4481 (91.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0168, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4176/4618 (90.4288%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4184/4618 (90.6020%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0418, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4045/4441 (91.0831%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4096/4441 (92.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0850, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3606/4013 (89.8580%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3732/4013 (92.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8495, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3986/4511 (88.3618%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4103/4511 (90.9554%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8587, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3850/4416 (87.1830%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3950/4416 (89.4475%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9062, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4328/4956 (87.3285%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4417/4956 (89.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1130, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4058/4538 (89.4227%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9790, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4634/5265 (88.0152%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4780/5265 (90.7882%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9437, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4632/5197 (89.1283%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4665/5197 (89.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9984, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4238/4716 (89.8643%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4278/4716 (90.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9002, Accuracy: 5616/10000 (56.1600%)
time spent on training: 265.35696268081665
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8025, Accuracy: 5975/10000 (59.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 8.6200, Accuracy: 334/9900 (3.3737%)
Done in 294.22029209136963 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 44.711399585896295.
Norm before scaling: 44.70373530472943. Distance: 2.1440089967382328
Total norm for 4 adversaries is: 44.70373530472943. distance: 2.1440089967382328
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2593, Accuracy: 9245/9900 (93.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 44.711399585896295.
Norm before scaling: 44.70832529390849. Distance: 2.2813016284691843
Total norm for 4 adversaries is: 44.70832529390849. distance: 2.2813016284691843
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2103, Accuracy: 9383/9900 (94.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 44.711399585896295.
Norm before scaling: 44.70311271189974. Distance: 2.0494062773472046
Total norm for 4 adversaries is: 44.70311271189974. distance: 2.0494062773472046
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0737, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 44.711399585896295.
Norm before scaling: 44.70568221670415. Distance: 2.228496688508228
Total norm for 4 adversaries is: 44.70568221670415. distance: 2.228496688508228
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2695, Accuracy: 9224/9900 (93.1717%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3210/3616 (88.7721%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8587, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3965/4315 (91.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9923, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4926/5455 (90.3025%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0671, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4574/4804 (95.2123%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4444/4804 (92.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0692, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3943/4362 (90.3943%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3945/4362 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0563, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5665/6263 (90.4519%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5711/6263 (91.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9835, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4114/4538 (90.6567%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4215/4538 (92.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8986, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4186/4634 (90.3323%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4192/4634 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0016, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4602/5116 (89.9531%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4687/5116 (91.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8000, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4166/4716 (88.3376%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4261/4716 (90.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0162, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3732/4046 (92.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0431, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4039/4518 (89.3980%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4147/4518 (91.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8807, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4645/5063 (91.7440%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4517/5063 (89.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0397, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5129/5740 (89.3554%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5196/5740 (90.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1018, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5069/5582 (90.8097%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5106/5582 (91.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1345, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4006/4433 (90.3677%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4096/4433 (92.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8948, Accuracy: 5620/10000 (56.2000%)
time spent on training: 261.49353289604187
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8468, Accuracy: 5871/10000 (58.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 8.1525, Accuracy: 393/9900 (3.9697%)
Done in 290.302134513855 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 44.74230140656882.
Norm before scaling: 44.736025882042206. Distance: 2.134501029855422
Total norm for 4 adversaries is: 44.736025882042206. distance: 2.134501029855422
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1660, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 44.74230140656882.
Norm before scaling: 44.73582668793687. Distance: 2.207625857574709
Total norm for 4 adversaries is: 44.73582668793687. distance: 2.207625857574709
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1332, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 44.74230140656882.
Norm before scaling: 44.73192858093995. Distance: 2.0575259948423263
Total norm for 4 adversaries is: 44.73192858093995. distance: 2.0575259948423263
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2037, Accuracy: 9378/9900 (94.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 44.74230140656882.
Norm before scaling: 44.73688267945141. Distance: 2.2185209988899968
Total norm for 4 adversaries is: 44.73688267945141. distance: 2.2185209988899968
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2952, Accuracy: 9143/9900 (92.3535%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4610/5197 (88.7050%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4557/5197 (87.6852%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0409, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3602/4025 (89.4907%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3728/4025 (92.6211%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8905, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4148/4481 (92.5686%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4145/4481 (92.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9961, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4123/4651 (88.6476%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4244/4651 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9353, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5355/5902 (90.7320%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5306/5902 (89.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9994, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3668/4126 (88.8997%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3780/4126 (91.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7858, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3920/4368 (89.7436%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3912/4368 (89.5604%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0485, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5818/6391 (91.0343%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5878/6391 (91.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1025, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3718/4175 (89.0539%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3708/4175 (88.8144%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9000, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4143/4596 (90.1436%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4248/4596 (92.4282%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9962, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4147/4634 (89.4907%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8360, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3764/4223 (89.1309%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3868/4223 (91.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9975, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3549/3911 (90.7441%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3373/3911 (86.2439%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9911, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3978/4433 (89.7361%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4128/4433 (93.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8331, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3889/4336 (89.6910%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4336 (92.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9495, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3181/3638 (87.4382%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3332/3638 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9035, Accuracy: 5633/10000 (56.3300%)
time spent on training: 263.4610946178436
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8391, Accuracy: 5889/10000 (58.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 7.9274, Accuracy: 409/9900 (4.1313%)
Done in 292.25228214263916 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 44.77165099057522.
Norm before scaling: 44.77014865887202. Distance: 2.1411795907099553
Total norm for 4 adversaries is: 44.77014865887202. distance: 2.1411795907099553
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2491, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 44.77165099057522.
Norm before scaling: 44.766606664629215. Distance: 2.235055459719069
Total norm for 4 adversaries is: 44.766606664629215. distance: 2.235055459719069
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1765, Accuracy: 9463/9900 (95.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 44.77165099057522.
Norm before scaling: 44.75912092802985. Distance: 2.0129410965208954
Total norm for 4 adversaries is: 44.75912092802985. distance: 2.0129410965208954
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1528, Accuracy: 9510/9900 (96.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 44.77165099057522.
Norm before scaling: 44.76448787822776. Distance: 2.1847300839819908
Total norm for 4 adversaries is: 44.76448787822776. distance: 2.1847300839819908
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2587, Accuracy: 9254/9900 (93.4747%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3411/3756 (90.8147%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3506/3756 (93.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8819, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4885/5424 (90.0627%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4961/5424 (91.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1568, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3989/4433 (89.9842%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4023/4433 (90.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8903, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3969/4501 (88.1804%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4501 (90.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0035, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3637/4025 (90.3602%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3758/4025 (93.3665%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7738, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3803/4235 (89.7993%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3875/4235 (91.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8716, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5563/6124 (90.8393%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5525/6124 (90.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0277, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4181/4634 (90.2244%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4189/4634 (90.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9998, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4248/4716 (90.0763%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0558, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4135/4767 (86.7422%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4206/4767 (88.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2010, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3363/3804 (88.4069%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3482/3804 (91.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9483, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3137/3472 (90.3514%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3254/3472 (93.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0313, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4833/5392 (89.6328%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4869/5392 (90.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0752, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5152/5740 (89.7561%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5247/5740 (91.4111%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0122, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4110/4596 (89.4256%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4241/4596 (92.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8625, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3186/3616 (88.1084%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3322/3616 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8753, Accuracy: 5682/10000 (56.8200%)
time spent on training: 262.0799241065979
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7887, Accuracy: 5960/10000 (59.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 8.1621, Accuracy: 351/9900 (3.5455%)
Done in 291.1657168865204 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 44.800917316309636.
Norm before scaling: 44.79140291831263. Distance: 2.1241540908092014
Total norm for 4 adversaries is: 44.79140291831263. distance: 2.1241540908092014
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1415, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 44.800917316309636.
Norm before scaling: 44.796260514184524. Distance: 2.2492050249980142
Total norm for 4 adversaries is: 44.796260514184524. distance: 2.2492050249980142
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0551, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 44.800917316309636.
Norm before scaling: 44.792065162956035. Distance: 2.0531387584114973
Total norm for 4 adversaries is: 44.792065162956035. distance: 2.0531387584114973
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1140, Accuracy: 9598/9900 (96.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 44.800917316309636.
Norm before scaling: 44.79588037350645. Distance: 2.1905316734296685
Total norm for 4 adversaries is: 44.79588037350645. distance: 2.1905316734296685
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.3108, Accuracy: 9173/9900 (92.6566%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4677/5063 (92.3761%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4560/5063 (90.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0311, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4574/4804 (95.2123%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4320/4804 (89.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2074, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4048/4558 (88.8109%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4117/4558 (90.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1312, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3391/3756 (90.2822%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3515/3756 (93.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8222, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4898/5424 (90.3024%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4973/5424 (91.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9872, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4032/4511 (89.3815%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4146/4511 (91.9087%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8134, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4639/5167 (89.7813%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4759/5167 (92.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0113, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4124/4356 (94.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9624, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4590/5244 (87.5286%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4679/5244 (89.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9777, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4263/4793 (88.9422%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9513, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3448/3828 (90.0731%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7872, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3657/4046 (90.3856%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3760/4046 (92.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9193, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3635/4013 (90.5806%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3744/4013 (93.2968%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7764, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8567, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3991/4362 (91.4947%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4027/4362 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9245, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3964/4346 (91.2103%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4101/4346 (94.3626%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7379, Accuracy: 5911/10000 (59.1100%)
time spent on training: 261.0182948112488
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.75.
Suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8253, Accuracy: 5926/10000 (59.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 8.0393, Accuracy: 383/9900 (3.8687%)
Done in 289.59220457077026 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.821399863705594.
Norm before scaling: 44.81565430844171. Distance: 2.137974901592647
Total norm for 4 adversaries is: 44.81565430844171. distance: 2.137974901592647
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1201, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 44.821399863705594.
Norm before scaling: 44.81389331646702. Distance: 2.2390838302586578
Total norm for 4 adversaries is: 44.81389331646702. distance: 2.2390838302586578
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1335, Accuracy: 9574/9900 (96.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 44.821399863705594.
Norm before scaling: 44.812094118629126. Distance: 2.077045131422596
Total norm for 4 adversaries is: 44.812094118629126. distance: 2.077045131422596
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0793, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 44.821399863705594.
Norm before scaling: 44.814549780961904. Distance: 2.18228465028301
Total norm for 4 adversaries is: 44.814549780961904. distance: 2.18228465028301
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2623, Accuracy: 9260/9900 (93.5354%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3707/4126 (89.8449%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3802/4126 (92.1474%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7768, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5021/5455 (92.0440%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5075/5455 (93.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0199, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4045/4558 (88.7451%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4046/4558 (88.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0797, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3914/4235 (92.4203%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9336, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3357/3804 (88.2492%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3519/3804 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8702, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5788/6391 (90.5649%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5776/6391 (90.3771%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9999, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3905/4336 (90.0600%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4336 (91.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0349, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4178/4663 (89.5990%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9116, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4047/4511 (89.7140%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4140/4511 (91.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8341, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4054/4503 (90.0289%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4053/4503 (90.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1651, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4632/5063 (91.4873%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4559/5063 (90.0454%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0258, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3898/4315 (90.3360%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4013/4315 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8391, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3226/3638 (88.6751%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3353/3638 (92.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8217, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4092/4441 (92.1414%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9769, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4300/4679 (91.9000%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4184/4679 (89.4208%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1311, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4752/5265 (90.2564%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4702/5265 (89.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0539, Accuracy: 5339/10000 (53.3900%)
time spent on training: 260.1540629863739
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.6136363636363636.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.6363636363636364.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.6818181818181818.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.7727272727272727.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.6818181818181818.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.6136363636363636.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.6818181818181818.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.6136363636363636.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6590909090909091.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.6818181818181818.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.75.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6363636363636364.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6590909090909091.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.7045454545454546.
Suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8436, Accuracy: 5882/10000 (58.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 8.3504, Accuracy: 338/9900 (3.4141%)
Done in 288.8545231819153 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 44.85015878638628.
Norm before scaling: 44.843151128405324. Distance: 2.130811038636004
Total norm for 4 adversaries is: 44.843151128405324. distance: 2.130811038636004
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1584, Accuracy: 9532/9900 (96.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 44.85015878638628.
Norm before scaling: 44.843242320732536. Distance: 2.251627015904277
Total norm for 4 adversaries is: 44.843242320732536. distance: 2.251627015904277
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0998, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4288/4717 (90.9052%), train_poison_data_count: 370
Global model norm: 44.85015878638628.
Norm before scaling: 44.841391216274026. Distance: 2.0060749773825433
Total norm for 4 adversaries is: 44.841391216274026. distance: 2.0060749773825433
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.2220, Accuracy: 9385/9900 (94.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 44.85015878638628.
Norm before scaling: 44.8447285934165. Distance: 2.2163102611561527
Total norm for 4 adversaries is: 44.8447285934165. distance: 2.2163102611561527
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0984, Accuracy: 9671/9900 (97.6869%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3936/4336 (90.7749%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4007/4336 (92.4124%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0585, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3405/3828 (88.9498%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8141, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3260/3672 (88.7800%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3285/3672 (89.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8389, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4154/4651 (89.3141%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4208/4651 (90.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8632, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3998/4361 (91.6762%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3962/4361 (90.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9759, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4547/5025 (90.4876%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4602/5025 (91.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0492, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5476/6124 (89.4187%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5583/6124 (91.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2446, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3301/3704 (89.1199%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3420/3704 (92.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8639, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4636/4934 (93.9603%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4367/4934 (88.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1754, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4498/5017 (89.6552%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4629/5017 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7835, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5001/5582 (89.5915%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5092/5582 (91.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0056, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4660/5167 (90.1877%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4684/5167 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2350, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3455/3861 (89.4846%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3474/3861 (89.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1128, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3357/3646 (92.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7063, Accuracy: 5976/10000 (59.7600%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4181/4558 (91.7288%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4122/4558 (90.4344%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9744, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4628/5116 (90.4613%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4676/5116 (91.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8902, Accuracy: 5621/10000 (56.2100%)
time spent on training: 262.6179428100586
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.7045454545454546.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.7045454545454546.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.7727272727272727.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.7727272727272727.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.7045454545454546.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6136363636363636.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.7727272727272727.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.75.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6363636363636364.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.7727272727272727.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.6818181818181818.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.7045454545454546.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6818181818181818.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.75.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.7954545454545454.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.7954545454545454.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.7272727272727273.
Suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9417, Accuracy: 5762/10000 (57.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 8.0858, Accuracy: 366/9900 (3.6970%)
Done in 290.99824118614197 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 44.88355838697019.
Norm before scaling: 44.875987432555455. Distance: 2.1792839524439303
Total norm for 4 adversaries is: 44.875987432555455. distance: 2.1792839524439303
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0206, Accuracy: 9838/9900 (99.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 44.88355838697019.
Norm before scaling: 44.874791901937414. Distance: 2.23905156645997
Total norm for 4 adversaries is: 44.874791901937414. distance: 2.23905156645997
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0721, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4288/4717 (90.9052%), train_poison_data_count: 370
Global model norm: 44.88355838697019.
Norm before scaling: 44.87252316240906. Distance: 2.025731263167385
Total norm for 4 adversaries is: 44.87252316240906. distance: 2.025731263167385
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1073, Accuracy: 9627/9900 (97.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 44.88355838697019.
Norm before scaling: 44.87914407876099. Distance: 2.2453540944153687
Total norm for 4 adversaries is: 44.87914407876099. distance: 2.2453540944153687
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1845, Accuracy: 9440/9900 (95.3535%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3954/4511 (87.6524%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4172/4511 (92.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8749, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3961/4346 (91.1413%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4062/4346 (93.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8941, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4528/4804 (94.2548%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4327/4804 (90.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2635, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4596/5232 (87.8440%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4656/5232 (88.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0201, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4188/4618 (90.6886%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4172/4618 (90.3421%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0054, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3256/3590 (90.6964%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3245/3590 (90.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0746, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5767/6391 (90.2363%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5777/6391 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9387, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4165/4354 (95.6592%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3890/4354 (89.3431%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0336, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4546/5055 (89.9308%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4650/5055 (91.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8791, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3461/3837 (90.2007%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3572/3837 (93.0936%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8646, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4036/4503 (89.6291%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4119/4503 (91.4724%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9592, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4171/4576 (91.1495%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4229/4576 (92.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8243, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4377/4793 (91.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0124, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4180/4634 (90.2028%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4270/4634 (92.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8240, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3622/4158 (87.1092%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3707/4158 (89.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0573, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5127/5740 (89.3206%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5236/5740 (91.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0963, Accuracy: 5337/10000 (53.3700%)
time spent on training: 263.53591895103455
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.6363636363636364.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.7272727272727273.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.7045454545454546.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.7727272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.6818181818181818.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.7727272727272727.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.6590909090909091.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.7727272727272727.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6363636363636364.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.6363636363636364.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.6363636363636364.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.6590909090909091.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.9545454545454546.
Suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1730, Accuracy: 5481/10000 (54.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 8.7334, Accuracy: 193/9900 (1.9495%)
Done in 292.0722541809082 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 44.91526310036489.
Norm before scaling: 44.90866245912015. Distance: 2.166156513114101
Total norm for 4 adversaries is: 44.90866245912015. distance: 2.166156513114101
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1950, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 44.91526310036489.
Norm before scaling: 44.90635329668008. Distance: 2.254304582909518
Total norm for 4 adversaries is: 44.90635329668008. distance: 2.254304582909518
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1039, Accuracy: 9642/9900 (97.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 44.91526310036489.
Norm before scaling: 44.90593603100054. Distance: 2.0835715602727314
Total norm for 4 adversaries is: 44.90593603100054. distance: 2.0835715602727314
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.3457, Accuracy: 9034/9900 (91.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4532/5066 (89.4591%), train_poison_data_count: 400
Global model norm: 44.91526310036489.
Norm before scaling: 44.911865732718674. Distance: 2.2652560229581864
Total norm for 4 adversaries is: 44.911865732718674. distance: 2.2652560229581864
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2785, Accuracy: 9195/9900 (92.8788%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3703/4184 (88.5038%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3824/4184 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8904, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5613/6263 (89.6216%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0960, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4031/4456 (90.4623%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4119/4456 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8938, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4107/4538 (90.5024%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4220/4538 (92.9925%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9048, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3772/4235 (89.0673%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3771/4235 (89.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1117, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3759/4223 (89.0126%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3887/4223 (92.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9297, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4945/5455 (90.6508%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4984/5455 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9475, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4403/5037 (87.4131%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4584/5037 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9117, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3401/3756 (90.5485%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3513/3756 (93.5304%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0875, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4730/5265 (89.8386%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4742/5265 (90.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8657, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4484/5055 (88.7043%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4555/5055 (90.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0342, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4579/4804 (95.3164%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4389/4804 (91.3614%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1070, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4623/5063 (91.3095%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4555/5063 (89.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8719, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3879/4295 (90.3143%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3934/4295 (91.5949%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8407, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2919/3271 (89.2388%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2951/3271 (90.2171%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8492, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4040/4356 (92.7456%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4136/4356 (94.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8976, Accuracy: 5691/10000 (56.9100%)
time spent on training: 264.4283344745636
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.8409090909090909.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.75.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.8863636363636364.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.8181818181818182.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.8181818181818182.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.9318181818181818.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.8863636363636364.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.8636363636363636.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.8636363636363636.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.8636363636363636.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.7272727272727273.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.9318181818181818.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.8636363636363636.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.8636363636363636.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.8636363636363636.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.8409090909090909.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.8863636363636364.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.8181818181818182.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.8636363636363636.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.8636363636363636.
Suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2188, Accuracy: 5384/10000 (53.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 8.2263, Accuracy: 231/9900 (2.3333%)
Done in 293.0627751350403 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 44.94454047768205.
Norm before scaling: 44.93743208878735. Distance: 2.136081858670144
Total norm for 4 adversaries is: 44.93743208878735. distance: 2.136081858670144
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1558, Accuracy: 9503/9900 (95.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 44.94454047768205.
Norm before scaling: 44.9419370962238. Distance: 2.2499245525002296
Total norm for 4 adversaries is: 44.9419370962238. distance: 2.2499245525002296
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2049, Accuracy: 9406/9900 (95.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 44.94454047768205.
Norm before scaling: 44.93550880063422. Distance: 2.0793063599081525
Total norm for 4 adversaries is: 44.93550880063422. distance: 2.0793063599081525
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2243, Accuracy: 9378/9900 (94.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 44.94454047768205.
Norm before scaling: 44.94161115365066. Distance: 2.243509361517911
Total norm for 4 adversaries is: 44.94161115365066. distance: 2.243509361517911
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2680, Accuracy: 9254/9900 (93.4747%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4062/4503 (90.2065%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4073/4503 (90.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0557, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3991/4456 (89.5646%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4456 (92.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0061, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4734/5265 (89.9145%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4791/5265 (90.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8942, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4199/4793 (87.6069%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9332, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4374/4928 (88.7581%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4507/4928 (91.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8991, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3298/3638 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9250, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4153/4663 (89.0628%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4342/4663 (93.1160%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9018, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4306/4928 (87.3782%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4460/4928 (90.5032%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0011, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4010/4465 (89.8096%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4123/4465 (92.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9091, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3650/3911 (93.3265%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3577/3911 (91.4600%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9547, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4055/4518 (89.7521%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0591, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3771/4235 (89.0437%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3880/4235 (91.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9677, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4667/4934 (94.5886%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4327/4934 (87.6976%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1115, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4142/4647 (89.1328%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4273/4647 (91.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8508, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4160/4651 (89.4431%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0973, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4390/4989 (87.9936%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4469/4989 (89.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9446, Accuracy: 5631/10000 (56.3100%)
time spent on training: 264.4307177066803
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.7727272727272727.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.6590909090909091.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.8181818181818182.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.8409090909090909.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.8409090909090909.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6363636363636364.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.7954545454545454.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.8409090909090909.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.8863636363636364.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.7727272727272727.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.8636363636363636.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.7727272727272727.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.7727272727272727.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.8636363636363636.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.8181818181818182.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.7727272727272727.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.8863636363636364.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.8409090909090909.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.75.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.8636363636363636.
Suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3098, Accuracy: 5257/10000 (52.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 8.0474, Accuracy: 261/9900 (2.6364%)
Done in 293.1525273323059 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 44.97989324018497.
Norm before scaling: 44.975193900707644. Distance: 2.194880975958995
Total norm for 4 adversaries is: 44.975193900707644. distance: 2.194880975958995
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0812, Accuracy: 9696/9900 (97.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 44.97989324018497.
Norm before scaling: 44.97412857644868. Distance: 2.2821328531988794
Total norm for 4 adversaries is: 44.97412857644868. distance: 2.2821328531988794
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2286, Accuracy: 9378/9900 (94.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 44.97989324018497.
Norm before scaling: 44.968885727731234. Distance: 2.083065498937508
Total norm for 4 adversaries is: 44.968885727731234. distance: 2.083065498937508
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1320, Accuracy: 9548/9900 (96.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 44.97989324018497.
Norm before scaling: 44.97900036275609. Distance: 2.2924398562862978
Total norm for 4 adversaries is: 44.97900036275609. distance: 2.2924398562862978
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0871, Accuracy: 9651/9900 (97.4848%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4092/4538 (90.1719%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4186/4538 (92.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8878, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3952/4362 (90.6006%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3953/4362 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9800, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4488/5244 (85.5835%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4687/5244 (89.3783%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8715, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3604/4046 (89.0756%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3651/4046 (90.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0455, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3622/4013 (90.2567%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3720/4013 (92.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7897, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3997/4465 (89.5185%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4465 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9529, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4571/5232 (87.3662%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4681/5232 (89.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0462, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4315/4928 (87.5609%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9244, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4585/5063 (90.5590%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4676/5063 (92.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8567, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5357/5902 (90.7658%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5385/5902 (91.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0055, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4052/4456 (90.9336%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4101/4456 (92.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8860, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4093/4596 (89.0557%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4202/4596 (91.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0231, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3999/4441 (90.0473%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4116/4441 (92.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0677, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5123/5740 (89.2509%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0710, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3113/3472 (89.6601%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3185/3472 (91.7339%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0316, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3414/3861 (88.4227%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3512/3861 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8123, Accuracy: 5803/10000 (58.0300%)
time spent on training: 262.7260775566101
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.8181818181818182.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.6136363636363636.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.6818181818181818.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.8636363636363636.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.7272727272727273.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.7272727272727273.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.6818181818181818.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.7954545454545454.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.7272727272727273.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.9318181818181818.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.6590909090909091.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.75.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6363636363636364.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6170212765957447.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.8181818181818182.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.75.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.7045454545454546.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.7727272727272727.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.7727272727272727.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.7727272727272727.
Suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Misclassification from 30 to 95 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2874, Accuracy: 5244/10000 (52.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 8.1150, Accuracy: 227/9900 (2.2929%)
Done in 291.5796265602112 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 45.01551246297978.
Norm before scaling: 45.01143382302643. Distance: 2.1414318930737304
Total norm for 4 adversaries is: 45.01143382302643. distance: 2.1414318930737304
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2591, Accuracy: 9236/9900 (93.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 45.01551246297978.
Norm before scaling: 45.01351386710509. Distance: 2.271552494041204
Total norm for 4 adversaries is: 45.01351386710509. distance: 2.271552494041204
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2575, Accuracy: 9294/9900 (93.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 45.01551246297978.
Norm before scaling: 45.004261408469695. Distance: 2.095018258937029
Total norm for 4 adversaries is: 45.004261408469695. distance: 2.095018258937029
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0822, Accuracy: 9699/9900 (97.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 45.01551246297978.
Norm before scaling: 45.00835425923725. Distance: 2.221775946575398
Total norm for 4 adversaries is: 45.00835425923725. distance: 2.221775946575398
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1543, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3414/3797 (89.9131%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3468/3797 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9289, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2903/3297 (88.0497%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7757, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3620/3911 (92.5594%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3555/3911 (90.8975%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0774, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2847/3271 (87.0376%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2876/3271 (87.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9225, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3660/4046 (90.4597%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3749/4046 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9705, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5130/5740 (89.3728%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5248/5740 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9920, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3558/3969 (89.6447%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3639/3969 (91.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8572, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3274/3704 (88.3909%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3367/3704 (90.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8674, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4292/4767 (90.0357%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4341/4767 (91.0636%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9942, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4470/4956 (90.1937%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4521/4956 (91.2228%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1156, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3228/3590 (89.9164%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3117/3590 (86.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1873, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5372/5902 (91.0200%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5296/5902 (89.7323%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9577, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4344/4928 (88.1494%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8996, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3786/4235 (89.3979%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3915/4235 (92.4439%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0451, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4716/5265 (89.5726%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4715/5265 (89.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9177, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4069/4356 (93.4114%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0224, Accuracy: 5550/10000 (55.5000%)
time spent on training: 257.5186493396759
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.7045454545454546.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.7045454545454546.
Suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.7272727272727273.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.8181818181818182.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.7045454545454546.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.7045454545454546.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6818181818181818.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6590909090909091.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.7272727272727273.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
 max_rate for 12 = 0.7727272727272727.
Suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.7272727272727273.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.7954545454545454.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.7272727272727273.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.7272727272727273.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.75.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.7272727272727273.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.7045454545454546.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.8409090909090909.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.7954545454545454.
Suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2478, Accuracy: 5318/10000 (53.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 8.0766, Accuracy: 269/9900 (2.7172%)
Done in 286.3017964363098 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 45.03941009731436.
Norm before scaling: 45.0329157503327. Distance: 2.1315036432573797
Total norm for 4 adversaries is: 45.0329157503327. distance: 2.1315036432573797
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1908, Accuracy: 9428/9900 (95.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 45.03941009731436.
Norm before scaling: 45.032125577018626. Distance: 2.246977683574035
Total norm for 4 adversaries is: 45.032125577018626. distance: 2.246977683574035
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1921, Accuracy: 9424/9900 (95.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 45.03941009731436.
Norm before scaling: 45.031058888820695. Distance: 2.1002143023907816
Total norm for 4 adversaries is: 45.031058888820695. distance: 2.1002143023907816
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0633, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 45.03941009731436.
Norm before scaling: 45.03000030795442. Distance: 2.1565634458191822
Total norm for 4 adversaries is: 45.03000030795442. distance: 2.1565634458191822
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0789, Accuracy: 9682/9900 (97.7980%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3640/4025 (90.4348%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3810/4025 (94.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8197, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5343/5902 (90.5286%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5375/5902 (91.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9942, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4237/4793 (88.3997%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8783, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4691/5265 (89.0978%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4787/5265 (90.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0779, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3841/4295 (89.4296%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3874/4295 (90.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9530, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3257/3704 (87.9320%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3385/3704 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8410, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4585/5116 (89.6208%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4605/5116 (90.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9206, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5145/5740 (89.6341%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5256/5740 (91.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9754, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3417/3797 (89.9921%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3462/3797 (91.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9931, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4222/4716 (89.5250%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4322/4716 (91.6455%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9257, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3990/4433 (90.0068%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4116/4433 (92.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8552, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3905/4416 (88.4284%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3995/4416 (90.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0092, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3721/4223 (88.1127%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7963, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4486/5083 (88.2550%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4590/5083 (90.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9886, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4074/4576 (89.0297%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4201/4576 (91.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0027, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4832/5392 (89.6142%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4784/5392 (88.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1207, Accuracy: 5409/10000 (54.0900%)
time spent on training: 266.37279987335205
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.6136363636363636.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.8636363636363636.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.8181818181818182.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.75.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.6818181818181818.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.8181818181818182.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
 max_rate for 15 = 0.7045454545454546.
Suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.75.
Suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.6590909090909091.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.6818181818181818.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
 max_rate for 11 = 0.7954545454545454.
Suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.6363636363636364.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.7727272727272727.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.7272727272727273.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
 max_rate for 19 = 0.6818181818181818.
Suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
 max_rate for 5 = 0.6818181818181818.
Suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected in more than 15.0% of clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1583, Accuracy: 5411/10000 (54.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 7.5384, Accuracy: 437/9900 (4.4141%)
Done in 294.88915181159973 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 45.07481573641622.
Norm before scaling: 45.06571942599843. Distance: 2.1247098388036156
Total norm for 4 adversaries is: 45.06571942599843. distance: 2.1247098388036156
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1067, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 45.07481573641622.
Norm before scaling: 45.06792968545163. Distance: 2.227833488837439
Total norm for 4 adversaries is: 45.06792968545163. distance: 2.227833488837439
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0670, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 45.07481573641622.
Norm before scaling: 45.06738931953043. Distance: 2.0849997023255207
Total norm for 4 adversaries is: 45.06738931953043. distance: 2.0849997023255207
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0491, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 45.07481573641622.
Norm before scaling: 45.06742453154218. Distance: 2.1679546733777237
Total norm for 4 adversaries is: 45.06742453154218. distance: 2.1679546733777237
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.3321, Accuracy: 9101/9900 (91.9293%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4735/5265 (89.9335%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4811/5265 (91.3770%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0243, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4029/4356 (92.4931%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3929/4356 (90.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1343, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3437/3756 (91.5069%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3506/3756 (93.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7991, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3419/3837 (89.1061%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3594/3837 (93.6669%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8183, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5159/5740 (89.8780%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9605, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3731/4223 (88.3495%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3889/4223 (92.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8671, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3986/4465 (89.2721%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4138/4465 (92.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8156, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4980/5591 (89.0717%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5046/5591 (90.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2291, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5526/5902 (93.6293%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5319/5902 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0973, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4382/4918 (89.1013%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4520/4918 (91.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1387, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3470/3861 (89.8731%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3502/3861 (90.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9900, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3853/4295 (89.7090%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3888/4295 (90.5239%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9640, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3577/4158 (86.0269%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3695/4158 (88.8648%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8811, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5654/6263 (90.2762%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5706/6263 (91.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0913, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4154/4354 (95.4065%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3328/4354 (76.4355%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.7487, Accuracy: 4328/10000 (43.2800%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3435/3797 (90.4662%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3471/3797 (91.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9580, Accuracy: 5709/10000 (57.0900%)
time spent on training: 263.8799023628235
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.6363636363636364.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.6818181818181818.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
 max_rate for 0 = 0.7272727272727273.
Suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.7045454545454546.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
 max_rate for 9 = 0.75.
Suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.6136363636363636.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
 max_rate for 13 = 0.6136363636363636.
Suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.6818181818181818.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
 max_rate for 8 = 0.6590909090909091.
Suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.6590909090909091.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
 max_rate for 18 = 0.6170212765957447.
Suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Misclassification from 81 to 13 detected but within acceptable limits.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2883, Accuracy: 5263/10000 (52.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 7.5422, Accuracy: 520/9900 (5.2525%)
Done in 292.5160629749298 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 45.12316857000265.
Norm before scaling: 45.114161830363756. Distance: 2.0988753486175455
Total norm for 4 adversaries is: 45.114161830363756. distance: 2.0988753486175455
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1726, Accuracy: 9464/9900 (95.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 45.12316857000265.
Norm before scaling: 45.11516567439518. Distance: 2.223450959433634
Total norm for 4 adversaries is: 45.11516567439518. distance: 2.223450959433634
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2962, Accuracy: 9197/9900 (92.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.12316857000265.
Norm before scaling: 45.11549442169577. Distance: 2.0481123351193573
Total norm for 4 adversaries is: 45.11549442169577. distance: 2.0481123351193573
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.3238, Accuracy: 9122/9900 (92.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4554/5066 (89.8934%), train_poison_data_count: 400
Global model norm: 45.12316857000265.
Norm before scaling: 45.11659699288888. Distance: 2.222995618176657
Total norm for 4 adversaries is: 45.11659699288888. distance: 2.222995618176657
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1825, Accuracy: 9432/9900 (95.2727%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3377/3797 (88.9386%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3470/3797 (91.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9832, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4431/5037 (87.9690%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8196, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4697/4934 (95.1966%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4689/4934 (95.0345%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8782, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4940/5455 (90.5591%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5027/5455 (92.1540%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8846, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5441/5902 (92.1891%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5368/5902 (90.9522%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1412, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5772/6391 (90.3145%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5831/6391 (91.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9349, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3623/3911 (92.6362%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3508/3911 (89.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8578, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4547/5195 (87.5265%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4670/5195 (89.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0224, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3776/4235 (89.1617%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3858/4235 (91.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9400, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4561/5116 (89.1517%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4679/5116 (91.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9402, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4065/4538 (89.5769%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4247/4538 (93.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8739, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5022/5582 (89.9678%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5131/5582 (91.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2802, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4095/4558 (89.8420%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4162/4558 (91.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0434, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3632/4046 (89.7677%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9309, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3412/3828 (89.1327%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3512/3828 (91.7450%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8760, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4495/5055 (88.9219%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5055 (91.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9867, Accuracy: 5529/10000 (55.2900%)
time spent on training: 265.9141457080841
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
 max_rate for 1 = 0.6808510638297872.
Suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
 max_rate for 6 = 0.6808510638297872.
Suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
 max_rate for 4 = 0.6595744680851063.
Suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6808510638297872.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
 max_rate for 17 = 0.6170212765957447.
Suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2596, Accuracy: 5313/10000 (53.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 7.3071, Accuracy: 617/9900 (6.2323%)
Done in 294.380490064621 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 45.15396431282709.
Norm before scaling: 45.14628458377001. Distance: 2.0611366621126277
Total norm for 4 adversaries is: 45.14628458377001. distance: 2.0611366621126277
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1097, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 45.15396431282709.
Norm before scaling: 45.144495929130855. Distance: 2.2277987076729304
Total norm for 4 adversaries is: 45.144495929130855. distance: 2.2277987076729304
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2991, Accuracy: 9199/9900 (92.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 45.15396431282709.
Norm before scaling: 45.14429718535194. Distance: 2.0449395966877755
Total norm for 4 adversaries is: 45.14429718535194. distance: 2.0449395966877755
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1563, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 45.15396431282709.
Norm before scaling: 45.14598985946177. Distance: 2.212064314364252
Total norm for 4 adversaries is: 45.14598985946177. distance: 2.212064314364252
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1027, Accuracy: 9624/9900 (97.2121%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5065/5582 (90.7381%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5155/5582 (92.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1766, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3986/4501 (88.5581%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4118/4501 (91.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9692, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3603/3911 (92.1248%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3500/3911 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9975, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4212/4663 (90.3281%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4333/4663 (92.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9203, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4730/5265 (89.8386%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4740/5265 (90.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9661, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3903/4416 (88.3832%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4050/4416 (91.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8588, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4128/4433 (93.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8026, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5623/6263 (89.7813%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5717/6263 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1075, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4982/5455 (91.3291%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4976/5455 (91.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0274, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4173/4634 (90.0518%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4224/4634 (91.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8644, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4176/4707 (88.7189%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4347/4707 (92.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8055, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3724/4126 (90.2569%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7704, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4633/5116 (90.5590%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4655/5116 (90.9891%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9368, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4616/5063 (91.1712%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4618/5063 (91.2107%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1489, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4022/4361 (92.2266%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4029/4361 (92.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0350, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5459/6124 (89.1411%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5601/6124 (91.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8684, Accuracy: 5692/10000 (56.9200%)
time spent on training: 267.98035430908203
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
 max_rate for 7 = 0.6382978723404256.
Suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6595744680851063.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2531, Accuracy: 5348/10000 (53.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 7.8664, Accuracy: 453/9900 (4.5758%)
Done in 296.53477597236633 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 45.182291366474544.
Norm before scaling: 45.175695964305575. Distance: 2.135642720484708
Total norm for 4 adversaries is: 45.175695964305575. distance: 2.135642720484708
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0619, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 45.182291366474544.
Norm before scaling: 45.17047380869015. Distance: 2.177610658971863
Total norm for 4 adversaries is: 45.17047380869015. distance: 2.177610658971863
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1449, Accuracy: 9540/9900 (96.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 45.182291366474544.
Norm before scaling: 45.17107104308783. Distance: 2.0794285865990054
Total norm for 4 adversaries is: 45.17107104308783. distance: 2.0794285865990054
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1554, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 45.182291366474544.
Norm before scaling: 45.171847976470644. Distance: 2.1345807804308587
Total norm for 4 adversaries is: 45.171847976470644. distance: 2.1345807804308587
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1894, Accuracy: 9426/9900 (95.2121%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4005/4356 (91.9421%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9526, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3959/4362 (90.7611%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4026/4362 (92.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9849, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4247/4679 (90.7673%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4230/4679 (90.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0876, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3626/4158 (87.2054%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3721/4158 (89.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9107, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4181/4651 (89.8946%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4277/4651 (91.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0461, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3744/4175 (89.6766%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3795/4175 (90.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8644, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4161/4618 (90.1039%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4241/4618 (91.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9559, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4117/4625 (89.0162%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4227/4625 (91.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8678, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5013/5582 (89.8065%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5161/5582 (92.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0072, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4369/4874 (89.6389%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4447/4874 (91.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0024, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4699/4934 (95.2371%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4504/4934 (91.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1236, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4921/5424 (90.7264%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5039/5424 (92.9019%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1833, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4594/4804 (95.6286%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4351/4804 (90.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9798, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4426/4918 (89.9959%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8702, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3444/3861 (89.1997%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3560/3861 (92.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8310, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3753/4223 (88.8705%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8175, Accuracy: 5820/10000 (58.2000%)
time spent on training: 261.95870900154114
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6595744680851063.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2926, Accuracy: 5328/10000 (53.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 8.1352, Accuracy: 343/9900 (3.4646%)
Done in 290.71305203437805 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.210552070890344.
Norm before scaling: 45.20199483334848. Distance: 2.080848228921716
Total norm for 4 adversaries is: 45.20199483334848. distance: 2.080848228921716
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1359, Accuracy: 9584/9900 (96.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.210552070890344.
Norm before scaling: 45.19913215816828. Distance: 2.2130333769393333
Total norm for 4 adversaries is: 45.19913215816828. distance: 2.2130333769393333
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1678, Accuracy: 9478/9900 (95.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 45.210552070890344.
Norm before scaling: 45.2019610764428. Distance: 2.1086224379112637
Total norm for 4 adversaries is: 45.2019610764428. distance: 2.1086224379112637
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1213, Accuracy: 9603/9900 (97.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 45.210552070890344.
Norm before scaling: 45.204865428385446. Distance: 2.2342706402502532
Total norm for 4 adversaries is: 45.204865428385446. distance: 2.2342706402502532
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2369, Accuracy: 9273/9900 (93.6667%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4110/4647 (88.4442%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4247/4647 (91.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8744, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3372/3804 (88.6435%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8945, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4999/5591 (89.4116%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4990/5591 (89.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1800, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4167/4634 (89.9223%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4232/4634 (91.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8439, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3995/4433 (90.1196%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8261, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3253/3704 (87.8240%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3374/3704 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8518, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3445/3837 (89.7837%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3593/3837 (93.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8202, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4964/5455 (90.9991%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4993/5455 (91.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1399, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5145/5740 (89.6341%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5188/5740 (90.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1142, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4380/4986 (87.8460%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4532/4986 (90.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8564, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4041/4456 (90.6867%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0122, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4026/4356 (92.4242%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3942/4356 (90.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1513, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3267/3590 (91.0028%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3207/3590 (89.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0138, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4064/4503 (90.2509%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4125/4503 (91.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9310, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4634/5037 (91.9992%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9905, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4632/5167 (89.6458%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4759/5167 (92.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0795, Accuracy: 5487/10000 (54.8700%)
time spent on training: 262.9996156692505
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2513, Accuracy: 5406/10000 (54.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 7.8603, Accuracy: 442/9900 (4.4646%)
Done in 291.60420417785645 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4492/4885 (91.9550%), train_poison_data_count: 385
Global model norm: 45.233971554763876.
Norm before scaling: 45.22366021630022. Distance: 2.065881442543002
Total norm for 4 adversaries is: 45.22366021630022. distance: 2.065881442543002
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2026, Accuracy: 9394/9900 (94.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 45.233971554763876.
Norm before scaling: 45.22411503893346. Distance: 2.2297541714640055
Total norm for 4 adversaries is: 45.22411503893346. distance: 2.2297541714640055
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1283, Accuracy: 9572/9900 (96.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 45.233971554763876.
Norm before scaling: 45.22427024442324. Distance: 2.1091851042995775
Total norm for 4 adversaries is: 45.22427024442324. distance: 2.1091851042995775
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0914, Accuracy: 9671/9900 (97.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 45.233971554763876.
Norm before scaling: 45.230258070424355. Distance: 2.242719314720766
Total norm for 4 adversaries is: 45.230258070424355. distance: 2.242719314720766
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0681, Accuracy: 9725/9900 (98.2323%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3213/3638 (88.3178%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3294/3638 (90.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9246, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4249/4716 (90.0975%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4310/4716 (91.3910%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9473, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4420/4956 (89.1848%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4474/4956 (90.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9867, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4853/5392 (90.0037%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4883/5392 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0117, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3755/4184 (89.7467%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3840/4184 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8407, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4081/4481 (91.0734%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4055/4481 (90.4932%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0125, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3239/3646 (88.8371%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3379/3646 (92.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8782, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4490/5025 (89.3532%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4620/5025 (91.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0274, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3278/3590 (91.3092%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3291/3590 (91.6713%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9546, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4133/4596 (89.9260%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4273/4596 (92.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9255, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3925/4336 (90.5212%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3997/4336 (92.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0705, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4366/4874 (89.5773%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4231/4874 (86.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1271, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4636/5167 (89.7232%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4742/5167 (91.7747%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0319, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4174/4618 (90.3854%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4286/4618 (92.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8836, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4371/4928 (88.6972%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9694, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4160/4647 (89.5201%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4231/4647 (91.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9400, Accuracy: 5631/10000 (56.3100%)
time spent on training: 260.237238407135
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6382978723404256.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2126, Accuracy: 5464/10000 (54.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 7.8952, Accuracy: 455/9900 (4.5960%)
Done in 289.14009189605713 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 45.26549555556224.
Norm before scaling: 45.26214605201984. Distance: 2.142785534343418
Total norm for 4 adversaries is: 45.26214605201984. distance: 2.142785534343418
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3402, Accuracy: 9072/9900 (91.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 45.26549555556224.
Norm before scaling: 45.25774439512397. Distance: 2.237528249892587
Total norm for 4 adversaries is: 45.25774439512397. distance: 2.237528249892587
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2024, Accuracy: 9386/9900 (94.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 45.26549555556224.
Norm before scaling: 45.25601004631871. Distance: 2.0672259660920607
Total norm for 4 adversaries is: 45.25601004631871. distance: 2.0672259660920607
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1359, Accuracy: 9541/9900 (96.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 45.26549555556224.
Norm before scaling: 45.2584267878646. Distance: 2.211075417897723
Total norm for 4 adversaries is: 45.2584267878646. distance: 2.211075417897723
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2181, Accuracy: 9369/9900 (94.6364%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3865/4368 (88.4844%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3913/4368 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9470, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4685/5195 (90.1829%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4578/5195 (88.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2217, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3910/4315 (90.6141%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4002/4315 (92.7462%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8391, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3260/3646 (89.4131%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3373/3646 (92.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8212, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3296/3590 (91.8106%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3296/3590 (91.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0628, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3698/4126 (89.6268%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3835/4126 (92.9472%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7152, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3998/4361 (91.6762%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4009/4361 (91.9285%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9436, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3423/3837 (89.2103%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3570/3837 (93.0414%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8345, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3834/4235 (90.5313%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3816/4235 (90.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0001, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5501/5902 (93.2057%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5511/5902 (93.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0197, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4008/4433 (90.4128%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4043/4433 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8961, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3212/3638 (88.2903%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3310/3638 (90.9841%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8077, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4639/5232 (88.6659%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4764/5232 (91.0550%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0213, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3890/4336 (89.7140%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4023/4336 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9304, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4989 (88.1740%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4533/4989 (90.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9689, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4058/4481 (90.5601%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4028/4481 (89.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9338, Accuracy: 5711/10000 (57.1100%)
time spent on training: 259.2002167701721
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1796, Accuracy: 5519/10000 (55.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 8.0112, Accuracy: 440/9900 (4.4444%)
Done in 287.5390625 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 45.29466513236548.
Norm before scaling: 45.28332843314828. Distance: 2.0668920511996403
Total norm for 4 adversaries is: 45.28332843314828. distance: 2.0668920511996403
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1330, Accuracy: 9549/9900 (96.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 45.29466513236548.
Norm before scaling: 45.28554154956635. Distance: 2.1563974965829105
Total norm for 4 adversaries is: 45.28554154956635. distance: 2.1563974965829105
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0661, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 45.29466513236548.
Norm before scaling: 45.28032262680446. Distance: 2.0080324045127464
Total norm for 4 adversaries is: 45.28032262680446. distance: 2.0080324045127464
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0388, Accuracy: 9808/9900 (99.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 45.29466513236548.
Norm before scaling: 45.287935151787394. Distance: 2.1969911937997257
Total norm for 4 adversaries is: 45.287935151787394. distance: 2.1969911937997257
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1426, Accuracy: 9541/9900 (96.3737%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4587/5116 (89.6599%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4660/5116 (91.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8933, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3955/4362 (90.6694%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0563, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4050/4441 (91.1957%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4147/4441 (93.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9717, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4242/4663 (90.9715%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4346/4663 (93.2018%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9687, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4517/5083 (88.8648%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4589/5083 (90.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9433, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4235/4767 (88.8399%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4315/4767 (90.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9804, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3426/3797 (90.2291%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3475/3797 (91.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8357, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4678/5195 (90.0481%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4725/5195 (90.9528%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0356, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4156/4618 (89.9957%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4196/4618 (90.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0651, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4036/4433 (91.0444%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4046/4433 (91.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8558, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4554/5055 (90.0890%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4654/5055 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7646, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3620/4158 (87.0611%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3740/4158 (89.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8651, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3418/3781 (90.3994%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3315/3781 (87.6752%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0810, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3704/4175 (88.7186%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3795/4175 (90.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9398, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4783/5265 (90.8452%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4754/5265 (90.2944%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0485, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3452/3837 (89.9661%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3543/3837 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8581, Accuracy: 5766/10000 (57.6600%)
time spent on training: 259.61873865127563
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2480, Accuracy: 5440/10000 (54.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 8.5078, Accuracy: 334/9900 (3.3737%)
Done in 288.1972014904022 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 45.31939602697724.
Norm before scaling: 45.30777992657553. Distance: 2.107514528742586
Total norm for 4 adversaries is: 45.30777992657553. distance: 2.107514528742586
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0761, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 45.31939602697724.
Norm before scaling: 45.30806820999848. Distance: 2.1822758008673024
Total norm for 4 adversaries is: 45.30806820999848. distance: 2.1822758008673024
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.2315, Accuracy: 9347/9900 (94.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 45.31939602697724.
Norm before scaling: 45.30551400888611. Distance: 2.0090194221419813
Total norm for 4 adversaries is: 45.30551400888611. distance: 2.0090194221419813
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1108, Accuracy: 9605/9900 (97.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.31939602697724.
Norm before scaling: 45.312085127411095. Distance: 2.1812460738094814
Total norm for 4 adversaries is: 45.312085127411095. distance: 2.1812460738094814
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1007, Accuracy: 9654/9900 (97.5152%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3638/3911 (93.0197%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3558/3911 (90.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0467, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4767/5195 (91.7613%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4635/5195 (89.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2081, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3437/3775 (91.0464%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8221, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4263/4679 (91.1092%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4272/4679 (91.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0075, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3967/4361 (90.9654%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4062/4361 (93.1438%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0004, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3244/3672 (88.3442%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3361/3672 (91.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8848, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4181/4481 (93.3051%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4158/4481 (92.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9054, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3703/4126 (89.7479%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3833/4126 (92.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7844, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3594/3969 (90.5518%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3640/3969 (91.7108%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9088, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4605/5116 (90.0117%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4658/5116 (91.0477%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8809, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4701/5063 (92.8501%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4460/5063 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0062, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2990/3297 (90.6885%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3078/3297 (93.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7374, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8978, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4156/4596 (90.4265%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4274/4596 (92.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9376, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3996/4501 (88.7803%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4037/4501 (89.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0401, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4050/4465 (90.7055%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4197/4465 (93.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8356, Accuracy: 5851/10000 (58.5100%)
time spent on training: 258.555052280426
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
 max_rate for 3 = 0.6808510638297872.
Suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2626, Accuracy: 5480/10000 (54.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 9.1612, Accuracy: 241/9900 (2.4343%)
Done in 287.5780305862427 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 45.350835077068865.
Norm before scaling: 45.338914714624565. Distance: 2.0925319032048653
Total norm for 4 adversaries is: 45.338914714624565. distance: 2.0925319032048653
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0995, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 45.350835077068865.
Norm before scaling: 45.34112242559176. Distance: 2.2090830220154105
Total norm for 4 adversaries is: 45.34112242559176. distance: 2.2090830220154105
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0620, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 45.350835077068865.
Norm before scaling: 45.33943165170909. Distance: 2.02636024565829
Total norm for 4 adversaries is: 45.33943165170909. distance: 2.02636024565829
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2315, Accuracy: 9351/9900 (94.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 45.350835077068865.
Norm before scaling: 45.34442302222788. Distance: 2.2269732180125374
Total norm for 4 adversaries is: 45.34442302222788. distance: 2.2269732180125374
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1137, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3945/4361 (90.4609%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4064/4361 (93.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9356, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3932/4346 (90.4740%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4077/4346 (93.8104%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7293, Accuracy: 5992/10000 (59.9200%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5001/5455 (91.6774%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5047/5455 (92.5206%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9507, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4012/4465 (89.8544%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7971, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3908/4336 (90.1292%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4013/4336 (92.5507%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9992, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4088/4441 (92.0513%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4166/4441 (93.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0363, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3970/4362 (91.0133%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3990/4362 (91.4718%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9524, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3579/3969 (90.1738%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3659/3969 (92.1895%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8927, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3859/4295 (89.8487%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3949/4295 (91.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0397, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4519/5017 (90.0737%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4620/5017 (92.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8068, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4742/5063 (93.6599%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4646/5063 (91.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0476, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2913/3271 (89.0553%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0067, Accuracy: 2850/3271 (87.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0280, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5743/6263 (91.6973%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5766/6263 (92.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0316, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4450/4874 (91.3008%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4424/4874 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9629, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3632/3911 (92.8663%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3552/3911 (90.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9265, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4606/4804 (95.8784%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4569/4804 (95.1082%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8301, Accuracy: 5862/10000 (58.6200%)
time spent on training: 262.38146591186523
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4091, Accuracy: 5281/10000 (52.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 9.2783, Accuracy: 203/9900 (2.0505%)
Done in 291.15080308914185 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4460/4885 (91.2999%), train_poison_data_count: 385
Global model norm: 45.370630815815204.
Norm before scaling: 45.359240440723596. Distance: 2.0703632852335403
Total norm for 4 adversaries is: 45.359240440723596. distance: 2.0703632852335403
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0577, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 45.370630815815204.
Norm before scaling: 45.35773334955545. Distance: 2.196860965342072
Total norm for 4 adversaries is: 45.35773334955545. distance: 2.196860965342072
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1951, Accuracy: 9406/9900 (95.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 45.370630815815204.
Norm before scaling: 45.35992938000869. Distance: 2.0475983251640444
Total norm for 4 adversaries is: 45.35992938000869. distance: 2.0475983251640444
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1621, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 45.370630815815204.
Norm before scaling: 45.35885021656468. Distance: 2.1756756138797564
Total norm for 4 adversaries is: 45.35885021656468. distance: 2.1756756138797564
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1173, Accuracy: 9574/9900 (96.7071%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5427/5902 (91.9519%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5431/5902 (92.0197%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9828, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4432/4918 (90.1179%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4547/4918 (92.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0724, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3626/4025 (90.0870%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3754/4025 (93.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8153, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3150/3472 (90.7258%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3170/3472 (91.3018%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8928, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4227/4793 (88.1911%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4373/4793 (91.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0022, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4667/4934 (94.5886%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4427/4934 (89.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1957, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3633/3911 (92.8918%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3637/3911 (92.9941%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9109, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4850/5392 (89.9481%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4906/5392 (90.9866%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0514, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3283/3638 (90.2419%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3338/3638 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8227, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5483/6124 (89.5330%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5552/6124 (90.6597%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9020, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3737/4175 (89.5090%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3831/4175 (91.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7905, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4175/4625 (90.2703%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4167/4625 (90.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0538, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4193/4354 (96.3023%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3935/4354 (90.3767%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2313, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4042/4511 (89.6032%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4150/4511 (91.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8184, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3330/3704 (89.9028%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3411/3704 (92.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7904, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3489/3861 (90.3652%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3547/3861 (91.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8945, Accuracy: 5699/10000 (56.9900%)
time spent on training: 260.81046772003174
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.5557, Accuracy: 5110/10000 (51.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 8.9705, Accuracy: 250/9900 (2.5253%)
Done in 289.4572424888611 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 45.397097752774904.
Norm before scaling: 45.385574159603564. Distance: 2.0675737800026375
Total norm for 4 adversaries is: 45.385574159603564. distance: 2.0675737800026375
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0383, Accuracy: 9804/9900 (99.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 45.397097752774904.
Norm before scaling: 45.38520836871717. Distance: 2.1700196608957985
Total norm for 4 adversaries is: 45.38520836871717. distance: 2.1700196608957985
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0534, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.397097752774904.
Norm before scaling: 45.386875920902234. Distance: 2.0753586792313605
Total norm for 4 adversaries is: 45.386875920902234. distance: 2.0753586792313605
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1109, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4571/5066 (90.2290%), train_poison_data_count: 400
Global model norm: 45.397097752774904.
Norm before scaling: 45.388481554382274. Distance: 2.1882110529967798
Total norm for 4 adversaries is: 45.388481554382274. distance: 2.1882110529967798
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1822, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4479/5083 (88.1173%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4552/5083 (89.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0324, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3265/3646 (89.5502%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3313/3646 (90.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8654, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4059/4503 (90.1399%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4143/4503 (92.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9132, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4045/4501 (89.8689%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4093/4501 (90.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8302, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3637/4013 (90.6305%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3751/4013 (93.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7978, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3988/4362 (91.4260%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0306, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3947/4315 (91.4716%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4050/4315 (93.8586%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8247, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4189/4651 (90.0667%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4238/4651 (91.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9682, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3937/4416 (89.1531%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4040/4416 (91.4855%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0337, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3241/3704 (87.5000%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3410/3704 (92.0626%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7946, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4182/4707 (88.8464%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4325/4707 (91.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8992, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4188/4662 (89.8327%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4317/4662 (92.5997%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8266, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4913/5424 (90.5789%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4985/5424 (91.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3844, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3912/4336 (90.2214%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4049/4336 (93.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8635, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4171/4481 (93.0819%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4122/4481 (91.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8923, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3430/3828 (89.6029%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3551/3828 (92.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8214, Accuracy: 5827/10000 (58.2700%)
time spent on training: 255.95787286758423
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.6083, Accuracy: 5016/10000 (50.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 8.8707, Accuracy: 278/9900 (2.8081%)
Done in 284.66523122787476 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 45.42887534205255.
Norm before scaling: 45.41327425451313. Distance: 2.0950934811222894
Total norm for 4 adversaries is: 45.41327425451313. distance: 2.0950934811222894
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0672, Accuracy: 9712/9900 (98.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 45.42887534205255.
Norm before scaling: 45.416615300047404. Distance: 2.191878487198326
Total norm for 4 adversaries is: 45.416615300047404. distance: 2.191878487198326
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0742, Accuracy: 9726/9900 (98.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 45.42887534205255.
Norm before scaling: 45.41520956425969. Distance: 2.0715699030199644
Total norm for 4 adversaries is: 45.41520956425969. distance: 2.0715699030199644
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1024, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 45.42887534205255.
Norm before scaling: 45.41785704193065. Distance: 2.2454025133708213
Total norm for 4 adversaries is: 45.41785704193065. distance: 2.2454025133708213
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1108, Accuracy: 9619/9900 (97.1616%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3754/4184 (89.7228%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3843/4184 (91.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9395, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4473/5037 (88.8029%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4649/5037 (92.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8169, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3634/4158 (87.3978%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8662, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2990/3271 (91.4094%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3065/3271 (93.7022%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7936, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4420/4918 (89.8739%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4536/4918 (92.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0276, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5473/5902 (92.7313%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5352/5902 (90.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0976, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4216/4354 (96.8305%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3845/4354 (88.3096%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2705, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3615/3969 (91.0809%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3651/3969 (91.9879%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8985, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4079/4356 (93.6410%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4084/4356 (93.7557%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0132, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3860/4295 (89.8719%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3764/4295 (87.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0556, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3709/4126 (89.8934%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3839/4126 (93.0441%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8534, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4389/4928 (89.0625%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4489/4928 (91.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8779, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4037/4511 (89.4924%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4117/4511 (91.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9402, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4148/4618 (89.8224%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4201/4618 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0240, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3287/3704 (88.7419%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3422/3704 (92.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7826, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3206/3616 (88.6615%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3344/3616 (92.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8963, Accuracy: 5836/10000 (58.3600%)
time spent on training: 259.1588685512543
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5307, Accuracy: 5122/10000 (51.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 9.5319, Accuracy: 156/9900 (1.5758%)
Done in 288.0787088871002 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 45.457851464467886.
Norm before scaling: 45.44349062125124. Distance: 1.9978986668364282
Total norm for 4 adversaries is: 45.44349062125124. distance: 1.9978986668364282
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1743, Accuracy: 9462/9900 (95.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 45.457851464467886.
Norm before scaling: 45.44599140480516. Distance: 2.153984981034675
Total norm for 4 adversaries is: 45.44599140480516. distance: 2.153984981034675
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1605, Accuracy: 9531/9900 (96.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 45.457851464467886.
Norm before scaling: 45.446904653431844. Distance: 2.0645501322407154
Total norm for 4 adversaries is: 45.446904653431844. distance: 2.0645501322407154
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1017, Accuracy: 9653/9900 (97.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 45.457851464467886.
Norm before scaling: 45.45087169990527. Distance: 2.222598646654431
Total norm for 4 adversaries is: 45.45087169990527. distance: 2.222598646654431
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2697, Accuracy: 9231/9900 (93.2424%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2957/3271 (90.4005%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2973/3271 (90.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9597, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4016/4456 (90.1257%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4119/4456 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9676, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3636/4013 (90.6055%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7256, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3474/3781 (91.8805%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3528/3781 (93.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1372, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3412/3775 (90.3841%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3593/3775 (95.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7920, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4603/5232 (87.9778%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4700/5232 (89.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0328, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4390/4989 (87.9936%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4468/4989 (89.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0903, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3234/3646 (88.6999%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3372/3646 (92.4849%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8000, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3949/4315 (91.5180%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4011/4315 (92.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8465, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4434/4918 (90.1586%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4568/4918 (92.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9780, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3949/4416 (89.4248%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4024/4416 (91.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8911, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5641/6263 (90.0687%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5787/6263 (92.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9629, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5454/6124 (89.0594%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5498/6124 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8570, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4194/4651 (90.1742%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4264/4651 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9044, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4033/4356 (92.5849%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3886/4356 (89.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2301, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4080/4356 (93.6639%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3839/4356 (88.1313%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1971, Accuracy: 5179/10000 (51.7900%)
time spent on training: 261.7529036998749
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.7442, Accuracy: 4852/10000 (48.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 9.5753, Accuracy: 115/9900 (1.1616%)
Done in 290.53757667541504 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 45.48702650292856.
Norm before scaling: 45.473195658953856. Distance: 2.080058639506738
Total norm for 4 adversaries is: 45.473195658953856. distance: 2.080058639506738
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1590, Accuracy: 9485/9900 (95.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 45.48702650292856.
Norm before scaling: 45.473791601935396. Distance: 2.19542131799087
Total norm for 4 adversaries is: 45.473791601935396. distance: 2.19542131799087
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0959, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.48702650292856.
Norm before scaling: 45.47410836124222. Distance: 2.0261191489759844
Total norm for 4 adversaries is: 45.47410836124222. distance: 2.0261191489759844
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.2416, Accuracy: 9323/9900 (94.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 45.48702650292856.
Norm before scaling: 45.479186946475856. Distance: 2.190814749299235
Total norm for 4 adversaries is: 45.479186946475856. distance: 2.190814749299235
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0973, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4222/4716 (89.5250%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4309/4716 (91.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8915, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4124/4634 (88.9944%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8884, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3460/3828 (90.3866%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3571/3828 (93.2863%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8932, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4447/4989 (89.1361%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4511/4989 (90.4189%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8989, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4574/5116 (89.4058%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4664/5116 (91.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0512, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4007/4362 (91.8615%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9548, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4512/5017 (89.9342%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4625/5017 (92.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8467, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4245/4354 (97.4966%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3974/4354 (91.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0881, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8830, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4648/5195 (89.4706%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4610/5195 (88.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0017, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4134/4596 (89.9478%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4260/4596 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0069, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4381/4928 (88.9002%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4473/4928 (90.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0079, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4647/5244 (88.6156%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4735/5244 (90.2937%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8911, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5483/5902 (92.9007%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5349/5902 (90.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0059, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4508/5025 (89.7114%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4651/5025 (92.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0300, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5488/6124 (89.6146%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5545/6124 (90.5454%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8963, Accuracy: 5672/10000 (56.7200%)
time spent on training: 265.7554316520691
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 3.1211, Accuracy: 4391/10000 (43.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 9.5094, Accuracy: 120/9900 (1.2121%)
Done in 294.57051968574524 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 45.5133533375783.
Norm before scaling: 45.50555318962456. Distance: 2.170879767196481
Total norm for 4 adversaries is: 45.50555318962456. distance: 2.170879767196481
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0923, Accuracy: 9657/9900 (97.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 45.5133533375783.
Norm before scaling: 45.502749852515784. Distance: 2.2093624260313938
Total norm for 4 adversaries is: 45.502749852515784. distance: 2.2093624260313938
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1965, Accuracy: 9428/9900 (95.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4286/4717 (90.8628%), train_poison_data_count: 370
Global model norm: 45.5133533375783.
Norm before scaling: 45.50372902816592. Distance: 2.067433093094281
Total norm for 4 adversaries is: 45.50372902816592. distance: 2.067433093094281
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0793, Accuracy: 9699/9900 (97.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 45.5133533375783.
Norm before scaling: 45.504134105629625. Distance: 2.2029606101747916
Total norm for 4 adversaries is: 45.504134105629625. distance: 2.2029606101747916
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0878, Accuracy: 9662/9900 (97.5960%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4600/5116 (89.9140%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4651/5116 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0558, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4620/5197 (88.8974%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4651/5197 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0859, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4086/4356 (93.8017%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3847/4356 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0166, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4244/4679 (90.7031%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4104/4679 (87.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1100, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4170/4647 (89.7353%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4279/4647 (92.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7725, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3555/3911 (90.8975%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3447/3911 (88.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2944, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3928/4315 (91.0313%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4026/4315 (93.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8705, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3207/3646 (87.9594%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3367/3646 (92.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8341, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4130/4634 (89.1239%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4213/4634 (90.9150%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9684, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4506/5055 (89.1395%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4665/5055 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8676, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3978/4362 (91.1967%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4005/4362 (91.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9627, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4625/4934 (93.7373%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4502/4934 (91.2444%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0377, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4224/4767 (88.6092%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4298/4767 (90.1615%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1520, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3972/4433 (89.6007%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4092/4433 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8251, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4304/4928 (87.3377%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4445/4928 (90.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0321, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3399/3837 (88.5848%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3547/3837 (92.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9688, Accuracy: 5600/10000 (56.0000%)
time spent on training: 260.5263226032257
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 3.0136, Accuracy: 4488/10000 (44.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 9.3312, Accuracy: 121/9900 (1.2222%)
Done in 289.41825103759766 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 45.541696746806934.
Norm before scaling: 45.52979150031878. Distance: 2.1632411238068223
Total norm for 4 adversaries is: 45.52979150031878. distance: 2.1632411238068223
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0324, Accuracy: 9805/9900 (99.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 45.541696746806934.
Norm before scaling: 45.5337245166632. Distance: 2.2653030692951566
Total norm for 4 adversaries is: 45.5337245166632. distance: 2.2653030692951566
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1309, Accuracy: 9538/9900 (96.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 45.541696746806934.
Norm before scaling: 45.5281962127935. Distance: 2.0592847095198032
Total norm for 4 adversaries is: 45.5281962127935. distance: 2.0592847095198032
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0860, Accuracy: 9671/9900 (97.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 45.541696746806934.
Norm before scaling: 45.538367558816546. Distance: 2.2696495353615056
Total norm for 4 adversaries is: 45.538367558816546. distance: 2.2696495353615056
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1193, Accuracy: 9618/9900 (97.1515%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4481/4986 (89.8716%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4549/4986 (91.2355%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8247, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4232/4767 (88.7770%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4328/4767 (90.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0599, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3928/4315 (91.0313%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4013/4315 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8503, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3311/3672 (90.1688%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3385/3672 (92.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8179, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4116/4558 (90.3028%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4067/4558 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3384, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3436/3828 (89.7597%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3556/3828 (92.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8323, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4271/4679 (91.2802%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4191/4679 (89.5704%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0765, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4408/4956 (88.9427%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4418/4956 (89.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9935, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4129/4356 (94.7888%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4038/4356 (92.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0002, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4116/4538 (90.7007%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8649, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3627/4013 (90.3813%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3766/4013 (93.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7501, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4751/5265 (90.2374%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4792/5265 (91.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9076, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4210/4663 (90.2852%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4327/4663 (92.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9334, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5667/6263 (90.4838%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5713/6263 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9558, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4667/5063 (92.1786%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4550/5063 (89.8677%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1633, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3889/4416 (88.0661%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4035/4416 (91.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9115, Accuracy: 5661/10000 (56.6100%)
time spent on training: 257.8214793205261
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.7599, Accuracy: 4725/10000 (47.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 9.4278, Accuracy: 138/9900 (1.3939%)
Done in 286.38663053512573 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 45.57255922478871.
Norm before scaling: 45.56033248873822. Distance: 2.113732027217675
Total norm for 4 adversaries is: 45.56033248873822. distance: 2.113732027217675
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0890, Accuracy: 9662/9900 (97.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 45.57255922478871.
Norm before scaling: 45.56011278468399. Distance: 2.1762447171746935
Total norm for 4 adversaries is: 45.56011278468399. distance: 2.1762447171746935
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0266, Accuracy: 9833/9900 (99.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 45.57255922478871.
Norm before scaling: 45.560715628639436. Distance: 2.1004558613404503
Total norm for 4 adversaries is: 45.560715628639436. distance: 2.1004558613404503
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0732, Accuracy: 9712/9900 (98.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 45.57255922478871.
Norm before scaling: 45.56176053926692. Distance: 2.1820335751475706
Total norm for 4 adversaries is: 45.56176053926692. distance: 2.1820335751475706
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2333, Accuracy: 9313/9900 (94.0707%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5078/5740 (88.4669%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5271/5740 (91.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0253, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4163/4651 (89.5076%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4310/4651 (92.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9945, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4050/4503 (89.9400%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4085/4503 (90.7173%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9908, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4234/4767 (88.8190%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4353/4767 (91.3153%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0264, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4937/5591 (88.3026%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5016/5591 (89.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1434, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3991/4465 (89.3841%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4155/4465 (93.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8056, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4418/4956 (89.1445%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4477/4956 (90.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0420, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3248/3704 (87.6890%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3409/3704 (92.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8132, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3659/4025 (90.9068%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3763/4025 (93.4907%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7403, Accuracy: 5981/10000 (59.8100%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4622/5083 (90.9306%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4679/5083 (92.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1468, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5472/6124 (89.3534%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5529/6124 (90.2841%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9700, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3838/4295 (89.3597%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3832/4295 (89.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9658, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4584/4804 (95.4205%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4431/4804 (92.2356%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9125, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4299/4793 (89.6933%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4383/4793 (91.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0076, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3991/4433 (90.0293%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4099/4433 (92.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9401, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3903/4361 (89.4978%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3919/4361 (89.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0835, Accuracy: 5424/10000 (54.2400%)
time spent on training: 265.41742181777954
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.9006, Accuracy: 4646/10000 (46.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 9.2953, Accuracy: 164/9900 (1.6566%)
Done in 294.06747579574585 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 45.59776049016826.
Norm before scaling: 45.586839242366594. Distance: 2.146546353390352
Total norm for 4 adversaries is: 45.586839242366594. distance: 2.146546353390352
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0512, Accuracy: 9764/9900 (98.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 45.59776049016826.
Norm before scaling: 45.58474786901042. Distance: 2.253766615854498
Total norm for 4 adversaries is: 45.58474786901042. distance: 2.253766615854498
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0964, Accuracy: 9661/9900 (97.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 45.59776049016826.
Norm before scaling: 45.58720609310248. Distance: 2.0914908219951602
Total norm for 4 adversaries is: 45.58720609310248. distance: 2.0914908219951602
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2370, Accuracy: 9348/9900 (94.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 45.59776049016826.
Norm before scaling: 45.588700242974134. Distance: 2.2450816121379447
Total norm for 4 adversaries is: 45.588700242974134. distance: 2.2450816121379447
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1351, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4100/4558 (89.9517%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4120/4558 (90.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0137, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4153/4596 (90.3612%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4277/4596 (93.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8678, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4421/4874 (90.7058%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4417/4874 (90.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9898, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3638/4158 (87.4940%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3726/4158 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9153, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4936/5455 (90.4858%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4968/5455 (91.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9814, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3962/4346 (91.1643%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4022/4346 (92.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9028, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4245/4679 (90.7245%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4313/4679 (92.1778%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9467, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3908/4416 (88.4964%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4007/4416 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8638, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3411/3828 (89.1066%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3571/3828 (93.2863%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8855, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3782/4223 (89.5572%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3938/4223 (93.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9268, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4681/5265 (88.9079%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4715/5265 (89.5537%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2108, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5410/6124 (88.3410%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5467/6124 (89.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9436, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3985/4361 (91.3781%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3983/4361 (91.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8873, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4454/4956 (89.8709%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4489/4956 (90.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0500, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5096/5740 (88.7805%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5271/5740 (91.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0407, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3629/4013 (90.4311%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3687/4013 (91.8764%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9204, Accuracy: 5621/10000 (56.2100%)
time spent on training: 263.1028594970703
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.7692, Accuracy: 4742/10000 (47.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 9.2571, Accuracy: 152/9900 (1.5354%)
Done in 291.9711470603943 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 45.63408246499402.
Norm before scaling: 45.62055307951943. Distance: 2.0829232257277566
Total norm for 4 adversaries is: 45.62055307951943. distance: 2.0829232257277566
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1948, Accuracy: 9396/9900 (94.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 45.63408246499402.
Norm before scaling: 45.61903321428732. Distance: 2.1733269537888646
Total norm for 4 adversaries is: 45.61903321428732. distance: 2.1733269537888646
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1818, Accuracy: 9471/9900 (95.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 45.63408246499402.
Norm before scaling: 45.616453608799425. Distance: 1.9929465250400753
Total norm for 4 adversaries is: 45.616453608799425. distance: 1.9929465250400753
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0673, Accuracy: 9739/9900 (98.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 45.63408246499402.
Norm before scaling: 45.6228541875533. Distance: 2.2353453763157085
Total norm for 4 adversaries is: 45.6228541875533. distance: 2.2353453763157085
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1312, Accuracy: 9568/9900 (96.6465%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3715/4184 (88.7906%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3856/4184 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7855, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3299/3590 (91.8942%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3287/3590 (91.5599%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0095, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3633/4158 (87.3737%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3751/4158 (90.2116%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9121, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3667/4025 (91.1056%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3746/4025 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9556, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3611/4046 (89.2486%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3694/4046 (91.3000%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8586, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4490/5025 (89.3532%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4588/5025 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0940, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4756/5063 (93.9364%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4659/5063 (92.0205%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8947, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4111/4356 (94.3756%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4189/4356 (96.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8242, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4147/4651 (89.1636%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4257/4651 (91.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0302, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4157/4356 (95.4316%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4020/4356 (92.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9262, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4099/4576 (89.5760%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4232/4576 (92.4825%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9132, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4023/4456 (90.2828%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8739, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2975/3297 (90.2335%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3065/3297 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.6982, Accuracy: 6046/10000 (60.4600%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4639/4804 (96.5654%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4431/4804 (92.2356%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0228, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3597/3969 (90.6274%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3619/3969 (91.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9823, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4615/5195 (88.8354%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4615/5195 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9933, Accuracy: 5518/10000 (55.1800%)
time spent on training: 257.00712966918945
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.8831, Accuracy: 4579/10000 (45.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 9.1247, Accuracy: 163/9900 (1.6465%)
Done in 285.94861793518066 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 45.657151022081145.
Norm before scaling: 45.64511542870716. Distance: 2.1355206968197264
Total norm for 4 adversaries is: 45.64511542870716. distance: 2.1355206968197264
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1031, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 45.657151022081145.
Norm before scaling: 45.6455406459314. Distance: 2.2409448669338037
Total norm for 4 adversaries is: 45.6455406459314. distance: 2.2409448669338037
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1070, Accuracy: 9629/9900 (97.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 45.657151022081145.
Norm before scaling: 45.643925334285996. Distance: 2.0851416051699796
Total norm for 4 adversaries is: 45.643925334285996. distance: 2.0851416051699796
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0911, Accuracy: 9638/9900 (97.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 45.657151022081145.
Norm before scaling: 45.64599527631778. Distance: 2.257017424618006
Total norm for 4 adversaries is: 45.64599527631778. distance: 2.257017424618006
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0892, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3396/3837 (88.5066%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3605/3837 (93.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7903, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5053/5582 (90.5231%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5148/5582 (92.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0218, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4981/5455 (91.3107%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5050/5455 (92.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9437, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4234/4679 (90.4894%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4249/4679 (90.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0010, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4084/4518 (90.3940%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4203/4518 (93.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9534, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4130/4618 (89.4327%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4253/4618 (92.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0755, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4195/4716 (88.9525%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4225/4716 (89.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9815, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4623/5244 (88.1579%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5244 (89.3783%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9300, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4413/4874 (90.5416%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4318/4874 (88.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2761, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4459/4928 (90.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0011, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3695/4126 (89.5540%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3832/4126 (92.8745%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8433, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3401/3828 (88.8454%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9159, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3117/3472 (89.7753%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9732, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3261/3638 (89.6372%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7480, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3261/3590 (90.8357%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3228/3590 (89.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1030, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3754/4223 (88.8942%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3878/4223 (91.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9150, Accuracy: 5564/10000 (55.6400%)
time spent on training: 257.75226974487305
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.7243, Accuracy: 4734/10000 (47.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 9.4515, Accuracy: 131/9900 (1.3232%)
Done in 286.32969999313354 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 45.67962536873661.
Norm before scaling: 45.666887343121765. Distance: 2.104690776049267
Total norm for 4 adversaries is: 45.666887343121765. distance: 2.104690776049267
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1470, Accuracy: 9536/9900 (96.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 45.67962536873661.
Norm before scaling: 45.66755827615759. Distance: 2.158895997553651
Total norm for 4 adversaries is: 45.66755827615759. distance: 2.158895997553651
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1540, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 45.67962536873661.
Norm before scaling: 45.66569514296947. Distance: 2.0433808999595096
Total norm for 4 adversaries is: 45.66569514296947. distance: 2.0433808999595096
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0851, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 45.67962536873661.
Norm before scaling: 45.668068820190165. Distance: 2.2265665690066987
Total norm for 4 adversaries is: 45.668068820190165. distance: 2.2265665690066987
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1269, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3995/4441 (89.9572%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4108/4441 (92.5017%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0115, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4480/5017 (89.2964%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4622/5017 (92.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8581, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4415/4918 (89.7723%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9345, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4667/5197 (89.8018%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4741/5197 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9753, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4197/4356 (96.3499%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4023/4356 (92.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9355, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4974/5455 (91.1824%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5013/5455 (91.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9673, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2984/3297 (90.5065%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7805, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4604/5195 (88.6237%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4730/5195 (91.0491%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0113, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3465/3828 (90.5172%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3529/3828 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9028, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4061/4456 (91.1355%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4147/4456 (93.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9017, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3968/4361 (90.9883%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3986/4361 (91.4011%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9177, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3824/4235 (90.2952%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3868/4235 (91.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0055, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4497/5025 (89.4925%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4606/5025 (91.6617%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9672, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3234/3646 (88.6999%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3355/3646 (92.0187%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7655, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3630/4158 (87.3016%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3729/4158 (89.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8478, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4110/4538 (90.5685%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4238/4538 (93.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8312, Accuracy: 5838/10000 (58.3800%)
time spent on training: 259.8239469528198
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.6787, Accuracy: 4793/10000 (47.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 9.3556, Accuracy: 141/9900 (1.4242%)
Done in 288.4706292152405 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 45.709059443773015.
Norm before scaling: 45.69227702454212. Distance: 2.0655753587075925
Total norm for 4 adversaries is: 45.69227702454212. distance: 2.0655753587075925
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2114, Accuracy: 9385/9900 (94.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 45.709059443773015.
Norm before scaling: 45.69588617886598. Distance: 2.214787881136466
Total norm for 4 adversaries is: 45.69588617886598. distance: 2.214787881136466
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1909, Accuracy: 9410/9900 (95.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 45.709059443773015.
Norm before scaling: 45.695843437033474. Distance: 2.1044052920357794
Total norm for 4 adversaries is: 45.695843437033474. distance: 2.1044052920357794
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0654, Accuracy: 9720/9900 (98.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 45.709059443773015.
Norm before scaling: 45.6992573149786. Distance: 2.218541847458497
Total norm for 4 adversaries is: 45.6992573149786. distance: 2.218541847458497
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1414, Accuracy: 9498/9900 (95.9394%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3876/4295 (90.2445%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3814/4295 (88.8009%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0032, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5105/5582 (91.4547%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5126/5582 (91.8309%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1793, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3256/3672 (88.6710%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3388/3672 (92.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8851, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4097/4518 (90.6817%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0789, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3398/3797 (89.4917%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3530/3797 (92.9681%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8657, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3989/4362 (91.4489%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9905, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4596/4804 (95.6703%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4217/4804 (87.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2412, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4619/5116 (90.2854%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4652/5116 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9626, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4509/5025 (89.7313%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4588/5025 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0761, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2970/3297 (90.0819%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3081/3297 (93.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8017, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3301/3704 (89.1199%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3370/3704 (90.9827%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8534, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4916/5424 (90.6342%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5009/5424 (92.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1212, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3470/3861 (89.8731%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3570/3861 (92.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9319, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4470/4874 (91.7111%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4543/4874 (93.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0585, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4196/4647 (90.2948%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4647 (92.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9028, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4109/4356 (94.3297%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3909/4356 (89.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2464, Accuracy: 5172/10000 (51.7200%)
time spent on training: 259.8819978237152
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.5611, Accuracy: 4881/10000 (48.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 9.1861, Accuracy: 184/9900 (1.8586%)
Done in 288.5640118122101 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 45.73419083068487.
Norm before scaling: 45.721176990434365. Distance: 2.1293153142331875
Total norm for 4 adversaries is: 45.721176990434365. distance: 2.1293153142331875
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1843, Accuracy: 9442/9900 (95.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 45.73419083068487.
Norm before scaling: 45.72128912549246. Distance: 2.190554638656376
Total norm for 4 adversaries is: 45.72128912549246. distance: 2.190554638656376
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2101, Accuracy: 9413/9900 (95.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 45.73419083068487.
Norm before scaling: 45.717844851771225. Distance: 2.028185013880885
Total norm for 4 adversaries is: 45.717844851771225. distance: 2.028185013880885
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1412, Accuracy: 9535/9900 (96.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 45.73419083068487.
Norm before scaling: 45.722997816163314. Distance: 2.2268372483309595
Total norm for 4 adversaries is: 45.722997816163314. distance: 2.2268372483309595
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2111, Accuracy: 9407/9900 (95.0202%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4084/4503 (90.6951%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4123/4503 (91.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9071, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3437/3861 (89.0184%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3525/3861 (91.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8690, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3726/4184 (89.0535%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3868/4184 (92.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9996, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4078/4518 (90.2612%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4170/4518 (92.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9739, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4608/5083 (90.6551%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5083 (91.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9101, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4623/4804 (96.2323%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4216/4804 (87.7602%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0944, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4147/4356 (95.2020%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3919/4356 (89.9679%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1482, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4639/5244 (88.4630%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4688/5244 (89.3974%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9440, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4271/4679 (91.2802%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4207/4679 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0885, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3910/4416 (88.5417%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4012/4416 (90.8514%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9540, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4402/4918 (89.5079%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4522/4918 (91.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1136, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3203/3616 (88.5785%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3359/3616 (92.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7582, Accuracy: 6010/10000 (60.1000%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4105/4576 (89.7072%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4293/4576 (93.8156%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8447, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4429/4928 (89.8742%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4500/4928 (91.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8696, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3647/4013 (90.8796%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3762/4013 (93.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7525, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3878/4336 (89.4373%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4336 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9708, Accuracy: 5595/10000 (55.9500%)
time spent on training: 259.69251680374146
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4962, Accuracy: 5015/10000 (50.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 8.9793, Accuracy: 190/9900 (1.9192%)
Done in 288.3154637813568 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4459/4885 (91.2794%), train_poison_data_count: 385
Global model norm: 45.76628381652808.
Norm before scaling: 45.7536846407273. Distance: 2.150512470116078
Total norm for 4 adversaries is: 45.7536846407273. distance: 2.150512470116078
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0957, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 45.76628381652808.
Norm before scaling: 45.75295894205232. Distance: 2.2169218456652002
Total norm for 4 adversaries is: 45.75295894205232. distance: 2.2169218456652002
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1061, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 45.76628381652808.
Norm before scaling: 45.75409284117378. Distance: 2.1562909108579333
Total norm for 4 adversaries is: 45.75409284117378. distance: 2.1562909108579333
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0312, Accuracy: 9816/9900 (99.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4533/5066 (89.4789%), train_poison_data_count: 400
Global model norm: 45.76628381652808.
Norm before scaling: 45.75785184926599. Distance: 2.2864259501765782
Total norm for 4 adversaries is: 45.75785184926599. distance: 2.2864259501765782
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0955, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5705/6263 (91.0905%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5759/6263 (91.9527%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0061, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3153/3472 (90.8122%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3200/3472 (92.1659%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9485, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3629/4158 (87.2775%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3787/4158 (91.0774%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8922, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3179/3638 (87.3832%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3341/3638 (91.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9021, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4430/4874 (90.8904%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4366/4874 (89.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0828, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4170/4356 (95.7300%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3959/4356 (90.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9988, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4069/4538 (89.6651%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8298, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4399/4928 (89.2654%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4486/4928 (91.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8531, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4165/4618 (90.1906%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4278/4618 (92.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9473, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4193/4707 (89.0801%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4266/4707 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9566, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4274/4679 (91.3443%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4284/4679 (91.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1073, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4133/4647 (88.9391%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4310/4647 (92.7480%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9064, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4135/4576 (90.3628%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4247/4576 (92.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9761, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3669/4046 (90.6822%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3755/4046 (92.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9737, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4159/4651 (89.4216%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4276/4651 (91.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1317, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4523/5055 (89.4758%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4639/5055 (91.7705%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9586, Accuracy: 5613/10000 (56.1300%)
time spent on training: 262.3333306312561
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.4878, Accuracy: 4984/10000 (49.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 9.0722, Accuracy: 139/9900 (1.4040%)
Done in 291.38409209251404 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 45.79586210923564.
Norm before scaling: 45.78355103005745. Distance: 2.156169945156796
Total norm for 4 adversaries is: 45.78355103005745. distance: 2.156169945156796
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.3884, Accuracy: 8934/9900 (90.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 45.79586210923564.
Norm before scaling: 45.78591059894954. Distance: 2.2929793557436793
Total norm for 4 adversaries is: 45.78591059894954. distance: 2.2929793557436793
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0684, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 45.79586210923564.
Norm before scaling: 45.781895259957835. Distance: 2.0813874757743456
Total norm for 4 adversaries is: 45.781895259957835. distance: 2.0813874757743456
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.2273, Accuracy: 9376/9900 (94.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 45.79586210923564.
Norm before scaling: 45.78725696512759. Distance: 2.273572570353983
Total norm for 4 adversaries is: 45.78725696512759. distance: 2.273572570353983
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0586, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5112/5740 (89.0592%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5229/5740 (91.0976%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0389, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3703/4175 (88.6946%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8941, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4367/4918 (88.7963%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4516/4918 (91.8259%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9835, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3836/4235 (90.5785%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3833/4235 (90.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9303, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4971/5455 (91.1274%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5045/5455 (92.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9103, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4194/4662 (89.9614%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4302/4662 (92.2780%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9113, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4046/4465 (90.6159%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4116/4465 (92.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9252, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4158/4651 (89.4001%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4258/4651 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0955, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4196/4618 (90.8618%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4307/4618 (93.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9121, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4612/5037 (91.5624%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9125, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4211/4354 (96.7157%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4009/4354 (92.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1710, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4096/4441 (92.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9567, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4115/4538 (90.6787%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4215/4538 (92.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8039, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4588/5116 (89.6794%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4652/5116 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8521, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5554/6124 (90.6924%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5576/6124 (91.0516%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8002, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3987/4362 (91.4030%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4009/4362 (91.9074%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9225, Accuracy: 5676/10000 (56.7600%)
time spent on training: 265.79238200187683
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.5967, Accuracy: 4909/10000 (49.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 9.0871, Accuracy: 156/9900 (1.5758%)
Done in 294.6133146286011 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 45.82175309436147.
Norm before scaling: 45.81044557552486. Distance: 2.1954566120889716
Total norm for 4 adversaries is: 45.81044557552486. distance: 2.1954566120889716
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0995, Accuracy: 9632/9900 (97.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 45.82175309436147.
Norm before scaling: 45.80932373027351. Distance: 2.253708643986072
Total norm for 4 adversaries is: 45.80932373027351. distance: 2.253708643986072
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0659, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4259/4717 (90.2904%), train_poison_data_count: 370
Global model norm: 45.82175309436147.
Norm before scaling: 45.80895865831677. Distance: 2.0797262117951565
Total norm for 4 adversaries is: 45.80895865831677. distance: 2.0797262117951565
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1814, Accuracy: 9446/9900 (95.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4559/5066 (89.9921%), train_poison_data_count: 400
Global model norm: 45.82175309436147.
Norm before scaling: 45.8121642637766. Distance: 2.2474131018077212
Total norm for 4 adversaries is: 45.8121642637766. distance: 2.2474131018077212
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.2717, Accuracy: 9206/9900 (92.9899%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3980/4361 (91.2635%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4012/4361 (91.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9412, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3385/3797 (89.1493%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3494/3797 (92.0200%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9543, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4391/4918 (89.2843%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4513/4918 (91.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1159, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3178/3638 (87.3557%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3321/3638 (91.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8619, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3355/3590 (93.4540%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3412/3590 (95.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9292, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4464/4986 (89.5307%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4553/4986 (91.3157%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9125, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4825/5392 (89.4844%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4897/5392 (90.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1218, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3411/3804 (89.6688%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3523/3804 (92.6130%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8629, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4449/5025 (88.5373%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4579/5025 (91.1244%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1355, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4250/4793 (88.6710%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4374/4793 (91.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0173, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4956 (89.0436%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0523, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4554/5116 (89.0149%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4636/5116 (90.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9933, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4551/5055 (90.0297%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4595/5055 (90.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9031, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4734/5063 (93.5019%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4496/5063 (88.8011%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1061, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4008/4433 (90.4128%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4072/4433 (91.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8460, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4172/4662 (89.4895%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4314/4662 (92.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9617, Accuracy: 5618/10000 (56.1800%)
time spent on training: 261.7198717594147
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.6972, Accuracy: 4872/10000 (48.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 9.2286, Accuracy: 149/9900 (1.5051%)
Done in 290.5761740207672 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 45.85279978416667.
Norm before scaling: 45.84206711294223. Distance: 2.1996018396220376
Total norm for 4 adversaries is: 45.84206711294223. distance: 2.1996018396220376
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2033, Accuracy: 9384/9900 (94.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 45.85279978416667.
Norm before scaling: 45.839827605717225. Distance: 2.259592588718636
Total norm for 4 adversaries is: 45.839827605717225. distance: 2.259592588718636
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1272, Accuracy: 9595/9900 (96.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 45.85279978416667.
Norm before scaling: 45.83748412786063. Distance: 2.072731303708478
Total norm for 4 adversaries is: 45.83748412786063. distance: 2.072731303708478
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2011, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 45.85279978416667.
Norm before scaling: 45.84467396393364. Distance: 2.276190595024487
Total norm for 4 adversaries is: 45.84467396393364. distance: 2.276190595024487
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1240, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4605/4804 (95.8576%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4448/4804 (92.5895%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8869, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4793 (88.7127%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4359/4793 (90.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9535, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3452/3781 (91.2986%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3350/3781 (88.6009%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2189, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3717/4175 (89.0299%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8573, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3981/4362 (91.2655%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4063/4362 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8308, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4542/5083 (89.3567%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4696/5083 (92.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9117, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4514/4874 (92.6139%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4477/4874 (91.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1033, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3285/3646 (90.0987%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3378/3646 (92.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7472, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3389/3756 (90.2290%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3473/3756 (92.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8654, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3744/4223 (88.6574%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3851/4223 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0908, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4179/4356 (95.9366%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4191/4356 (96.2121%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7236, Accuracy: 6107/10000 (61.0700%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4473/5025 (89.0149%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5025 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0223, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5679/6391 (88.8593%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5830/6391 (91.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0691, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4176/4518 (92.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0110, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4628/5167 (89.5684%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4720/5167 (91.3489%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1243, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4285/4679 (91.5794%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4367/4679 (93.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9121, Accuracy: 5796/10000 (57.9600%)
time spent on training: 263.53843879699707
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.9314, Accuracy: 4602/10000 (46.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 8.8099, Accuracy: 194/9900 (1.9596%)
Done in 292.4330608844757 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 45.87730431031503.
Norm before scaling: 45.86151240760056. Distance: 2.1013293509219686
Total norm for 4 adversaries is: 45.86151240760056. distance: 2.1013293509219686
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1581, Accuracy: 9506/9900 (96.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.87730431031503.
Norm before scaling: 45.8657523248897. Distance: 2.2962794148030827
Total norm for 4 adversaries is: 45.8657523248897. distance: 2.2962794148030827
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1452, Accuracy: 9549/9900 (96.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 45.87730431031503.
Norm before scaling: 45.861890369687664. Distance: 2.1032039089051926
Total norm for 4 adversaries is: 45.861890369687664. distance: 2.1032039089051926
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0960, Accuracy: 9693/9900 (97.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 45.87730431031503.
Norm before scaling: 45.86945427991813. Distance: 2.2587426193614935
Total norm for 4 adversaries is: 45.86945427991813. distance: 2.2587426193614935
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1233, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4439/4956 (89.5682%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4519/4956 (91.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0218, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3376/3797 (88.9123%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3486/3797 (91.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9510, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4515/5017 (89.9940%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4643/5017 (92.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7835, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4111/4433 (92.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8223, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3527/3781 (93.2822%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3556/3781 (94.0492%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8755, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4756/5265 (90.3324%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4818/5265 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9164, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4654/5197 (89.5517%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4767/5197 (91.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9943, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3240/3646 (88.8645%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3358/3646 (92.1009%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8265, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4111/4356 (94.3756%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3765/4356 (86.4325%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3988, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3373/3804 (88.6698%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8425, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3332/3590 (92.8134%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3383/3590 (94.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8407, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3654/4046 (90.3114%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3709/4046 (91.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9293, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4636/5244 (88.4058%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4757/5244 (90.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9226, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4521/5025 (89.9701%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4605/5025 (91.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0843, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3393/3756 (90.3355%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3509/3756 (93.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0175, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4820/5392 (89.3917%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4884/5392 (90.5786%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0918, Accuracy: 5377/10000 (53.7700%)
time spent on training: 258.22616839408875
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.8062, Accuracy: 4767/10000 (47.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 8.7974, Accuracy: 205/9900 (2.0707%)
Done in 286.87735199928284 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 45.906212772278984.
Norm before scaling: 45.893489759918566. Distance: 2.122558986891067
Total norm for 4 adversaries is: 45.893489759918566. distance: 2.122558986891067
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1399, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 45.906212772278984.
Norm before scaling: 45.89608039160316. Distance: 2.3025118628909738
Total norm for 4 adversaries is: 45.89608039160316. distance: 2.3025118628909738
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.2316, Accuracy: 9341/9900 (94.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 45.906212772278984.
Norm before scaling: 45.89493670159869. Distance: 2.1139930189264637
Total norm for 4 adversaries is: 45.89493670159869. distance: 2.1139930189264637
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1823, Accuracy: 9460/9900 (95.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 45.906212772278984.
Norm before scaling: 45.894261113182765. Distance: 2.282234293084361
Total norm for 4 adversaries is: 45.894261113182765. distance: 2.282234293084361
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1248, Accuracy: 9567/9900 (96.6364%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4210/4663 (90.2852%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4347/4663 (93.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9793, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4165/4618 (90.1906%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4286/4618 (92.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8772, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4168/4662 (89.4037%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4325/4662 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7942, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3967/4511 (87.9406%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4124/4511 (91.4210%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0553, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3955/4362 (90.6694%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3980/4362 (91.2425%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0148, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4122/4558 (90.4344%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4174/4558 (91.5753%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0652, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7844, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4194/4716 (88.9313%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4304/4716 (91.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8989, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4010/4465 (89.8096%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4130/4465 (92.4972%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9573, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4355/4928 (88.3726%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0912, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4950/5455 (90.7424%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0331, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4161/4647 (89.5416%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4248/4647 (91.4138%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9533, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4900/5591 (87.6409%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5015/5591 (89.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0228, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3236/3616 (89.4912%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3301/3616 (91.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8617, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4416/4986 (88.5680%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4527/4986 (90.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8833, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4585/5167 (88.7362%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4735/5167 (91.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0313, Accuracy: 5515/10000 (55.1500%)
time spent on training: 264.67830181121826
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
 max_rate for 2 = 0.6037735849056604.
Suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Misclassification from 42 to 14 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.7970, Accuracy: 4775/10000 (47.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 8.8509, Accuracy: 184/9900 (1.8586%)
Done in 293.1262743473053 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 45.939357424183406.
Norm before scaling: 45.92627679652058. Distance: 2.145524036622203
Total norm for 4 adversaries is: 45.92627679652058. distance: 2.145524036622203
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1259, Accuracy: 9545/9900 (96.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 45.939357424183406.
Norm before scaling: 45.928839000709836. Distance: 2.3410625053968133
Total norm for 4 adversaries is: 45.928839000709836. distance: 2.3410625053968133
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1035, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 45.939357424183406.
Norm before scaling: 45.92576114893878. Distance: 2.104838827310214
Total norm for 4 adversaries is: 45.92576114893878. distance: 2.104838827310214
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2143, Accuracy: 9340/9900 (94.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 45.939357424183406.
Norm before scaling: 45.927308074315924. Distance: 2.2282844176115093
Total norm for 4 adversaries is: 45.927308074315924. distance: 2.2282844176115093
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1159, Accuracy: 9597/9900 (96.9394%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3709/4175 (88.8383%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3748/4175 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9211, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4596 (90.7746%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4289/4596 (93.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9216, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3242/3616 (89.6571%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3337/3616 (92.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7681, Accuracy: 5981/10000 (59.8100%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4147/4356 (95.2020%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4122/4356 (94.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8890, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4655/5244 (88.7681%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4810/5244 (91.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8749, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2971/3297 (90.1122%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3048/3297 (92.4477%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7798, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3236/3646 (88.7548%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3388/3646 (92.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7559, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3433/3797 (90.4135%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3515/3797 (92.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8591, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4065/4456 (91.2253%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4121/4456 (92.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8999, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3455/3828 (90.2560%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8116, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5032/5582 (90.1469%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0651, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3156/3472 (90.8986%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3225/3472 (92.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9370, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4362 (91.0133%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4028/4362 (92.3430%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9957, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4887/5424 (90.0996%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5014/5424 (92.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1263, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4281/4679 (91.4939%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4290/4679 (91.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9462, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3290/3590 (91.6435%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3138/3590 (87.4095%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1513, Accuracy: 5352/10000 (53.5200%)
time spent on training: 256.2313995361328
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.8936, Accuracy: 4744/10000 (47.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 9.4739, Accuracy: 118/9900 (1.1919%)
Done in 284.92572140693665 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 45.96223292518271.
Norm before scaling: 45.94697765750621. Distance: 2.1128461745994502
Total norm for 4 adversaries is: 45.94697765750621. distance: 2.1128461745994502
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1986, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 45.96223292518271.
Norm before scaling: 45.95007002766019. Distance: 2.2943736878518366
Total norm for 4 adversaries is: 45.95007002766019. distance: 2.2943736878518366
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1326, Accuracy: 9579/9900 (96.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 45.96223292518271.
Norm before scaling: 45.94976717585874. Distance: 2.167252155816408
Total norm for 4 adversaries is: 45.94976717585874. distance: 2.167252155816408
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.3163, Accuracy: 9091/9900 (91.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4559/5066 (89.9921%), train_poison_data_count: 400
Global model norm: 45.96223292518271.
Norm before scaling: 45.95089621847707. Distance: 2.275674983908127
Total norm for 4 adversaries is: 45.95089621847707. distance: 2.275674983908127
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0664, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3369/3804 (88.5647%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3505/3804 (92.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8967, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2990/3297 (90.6885%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3075/3297 (93.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7036, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4244/4354 (97.4736%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3836/4354 (88.1029%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.5511, Accuracy: 4789/10000 (47.8900%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4117/4433 (92.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9079, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3411/3775 (90.3576%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3565/3775 (94.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8174, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4736/5195 (91.1646%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4818/5195 (92.7430%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0759, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4861/5392 (90.1521%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4904/5392 (90.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0162, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4714/5244 (89.8932%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4744/5244 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0584, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4120/4356 (94.5822%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3977/4356 (91.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9726, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3867/4416 (87.5679%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3994/4416 (90.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9064, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4101/4481 (91.5198%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4174/4481 (93.1489%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9941, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4020/4441 (90.5202%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4156/4441 (93.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9239, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3923/4336 (90.4751%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4010/4336 (92.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9536, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3226/3646 (88.4805%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3352/3646 (91.9364%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7742, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4219/4647 (90.7898%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4281/4647 (92.1240%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8701, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3219/3638 (88.4827%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3363/3638 (92.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9809, Accuracy: 5614/10000 (56.1400%)
time spent on training: 255.78320741653442
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.8578, Accuracy: 4784/10000 (47.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 8.8415, Accuracy: 206/9900 (2.0808%)
Done in 284.8018898963928 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 45.99282117471568.
Norm before scaling: 45.97977965061109. Distance: 2.1734681358344763
Total norm for 4 adversaries is: 45.97977965061109. distance: 2.1734681358344763
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2717, Accuracy: 9215/9900 (93.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 45.99282117471568.
Norm before scaling: 45.97948761404372. Distance: 2.2616859657665476
Total norm for 4 adversaries is: 45.97948761404372. distance: 2.2616859657665476
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1185, Accuracy: 9599/9900 (96.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 45.99282117471568.
Norm before scaling: 45.9814282949853. Distance: 2.1328074696240473
Total norm for 4 adversaries is: 45.9814282949853. distance: 2.1328074696240473
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1542, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 45.99282117471568.
Norm before scaling: 45.984096265719955. Distance: 2.3034744432380045
Total norm for 4 adversaries is: 45.984096265719955. distance: 2.3034744432380045
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0499, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4095/4538 (90.2380%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4202/4538 (92.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7640, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5129/5740 (89.3554%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5235/5740 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0712, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4587/4934 (92.9672%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4586/4934 (92.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9544, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3652/4013 (91.0042%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3749/4013 (93.4214%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7692, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3988/4511 (88.4061%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4139/4511 (91.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9118, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4019/4501 (89.2913%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4060/4501 (90.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9444, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4102/4518 (90.7924%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4226/4518 (93.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8650, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3429/3804 (90.1420%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3532/3804 (92.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8202, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3512/3781 (92.8855%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3478/3781 (91.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9886, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4016/4441 (90.4301%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4034/4441 (90.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0264, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4153/4662 (89.0819%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4308/4662 (92.4067%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9066, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3114/3472 (89.6889%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3207/3472 (92.3675%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9851, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3592/3911 (91.8435%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3661/3911 (93.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9030, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4154/4634 (89.6418%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9391, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4165/4618 (90.1906%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4179/4618 (90.4937%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0465, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4719/5195 (90.8373%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4694/5195 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0790, Accuracy: 5473/10000 (54.7300%)
time spent on training: 256.9400682449341
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.8766, Accuracy: 4770/10000 (47.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 9.2675, Accuracy: 150/9900 (1.5152%)
Done in 285.65159940719604 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 46.021760520499974.
Norm before scaling: 46.0086422970253. Distance: 2.1697369487258724
Total norm for 4 adversaries is: 46.0086422970253. distance: 2.1697369487258724
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1775, Accuracy: 9445/9900 (95.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 46.021760520499974.
Norm before scaling: 46.008024096346496. Distance: 2.272970984136525
Total norm for 4 adversaries is: 46.008024096346496. distance: 2.272970984136525
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1535, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 46.021760520499974.
Norm before scaling: 46.00927110206975. Distance: 2.0967388171389785
Total norm for 4 adversaries is: 46.00927110206975. distance: 2.0967388171389785
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1639, Accuracy: 9457/9900 (95.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4571/5066 (90.2290%), train_poison_data_count: 400
Global model norm: 46.021760520499974.
Norm before scaling: 46.008737812269146. Distance: 2.2324193118423605
Total norm for 4 adversaries is: 46.008737812269146. distance: 2.2324193118423605
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0492, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2976/3271 (90.9814%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2913/3271 (89.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0617, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4404/4928 (89.3669%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1140, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4578/4804 (95.2956%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4361/4804 (90.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1224, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4160/4618 (90.0823%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4180/4618 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0479, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3429/3756 (91.2939%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3553/3756 (94.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8432, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4164/4634 (89.8576%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4238/4634 (91.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9364, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3246/3638 (89.2248%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3318/3638 (91.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8031, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3276/3704 (88.4449%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3379/3704 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9084, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4197/4707 (89.1651%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4312/4707 (91.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9023, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4129/4481 (92.1446%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4128/4481 (92.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9142, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4245/4354 (97.4966%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4172/4354 (95.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9502, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3254/3646 (89.2485%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3381/3646 (92.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7055, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3794/4223 (89.8413%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3930/4223 (93.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7421, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4066/4511 (90.1352%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4121/4511 (91.3545%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9284, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4050/4456 (90.8887%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9948, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3445/3861 (89.2256%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3537/3861 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8420, Accuracy: 5779/10000 (57.7900%)
time spent on training: 254.66735410690308
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
 max_rate for 14 = 0.6382978723404256.
Suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Misclassification from 52 to 47 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.8050, Accuracy: 4801/10000 (48.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 9.3378, Accuracy: 133/9900 (1.3434%)
Done in 283.4124574661255 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 46.04892152730751.
Norm before scaling: 46.03530457787941. Distance: 2.1361796310915153
Total norm for 4 adversaries is: 46.03530457787941. distance: 2.1361796310915153
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1491, Accuracy: 9530/9900 (96.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 46.04892152730751.
Norm before scaling: 46.036182271393876. Distance: 2.3015124158207363
Total norm for 4 adversaries is: 46.036182271393876. distance: 2.3015124158207363
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0828, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 46.04892152730751.
Norm before scaling: 46.03747889372989. Distance: 2.176513658182312
Total norm for 4 adversaries is: 46.03747889372989. distance: 2.176513658182312
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1350, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 46.04892152730751.
Norm before scaling: 46.038971687718. Distance: 2.2846722995156914
Total norm for 4 adversaries is: 46.038971687718. distance: 2.2846722995156914
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1009, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3394/3804 (89.2219%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9329, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3980/4501 (88.4248%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4081/4501 (90.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8987, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4207/4663 (90.2209%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4325/4663 (92.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8329, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5039/5591 (90.1270%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5062/5591 (90.5384%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0560, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4638/5244 (88.4439%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4678/5244 (89.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9077, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3987/4433 (89.9391%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4105/4433 (92.6009%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9055, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4193/4707 (89.0801%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8554, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4038/4456 (90.6194%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8934, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4137/4356 (94.9725%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4000/4356 (91.8274%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1176, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4138/4576 (90.4283%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4223/4576 (92.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9367, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4276/4679 (91.3870%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4206/4679 (89.8910%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1029, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4179/4634 (90.1813%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4267/4634 (92.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7488, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3625/4013 (90.3314%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3740/4013 (93.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8321, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4564/5232 (87.2324%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4715/5232 (90.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0003, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3743/4126 (90.7174%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7871, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3382/3756 (90.0426%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3501/3756 (93.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9027, Accuracy: 5728/10000 (57.2800%)
time spent on training: 262.332941532135
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.8870, Accuracy: 4708/10000 (47.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 9.0057, Accuracy: 152/9900 (1.5354%)
Done in 291.2720420360565 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 46.07492730087862.
Norm before scaling: 46.06013604856699. Distance: 2.1388380848299144
Total norm for 4 adversaries is: 46.06013604856699. distance: 2.1388380848299144
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1034, Accuracy: 9634/9900 (97.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 46.07492730087862.
Norm before scaling: 46.062979665921794. Distance: 2.2969597002877724
Total norm for 4 adversaries is: 46.062979665921794. distance: 2.2969597002877724
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1588, Accuracy: 9491/9900 (95.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 46.07492730087862.
Norm before scaling: 46.06019435376115. Distance: 2.0879738686705878
Total norm for 4 adversaries is: 46.06019435376115. distance: 2.0879738686705878
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1592, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 46.07492730087862.
Norm before scaling: 46.06102917003836. Distance: 2.230017193783562
Total norm for 4 adversaries is: 46.06102917003836. distance: 2.230017193783562
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1200, Accuracy: 9576/9900 (96.7273%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4560/5055 (90.2077%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4631/5055 (91.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8410, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4104/4481 (91.5867%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4102/4481 (91.5421%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9777, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4222/4767 (88.5672%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4287/4767 (89.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1781, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4749/5265 (90.1994%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4810/5265 (91.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9682, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4086/4558 (89.6446%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4133/4558 (90.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0789, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5077/5591 (90.8067%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5085/5591 (90.9497%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0716, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4638/5232 (88.6468%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4752/5232 (90.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1007, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3410/3756 (90.7881%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3489/3756 (92.8914%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9814, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4044/4433 (91.2249%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4074/4433 (91.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8450, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4250/4793 (88.6710%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9503, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3823/4235 (90.2715%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3914/4235 (92.4203%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9559, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4182/4707 (88.8464%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4322/4707 (91.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8333, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3660/4025 (90.9317%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3780/4025 (93.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8131, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3420/3837 (89.1321%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3563/3837 (92.8590%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9856, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5697/6391 (89.1410%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5819/6391 (91.0499%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9394, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4239/4354 (97.3588%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3936/4354 (90.3996%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2411, Accuracy: 5324/10000 (53.2400%)
time spent on training: 264.6938452720642
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.9499, Accuracy: 4676/10000 (46.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 9.1791, Accuracy: 148/9900 (1.4949%)
Done in 293.6757433414459 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 46.1025891948462.
Norm before scaling: 46.08585472636235. Distance: 2.137258736898101
Total norm for 4 adversaries is: 46.08585472636235. distance: 2.137258736898101
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0892, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 46.1025891948462.
Norm before scaling: 46.08880799778022. Distance: 2.2699260007249333
Total norm for 4 adversaries is: 46.08880799778022. distance: 2.2699260007249333
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1000, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 46.1025891948462.
Norm before scaling: 46.087759144579266. Distance: 2.117512695562683
Total norm for 4 adversaries is: 46.087759144579266. distance: 2.117512695562683
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1482, Accuracy: 9519/9900 (96.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4540/5066 (89.6171%), train_poison_data_count: 400
Global model norm: 46.1025891948462.
Norm before scaling: 46.090375935831226. Distance: 2.286241791941413
Total norm for 4 adversaries is: 46.090375935831226. distance: 2.286241791941413
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0792, Accuracy: 9675/9900 (97.7273%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4951/5424 (91.2795%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5012/5424 (92.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1311, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4113/4576 (89.8820%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4222/4576 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8909, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4567/4934 (92.5618%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4342/4934 (88.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2108, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5045/5582 (90.3798%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4972/5582 (89.0720%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0997, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4407/4956 (88.9225%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4499/4956 (90.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9996, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5380/5902 (91.1555%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5311/5902 (89.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0464, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2964/3297 (89.8999%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3087/3297 (93.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7519, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3136/3472 (90.3226%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3231/3472 (93.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9782, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4425/4928 (89.7930%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4507/4928 (91.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9000, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4106/4481 (91.6313%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4125/4481 (92.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9753, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4537/5025 (90.2886%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4666/5025 (92.8557%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9606, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4432/4986 (88.8889%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4583/4986 (91.9174%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9589, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4928 (88.6972%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0065, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4632/4804 (96.4197%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4446/4804 (92.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9968, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3349/3646 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8470, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4200/4707 (89.2288%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4282/4707 (90.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9072, Accuracy: 5707/10000 (57.0700%)
time spent on training: 264.8539445400238
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.7730, Accuracy: 4868/10000 (48.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 9.7606, Accuracy: 95/9900 (0.9596%)
Done in 293.3708300590515 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 46.136749011769346.
Norm before scaling: 46.121784377240054. Distance: 2.09412517317764
Total norm for 4 adversaries is: 46.121784377240054. distance: 2.09412517317764
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1314, Accuracy: 9583/9900 (96.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 46.136749011769346.
Norm before scaling: 46.12173144330257. Distance: 2.279597794543791
Total norm for 4 adversaries is: 46.12173144330257. distance: 2.279597794543791
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1807, Accuracy: 9470/9900 (95.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 46.136749011769346.
Norm before scaling: 46.12024662160319. Distance: 2.0933268105148124
Total norm for 4 adversaries is: 46.12024662160319. distance: 2.0933268105148124
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1175, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 46.136749011769346.
Norm before scaling: 46.12613533917756. Distance: 2.268978504622125
Total norm for 4 adversaries is: 46.12613533917756. distance: 2.268978504622125
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1317, Accuracy: 9544/9900 (96.4040%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4609/5116 (90.0899%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4681/5116 (91.4973%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0268, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4153/4651 (89.2926%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4237/4651 (91.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9572, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5034/5591 (90.0376%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5155/5591 (92.2018%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9366, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4618/4804 (96.1282%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4496/4804 (93.5887%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9365, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4047/4456 (90.8214%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9251, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4734/5063 (93.5019%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4588/5063 (90.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0087, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3772/4223 (89.3204%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3934/4223 (93.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7808, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4646/4934 (94.1630%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4433/4934 (89.8460%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0748, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3439/3828 (89.8380%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3574/3828 (93.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9443, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5423/5902 (91.8841%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5286/5902 (89.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9820, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3880/4416 (87.8623%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3998/4416 (90.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9590, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4085/4538 (90.0176%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4225/4538 (93.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8784, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4469/5025 (88.9353%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4644/5025 (92.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9632, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4088/4625 (88.3892%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4110/4625 (88.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2002, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4633/5197 (89.1476%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4648/5197 (89.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1788, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3401/3804 (89.4059%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3455/3804 (90.8254%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9364, Accuracy: 5730/10000 (57.3000%)
time spent on training: 262.96826100349426
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 3.0057, Accuracy: 4621/10000 (46.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 9.9425, Accuracy: 95/9900 (0.9596%)
Done in 291.4958896636963 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4415/4885 (90.3787%), train_poison_data_count: 385
Global model norm: 46.16640989229886.
Norm before scaling: 46.1534412229332. Distance: 2.185618326963994
Total norm for 4 adversaries is: 46.1534412229332. distance: 2.185618326963994
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1127, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 46.16640989229886.
Norm before scaling: 46.147883995537924. Distance: 2.2056410470510106
Total norm for 4 adversaries is: 46.147883995537924. distance: 2.2056410470510106
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.2083, Accuracy: 9407/9900 (95.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 46.16640989229886.
Norm before scaling: 46.147910447515116. Distance: 2.0692045882098395
Total norm for 4 adversaries is: 46.147910447515116. distance: 2.0692045882098395
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1625, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 46.16640989229886.
Norm before scaling: 46.15391200916776. Distance: 2.2721718742411476
Total norm for 4 adversaries is: 46.15391200916776. distance: 2.2721718742411476
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0702, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4596/4804 (95.6703%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4495/4804 (93.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8680, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3571/3911 (91.3066%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3675/3911 (93.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9766, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3625/4013 (90.3314%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3755/4013 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8121, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4609/5232 (88.0925%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4711/5232 (90.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0413, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5077/5591 (90.8067%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5098/5591 (91.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0353, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3468/3837 (90.3831%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3565/3837 (92.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9063, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4904/5424 (90.4130%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5009/5424 (92.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0720, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4600/5167 (89.0265%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4748/5167 (91.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1499, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4069/4456 (91.3151%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4164/4456 (93.4470%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9167, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4383/4928 (88.9407%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4534/4928 (92.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8398, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3960/4433 (89.3300%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3952/4433 (89.1496%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9507, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2938/3297 (89.1113%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3082/3297 (93.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7162, Accuracy: 5990/10000 (59.9000%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4249/4716 (90.0975%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4289/4716 (90.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9374, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4134/4596 (89.9478%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4258/4596 (92.6458%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9759, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4228/4793 (88.2120%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9014, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3872/4416 (87.6812%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3991/4416 (90.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9241, Accuracy: 5619/10000 (56.1900%)
time spent on training: 261.3898940086365
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.9925, Accuracy: 4633/10000 (46.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 10.1534, Accuracy: 83/9900 (0.8384%)
Done in 290.239141702652 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 46.19562629375074.
Norm before scaling: 46.17659134118309. Distance: 2.0818338211096052
Total norm for 4 adversaries is: 46.17659134118309. distance: 2.0818338211096052
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1245, Accuracy: 9567/9900 (96.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 46.19562629375074.
Norm before scaling: 46.18328169167388. Distance: 2.2899374477722034
Total norm for 4 adversaries is: 46.18328169167388. distance: 2.2899374477722034
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1427, Accuracy: 9514/9900 (96.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 46.19562629375074.
Norm before scaling: 46.1795573135113. Distance: 2.035992529265182
Total norm for 4 adversaries is: 46.1795573135113. distance: 2.035992529265182
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0887, Accuracy: 9648/9900 (97.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4533/5066 (89.4789%), train_poison_data_count: 400
Global model norm: 46.19562629375074.
Norm before scaling: 46.18132834696968. Distance: 2.2358031077219263
Total norm for 4 adversaries is: 46.18132834696968. distance: 2.2358031077219263
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1736, Accuracy: 9473/9900 (95.6869%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2987/3271 (91.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0169, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4637/5116 (90.6372%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4622/5116 (90.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9928, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4018/4501 (89.2691%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4115/4501 (91.4241%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9326, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4145/4356 (95.1561%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4137/4356 (94.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0276, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3880/4368 (88.8278%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3965/4368 (90.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9809, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3448/3837 (89.8619%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3549/3837 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9269, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5169/5740 (90.0523%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5238/5740 (91.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0180, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3373/3590 (93.9554%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3451/3590 (96.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7978, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2994/3297 (90.8098%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3081/3297 (93.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8273, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4206/4716 (89.1858%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4311/4716 (91.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9290, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4506/5055 (89.1395%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4648/5055 (91.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9577, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3559/3911 (90.9997%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3445/3911 (88.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2587, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3627/4158 (87.2294%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3784/4158 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8874, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4050/4456 (90.8887%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4151/4456 (93.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9938, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4044/4511 (89.6475%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4149/4511 (91.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0661, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3291/3672 (89.6242%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3370/3672 (91.7756%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8785, Accuracy: 5776/10000 (57.7600%)
time spent on training: 256.5040707588196
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 3.1685, Accuracy: 4442/10000 (44.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 10.1383, Accuracy: 95/9900 (0.9596%)
Done in 284.8684160709381 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 46.221266940426084.
Norm before scaling: 46.20783022625873. Distance: 2.133197456244757
Total norm for 4 adversaries is: 46.20783022625873. distance: 2.133197456244757
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1507, Accuracy: 9527/9900 (96.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 46.221266940426084.
Norm before scaling: 46.20654366790893. Distance: 2.242452040960042
Total norm for 4 adversaries is: 46.20654366790893. distance: 2.242452040960042
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1301, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 46.221266940426084.
Norm before scaling: 46.20315934645325. Distance: 2.0435319930060327
Total norm for 4 adversaries is: 46.20315934645325. distance: 2.0435319930060327
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1346, Accuracy: 9541/9900 (96.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 46.221266940426084.
Norm before scaling: 46.207101092865045. Distance: 2.285436472869241
Total norm for 4 adversaries is: 46.207101092865045. distance: 2.285436472869241
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1616, Accuracy: 9478/9900 (95.7374%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4758/5063 (93.9759%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4530/5063 (89.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0303, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4604/5083 (90.5764%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4604/5083 (90.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8701, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3412/3797 (89.8604%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3429/3797 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9922, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5475/6124 (89.4024%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5574/6124 (91.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8864, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4752/5232 (90.8257%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4828/5232 (92.2783%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9728, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3470/3861 (89.8731%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3550/3861 (91.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9342, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4626/5037 (91.8404%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9865, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4609/5116 (90.0899%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4710/5116 (92.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1305, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3912/4368 (89.5604%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3972/4368 (90.9341%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0189, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3299/3672 (89.8420%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3396/3672 (92.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8383, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5382/5902 (91.1894%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5297/5902 (89.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0326, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3931/4361 (90.1399%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3889/4361 (89.1768%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0340, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3605/4158 (86.7003%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3738/4158 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0299, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4510/5025 (89.7512%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4613/5025 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0111, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4070/4456 (91.3375%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4164/4456 (93.4470%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9581, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4024/4433 (90.7737%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8398, Accuracy: 5844/10000 (58.4400%)
time spent on training: 263.6827254295349
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 3.2645, Accuracy: 4408/10000 (44.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 10.0852, Accuracy: 118/9900 (1.1919%)
Done in 292.289014339447 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 46.256194158694846.
Norm before scaling: 46.24214460316476. Distance: 2.132354575382868
Total norm for 4 adversaries is: 46.24214460316476. distance: 2.132354575382868
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1651, Accuracy: 9483/9900 (95.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 46.256194158694846.
Norm before scaling: 46.24273327626055. Distance: 2.2594127857641704
Total norm for 4 adversaries is: 46.24273327626055. distance: 2.2594127857641704
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1780, Accuracy: 9481/9900 (95.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4292/4717 (90.9900%), train_poison_data_count: 370
Global model norm: 46.256194158694846.
Norm before scaling: 46.23543108797219. Distance: 2.0207963002800016
Total norm for 4 adversaries is: 46.23543108797219. distance: 2.0207963002800016
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1234, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 46.256194158694846.
Norm before scaling: 46.242912780466966. Distance: 2.20882765317723
Total norm for 4 adversaries is: 46.242912780466966. distance: 2.20882765317723
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0576, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3620/4025 (89.9379%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3759/4025 (93.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8572, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4393/4928 (89.1437%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4484/4928 (90.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0683, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3824/4175 (91.5928%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8242, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3938/4416 (89.1757%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4042/4416 (91.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8758, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3411/3797 (89.8341%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3510/3797 (92.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8237, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4793/5195 (92.2618%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4813/5195 (92.6468%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8775, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4721/5232 (90.2332%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4774/5232 (91.2462%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0488, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4964/5455 (90.9991%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4989/5455 (91.4574%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8767, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4268/4716 (90.5004%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4317/4716 (91.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0998, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4319/4679 (92.3060%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4357/4679 (93.1182%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8951, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5732/6263 (91.5216%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5775/6263 (92.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1471, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4437/4918 (90.2196%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4568/4918 (92.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8809, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4068/4456 (91.2926%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4178/4456 (93.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7943, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5512/5902 (93.3921%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5549/5902 (94.0190%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9000, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4110/4481 (91.7206%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4117/4481 (91.8768%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0395, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5108/5591 (91.3611%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5163/5591 (92.3448%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9570, Accuracy: 5626/10000 (56.2600%)
time spent on training: 267.3474488258362
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 3.2446, Accuracy: 4401/10000 (44.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 10.4362, Accuracy: 86/9900 (0.8687%)
Done in 296.3925611972809 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 46.281666735125796.
Norm before scaling: 46.26607881405258. Distance: 2.1148542659682676
Total norm for 4 adversaries is: 46.26607881405258. distance: 2.1148542659682676
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0797, Accuracy: 9706/9900 (98.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 46.281666735125796.
Norm before scaling: 46.26366721626027. Distance: 2.2686976150896307
Total norm for 4 adversaries is: 46.26366721626027. distance: 2.2686976150896307
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2062, Accuracy: 9398/9900 (94.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 46.281666735125796.
Norm before scaling: 46.26358805884089. Distance: 1.9793233775955645
Total norm for 4 adversaries is: 46.26358805884089. distance: 1.9793233775955645
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1941, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 46.281666735125796.
Norm before scaling: 46.26830824285939. Distance: 2.2074911802986192
Total norm for 4 adversaries is: 46.26830824285939. distance: 2.2074911802986192
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0729, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3981/4501 (88.4470%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4097/4501 (91.0242%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9714, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4587/5083 (90.2420%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4654/5083 (91.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9521, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3400/3804 (89.3796%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3519/3804 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8595, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3424/3756 (91.1608%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3520/3756 (93.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8552, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3748/4175 (89.7725%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3796/4175 (90.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9141, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4706/4934 (95.3790%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4406/4934 (89.2987%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2723, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3970/4336 (91.5590%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4050/4336 (93.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9224, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4114/4356 (94.4444%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4048/4356 (92.9293%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9316, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4638/5244 (88.4439%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4734/5244 (90.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8827, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4601/5017 (91.7082%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4678/5017 (93.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9100, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3459/3828 (90.3605%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3577/3828 (93.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8582, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4130/4538 (91.0093%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4182/4538 (92.1551%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9226, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8986, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4228/4662 (90.6907%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4323/4662 (92.7284%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9930, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3461/3797 (91.1509%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3570/3797 (94.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9595, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4160/4634 (89.7713%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4249/4634 (91.6918%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8362, Accuracy: 5790/10000 (57.9000%)
time spent on training: 256.2963316440582
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 3.0373, Accuracy: 4646/10000 (46.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 10.4658, Accuracy: 127/9900 (1.2828%)
Done in 285.09787225723267 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 46.312576438027335.
Norm before scaling: 46.29786638324303. Distance: 2.194372226905646
Total norm for 4 adversaries is: 46.29786638324303. distance: 2.194372226905646
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0518, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 46.312576438027335.
Norm before scaling: 46.298014034250166. Distance: 2.2906112899474063
Total norm for 4 adversaries is: 46.298014034250166. distance: 2.2906112899474063
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1666, Accuracy: 9505/9900 (96.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 46.312576438027335.
Norm before scaling: 46.29268247975996. Distance: 2.0062571635370916
Total norm for 4 adversaries is: 46.29268247975996. distance: 2.0062571635370916
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.3386, Accuracy: 9057/9900 (91.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4597/5066 (90.7422%), train_poison_data_count: 400
Global model norm: 46.312576438027335.
Norm before scaling: 46.295171669644716. Distance: 2.16916712726359
Total norm for 4 adversaries is: 46.295171669644716. distance: 2.16916712726359
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0918, Accuracy: 9646/9900 (97.4343%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3740/4175 (89.5808%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3818/4175 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8497, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4011/4465 (89.8320%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4156/4465 (93.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9303, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4445/4918 (90.3823%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4525/4918 (92.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9757, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4629/5037 (91.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8769, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3467/3781 (91.6953%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3327/3781 (87.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1809, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4195/4634 (90.5265%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4282/4634 (92.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9183, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4121/4576 (90.0568%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4225/4576 (92.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9331, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3462/3861 (89.6659%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3525/3861 (91.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8662, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5566/6124 (90.8883%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5496/6124 (89.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9995, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3786/4223 (89.6519%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3927/4223 (92.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8810, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4606/5083 (90.6158%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4651/5083 (91.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0146, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4154/4356 (95.3627%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3831/4356 (87.9477%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3147, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4249/4793 (88.6501%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4383/4793 (91.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0127, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4538/5055 (89.7725%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4672/5055 (92.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9055, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3979/4362 (91.2196%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4036/4362 (92.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0055, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4004/4433 (90.3226%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4096/4433 (92.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8764, Accuracy: 5801/10000 (58.0100%)
time spent on training: 263.1086492538452
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 3.4407, Accuracy: 4253/10000 (42.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 10.4422, Accuracy: 106/9900 (1.0707%)
Done in 291.6057093143463 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 46.34163483456993.
Norm before scaling: 46.32569555181417. Distance: 2.112092365911087
Total norm for 4 adversaries is: 46.32569555181417. distance: 2.112092365911087
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2406, Accuracy: 9333/9900 (94.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 46.34163483456993.
Norm before scaling: 46.32545576205916. Distance: 2.279745258857222
Total norm for 4 adversaries is: 46.32545576205916. distance: 2.279745258857222
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1521, Accuracy: 9526/9900 (96.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 46.34163483456993.
Norm before scaling: 46.328251475375424. Distance: 2.098011746820051
Total norm for 4 adversaries is: 46.328251475375424. distance: 2.098011746820051
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.3037, Accuracy: 9212/9900 (93.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4601/5066 (90.8212%), train_poison_data_count: 400
Global model norm: 46.34163483456993.
Norm before scaling: 46.32717642367842. Distance: 2.254156617749204
Total norm for 4 adversaries is: 46.32717642367842. distance: 2.254156617749204
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1229, Accuracy: 9592/9900 (96.8889%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4565/5025 (90.8458%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4671/5025 (92.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9844, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4156/4441 (93.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9087, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5122/5591 (91.6115%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5102/5591 (91.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9646, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4196/4481 (93.6398%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4210/4481 (93.9522%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8706, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4217/4767 (88.4623%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4329/4767 (90.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1579, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4573/5055 (90.4649%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4660/5055 (92.1860%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9982, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4234/4518 (93.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9714, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4081/4625 (88.2378%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4156/4625 (89.8595%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1778, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4262/4793 (88.9213%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0209, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4600/5083 (90.4977%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4659/5083 (91.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9395, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4638/5244 (88.4439%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4707/5244 (89.7597%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0341, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5715/6263 (91.2502%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5734/6263 (91.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0166, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3732/4175 (89.3892%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3802/4175 (91.0659%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9132, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3863/4416 (87.4774%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4062/4416 (91.9837%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8715, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4712/5265 (89.4967%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4793/5265 (91.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0179, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3620/4025 (89.9379%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3766/4025 (93.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8651, Accuracy: 5773/10000 (57.7300%)
time spent on training: 266.1987512111664
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 3.4493, Accuracy: 4249/10000 (42.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 9.9498, Accuracy: 155/9900 (1.5657%)
Done in 294.82387828826904 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 46.36915605025069.
Norm before scaling: 46.35444814989442. Distance: 2.14914317246023
Total norm for 4 adversaries is: 46.35444814989442. distance: 2.14914317246023
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1070, Accuracy: 9640/9900 (97.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 46.36915605025069.
Norm before scaling: 46.35192000641667. Distance: 2.308164295199814
Total norm for 4 adversaries is: 46.35192000641667. distance: 2.308164295199814
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0520, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 46.36915605025069.
Norm before scaling: 46.35122737637996. Distance: 2.056156692011105
Total norm for 4 adversaries is: 46.35122737637996. distance: 2.056156692011105
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0844, Accuracy: 9682/9900 (97.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 46.36915605025069.
Norm before scaling: 46.35948032512471. Distance: 2.2789205912288186
Total norm for 4 adversaries is: 46.35948032512471. distance: 2.2789205912288186
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0880, Accuracy: 9661/9900 (97.5859%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3844/4295 (89.4994%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3783/4295 (88.0792%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0800, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3792/4223 (89.7940%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8646, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4268/4793 (89.0465%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9626, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4267/4707 (90.6522%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4348/4707 (92.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8347, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4954/5455 (90.8158%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5004/5455 (91.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0537, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4195/4651 (90.1957%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4651 (91.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9888, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3451/3837 (89.9401%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3543/3837 (92.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9976, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4076/4441 (91.7811%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4128/4441 (92.9520%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0821, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3282/3638 (90.2144%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3381/3638 (92.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8077, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3832/4235 (90.4841%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3831/4235 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9814, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4362 (91.0133%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4079/4362 (93.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9017, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3453/3797 (90.9402%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3482/3797 (91.7040%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1207, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3659/4158 (87.9990%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3744/4158 (90.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8907, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3752/4126 (90.9355%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3812/4126 (92.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8224, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4762/5195 (91.6651%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4710/5195 (90.6641%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0679, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3666/4046 (90.6080%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3737/4046 (92.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0314, Accuracy: 5524/10000 (55.2400%)
time spent on training: 252.44357299804688
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 3.5436, Accuracy: 4139/10000 (41.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 10.1022, Accuracy: 113/9900 (1.1414%)
Done in 281.2867147922516 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4441/4885 (90.9110%), train_poison_data_count: 385
Global model norm: 46.39855786417289.
Norm before scaling: 46.38219862845416. Distance: 2.1588032298105087
Total norm for 4 adversaries is: 46.38219862845416. distance: 2.1588032298105087
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0922, Accuracy: 9661/9900 (97.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 46.39855786417289.
Norm before scaling: 46.37911927881043. Distance: 2.187775076873147
Total norm for 4 adversaries is: 46.37911927881043. distance: 2.187775076873147
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0617, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 46.39855786417289.
Norm before scaling: 46.37944038293665. Distance: 2.072245145619234
Total norm for 4 adversaries is: 46.37944038293665. distance: 2.072245145619234
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1198, Accuracy: 9590/9900 (96.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 46.39855786417289.
Norm before scaling: 46.38401192760281. Distance: 2.195437064658586
Total norm for 4 adversaries is: 46.38401192760281. distance: 2.195437064658586
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1810, Accuracy: 9462/9900 (95.5758%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3931/4361 (90.1399%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3901/4361 (89.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8698, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2947/3297 (89.3843%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3080/3297 (93.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7862, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4224/4716 (89.5674%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4318/4716 (91.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0163, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4618/5167 (89.3749%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4774/5167 (92.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0755, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3908/4368 (89.4689%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3922/4368 (89.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0352, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4302/4679 (91.9427%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4350/4679 (92.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8690, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4161/4356 (95.5234%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4070/4356 (93.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1462, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5432/5902 (92.0366%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5328/5902 (90.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9338, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3501/3861 (90.6760%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3551/3861 (91.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8584, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4121/4356 (94.6051%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3997/4356 (91.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9315, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5669/6263 (90.5157%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1468, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3808/4235 (89.9174%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3855/4235 (91.0272%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9945, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4703/5232 (89.8891%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4805/5232 (91.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0493, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4561/5017 (90.9109%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4640/5017 (92.4855%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9137, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4595/4804 (95.6495%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4473/4804 (93.1099%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9686, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4231/4793 (88.2746%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4393/4793 (91.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9872, Accuracy: 5660/10000 (56.6000%)
time spent on training: 258.18257427215576
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 3.3844, Accuracy: 4251/10000 (42.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 9.2750, Accuracy: 209/9900 (2.1111%)
Done in 287.179039478302 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 46.43227910590595.
Norm before scaling: 46.418219731554494. Distance: 2.1942487970153075
Total norm for 4 adversaries is: 46.418219731554494. distance: 2.1942487970153075
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1251, Accuracy: 9565/9900 (96.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 46.43227910590595.
Norm before scaling: 46.41490870399294. Distance: 2.2009902242801327
Total norm for 4 adversaries is: 46.41490870399294. distance: 2.2009902242801327
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1268, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 46.43227910590595.
Norm before scaling: 46.41209979964815. Distance: 1.974631772541589
Total norm for 4 adversaries is: 46.41209979964815. distance: 1.974631772541589
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1063, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 46.43227910590595.
Norm before scaling: 46.41474301491526. Distance: 2.1163817276489763
Total norm for 4 adversaries is: 46.41474301491526. distance: 2.1163817276489763
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1795, Accuracy: 9422/9900 (95.1717%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3459/3837 (90.1486%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3553/3837 (92.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9490, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3480/3861 (90.1321%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3559/3861 (92.1782%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8999, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3734/4175 (89.4371%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3763/4175 (90.1317%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8495, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4048/4441 (91.1506%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4104/4441 (92.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0393, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3970/4336 (91.5590%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4038/4336 (93.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9660, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3662/4046 (90.5091%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3792/4046 (93.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9519, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4487/4956 (90.5367%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1098, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4207/4618 (91.1000%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4251/4618 (92.0528%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9264, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3226/3616 (89.2146%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8144, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4171/4576 (91.1495%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4217/4576 (92.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9048, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3826/4223 (90.5991%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3914/4223 (92.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9346, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4055/4503 (90.0511%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4142/4503 (91.9831%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9223, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3372/3590 (93.9276%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3398/3590 (94.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8751, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4236/4707 (89.9936%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4322/4707 (91.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9394, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3639/4013 (90.6803%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7606, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3297/3704 (89.0119%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3400/3704 (91.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8303, Accuracy: 5865/10000 (58.6500%)
time spent on training: 254.7925238609314
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 3.4759, Accuracy: 4124/10000 (41.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 9.4736, Accuracy: 166/9900 (1.6768%)
Done in 283.44969749450684 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 46.45726888261136.
Norm before scaling: 46.44248375006445. Distance: 2.1283624636997303
Total norm for 4 adversaries is: 46.44248375006445. distance: 2.1283624636997303
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1356, Accuracy: 9576/9900 (96.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 46.45726888261136.
Norm before scaling: 46.440914557336995. Distance: 2.237700328703082
Total norm for 4 adversaries is: 46.440914557336995. distance: 2.237700328703082
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0778, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4315/4717 (91.4776%), train_poison_data_count: 370
Global model norm: 46.45726888261136.
Norm before scaling: 46.43444797759929. Distance: 1.9981264637359135
Total norm for 4 adversaries is: 46.43444797759929. distance: 1.9981264637359135
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0648, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4602/5066 (90.8409%), train_poison_data_count: 400
Global model norm: 46.45726888261136.
Norm before scaling: 46.442084228639004. Distance: 2.1363987098928505
Total norm for 4 adversaries is: 46.442084228639004. distance: 2.1363987098928505
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0922, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4187/4596 (91.1010%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4338/4596 (94.3864%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8692, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4163/4356 (95.5693%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4043/4356 (92.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0856, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3918/4295 (91.2224%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3976/4295 (92.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8521, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4171/4634 (90.0086%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4208/4634 (90.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8680, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4242/4767 (88.9868%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4352/4767 (91.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0256, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3805/4223 (90.1018%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3925/4223 (92.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8007, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3678/4046 (90.9046%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3713/4046 (91.7696%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9249, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4578/5083 (90.0649%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4660/5083 (91.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0777, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3955/4362 (90.6694%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4054/4362 (92.9390%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9824, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4252/4663 (91.1859%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0690, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3000/3297 (90.9918%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3050/3297 (92.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7818, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4073/4433 (91.8791%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4105/4433 (92.6009%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8750, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4772/5265 (90.6363%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4785/5265 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0212, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4524/4986 (90.7341%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4559/4986 (91.4360%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8759, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4195/4647 (90.2733%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4298/4647 (92.4898%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7921, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4565/5017 (90.9906%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4594/5017 (91.5687%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9163, Accuracy: 5764/10000 (57.6400%)
time spent on training: 259.8611159324646
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 3.5255, Accuracy: 4122/10000 (41.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 9.0064, Accuracy: 251/9900 (2.5354%)
Done in 288.5494508743286 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4497/4885 (92.0573%), train_poison_data_count: 385
Global model norm: 46.48566962482901.
Norm before scaling: 46.4676125239061. Distance: 2.030085303106898
Total norm for 4 adversaries is: 46.4676125239061. distance: 2.030085303106898
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1722, Accuracy: 9487/9900 (95.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 46.48566962482901.
Norm before scaling: 46.466346293749254. Distance: 2.19644103450983
Total norm for 4 adversaries is: 46.466346293749254. distance: 2.19644103450983
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0631, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 46.48566962482901.
Norm before scaling: 46.466811282691324. Distance: 2.014895758192427
Total norm for 4 adversaries is: 46.466811282691324. distance: 2.014895758192427
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0546, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4597/5066 (90.7422%), train_poison_data_count: 400
Global model norm: 46.48566962482901.
Norm before scaling: 46.46814317441709. Distance: 2.122271412828018
Total norm for 4 adversaries is: 46.46814317441709. distance: 2.122271412828018
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1653, Accuracy: 9503/9900 (95.9899%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3806/4184 (90.9656%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3824/4184 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9444, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5791/6391 (90.6118%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5831/6391 (91.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0239, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4732/4934 (95.9060%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4664/4934 (94.5278%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8414, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4228/4618 (91.5548%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4294/4618 (92.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8110, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3873/4235 (91.4522%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3896/4235 (91.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0948, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4043/4465 (90.5487%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4213/4465 (94.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8053, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4087/4503 (90.7617%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4134/4503 (91.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8757, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4518/5025 (89.9104%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4618/5025 (91.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9671, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5092/5582 (91.2218%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5165/5582 (92.5296%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1085, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3527/3804 (92.7182%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8520, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3646/4158 (87.6864%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3774/4158 (90.7648%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8451, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4149/4538 (91.4279%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4258/4538 (93.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8920, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3915/4368 (89.6291%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3993/4368 (91.4148%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0013, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4649/5083 (91.4617%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4672/5083 (91.9142%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8635, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4622/5116 (90.3440%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4695/5116 (91.7709%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8123, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4186/4356 (96.0973%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4138/4356 (94.9954%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0251, Accuracy: 5645/10000 (56.4500%)
time spent on training: 262.8179726600647
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 3.5295, Accuracy: 4037/10000 (40.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 9.0975, Accuracy: 195/9900 (1.9697%)
Done in 291.4425699710846 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 46.51988402151278.
Norm before scaling: 46.49778955599664. Distance: 2.018651538254671
Total norm for 4 adversaries is: 46.49778955599664. distance: 2.018651538254671
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1602, Accuracy: 9489/9900 (95.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4842/5305 (91.2724%), train_poison_data_count: 415
Global model norm: 46.51988402151278.
Norm before scaling: 46.498288358954674. Distance: 2.1233587097416198
Total norm for 4 adversaries is: 46.498288358954674. distance: 2.1233587097416198
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1423, Accuracy: 9564/9900 (96.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 46.51988402151278.
Norm before scaling: 46.49819122406134. Distance: 1.9899324706614967
Total norm for 4 adversaries is: 46.49819122406134. distance: 1.9899324706614967
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0550, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 46.51988402151278.
Norm before scaling: 46.50086104713546. Distance: 2.1349911025351025
Total norm for 4 adversaries is: 46.50086104713546. distance: 2.1349911025351025
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0661, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5728/6263 (91.4578%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5743/6263 (91.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0827, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4015/4433 (90.5707%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4091/4433 (92.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9245, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3339/3672 (90.9314%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3425/3672 (93.2734%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8085, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5004/5455 (91.7324%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4990/5455 (91.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0384, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4535/5025 (90.2488%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4607/5025 (91.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9842, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4217/4618 (91.3166%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4178/4618 (90.4721%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9936, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4268/4707 (90.6735%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4331/4707 (92.0119%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9396, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4008/4362 (91.8845%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3959/4362 (90.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9909, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4414/4989 (88.4746%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4541/4989 (91.0202%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0656, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4655/5083 (91.5798%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4688/5083 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9074, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4181/4647 (89.9720%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4302/4647 (92.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9050, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3931/4368 (89.9954%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3925/4368 (89.8581%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0359, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4255/4354 (97.7262%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4222/4354 (96.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8502, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4767 (89.0078%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4338/4767 (91.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1658, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4275/4662 (91.6988%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4344/4662 (93.1789%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9375, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4623/4804 (96.2323%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4595/4804 (95.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8245, Accuracy: 5965/10000 (59.6500%)
time spent on training: 265.3932807445526
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
 max_rate for 16 = 0.6086956521739131.
Suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Misclassification from 8 to 48 detected but within acceptable limits.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 3.4641, Accuracy: 4146/10000 (41.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 9.3535, Accuracy: 184/9900 (1.8586%)
Done in 294.1401438713074 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 46.54308005258408.
Norm before scaling: 46.52348669707726. Distance: 2.058957265068574
Total norm for 4 adversaries is: 46.52348669707726. distance: 2.058957265068574
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0625, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 46.54308005258408.
Norm before scaling: 46.52467528265243. Distance: 2.2061541139336276
Total norm for 4 adversaries is: 46.52467528265243. distance: 2.2061541139336276
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1207, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4318/4717 (91.5412%), train_poison_data_count: 370
Global model norm: 46.54308005258408.
Norm before scaling: 46.522807116845925. Distance: 1.9795012208029579
Total norm for 4 adversaries is: 46.522807116845925. distance: 1.9795012208029579
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0337, Accuracy: 9815/9900 (99.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4637/5066 (91.5318%), train_poison_data_count: 400
Global model norm: 46.54308005258408.
Norm before scaling: 46.526942169631674. Distance: 2.1077471067607587
Total norm for 4 adversaries is: 46.526942169631674. distance: 2.1077471067607587
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1501, Accuracy: 9510/9900 (96.0606%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3867/4235 (91.3105%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3837/4235 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0548, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3450/3775 (91.3907%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3572/3775 (94.6225%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8272, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4486/4874 (92.0394%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4424/4874 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0758, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4716/5265 (89.5726%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4694/5265 (89.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9400, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4670/5083 (91.8749%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4717/5083 (92.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9493, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4049/4511 (89.7584%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4163/4511 (92.2855%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8783, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4174/4538 (91.9788%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4226/4538 (93.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9666, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4275/4716 (90.6489%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4351/4716 (92.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9806, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4250/4663 (91.1430%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4345/4663 (93.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8324, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4092/4441 (92.1414%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4140/4441 (93.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0721, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4284/4793 (89.3803%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4422/4793 (92.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0569, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4268/4662 (91.5487%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4342/4662 (93.1360%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8532, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3334/3704 (90.0108%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3451/3704 (93.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7671, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4482/4989 (89.8376%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4497/4989 (90.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8384, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3996/4346 (91.9466%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4091/4346 (94.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7502, Accuracy: 6039/10000 (60.3900%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3986/4362 (91.3801%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4060/4362 (93.0766%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9179, Accuracy: 5631/10000 (56.3100%)
time spent on training: 259.6422653198242
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 3.4458, Accuracy: 4154/10000 (41.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 9.1979, Accuracy: 213/9900 (2.1515%)
Done in 288.38719058036804 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 46.57385295739311.
Norm before scaling: 46.55383203715619. Distance: 2.0101685708562
Total norm for 4 adversaries is: 46.55383203715619. distance: 2.0101685708562
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0889, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 46.57385295739311.
Norm before scaling: 46.55443250160907. Distance: 2.1681883554667234
Total norm for 4 adversaries is: 46.55443250160907. distance: 2.1681883554667234
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1616, Accuracy: 9527/9900 (96.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 46.57385295739311.
Norm before scaling: 46.550850577117544. Distance: 1.9669285780328052
Total norm for 4 adversaries is: 46.550850577117544. distance: 1.9669285780328052
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1474, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4654/5066 (91.8674%), train_poison_data_count: 400
Global model norm: 46.57385295739311.
Norm before scaling: 46.55051229914124. Distance: 2.0473858144963493
Total norm for 4 adversaries is: 46.55051229914124. distance: 2.0473858144963493
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2030, Accuracy: 9421/9900 (95.1616%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3586/3969 (90.3502%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3653/3969 (92.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9842, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4157/4558 (91.2023%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4172/4558 (91.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0548, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4427/4918 (90.0163%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4508/4918 (91.6633%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9234, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5570/5902 (94.3748%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5518/5902 (93.4937%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9135, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4863/5265 (92.3647%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4863/5265 (92.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0047, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4089/4511 (90.6451%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4216/4511 (93.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7948, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4215/4625 (91.1351%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4265/4625 (92.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9900, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3949/4416 (89.4248%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4053/4416 (91.7799%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8998, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3028/3297 (91.8411%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3098/3297 (93.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6772, Accuracy: 6162/10000 (61.6200%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4574/5025 (91.0249%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4650/5025 (92.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0205, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4080/4441 (91.8712%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4126/4441 (92.9070%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9039, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4202/4481 (93.7737%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4159/4481 (92.8141%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0066, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3479/3797 (91.6250%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3530/3797 (92.9681%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8083, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3323/3646 (91.1410%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3416/3646 (93.6917%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7482, Accuracy: 6022/10000 (60.2200%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3707/4025 (92.0994%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3783/4025 (93.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8260, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4443/4928 (90.1583%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4479/4928 (90.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0329, Accuracy: 5529/10000 (55.2900%)
time spent on training: 259.0745780467987
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 3.6013, Accuracy: 3963/10000 (39.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 9.3032, Accuracy: 190/9900 (1.9192%)
Done in 287.89048051834106 sec.
Saving all the graphs.
This run has a label: Oct.23_00.44.30. Visdom environment: cifar100_CerP
