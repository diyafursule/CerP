current path: saved_models/model_cifar100_Dec.09_11.41.48_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.44001683902676. Distance: 2.2941397645007857
Total norm for 4 adversaries is: 42.44001683902676. distance: 2.2941397645007857
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4487, Accuracy: 8817/9900 (89.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43522177242626. Distance: 2.2507100574339374
Total norm for 4 adversaries is: 42.43522177242626. distance: 2.2507100574339374
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7149, Accuracy: 8339/9900 (84.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438679337442274. Distance: 2.177387733412166
Total norm for 4 adversaries is: 42.438679337442274. distance: 2.177387733412166
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4290, Accuracy: 8889/9900 (89.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44025557143536. Distance: 2.303558072867811
Total norm for 4 adversaries is: 42.44025557143536. distance: 2.303558072867811
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6042, Accuracy: 8501/9900 (85.8687%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3711/4356 (85.1928%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3498, Accuracy: 4725/10000 (47.2500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3941/4465 (88.2643%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4077/4465 (91.3102%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9982, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4158/4647 (89.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9385, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4446/5055 (87.9525%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4503/5055 (89.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1035, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4438/5116 (86.7475%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4470/5116 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9941, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3627/4126 (87.9060%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3733/4126 (90.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9397, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3080/3472 (88.7097%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0615, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4435/4986 (88.9491%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4454/4986 (89.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1385, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3538/4013 (88.1635%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8400, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4027/4618 (87.2023%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4075/4618 (88.2417%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0379, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4432/5083 (87.1926%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4459/5083 (87.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9883, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3962/4511 (87.8297%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4020/4511 (89.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1168, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3332/3797 (87.7535%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3383/3797 (89.0967%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9857, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4997/5582 (89.5199%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5059/5582 (90.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1031, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3153/3616 (87.1958%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3200/3616 (88.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1052, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4829/5455 (88.5243%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4850/5455 (88.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0097, Accuracy: 5280/10000 (52.8000%)
time spent on training: 257.8046364784241
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1046, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0861, Accuracy: 115/9900 (1.1616%)
Done in 286.64378356933594 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.454715074197.
Norm before scaling: 42.46066222886853. Distance: 2.109784460945992
Total norm for 4 adversaries is: 42.46066222886853. distance: 2.109784460945992
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2520, Accuracy: 9239/9900 (93.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 42.454715074197.
Norm before scaling: 42.458117862912125. Distance: 2.1662211204580446
Total norm for 4 adversaries is: 42.458117862912125. distance: 2.1662211204580446
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5639, Accuracy: 8537/9900 (86.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 42.454715074197.
Norm before scaling: 42.461994725798625. Distance: 2.1658679027765824
Total norm for 4 adversaries is: 42.461994725798625. distance: 2.1658679027765824
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2276, Accuracy: 9355/9900 (94.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.454715074197.
Norm before scaling: 42.4646294105643. Distance: 2.29358785612273
Total norm for 4 adversaries is: 42.4646294105643. distance: 2.29358785612273
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2572, Accuracy: 9199/9900 (92.9192%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3597/4025 (89.3665%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3732/4025 (92.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8792, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3348/3797 (88.1749%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3396/3797 (89.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0226, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3939/4625 (85.1676%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4021/4625 (86.9405%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0971, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3856/4481 (86.0522%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3860/4481 (86.1415%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0979, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3861/4315 (89.4786%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3986/4315 (92.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0237, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3700/4235 (87.3672%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3836/4235 (90.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0046, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3371/3828 (88.0617%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3483/3828 (90.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9170, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3822/4416 (86.5489%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3959/4416 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9375, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9521, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4551/5265 (86.4387%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4513/5265 (85.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9799, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3354/3781 (88.7067%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3318/3781 (87.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1712, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3985/4441 (89.7320%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4061/4441 (91.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1277, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4031/4433 (90.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0111, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4409/5083 (86.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1774, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4325/4928 (87.7638%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4407/4928 (89.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9326, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4177/4793 (87.1479%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0385, Accuracy: 5396/10000 (53.9600%)
time spent on training: 256.6290211677551
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0961, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0690, Accuracy: 227/9900 (2.2929%)
Done in 283.98688292503357 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 42.47721844605721.
Norm before scaling: 42.477724228871566. Distance: 2.0178491903309905
Total norm for 4 adversaries is: 42.477724228871566. distance: 2.0178491903309905
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2326, Accuracy: 9275/9900 (93.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 42.47721844605721.
Norm before scaling: 42.478428291512714. Distance: 2.0954290461432126
Total norm for 4 adversaries is: 42.478428291512714. distance: 2.0954290461432126
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0855, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.47721844605721.
Norm before scaling: 42.478918254750205. Distance: 1.9894129561992853
Total norm for 4 adversaries is: 42.478918254750205. distance: 1.9894129561992853
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2062, Accuracy: 9365/9900 (94.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4516/5066 (89.1433%), train_poison_data_count: 400
Global model norm: 42.47721844605721.
Norm before scaling: 42.48341961733792. Distance: 2.163760498127188
Total norm for 4 adversaries is: 42.48341961733792. distance: 2.163760498127188
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1563, Accuracy: 9500/9900 (95.9596%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3301/3616 (91.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8392, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3408/3837 (88.8194%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9725, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4168/4679 (89.0789%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4264/4679 (91.1306%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0696, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3102/3638 (85.2666%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3251/3638 (89.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0828, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3635/4046 (89.8418%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3643/4046 (90.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0010, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3992/4518 (88.3577%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4103/4518 (90.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0857, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3384/3797 (89.1230%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3431/3797 (90.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1069, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4473/5025 (89.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3039, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3915/4362 (89.7524%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3944/4362 (90.4172%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0660, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3991/4558 (87.5603%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3999/4558 (87.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1251, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3210/3672 (87.4183%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3262/3672 (88.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0716, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4328/4874 (88.7977%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4347/4874 (89.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2374, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3611/4025 (89.7143%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9384, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4088/4663 (87.6689%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4243/4663 (90.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0392, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3461/3911 (88.4940%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3456/3911 (88.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9920, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/5017 (88.5589%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4568/5017 (91.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8615, Accuracy: 5671/10000 (56.7100%)
time spent on training: 254.77545619010925
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0900, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0828, Accuracy: 427/9900 (4.3131%)
Done in 282.0643255710602 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.49768203697262.
Norm before scaling: 42.49967974373822. Distance: 1.9696523626874078
Total norm for 4 adversaries is: 42.49967974373822. distance: 1.9696523626874078
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5248, Accuracy: 8707/9900 (87.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 42.49768203697262.
Norm before scaling: 42.495694290164565. Distance: 2.018796569476039
Total norm for 4 adversaries is: 42.495694290164565. distance: 2.018796569476039
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0761, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.49768203697262.
Norm before scaling: 42.49915124382265. Distance: 1.9556624142514027
Total norm for 4 adversaries is: 42.49915124382265. distance: 1.9556624142514027
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1369, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4539/5066 (89.5973%), train_poison_data_count: 400
Global model norm: 42.49768203697262.
Norm before scaling: 42.503433627381064. Distance: 2.1173272456258574
Total norm for 4 adversaries is: 42.503433627381064. distance: 2.1173272456258574
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3259, Accuracy: 9087/9900 (91.7879%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5263/6124 (85.9406%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5287/6124 (86.3325%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0796, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3879/4356 (89.0496%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3628/4356 (83.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3892, Accuracy: 4907/10000 (49.0700%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3540/4158 (85.1371%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3612/4158 (86.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1337, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4888/5455 (89.6059%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4875/5455 (89.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9962, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3935/4511 (87.2312%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4068/4511 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0125, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4536/5232 (86.6972%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4550/5232 (86.9648%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1145, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4498/5244 (85.7742%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4545/5244 (86.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0245, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4391/4918 (89.2843%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4384/4918 (89.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0810, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3624/4126 (87.8333%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3728/4126 (90.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8648, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4368/4928 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1742, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3742/4223 (88.6100%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3833/4223 (90.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8996, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4528/5195 (87.1607%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4583/5195 (88.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2075, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0236, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3210/3646 (88.0417%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3279/3646 (89.9342%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8960, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3194/3616 (88.3296%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3206/3616 (88.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9328, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4072/4716 (86.3444%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4076/4716 (86.4292%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9470, Accuracy: 5482/10000 (54.8200%)
time spent on training: 262.6460220813751
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0876, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4085, Accuracy: 699/9900 (7.0606%)
Done in 289.8325185775757 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 42.522737770974516.
Norm before scaling: 42.52545337289554. Distance: 1.9561203837491685
Total norm for 4 adversaries is: 42.52545337289554. distance: 1.9561203837491685
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1748, Accuracy: 9478/9900 (95.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4868/5305 (91.7625%), train_poison_data_count: 415
Global model norm: 42.522737770974516.
Norm before scaling: 42.51754721628545. Distance: 1.9814540360861748
Total norm for 4 adversaries is: 42.51754721628545. distance: 1.9814540360861748
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1451, Accuracy: 9530/9900 (96.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 42.522737770974516.
Norm before scaling: 42.52345113563074. Distance: 1.919010229201732
Total norm for 4 adversaries is: 42.52345113563074. distance: 1.919010229201732
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2027, Accuracy: 9371/9900 (94.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 42.522737770974516.
Norm before scaling: 42.53005457311556. Distance: 2.0806274261872986
Total norm for 4 adversaries is: 42.53005457311556. distance: 2.0806274261872986
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2677, Accuracy: 9232/9900 (93.2525%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5277/6124 (86.1692%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5327/6124 (86.9856%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9954, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3972/4433 (89.6007%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4044/4433 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9888, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3374/3781 (89.2357%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3226/3781 (85.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3648, Accuracy: 4837/10000 (48.3700%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3568/3969 (89.8967%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3576/3969 (90.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9392, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4516/5025 (89.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2609, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4175/4679 (89.2285%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4229/4679 (90.3826%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9671, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4165/4707 (88.4852%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4215/4707 (89.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0427, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4441/4986 (89.0694%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4434/4986 (88.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8918, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3900/4315 (90.3824%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3959/4315 (91.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8527, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3856/4416 (87.3188%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3939/4416 (89.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9909, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4244/4804 (88.3430%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4060/4804 (84.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0782, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4168/4793 (86.9602%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4277/4793 (89.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0959, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4539/5232 (86.7546%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4549/5232 (86.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9976, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4111/4662 (88.1810%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4232/4662 (90.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0650, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4244/4956 (85.6336%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4320/4956 (87.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2539, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3836/4368 (87.8205%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3837/4368 (87.8434%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9902, Accuracy: 5427/10000 (54.2700%)
time spent on training: 261.94051933288574
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0869, Accuracy: 7073/10000 (70.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7294, Accuracy: 1069/9900 (10.7980%)
Done in 288.9740834236145 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 42.54705718607707.
Norm before scaling: 42.54735269884235. Distance: 1.922633509867648
Total norm for 4 adversaries is: 42.54735269884235. distance: 1.922633509867648
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2792, Accuracy: 9205/9900 (92.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4858/5305 (91.5740%), train_poison_data_count: 415
Global model norm: 42.54705718607707.
Norm before scaling: 42.54393122390519. Distance: 1.952475905324676
Total norm for 4 adversaries is: 42.54393122390519. distance: 1.952475905324676
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2198, Accuracy: 9353/9900 (94.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4318/4717 (91.5412%), train_poison_data_count: 370
Global model norm: 42.54705718607707.
Norm before scaling: 42.547067227806664. Distance: 1.8675442279036578
Total norm for 4 adversaries is: 42.547067227806664. distance: 1.8675442279036578
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2407, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 42.54705718607707.
Norm before scaling: 42.551790881542956. Distance: 2.020152839317278
Total norm for 4 adversaries is: 42.551790881542956. distance: 2.020152839317278
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1117, Accuracy: 9607/9900 (97.0404%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5347/6124 (87.3122%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5345/6124 (87.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0916, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5158/5902 (87.3941%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5115/5902 (86.6655%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1269, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4185/4707 (88.9101%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4206/4707 (89.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9200, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4095/4647 (88.1214%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4177/4647 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9042, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2984/3297 (90.5065%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3016/3297 (91.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8615, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5553/6263 (88.6636%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5648/6263 (90.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1063, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4187/4663 (89.7920%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4253/4663 (91.2074%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1407, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4344/4956 (87.6513%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4347/4956 (87.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3298, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3616/4046 (89.3722%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3705/4046 (91.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9031, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3710/4184 (88.6711%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3778/4184 (90.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8445, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4886/5591 (87.3904%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4893/5591 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2194, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4113/4634 (88.7570%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4162/4634 (89.8144%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9772, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3409/3828 (89.0543%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3496/3828 (91.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9506, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3265/3638 (89.7471%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9392, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3396/3781 (89.8175%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3390/3781 (89.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1573, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3418/3837 (89.0800%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3544/3837 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8616, Accuracy: 5718/10000 (57.1800%)
time spent on training: 258.8054735660553
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0847, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.1818, Accuracy: 1413/9900 (14.2727%)
Done in 286.0108587741852 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4482/4885 (91.7503%), train_poison_data_count: 385
Global model norm: 42.57051824252907.
Norm before scaling: 42.568634263350226. Distance: 1.8512839578608833
Total norm for 4 adversaries is: 42.568634263350226. distance: 1.8512839578608833
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2811, Accuracy: 9219/9900 (93.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 42.57051824252907.
Norm before scaling: 42.56794746481427. Distance: 1.938455407630159
Total norm for 4 adversaries is: 42.56794746481427. distance: 1.938455407630159
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1517, Accuracy: 9537/9900 (96.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 42.57051824252907.
Norm before scaling: 42.57235052586215. Distance: 1.8827369643132261
Total norm for 4 adversaries is: 42.57235052586215. distance: 1.8827369643132261
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1445, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4619/5066 (91.1765%), train_poison_data_count: 400
Global model norm: 42.57051824252907.
Norm before scaling: 42.572247300728385. Distance: 1.950339260910972
Total norm for 4 adversaries is: 42.572247300728385. distance: 1.950339260910972
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2585, Accuracy: 9289/9900 (93.8283%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3932/4501 (87.3584%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3945/4501 (87.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0877, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3749/4175 (89.7964%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0004, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3166/3616 (87.5553%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3229/3616 (89.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9291, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4080/4634 (88.0449%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4107/4634 (88.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9078, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4041/4558 (88.6573%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3979/4558 (87.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0841, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4564/5167 (88.3298%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4607/5167 (89.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0926, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3888/4356 (89.2562%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3837/4356 (88.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2836, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4155/4716 (88.1043%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4163/4716 (88.2740%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0516, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5393/6124 (88.0634%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5339/6124 (87.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1194, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4471/5055 (88.4471%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4564/5055 (90.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0444, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4521/5025 (89.9701%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4573/5025 (91.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0794, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4392/4918 (89.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1831, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3761/4223 (89.0599%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3812/4223 (90.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9002, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3927/4481 (87.6367%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3861/4481 (86.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9938, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3301/3638 (90.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9162, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4013 (89.2350%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9134, Accuracy: 5564/10000 (55.6400%)
time spent on training: 263.19399189949036
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0857, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6520, Accuracy: 1925/9900 (19.4444%)
Done in 290.3879098892212 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4512/4885 (92.3644%), train_poison_data_count: 385
Global model norm: 42.593830245705774.
Norm before scaling: 42.591554648119505. Distance: 1.8345559623918097
Total norm for 4 adversaries is: 42.591554648119505. distance: 1.8345559623918097
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2386, Accuracy: 9295/9900 (93.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 42.593830245705774.
Norm before scaling: 42.5906704568141. Distance: 1.920537033176875
Total norm for 4 adversaries is: 42.5906704568141. distance: 1.920537033176875
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2357, Accuracy: 9336/9900 (94.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4334/4717 (91.8804%), train_poison_data_count: 370
Global model norm: 42.593830245705774.
Norm before scaling: 42.5927297199886. Distance: 1.782942921099804
Total norm for 4 adversaries is: 42.5927297199886. distance: 1.782942921099804
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4365, Accuracy: 8845/9900 (89.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 42.593830245705774.
Norm before scaling: 42.59510126020582. Distance: 1.9546662010050935
Total norm for 4 adversaries is: 42.59510126020582. distance: 1.9546662010050935
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1410, Accuracy: 9535/9900 (96.3131%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3211/3646 (88.0691%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3314/3646 (90.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7888, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3957/4501 (87.9138%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4004/4501 (88.9580%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0070, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4114/4651 (88.4541%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4184/4651 (89.9591%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0073, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4595/5167 (88.9297%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4667/5167 (90.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1646, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4907/5455 (89.9542%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4921/5455 (90.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0069, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4921/5591 (88.0165%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4869/5591 (87.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0507, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4228/4679 (90.3612%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4138/4679 (88.4377%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0817, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4486/5017 (89.4160%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4515/5017 (89.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9383, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4266/4793 (89.0048%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4313/4793 (89.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0787, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4041/4456 (90.6867%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4082/4456 (91.6068%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9638, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4830/5424 (89.0487%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4929/5424 (90.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1706, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3695/4175 (88.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9618, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4565/5116 (89.2299%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4566/5116 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0259, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3355/3704 (90.5778%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9242, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4529/5232 (86.5635%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4637/5232 (88.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1848, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3109/3472 (89.5449%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3171/3472 (91.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0467, Accuracy: 5528/10000 (55.2800%)
time spent on training: 263.0978672504425
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0888, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1733, Accuracy: 2492/9900 (25.1717%)
Done in 290.3420934677124 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 42.61742595602399.
Norm before scaling: 42.61522036592017. Distance: 1.8027786133732726
Total norm for 4 adversaries is: 42.61522036592017. distance: 1.8027786133732726
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1996, Accuracy: 9410/9900 (95.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4888/5305 (92.1395%), train_poison_data_count: 415
Global model norm: 42.61742595602399.
Norm before scaling: 42.61135314669305. Distance: 1.8781032313451547
Total norm for 4 adversaries is: 42.61135314669305. distance: 1.8781032313451547
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2071, Accuracy: 9418/9900 (95.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 42.61742595602399.
Norm before scaling: 42.61446700184765. Distance: 1.7873683053967817
Total norm for 4 adversaries is: 42.61446700184765. distance: 1.7873683053967817
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1472, Accuracy: 9535/9900 (96.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4637/5066 (91.5318%), train_poison_data_count: 400
Global model norm: 42.61742595602399.
Norm before scaling: 42.618694834709125. Distance: 1.9199584460728847
Total norm for 4 adversaries is: 42.618694834709125. distance: 1.9199584460728847
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3545, Accuracy: 9025/9900 (91.1616%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3244/3590 (90.3621%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3339/3590 (93.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9631, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3872/4368 (88.6447%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3862/4368 (88.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8313, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3306/3704 (89.2549%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3391/3704 (91.5497%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9602, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4367/4928 (88.6161%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4385/4928 (88.9813%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1011, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3914/4356 (89.8531%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3838/4356 (88.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2056, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3492/3911 (89.2866%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3357/3911 (85.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2260, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4151/4651 (89.2496%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4199/4651 (90.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1431, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3750/4184 (89.6272%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3764/4184 (89.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0373, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3934/4346 (90.5200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3995/4346 (91.9236%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9044, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4246/4793 (88.5875%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4356/4793 (90.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0261, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3430/3804 (90.1682%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3476/3804 (91.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9442, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4510/4986 (90.4533%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4519/4986 (90.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8279, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5383/6124 (87.9001%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5294/6124 (86.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3394, Accuracy: 4809/10000 (48.0900%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4188/4707 (88.9739%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4243/4707 (90.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9451, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3833/4235 (90.5077%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3670/4235 (86.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1551, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3659/4046 (90.4350%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0084, Accuracy: 5382/10000 (53.8200%)
time spent on training: 257.1698226928711
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0923, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7148, Accuracy: 3058/9900 (30.8889%)
Done in 284.624219417572 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4554/4885 (93.2242%), train_poison_data_count: 385
Global model norm: 42.639744689062546.
Norm before scaling: 42.634058730869. Distance: 1.7731439960956055
Total norm for 4 adversaries is: 42.634058730869. distance: 1.7731439960956055
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0610, Accuracy: 9739/9900 (98.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4907/5305 (92.4976%), train_poison_data_count: 415
Global model norm: 42.639744689062546.
Norm before scaling: 42.6354416394279. Distance: 1.843796099070312
Total norm for 4 adversaries is: 42.6354416394279. distance: 1.843796099070312
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1062, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 42.639744689062546.
Norm before scaling: 42.63675006440673. Distance: 1.7488049104916525
Total norm for 4 adversaries is: 42.63675006440673. distance: 1.7488049104916525
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3372, Accuracy: 9124/9900 (92.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 42.639744689062546.
Norm before scaling: 42.641324941580294. Distance: 1.9422006497662998
Total norm for 4 adversaries is: 42.641324941580294. distance: 1.9422006497662998
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1796, Accuracy: 9447/9900 (95.4242%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4464/4986 (89.5307%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4488/4986 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9704, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4072/4634 (87.8722%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4120/4634 (88.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9012, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4164/4716 (88.2952%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4231/4716 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1105, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5363/6124 (87.5735%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5423/6124 (88.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0254, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4406/4918 (89.5893%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0399, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3408/3797 (89.7551%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3415/3797 (89.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1454, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5003/5582 (89.6274%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5033/5582 (90.1648%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1403, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4956 (87.8733%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4322/4956 (87.2074%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1055, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4024/4433 (90.7737%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4032/4433 (90.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8529, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3886/4354 (89.2513%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0116, Accuracy: 3405/4354 (78.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3926, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4357/4928 (88.4131%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4396/4928 (89.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9283, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3475/3911 (88.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9988, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3863/4481 (86.2084%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3827/4481 (85.4050%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2098, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4602/5197 (88.5511%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4634/5197 (89.1668%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9450, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4855/5455 (89.0009%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4902/5455 (89.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0183, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3831/4361 (87.8468%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3764/4361 (86.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1581, Accuracy: 5129/10000 (51.2900%)
time spent on training: 263.7577624320984
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0978, Accuracy: 7040/10000 (70.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3257, Accuracy: 3578/9900 (36.1414%)
Done in 290.7987916469574 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4537/4885 (92.8762%), train_poison_data_count: 385
Global model norm: 42.6653349986482.
Norm before scaling: 42.66485575965525. Distance: 1.7725032412522224
Total norm for 4 adversaries is: 42.66485575965525. distance: 1.7725032412522224
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1586, Accuracy: 9516/9900 (96.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4915/5305 (92.6484%), train_poison_data_count: 415
Global model norm: 42.6653349986482.
Norm before scaling: 42.658473499741234. Distance: 1.8298173553749488
Total norm for 4 adversaries is: 42.658473499741234. distance: 1.8298173553749488
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1441, Accuracy: 9516/9900 (96.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4366/4717 (92.5588%), train_poison_data_count: 370
Global model norm: 42.6653349986482.
Norm before scaling: 42.65924611730586. Distance: 1.7076703234907724
Total norm for 4 adversaries is: 42.65924611730586. distance: 1.7076703234907724
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0662, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4629/5066 (91.3739%), train_poison_data_count: 400
Global model norm: 42.6653349986482.
Norm before scaling: 42.66802292893429. Distance: 1.910138713233501
Total norm for 4 adversaries is: 42.66802292893429. distance: 1.910138713233501
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1696, Accuracy: 9475/9900 (95.7071%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4346/4928 (88.1899%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4352/4928 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0041, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3787/4184 (90.5115%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3820/4184 (91.3002%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8709, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4273/4707 (90.7797%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4230/4707 (89.8662%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0613, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3450/3828 (90.1254%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9023, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4020/4503 (89.2738%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4032/4503 (89.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9246, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4216/4662 (90.4333%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4234/4662 (90.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9211, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3787/4235 (89.4215%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3827/4235 (90.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0516, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5244 (84.9733%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4485/5244 (85.5263%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1562, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4253/4793 (88.7336%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0079, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3990/4481 (89.0426%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3879/4481 (86.5655%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2321, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3967/4346 (91.2793%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4036/4346 (92.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7402, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3843/4361 (88.1220%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3671/4361 (84.1779%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1954, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4580/5055 (90.6034%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4563/5055 (90.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9749, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4592/5195 (88.3927%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4548/5195 (87.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1744, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3941/4315 (91.3326%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3990/4315 (92.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8836, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4224/4663 (90.5855%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4286/4663 (91.9151%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1070, Accuracy: 5334/10000 (53.3400%)
time spent on training: 259.9746868610382
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1033, Accuracy: 7035/10000 (70.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9173, Accuracy: 4158/9900 (42.0000%)
Done in 287.40254044532776 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4543/4885 (92.9990%), train_poison_data_count: 385
Global model norm: 42.688816837759894.
Norm before scaling: 42.685132163465305. Distance: 1.6992944459387882
Total norm for 4 adversaries is: 42.685132163465305. distance: 1.6992944459387882
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1746, Accuracy: 9486/9900 (95.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4924/5305 (92.8181%), train_poison_data_count: 415
Global model norm: 42.688816837759894.
Norm before scaling: 42.683949625872984. Distance: 1.8134396846639098
Total norm for 4 adversaries is: 42.683949625872984. distance: 1.8134396846639098
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2241, Accuracy: 9345/9900 (94.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.688816837759894.
Norm before scaling: 42.6830315994944. Distance: 1.6700566466083895
Total norm for 4 adversaries is: 42.6830315994944. distance: 1.6700566466083895
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1768, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4675/5066 (92.2819%), train_poison_data_count: 400
Global model norm: 42.688816837759894.
Norm before scaling: 42.6887138942521. Distance: 1.8399047841438905
Total norm for 4 adversaries is: 42.6887138942521. distance: 1.8399047841438905
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1399, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3980/4315 (92.2364%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3960/4315 (91.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8740, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3278/3590 (91.3092%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3219/3590 (89.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1116, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4219/4679 (90.1688%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4269/4679 (91.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9798, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4630/5167 (89.6071%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4661/5167 (90.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0363, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3394/3775 (89.9073%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8543, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3455/3828 (90.2560%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9267, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3813/4235 (90.0354%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3865/4235 (91.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0037, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4166/4647 (89.6492%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4222/4647 (90.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9614, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4423/4918 (89.9349%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4470/4918 (90.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0722, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3999/4433 (90.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9764, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3995/4481 (89.1542%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0774, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3833/4295 (89.2433%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3699/4295 (86.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1212, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4018/4503 (89.2294%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4033/4503 (89.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9369, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3866/4354 (88.7919%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3559/4354 (81.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4414, Accuracy: 4729/10000 (47.2900%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4493/4986 (90.1123%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4445/4986 (89.1496%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0026, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5593/6263 (89.3023%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5685/6263 (90.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1173, Accuracy: 5247/10000 (52.4700%)
time spent on training: 257.96940517425537
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1154, Accuracy: 7000/10000 (70.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6062, Accuracy: 4694/9900 (47.4141%)
Done in 285.3215026855469 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4536/4885 (92.8557%), train_poison_data_count: 385
Global model norm: 42.71179848112448.
Norm before scaling: 42.70693103007769. Distance: 1.7318872704238157
Total norm for 4 adversaries is: 42.70693103007769. distance: 1.7318872704238157
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1614, Accuracy: 9506/9900 (96.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4905/5305 (92.4599%), train_poison_data_count: 415
Global model norm: 42.71179848112448.
Norm before scaling: 42.707399792896695. Distance: 1.86809514542249
Total norm for 4 adversaries is: 42.707399792896695. distance: 1.86809514542249
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0841, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.71179848112448.
Norm before scaling: 42.70418266161846. Distance: 1.6534571582560682
Total norm for 4 adversaries is: 42.70418266161846. distance: 1.6534571582560682
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1679, Accuracy: 9500/9900 (95.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4680/5066 (92.3806%), train_poison_data_count: 400
Global model norm: 42.71179848112448.
Norm before scaling: 42.710140809059475. Distance: 1.8258319395551261
Total norm for 4 adversaries is: 42.710140809059475. distance: 1.8258319395551261
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0623, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3770/4223 (89.2730%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3826/4223 (90.5991%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0088, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4955/5455 (90.8341%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4902/5455 (89.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0933, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5113/5582 (91.5980%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5098/5582 (91.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1928, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4031/4465 (90.2800%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4075/4465 (91.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8200, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4964/5591 (88.7855%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4970/5591 (88.8929%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1948, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3540/3911 (90.5139%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3383/3911 (86.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0231, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3919/4356 (89.9679%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0142, Accuracy: 3306/4356 (75.8953%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6801, Accuracy: 4456/10000 (44.5600%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4462/5037 (88.5845%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4520/5037 (89.7360%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0012, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4250/4679 (90.8314%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4267/4679 (91.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1574, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3997/4362 (91.6323%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3929/4362 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0766, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4129/4518 (91.3900%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4195/4518 (92.8508%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8911, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4508/5083 (88.6878%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4468/5083 (87.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1656, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3731/4013 (92.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7897, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4631/5197 (89.1091%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4662/5197 (89.7056%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0694, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2977/3297 (90.2942%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3056/3297 (92.6903%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7678, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4032/4441 (90.7904%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4036/4441 (90.8804%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0494, Accuracy: 5429/10000 (54.2900%)
time spent on training: 261.2151982784271
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1154, Accuracy: 7001/10000 (70.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3597, Accuracy: 5069/9900 (51.2020%)
Done in 288.47613763809204 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4540/4885 (92.9376%), train_poison_data_count: 385
Global model norm: 42.73465350686212.
Norm before scaling: 42.72960296710657. Distance: 1.7222766414713087
Total norm for 4 adversaries is: 42.72960296710657. distance: 1.7222766414713087
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0890, Accuracy: 9690/9900 (97.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4924/5305 (92.8181%), train_poison_data_count: 415
Global model norm: 42.73465350686212.
Norm before scaling: 42.72656178574693. Distance: 1.7441463662594476
Total norm for 4 adversaries is: 42.72656178574693. distance: 1.7441463662594476
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3056, Accuracy: 9209/9900 (93.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4397/4717 (93.2160%), train_poison_data_count: 370
Global model norm: 42.73465350686212.
Norm before scaling: 42.72778028411741. Distance: 1.6544510770627348
Total norm for 4 adversaries is: 42.72778028411741. distance: 1.6544510770627348
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2959, Accuracy: 9147/9900 (92.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4681/5066 (92.4003%), train_poison_data_count: 400
Global model norm: 42.73465350686212.
Norm before scaling: 42.73337236026722. Distance: 1.8298377466449398
Total norm for 4 adversaries is: 42.73337236026722. distance: 1.8298377466449398
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1778, Accuracy: 9452/9900 (95.4747%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4038/4501 (89.7134%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4009/4501 (89.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9767, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4027/4511 (89.2707%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4088/4511 (90.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9828, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3911/4354 (89.8254%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3467/4354 (79.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5828, Accuracy: 4544/10000 (45.4400%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3979/4346 (91.5555%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4026/4346 (92.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8601, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4241/4707 (90.0999%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4252/4707 (90.3335%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9886, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4944/5591 (88.4278%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4888/5591 (87.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1036, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4139/4647 (89.0682%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4193/4647 (90.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8460, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4117/4538 (90.7228%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4185/4538 (92.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9001, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4384/4934 (88.8529%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4367/4934 (88.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1823, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4330/4804 (90.1332%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4270/4804 (88.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1415, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5688/6263 (90.8191%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5675/6263 (90.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1686, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3964/4481 (88.4624%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3916/4481 (87.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0425, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4444/5063 (87.7740%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4426/5063 (87.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0303, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3744/4223 (88.6574%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3855/4223 (91.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9303, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4069/4441 (91.6235%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4102/4441 (92.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0348, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3410/3756 (90.7881%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3471/3756 (92.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8681, Accuracy: 5696/10000 (56.9600%)
time spent on training: 263.81558322906494
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1196, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1592, Accuracy: 5381/9900 (54.3535%)
Done in 291.2508249282837 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4582/4885 (93.7973%), train_poison_data_count: 385
Global model norm: 42.758191489504384.
Norm before scaling: 42.750902311384024. Distance: 1.668299264791814
Total norm for 4 adversaries is: 42.750902311384024. distance: 1.668299264791814
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1294, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4933/5305 (92.9877%), train_poison_data_count: 415
Global model norm: 42.758191489504384.
Norm before scaling: 42.75493392580557. Distance: 1.846787165636393
Total norm for 4 adversaries is: 42.75493392580557. distance: 1.846787165636393
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0602, Accuracy: 9742/9900 (98.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4389/4717 (93.0464%), train_poison_data_count: 370
Global model norm: 42.758191489504384.
Norm before scaling: 42.751813169699304. Distance: 1.622290773699694
Total norm for 4 adversaries is: 42.751813169699304. distance: 1.622290773699694
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2018, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4713/5066 (93.0320%), train_poison_data_count: 400
Global model norm: 42.758191489504384.
Norm before scaling: 42.75263406769883. Distance: 1.7610335614083958
Total norm for 4 adversaries is: 42.75263406769883. distance: 1.7610335614083958
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2047, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4489/5244 (85.6026%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4560/5244 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0236, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4430/4928 (89.8945%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4436/4928 (90.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9048, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3424/3804 (90.0105%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8773, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3653/4013 (91.0292%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9110, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3644/4158 (87.6383%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3629/4158 (87.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0214, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5113/5582 (91.5980%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5075/5582 (90.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0228, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4906/5455 (89.9358%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4946/5455 (90.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0094, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3911/4354 (89.8254%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3544/4354 (81.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5237, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4035/4433 (91.0219%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4045/4433 (91.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9889, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3242/3646 (88.9194%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3337/3646 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8314, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4518 (90.5710%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4100/4518 (90.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9873, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3865/4235 (91.2633%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3778/4235 (89.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2991, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4007/4362 (91.8615%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3907/4362 (89.5690%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0735, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4868/5392 (90.2819%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4750/5392 (88.0935%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1123, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4931/5591 (88.1953%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4914/5591 (87.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1810, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3488/3756 (92.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9612, Accuracy: 5655/10000 (56.5500%)
time spent on training: 259.51702308654785
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1244, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9529, Accuracy: 5787/9900 (58.4545%)
Done in 286.8465714454651 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4561/4885 (93.3675%), train_poison_data_count: 385
Global model norm: 42.781446881395034.
Norm before scaling: 42.77326698025371. Distance: 1.6760315608100644
Total norm for 4 adversaries is: 42.77326698025371. distance: 1.6760315608100644
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0886, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4940/5305 (93.1197%), train_poison_data_count: 415
Global model norm: 42.781446881395034.
Norm before scaling: 42.772788950562656. Distance: 1.7771346755249031
Total norm for 4 adversaries is: 42.772788950562656. distance: 1.7771346755249031
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0201, Accuracy: 9846/9900 (99.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4396/4717 (93.1948%), train_poison_data_count: 370
Global model norm: 42.781446881395034.
Norm before scaling: 42.774021828200524. Distance: 1.6376508366659364
Total norm for 4 adversaries is: 42.774021828200524. distance: 1.6376508366659364
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1137, Accuracy: 9622/9900 (97.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4689/5066 (92.5582%), train_poison_data_count: 400
Global model norm: 42.781446881395034.
Norm before scaling: 42.77659306282467. Distance: 1.7989319679199844
Total norm for 4 adversaries is: 42.77659306282467. distance: 1.7989319679199844
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1343, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4223/4634 (91.1308%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4157/4634 (89.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1159, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4081/4503 (90.6285%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4052/4503 (89.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0244, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4390/4928 (89.0828%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4487/4928 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8130, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3421/3804 (89.9317%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3457/3804 (90.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9580, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3284/3590 (91.4763%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3080/3590 (85.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3606, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4176/4647 (89.8644%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9160, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4037/4625 (87.2865%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4064/4625 (87.8703%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0265, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3953/4356 (90.7484%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3867/4356 (88.7741%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1285, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3461/3797 (91.1509%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3497/3797 (92.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9714, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4068/4456 (91.2926%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4079/4456 (91.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9209, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3636/4025 (90.3354%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3734/4025 (92.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8680, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3171/3472 (91.3306%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3160/3472 (91.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9709, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2950/3297 (89.4753%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3006/3297 (91.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8485, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3917/4416 (88.7002%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4001/4416 (90.6024%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0669, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3961/4356 (90.9320%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4041/4356 (92.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0572, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3235/3638 (88.9225%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3333/3638 (91.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8466, Accuracy: 5624/10000 (56.2400%)
time spent on training: 253.89998531341553
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1289, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7590, Accuracy: 6132/9900 (61.9394%)
Done in 280.8684079647064 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4560/4885 (93.3470%), train_poison_data_count: 385
Global model norm: 42.801579640552546.
Norm before scaling: 42.79558002787058. Distance: 1.6930826878462024
Total norm for 4 adversaries is: 42.79558002787058. distance: 1.6930826878462024
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1596, Accuracy: 9519/9900 (96.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4949/5305 (93.2893%), train_poison_data_count: 415
Global model norm: 42.801579640552546.
Norm before scaling: 42.791288369848864. Distance: 1.7369784498618352
Total norm for 4 adversaries is: 42.791288369848864. distance: 1.7369784498618352
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1045, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.801579640552546.
Norm before scaling: 42.79251928820328. Distance: 1.6214092636999418
Total norm for 4 adversaries is: 42.79251928820328. distance: 1.6214092636999418
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1150, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4727/5066 (93.3083%), train_poison_data_count: 400
Global model norm: 42.801579640552546.
Norm before scaling: 42.794550297394764. Distance: 1.7520449134826634
Total norm for 4 adversaries is: 42.794550297394764. distance: 1.7520449134826634
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0898, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3745/4175 (89.7006%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3719/4175 (89.0778%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9563, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4352/4956 (87.8128%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4453/4956 (89.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1180, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4462/5037 (88.5845%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4585/5037 (91.0264%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9474, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4304/4793 (89.7976%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4332/4793 (90.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1141, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3421/3804 (89.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0711, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4874/5392 (90.3932%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4887/5392 (90.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0586, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4082/4465 (91.4222%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4105/4465 (91.9373%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9237, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4184/4596 (91.0357%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4226/4596 (91.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9358, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5401/6124 (88.1940%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5387/6124 (87.9654%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9761, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2925/3271 (89.4222%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2983/3271 (91.1954%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8959, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3259/3590 (90.7799%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3273/3590 (91.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1003, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3964/4501 (88.0693%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0852, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4669/5232 (89.2393%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4619/5232 (88.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1226, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3278/3672 (89.2702%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3293/3672 (89.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9476, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3823/4223 (90.5281%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3868/4223 (91.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1537, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3931/4354 (90.2848%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0165, Accuracy: 3070/4354 (70.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.8295, Accuracy: 4061/10000 (40.6100%)
time spent on training: 259.7725296020508
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1366, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5673, Accuracy: 6497/9900 (65.6263%)
Done in 286.85639572143555 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4629/4885 (94.7595%), train_poison_data_count: 385
Global model norm: 42.82443093335421.
Norm before scaling: 42.81140081846263. Distance: 1.568439106321909
Total norm for 4 adversaries is: 42.81140081846263. distance: 1.568439106321909
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2612, Accuracy: 9274/9900 (93.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4974/5305 (93.7606%), train_poison_data_count: 415
Global model norm: 42.82443093335421.
Norm before scaling: 42.811383710355734. Distance: 1.6967169222605396
Total norm for 4 adversaries is: 42.811383710355734. distance: 1.6967169222605396
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0587, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4407/4717 (93.4280%), train_poison_data_count: 370
Global model norm: 42.82443093335421.
Norm before scaling: 42.81640036977653. Distance: 1.6425858904533668
Total norm for 4 adversaries is: 42.81640036977653. distance: 1.6425858904533668
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0722, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4732/5066 (93.4070%), train_poison_data_count: 400
Global model norm: 42.82443093335421.
Norm before scaling: 42.816302009555166. Distance: 1.682881711423823
Total norm for 4 adversaries is: 42.816302009555166. distance: 1.682881711423823
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1840, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5097/5582 (91.3114%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5057/5582 (90.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0759, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4163/4647 (89.5847%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4189/4647 (90.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0073, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4035/4465 (90.3695%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4148/4465 (92.9003%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8478, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4558/5083 (89.6715%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4467/5083 (87.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2045, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3874/4416 (87.7264%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3938/4416 (89.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9580, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4421/4956 (89.2050%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4392/4956 (88.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0742, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4033/4362 (92.4576%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3870/4362 (88.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0291, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3950/4356 (90.6795%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3808/4356 (87.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2233, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3417/3781 (90.3729%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3463/3781 (91.5895%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0263, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3287/3590 (91.5599%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3302/3590 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0121, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4211/4651 (90.5397%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4268/4651 (91.7652%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9946, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4216/4662 (90.4333%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4239/4662 (90.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9121, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3163/3472 (91.1002%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3233/3472 (93.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8329, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4906/5424 (90.4499%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4969/5424 (91.6114%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1132, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2970/3271 (90.7979%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2916/3271 (89.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9882, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4498/5037 (89.2992%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4530/5037 (89.9345%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9799, Accuracy: 5578/10000 (55.7800%)
time spent on training: 259.6847267150879
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1395, Accuracy: 6963/10000 (69.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4845, Accuracy: 6667/9900 (67.3434%)
Done in 286.9162859916687 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.846280012826085.
Norm before scaling: 42.838169482932365. Distance: 1.5987431715878353
Total norm for 4 adversaries is: 42.838169482932365. distance: 1.5987431715878353
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1607, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4965/5305 (93.5910%), train_poison_data_count: 415
Global model norm: 42.846280012826085.
Norm before scaling: 42.83669480568033. Distance: 1.7282616725082138
Total norm for 4 adversaries is: 42.83669480568033. distance: 1.7282616725082138
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1000, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4430/4717 (93.9156%), train_poison_data_count: 370
Global model norm: 42.846280012826085.
Norm before scaling: 42.83431099296669. Distance: 1.5763415844392736
Total norm for 4 adversaries is: 42.83431099296669. distance: 1.5763415844392736
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2065, Accuracy: 9397/9900 (94.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4695/5066 (92.6767%), train_poison_data_count: 400
Global model norm: 42.846280012826085.
Norm before scaling: 42.84123693395477. Distance: 1.7646854567748154
Total norm for 4 adversaries is: 42.84123693395477. distance: 1.7646854567748154
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2856, Accuracy: 9196/9900 (92.8889%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4390/4989 (87.9936%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4465/4989 (89.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0668, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3656/4013 (91.1039%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8153, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4613/5195 (88.7969%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4460/5195 (85.8518%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1057, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3607/3969 (90.8793%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3581/3969 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9109, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3974/4356 (91.2305%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3825/4356 (87.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1645, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4057/4441 (91.3533%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4075/4441 (91.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0229, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4105/4518 (90.8588%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4151/4518 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0605, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3537/3911 (90.4372%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3288/3911 (84.0706%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0744, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4015/4362 (92.0449%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3946/4362 (90.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0436, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3465/3804 (91.0883%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0047, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3811/4223 (90.2439%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3891/4223 (92.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0028, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4210/4634 (90.8502%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4208/4634 (90.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8644, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3944/4354 (90.5834%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0159, Accuracy: 3126/4354 (71.7960%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.8291, Accuracy: 4159/10000 (41.5900%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4524/5244 (86.2700%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4525/5244 (86.2891%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0043, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4485/5037 (89.0411%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4604/5037 (91.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0502, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3330/3704 (89.9028%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3367/3704 (90.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8619, Accuracy: 5687/10000 (56.8700%)
time spent on training: 259.412593126297
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1365, Accuracy: 6992/10000 (69.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.4200, Accuracy: 6787/9900 (68.5556%)
Done in 286.622642993927 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4612/4885 (94.4115%), train_poison_data_count: 385
Global model norm: 42.868969373618604.
Norm before scaling: 42.85809473343032. Distance: 1.5841004203310833
Total norm for 4 adversaries is: 42.85809473343032. distance: 1.5841004203310833
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1429, Accuracy: 9535/9900 (96.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4972/5305 (93.7229%), train_poison_data_count: 415
Global model norm: 42.868969373618604.
Norm before scaling: 42.85703374939609. Distance: 1.6954302768843799
Total norm for 4 adversaries is: 42.85703374939609. distance: 1.6954302768843799
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0717, Accuracy: 9709/9900 (98.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4419/4717 (93.6824%), train_poison_data_count: 370
Global model norm: 42.868969373618604.
Norm before scaling: 42.857103533045574. Distance: 1.5457722750358578
Total norm for 4 adversaries is: 42.857103533045574. distance: 1.5457722750358578
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1006, Accuracy: 9641/9900 (97.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4738/5066 (93.5255%), train_poison_data_count: 400
Global model norm: 42.868969373618604.
Norm before scaling: 42.85969968889044. Distance: 1.6537084692759423
Total norm for 4 adversaries is: 42.85969968889044. distance: 1.6537084692759423
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2037, Accuracy: 9404/9900 (94.9899%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3924/4416 (88.8587%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3973/4416 (89.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0353, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4632/5197 (89.1283%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4610/5197 (88.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9896, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4428/4918 (90.0366%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1730, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5690/6263 (90.8510%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5706/6263 (91.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0706, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3337/3646 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7888, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4315/4707 (91.6720%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4305/4707 (91.4595%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9414, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4463/5063 (88.1493%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4272/5063 (84.3769%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3881, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3834/4295 (89.2666%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3845/4295 (89.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9695, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4338/4793 (90.5070%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4374/4793 (91.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9666, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4125/4538 (90.8991%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4234/4538 (93.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8425, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4548/5083 (89.4747%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4523/5083 (88.9829%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0539, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3247/3638 (89.2523%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3304/3638 (90.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8068, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5451/6124 (89.0105%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5429/6124 (88.6512%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0859, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4168/4618 (90.2555%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3993/4618 (86.4660%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9768, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3628/3969 (91.4084%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3612/3969 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8529, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3614/4158 (86.9168%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3679/4158 (88.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9549, Accuracy: 5401/10000 (54.0100%)
time spent on training: 257.97662138938904
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1363, Accuracy: 7000/10000 (70.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3550, Accuracy: 6907/9900 (69.7677%)
Done in 285.1966574192047 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4593/4885 (94.0225%), train_poison_data_count: 385
Global model norm: 42.892574523089074.
Norm before scaling: 42.88259686933398. Distance: 1.5573702721123286
Total norm for 4 adversaries is: 42.88259686933398. distance: 1.5573702721123286
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1982, Accuracy: 9427/9900 (95.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4945/5305 (93.2139%), train_poison_data_count: 415
Global model norm: 42.892574523089074.
Norm before scaling: 42.88117780747457. Distance: 1.7354777499008742
Total norm for 4 adversaries is: 42.88117780747457. distance: 1.7354777499008742
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1658, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4439/4717 (94.1064%), train_poison_data_count: 370
Global model norm: 42.892574523089074.
Norm before scaling: 42.88128882905253. Distance: 1.5486937340713638
Total norm for 4 adversaries is: 42.88128882905253. distance: 1.5486937340713638
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0793, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4714/5066 (93.0517%), train_poison_data_count: 400
Global model norm: 42.892574523089074.
Norm before scaling: 42.88550601283099. Distance: 1.7242780390900583
Total norm for 4 adversaries is: 42.88550601283099. distance: 1.7242780390900583
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3168, Accuracy: 9153/9900 (92.4545%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4146/4716 (87.9135%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4168/4716 (88.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1076, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3996/4481 (89.1765%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3929/4481 (87.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1378, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3917/4361 (89.8188%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3797/4361 (87.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0337, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4368/4793 (91.1329%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4414/4793 (92.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9409, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3909/4295 (91.0128%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3740/4295 (87.0780%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0357, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4587/5244 (87.4714%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4590/5244 (87.5286%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9973, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4433/4989 (88.8555%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4456/4989 (89.3165%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0129, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4643/5197 (89.3400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4674/5197 (89.9365%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9801, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3938/4356 (90.4040%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3675/4356 (84.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3349, Accuracy: 4765/10000 (47.6500%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4163/4647 (89.5847%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9705, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3664/4013 (91.3033%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7812, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4153/4538 (91.5161%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4185/4538 (92.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7946, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4292/4707 (91.1833%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4302/4707 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8571, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5653/6263 (90.2603%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5669/6263 (90.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1786, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3873/4235 (91.4522%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3747/4235 (88.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9161, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3485/3861 (90.2616%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3458/3861 (89.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1466, Accuracy: 5213/10000 (52.1300%)
time spent on training: 261.0206274986267
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1392, Accuracy: 7001/10000 (70.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.2921, Accuracy: 7029/9900 (71.0000%)
Done in 288.3743567466736 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4594/4885 (94.0430%), train_poison_data_count: 385
Global model norm: 42.91648668171199.
Norm before scaling: 42.908588565184125. Distance: 1.629924209096448
Total norm for 4 adversaries is: 42.908588565184125. distance: 1.629924209096448
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1210, Accuracy: 9609/9900 (97.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4975/5305 (93.7795%), train_poison_data_count: 415
Global model norm: 42.91648668171199.
Norm before scaling: 42.90491565204825. Distance: 1.7029612051218026
Total norm for 4 adversaries is: 42.90491565204825. distance: 1.7029612051218026
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1180, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4419/4717 (93.6824%), train_poison_data_count: 370
Global model norm: 42.91648668171199.
Norm before scaling: 42.90531681432384. Distance: 1.544883139181345
Total norm for 4 adversaries is: 42.90531681432384. distance: 1.544883139181345
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1360, Accuracy: 9542/9900 (96.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.91648668171199.
Norm before scaling: 42.910507402124864. Distance: 1.7163492254925503
Total norm for 4 adversaries is: 42.910507402124864. distance: 1.7163492254925503
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0962, Accuracy: 9643/9900 (97.4040%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4608/5055 (91.1573%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4619/5055 (91.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0350, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3485/3828 (91.0397%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3578/3828 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8607, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3922/4361 (89.9335%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3867/4361 (88.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0003, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3652/4013 (91.0042%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8352, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4111/4518 (90.9916%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4154/4518 (91.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9521, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4096/4558 (89.8640%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4043/4558 (88.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1464, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3729/4126 (90.3781%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3777/4126 (91.5414%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8846, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4275/4679 (91.3657%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3932/4679 (84.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2113, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3919/4235 (92.5384%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3845/4235 (90.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8565, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4483/5037 (89.0014%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4608/5037 (91.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9019, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3301/3672 (89.8965%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3353/3672 (91.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.7937, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4443/4928 (90.1583%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4413/4928 (89.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9569, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3978/4356 (91.3223%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3829/4356 (87.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1675, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4085/4456 (91.6741%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4112/4456 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9828, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4793 (90.0689%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4398/4793 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9915, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4540/5025 (90.3483%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4544/5025 (90.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9403, Accuracy: 5514/10000 (55.1400%)
time spent on training: 259.7482500076294
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1377, Accuracy: 7004/10000 (70.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.1960, Accuracy: 7191/9900 (72.6364%)
Done in 287.1480219364166 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4637/4885 (94.9232%), train_poison_data_count: 385
Global model norm: 42.93826333246155.
Norm before scaling: 42.927107662473894. Distance: 1.5434096853156243
Total norm for 4 adversaries is: 42.927107662473894. distance: 1.5434096853156243
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0879, Accuracy: 9662/9900 (97.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4993/5305 (94.1188%), train_poison_data_count: 415
Global model norm: 42.93826333246155.
Norm before scaling: 42.92629721030571. Distance: 1.6902416704274756
Total norm for 4 adversaries is: 42.92629721030571. distance: 1.6902416704274756
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0848, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4459/4717 (94.5304%), train_poison_data_count: 370
Global model norm: 42.93826333246155.
Norm before scaling: 42.92361976568451. Distance: 1.4871992047501152
Total norm for 4 adversaries is: 42.92361976568451. distance: 1.4871992047501152
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1668, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.93826333246155.
Norm before scaling: 42.93108718714578. Distance: 1.684097604079564
Total norm for 4 adversaries is: 42.93108718714578. distance: 1.684097604079564
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1162, Accuracy: 9594/9900 (96.9091%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3980/4346 (91.5785%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4041/4346 (92.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8598, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3803/4184 (90.8939%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3804/4184 (90.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9745, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3947/4356 (90.6107%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3432/4356 (78.7879%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2838, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3314/3646 (90.8941%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3362/3646 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7753, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4594/5083 (90.3797%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4539/5083 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9471, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3963/4356 (90.9780%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3909/4356 (89.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1085, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4091/4558 (89.7543%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4072/4558 (89.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1024, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3761/4175 (90.0838%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3701/4175 (88.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9236, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3195/3472 (92.0219%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3146/3472 (90.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1339, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4116/4501 (91.4463%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4078/4501 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9049, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4933/5424 (90.9476%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4955/5424 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1648, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4026/4481 (89.8460%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3976/4481 (88.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0318, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4929/5455 (90.3575%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4947/5455 (90.6874%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0721, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4691/5232 (89.6598%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4645/5232 (88.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0508, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5588/6391 (87.4355%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5537/6391 (86.6375%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0890, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3475/3775 (92.0530%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3577/3775 (94.7550%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8993, Accuracy: 5707/10000 (57.0700%)
time spent on training: 260.56536626815796
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1438, Accuracy: 6998/10000 (69.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.0828, Accuracy: 7419/9900 (74.9394%)
Done in 288.30930161476135 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4600/4885 (94.1658%), train_poison_data_count: 385
Global model norm: 42.96156189876306.
Norm before scaling: 42.95177647710351. Distance: 1.6409085709871936
Total norm for 4 adversaries is: 42.95177647710351. distance: 1.6409085709871936
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0877, Accuracy: 9653/9900 (97.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5004/5305 (94.3261%), train_poison_data_count: 415
Global model norm: 42.96156189876306.
Norm before scaling: 42.94735831151318. Distance: 1.6465782781320284
Total norm for 4 adversaries is: 42.94735831151318. distance: 1.6465782781320284
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0420, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4440/4717 (94.1276%), train_poison_data_count: 370
Global model norm: 42.96156189876306.
Norm before scaling: 42.94851085847957. Distance: 1.5233246590320744
Total norm for 4 adversaries is: 42.94851085847957. distance: 1.5233246590320744
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1444, Accuracy: 9510/9900 (96.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4744/5066 (93.6439%), train_poison_data_count: 400
Global model norm: 42.96156189876306.
Norm before scaling: 42.95459852192414. Distance: 1.695142886910557
Total norm for 4 adversaries is: 42.95459852192414. distance: 1.695142886910557
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1627, Accuracy: 9478/9900 (95.7374%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3684/4025 (91.5280%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3746/4025 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8296, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3878/4223 (91.8305%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3859/4223 (91.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9375, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3262/3638 (89.6647%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3392/3638 (93.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8415, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4490/5063 (88.6826%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4385/5063 (86.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2587, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4387/4874 (90.0082%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4251/4874 (87.2179%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.7366, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4338/4804 (90.2998%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4105/4804 (85.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2621, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3679/4158 (88.4800%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3637/4158 (87.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0869, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4083/4518 (90.3718%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4125/4518 (91.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0396, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3887/4235 (91.7828%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3824/4235 (90.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9381, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4373/4934 (88.6299%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4048/4934 (82.0430%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2368, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5638/6391 (88.2178%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5631/6391 (88.1083%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0850, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3880/4295 (90.3376%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3843/4295 (89.4761%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0378, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3471/3756 (92.4121%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3545/3756 (94.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8720, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4046/4481 (90.2923%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3900/4481 (87.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0418, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3745/4175 (89.7006%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3713/4175 (88.9341%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0305, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3299/3590 (91.8942%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3195/3590 (88.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1493, Accuracy: 5288/10000 (52.8800%)
time spent on training: 256.4339454174042
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1537, Accuracy: 6971/10000 (69.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.9842, Accuracy: 7609/9900 (76.8586%)
Done in 284.2836194038391 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4631/4885 (94.8004%), train_poison_data_count: 385
Global model norm: 42.984677445773485.
Norm before scaling: 42.97087636784142. Distance: 1.539332022521952
Total norm for 4 adversaries is: 42.97087636784142. distance: 1.539332022521952
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1900, Accuracy: 9435/9900 (95.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5051/5305 (95.2121%), train_poison_data_count: 415
Global model norm: 42.984677445773485.
Norm before scaling: 42.967109343677784. Distance: 1.5445861065721926
Total norm for 4 adversaries is: 42.967109343677784. distance: 1.5445861065721926
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2585, Accuracy: 9312/9900 (94.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4456/4717 (94.4668%), train_poison_data_count: 370
Global model norm: 42.984677445773485.
Norm before scaling: 42.97009372898929. Distance: 1.46629395987328
Total norm for 4 adversaries is: 42.97009372898929. distance: 1.46629395987328
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1096, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4767/5066 (94.0979%), train_poison_data_count: 400
Global model norm: 42.984677445773485.
Norm before scaling: 42.97657883225467. Distance: 1.6602651044275973
Total norm for 4 adversaries is: 42.97657883225467. distance: 1.6602651044275973
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0826, Accuracy: 9692/9900 (97.8990%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3513/3828 (91.7712%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7500, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3567/3911 (91.2043%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3357/3911 (85.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2599, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4034/4362 (92.4805%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3924/4362 (89.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9426, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4784/5197 (92.0531%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4645/5197 (89.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1825, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4292/4679 (91.7290%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4163/4679 (88.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2009, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4349/4793 (90.7365%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1022, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4601/5116 (89.9335%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4599/5116 (89.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1396, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4093/4625 (88.4973%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4070/4625 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0237, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4250/4618 (92.0312%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4165/4618 (90.1906%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0820, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2966/3271 (90.6756%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2985/3271 (91.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8976, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3819/4175 (91.4731%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3791/4175 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9435, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3230/3616 (89.3252%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3315/3616 (91.6759%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9002, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3976/4481 (88.7302%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3916/4481 (87.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1355, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3946/4368 (90.3388%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3922/4368 (89.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9420, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5135/5740 (89.4599%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5209/5740 (90.7491%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1198, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4184/4647 (90.0366%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4237/4647 (91.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9705, Accuracy: 5539/10000 (55.3900%)
time spent on training: 256.7458143234253
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1662, Accuracy: 6958/10000 (69.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.8653, Accuracy: 7865/9900 (79.4444%)
Done in 283.94726753234863 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4655/4885 (95.2917%), train_poison_data_count: 385
Global model norm: 43.00706956102174.
Norm before scaling: 42.99344886733108. Distance: 1.5185496633759332
Total norm for 4 adversaries is: 42.99344886733108. distance: 1.5185496633759332
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2289, Accuracy: 9329/9900 (94.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5006/5305 (94.3638%), train_poison_data_count: 415
Global model norm: 43.00706956102174.
Norm before scaling: 42.98943962120595. Distance: 1.6195056167980943
Total norm for 4 adversaries is: 42.98943962120595. distance: 1.6195056167980943
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1062, Accuracy: 9657/9900 (97.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4455/4717 (94.4456%), train_poison_data_count: 370
Global model norm: 43.00706956102174.
Norm before scaling: 42.992223701829204. Distance: 1.4754446329337152
Total norm for 4 adversaries is: 42.992223701829204. distance: 1.4754446329337152
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0538, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4768/5066 (94.1176%), train_poison_data_count: 400
Global model norm: 43.00706956102174.
Norm before scaling: 42.997193710661946. Distance: 1.6522939688035185
Total norm for 4 adversaries is: 42.997193710661946. distance: 1.6522939688035185
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0559, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5004/5591 (89.5010%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4990/5591 (89.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0491, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4956 (89.1445%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4341/4956 (87.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1877, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4042/4511 (89.6032%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4118/4511 (91.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9605, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3725/4013 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8467, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3315/3590 (92.3398%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3345/3590 (93.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9344, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4343/4793 (90.6113%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4380/4793 (91.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0314, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3473/3804 (91.2986%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3475/3804 (91.3512%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0039, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3497/3837 (91.1389%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3562/3837 (92.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9226, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3949/4361 (90.5526%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3799/4361 (87.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0542, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4511/5063 (89.0974%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4430/5063 (87.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3791, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3921/4368 (89.7665%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1105, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4333/4679 (92.6053%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4128/4679 (88.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0105, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4736/5265 (89.9525%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4660/5265 (88.5090%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1253, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4244/4767 (89.0287%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4204/4767 (88.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2033, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5208/5902 (88.2413%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4890/5902 (82.8533%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.4503, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3809/4223 (90.1965%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9128, Accuracy: 5615/10000 (56.1500%)
time spent on training: 253.62053275108337
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1649, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.8692, Accuracy: 7870/9900 (79.4949%)
Done in 281.08113980293274 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4678/4885 (95.7625%), train_poison_data_count: 385
Global model norm: 43.0302315829014.
Norm before scaling: 43.01388254734598. Distance: 1.4284220447092237
Total norm for 4 adversaries is: 43.01388254734598. distance: 1.4284220447092237
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1859, Accuracy: 9436/9900 (95.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4999/5305 (94.2319%), train_poison_data_count: 415
Global model norm: 43.0302315829014.
Norm before scaling: 43.01761993648649. Distance: 1.6597708939244005
Total norm for 4 adversaries is: 43.01761993648649. distance: 1.6597708939244005
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1530, Accuracy: 9514/9900 (96.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4450/4717 (94.3396%), train_poison_data_count: 370
Global model norm: 43.0302315829014.
Norm before scaling: 43.01420181308945. Distance: 1.4485769984486743
Total norm for 4 adversaries is: 43.01420181308945. distance: 1.4485769984486743
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1677, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4767/5066 (94.0979%), train_poison_data_count: 400
Global model norm: 43.0302315829014.
Norm before scaling: 43.01792356735591. Distance: 1.6476939183031192
Total norm for 4 adversaries is: 43.01792356735591. distance: 1.6476939183031192
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0482, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3490/3797 (91.9147%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3462/3797 (91.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9324, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3500/3861 (90.6501%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3486/3861 (90.2875%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0622, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4297/4707 (91.2896%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4251/4707 (90.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1011, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4137/4518 (91.5671%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0998, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3694/4013 (92.0508%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3707/4013 (92.3748%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9337, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4714/5167 (91.2328%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4683/5167 (90.6329%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2070, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3603/3969 (90.7785%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3628/3969 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8824, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4082/4441 (91.9162%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4078/4441 (91.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0343, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4104/4558 (90.0395%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4115/4558 (90.2808%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9992, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4065/4465 (91.0414%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4126/4465 (92.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8849, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3305/3638 (90.8466%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3360/3638 (92.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9259, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4138/4538 (91.1855%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4207/4538 (92.7060%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8924, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5125/5740 (89.2857%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5174/5740 (90.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2216, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3503/3837 (91.2953%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3546/3837 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9540, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3957/4361 (90.7361%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3685/4361 (84.4990%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1284, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4375/4793 (91.2789%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0422, Accuracy: 5406/10000 (54.0600%)
time spent on training: 258.52422761917114
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1674, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.7926, Accuracy: 8020/9900 (81.0101%)
Done in 285.8328523635864 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.050823605198744.
Norm before scaling: 43.033801610532706. Distance: 1.4781067054697088
Total norm for 4 adversaries is: 43.033801610532706. distance: 1.4781067054697088
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1084, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4996/5305 (94.1753%), train_poison_data_count: 415
Global model norm: 43.050823605198744.
Norm before scaling: 43.03562409686015. Distance: 1.6456655907759081
Total norm for 4 adversaries is: 43.03562409686015. distance: 1.6456655907759081
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0858, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4461/4717 (94.5728%), train_poison_data_count: 370
Global model norm: 43.050823605198744.
Norm before scaling: 43.0359956760399. Distance: 1.4601499505312798
Total norm for 4 adversaries is: 43.0359956760399. distance: 1.4601499505312798
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1868, Accuracy: 9443/9900 (95.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4771/5066 (94.1769%), train_poison_data_count: 400
Global model norm: 43.050823605198744.
Norm before scaling: 43.03816410275812. Distance: 1.6283058139319815
Total norm for 4 adversaries is: 43.03816410275812. distance: 1.6283058139319815
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1294, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4251/4767 (89.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2112, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4105/4441 (92.4341%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4135/4441 (93.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1723, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4000/4356 (91.8274%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3853/4356 (88.4527%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.7528, Accuracy: 4567/10000 (45.6700%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5583/6391 (87.3572%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5518/6391 (86.3402%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1844, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3816/4184 (91.2046%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3812/4184 (91.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0196, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4009/4346 (92.2457%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4048/4346 (93.1431%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7584, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4493/5037 (89.1999%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4631/5037 (91.9396%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0242, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4209/4634 (90.8287%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4207/4634 (90.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1669, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4405/4934 (89.2785%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4280/4934 (86.7450%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1520, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4923/5424 (90.7633%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4908/5424 (90.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2295, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3455/3781 (91.3779%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3246/3781 (85.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1670, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3531/3861 (91.4530%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3514/3861 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9350, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4628/5055 (91.5529%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4627/5055 (91.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9456, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4086/4433 (92.1723%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4040/4433 (91.1347%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8779, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4688/5167 (90.7296%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4645/5167 (89.8974%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1415, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3331/3590 (92.7855%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3171/3590 (88.3287%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3773, Accuracy: 5066/10000 (50.6600%)
time spent on training: 258.82196021080017
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1689, Accuracy: 6949/10000 (69.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.7281, Accuracy: 8165/9900 (82.4747%)
Done in 287.25187253952026 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4646/4885 (95.1075%), train_poison_data_count: 385
Global model norm: 43.07349024079007.
Norm before scaling: 43.05626315502775. Distance: 1.4686025991943332
Total norm for 4 adversaries is: 43.05626315502775. distance: 1.4686025991943332
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1487, Accuracy: 9540/9900 (96.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5023/5305 (94.6843%), train_poison_data_count: 415
Global model norm: 43.07349024079007.
Norm before scaling: 43.05498732543943. Distance: 1.570626981759026
Total norm for 4 adversaries is: 43.05498732543943. distance: 1.570626981759026
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1347, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4477/4717 (94.9120%), train_poison_data_count: 370
Global model norm: 43.07349024079007.
Norm before scaling: 43.058088943164904. Distance: 1.4514753761055665
Total norm for 4 adversaries is: 43.058088943164904. distance: 1.4514753761055665
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0774, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4790/5066 (94.5519%), train_poison_data_count: 400
Global model norm: 43.07349024079007.
Norm before scaling: 43.0623270814743. Distance: 1.5917570331478619
Total norm for 4 adversaries is: 43.0623270814743. distance: 1.5917570331478619
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2217, Accuracy: 9342/9900 (94.3636%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3924/4368 (89.8352%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3948/4368 (90.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9106, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3502/3828 (91.4838%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3549/3828 (92.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7831, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4049/4356 (92.9522%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3684/4356 (84.5730%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1704, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3515/3861 (91.0386%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3490/3861 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9033, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3210/3472 (92.4539%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3232/3472 (93.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9182, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4181/4538 (92.1331%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4194/4538 (92.4196%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9308, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4909/5392 (91.0423%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4869/5392 (90.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0645, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3907/4295 (90.9662%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3709/4295 (86.3562%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0032, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3874/4235 (91.4758%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3822/4235 (90.2479%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0379, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4128/4456 (92.6391%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4078/4456 (91.5171%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9250, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4731/5265 (89.8575%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4656/5265 (88.4330%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9819, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4127/4441 (92.9295%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4144/4441 (93.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9809, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3711/4013 (92.4745%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7557, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4092/4465 (91.6461%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4120/4465 (92.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9296, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5693/6263 (90.8989%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5684/6263 (90.7552%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9031, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4514/4986 (90.5335%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4527/4986 (90.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8746, Accuracy: 5666/10000 (56.6600%)
time spent on training: 261.421258687973
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1690, Accuracy: 6939/10000 (69.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.7056, Accuracy: 8231/9900 (83.1414%)
Done in 288.7686619758606 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4629/4885 (94.7595%), train_poison_data_count: 385
Global model norm: 43.09498644210615.
Norm before scaling: 43.07940439476633. Distance: 1.5007462234818123
Total norm for 4 adversaries is: 43.07940439476633. distance: 1.5007462234818123
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2025, Accuracy: 9395/9900 (94.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5026/5305 (94.7408%), train_poison_data_count: 415
Global model norm: 43.09498644210615.
Norm before scaling: 43.07953332391438. Distance: 1.5859449414609517
Total norm for 4 adversaries is: 43.07953332391438. distance: 1.5859449414609517
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1158, Accuracy: 9607/9900 (97.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4465/4717 (94.6576%), train_poison_data_count: 370
Global model norm: 43.09498644210615.
Norm before scaling: 43.07846220850972. Distance: 1.4488365306800683
Total norm for 4 adversaries is: 43.07846220850972. distance: 1.4488365306800683
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0648, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4801/5066 (94.7690%), train_poison_data_count: 400
Global model norm: 43.09498644210615.
Norm before scaling: 43.08183698189267. Distance: 1.5751012406280904
Total norm for 4 adversaries is: 43.08183698189267. distance: 1.5751012406280904
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1114, Accuracy: 9623/9900 (97.2020%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3700/4158 (88.9851%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3672/4158 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1091, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4682/5167 (90.6135%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4686/5167 (90.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0818, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3515/3828 (91.8234%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3510/3828 (91.6928%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8957, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4274/4663 (91.6577%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4256/4663 (91.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8973, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4064/4433 (91.6761%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4433 (92.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9073, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3834/4184 (91.6348%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3821/4184 (91.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9610, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4245/4716 (90.0127%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4213/4716 (89.3342%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1245, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3877/4223 (91.8068%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3900/4223 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8559, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4305/4679 (92.0068%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4165/4679 (89.0147%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1352, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3323/3704 (89.7138%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3394/3704 (91.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8726, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3524/3837 (91.8426%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3581/3837 (93.3281%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9798, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3540/3861 (91.6861%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9976, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4955/5424 (91.3532%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4928/5424 (90.8555%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1151, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4203/4576 (91.8488%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4221/4576 (92.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8645, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3681/4025 (91.4534%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3766/4025 (93.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7604, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3483/3775 (92.2649%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3562/3775 (94.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8224, Accuracy: 5760/10000 (57.6000%)
time spent on training: 256.3787000179291
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1678, Accuracy: 6926/10000 (69.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.6613, Accuracy: 8318/9900 (84.0202%)
Done in 283.9867570400238 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4653/4885 (95.2508%), train_poison_data_count: 385
Global model norm: 43.11493173909925.
Norm before scaling: 43.100688063225135. Distance: 1.5039517482464213
Total norm for 4 adversaries is: 43.100688063225135. distance: 1.5039517482464213
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0750, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5009/5305 (94.4204%), train_poison_data_count: 415
Global model norm: 43.11493173909925.
Norm before scaling: 43.099431958626205. Distance: 1.6254032074932427
Total norm for 4 adversaries is: 43.099431958626205. distance: 1.6254032074932427
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0971, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4484/4717 (95.0604%), train_poison_data_count: 370
Global model norm: 43.11493173909925.
Norm before scaling: 43.09582063100058. Distance: 1.3911263494389914
Total norm for 4 adversaries is: 43.09582063100058. distance: 1.3911263494389914
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2655, Accuracy: 9255/9900 (93.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4784/5066 (94.4335%), train_poison_data_count: 400
Global model norm: 43.11493173909925.
Norm before scaling: 43.10192997056512. Distance: 1.589491821628013
Total norm for 4 adversaries is: 43.10192997056512. distance: 1.589491821628013
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0424, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4170/4576 (91.1276%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4224/4576 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9549, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3313/3672 (90.2233%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3343/3672 (91.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9226, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4255/4618 (92.1395%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4087/4618 (88.5015%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0712, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4211/4538 (92.7942%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4280/4538 (94.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7891, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4531/5025 (90.1692%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4623/5025 (92.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0873, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3316/3590 (92.3677%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3342/3590 (93.0919%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9205, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4302/4707 (91.3958%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4285/4707 (91.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1357, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4498/4918 (91.4599%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4465/4918 (90.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9787, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3935/4336 (90.7518%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3967/4336 (91.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9780, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5247/5902 (88.9021%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5069/5902 (85.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2069, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4119/4441 (92.7494%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4153/4441 (93.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9340, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4700/5232 (89.8318%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4675/5232 (89.3540%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0621, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4351/4804 (90.5704%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4211/4804 (87.6561%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2135, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3640/3969 (91.7108%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3655/3969 (92.0887%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8963, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4921/5392 (91.2648%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4837/5392 (89.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0966, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3524/3828 (92.0585%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3543/3828 (92.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8445, Accuracy: 5693/10000 (56.9300%)
time spent on training: 259.5477216243744
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1809, Accuracy: 6904/10000 (69.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.5894, Accuracy: 8477/9900 (85.6263%)
Done in 286.5440413951874 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4682/4885 (95.8444%), train_poison_data_count: 385
Global model norm: 43.13651199381085.
Norm before scaling: 43.117032495418066. Distance: 1.3978537934325324
Total norm for 4 adversaries is: 43.117032495418066. distance: 1.3978537934325324
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1028, Accuracy: 9629/9900 (97.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5031/5305 (94.8351%), train_poison_data_count: 415
Global model norm: 43.13651199381085.
Norm before scaling: 43.11986920338683. Distance: 1.579503429944069
Total norm for 4 adversaries is: 43.11986920338683. distance: 1.579503429944069
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0805, Accuracy: 9693/9900 (97.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4461/4717 (94.5728%), train_poison_data_count: 370
Global model norm: 43.13651199381085.
Norm before scaling: 43.11938510774838. Distance: 1.4427225362397638
Total norm for 4 adversaries is: 43.11938510774838. distance: 1.4427225362397638
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1179, Accuracy: 9590/9900 (96.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4797/5066 (94.6901%), train_poison_data_count: 400
Global model norm: 43.13651199381085.
Norm before scaling: 43.12109923481485. Distance: 1.5449601468868865
Total norm for 4 adversaries is: 43.12109923481485. distance: 1.5449601468868865
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0979, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4689/5232 (89.6216%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4590/5232 (87.7294%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1254, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4462/4956 (90.0323%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2942, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4505/5063 (88.9789%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4433/5063 (87.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2777, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3738/4025 (92.8696%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3778/4025 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8186, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4109/4441 (92.5242%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4094/4441 (92.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1736, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4112/4625 (88.9081%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4066/4625 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0434, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4989/5591 (89.2327%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4810/5591 (86.0311%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2391, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5146/5582 (92.1892%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5067/5582 (90.7739%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2176, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5241/5902 (88.8004%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5116/5902 (86.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3349, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4216/4538 (92.9044%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8112, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4606/5025 (91.6617%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4665/5025 (92.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9908, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3881/4223 (91.9015%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8442, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3928/4361 (90.0711%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3736/4361 (85.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1650, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3954/4354 (90.8130%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3535/4354 (81.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4889, Accuracy: 4666/10000 (46.6600%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3329/3672 (90.6590%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3330/3672 (90.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1309, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3988/4356 (91.5519%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3907/4356 (89.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2544, Accuracy: 5025/10000 (50.2500%)
time spent on training: 263.4287610054016
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1845, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.5726, Accuracy: 8518/9900 (86.0404%)
Done in 290.6739284992218 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4642/4885 (95.0256%), train_poison_data_count: 385
Global model norm: 43.16018011386117.
Norm before scaling: 43.14332858922469. Distance: 1.4561511288588505
Total norm for 4 adversaries is: 43.14332858922469. distance: 1.4561511288588505
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0600, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5043/5305 (95.0613%), train_poison_data_count: 415
Global model norm: 43.16018011386117.
Norm before scaling: 43.13997984849002. Distance: 1.5182905844495398
Total norm for 4 adversaries is: 43.13997984849002. distance: 1.5182905844495398
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1232, Accuracy: 9574/9900 (96.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4486/4717 (95.1028%), train_poison_data_count: 370
Global model norm: 43.16018011386117.
Norm before scaling: 43.14123477249246. Distance: 1.3914780304271344
Total norm for 4 adversaries is: 43.14123477249246. distance: 1.3914780304271344
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1555, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4807/5066 (94.8875%), train_poison_data_count: 400
Global model norm: 43.16018011386117.
Norm before scaling: 43.146388491318135. Distance: 1.5543523839418063
Total norm for 4 adversaries is: 43.146388491318135. distance: 1.5543523839418063
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0951, Accuracy: 9674/9900 (97.7172%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3556/3828 (92.8945%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3546/3828 (92.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8326, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3920/4235 (92.5620%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3760/4235 (88.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9157, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3366/3704 (90.8747%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3306/3704 (89.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9979, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3712/4046 (91.7449%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3752/4046 (92.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7756, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4500/4928 (91.3149%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4442/4928 (90.1380%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9500, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5216/5740 (90.8711%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5145/5740 (89.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0386, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4599/5083 (90.4781%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4535/5083 (89.2190%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8830, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4192/4576 (91.6084%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4163/4576 (90.9747%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9067, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4235/4647 (91.1341%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4242/4647 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9337, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4985/5424 (91.9063%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4961/5424 (91.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2216, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4081/4503 (90.6285%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4057/4503 (90.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0037, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5664/6391 (88.6246%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5600/6391 (87.6232%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0960, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4085/4511 (90.5564%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4072/4511 (90.2682%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0065, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4115/4456 (92.3474%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4104/4456 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0100, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4358/4804 (90.7161%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4137/4804 (86.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2544, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3457/3804 (90.8780%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3496/3804 (91.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9984, Accuracy: 5468/10000 (54.6800%)
time spent on training: 262.5915231704712
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1866, Accuracy: 6921/10000 (69.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.5366, Accuracy: 8585/9900 (86.7172%)
Done in 289.9889323711395 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4662/4885 (95.4350%), train_poison_data_count: 385
Global model norm: 43.18292362240108.
Norm before scaling: 43.16473910668797. Distance: 1.4433027160838876
Total norm for 4 adversaries is: 43.16473910668797. distance: 1.4433027160838876
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0886, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5055/5305 (95.2875%), train_poison_data_count: 415
Global model norm: 43.18292362240108.
Norm before scaling: 43.164859296944314. Distance: 1.5808489867732254
Total norm for 4 adversaries is: 43.164859296944314. distance: 1.5808489867732254
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0984, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4476/4717 (94.8908%), train_poison_data_count: 370
Global model norm: 43.18292362240108.
Norm before scaling: 43.16582504885592. Distance: 1.4247592555353064
Total norm for 4 adversaries is: 43.16582504885592. distance: 1.4247592555353064
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0795, Accuracy: 9689/9900 (97.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4820/5066 (95.1441%), train_poison_data_count: 400
Global model norm: 43.18292362240108.
Norm before scaling: 43.16569779142129. Distance: 1.4875124249620586
Total norm for 4 adversaries is: 43.16569779142129. distance: 1.4875124249620586
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0700, Accuracy: 9705/9900 (98.0303%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4517/4928 (91.6599%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4466/4928 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9200, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4501/5037 (89.3587%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4590/5037 (91.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0110, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4963/5392 (92.0438%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4830/5392 (89.5772%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0239, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4098/4501 (91.0464%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4092/4501 (90.9131%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9468, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3446/3804 (90.5889%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3510/3804 (92.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9253, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3536/3837 (92.1553%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3573/3837 (93.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9629, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4534/5063 (89.5516%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4261/5063 (84.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2937, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4067/4481 (90.7610%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3968/4481 (88.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1876, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4166/4518 (92.2089%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4140/4518 (91.6335%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9511, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3274/3638 (89.9945%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3322/3638 (91.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8898, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4278/4663 (91.7435%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4283/4663 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9755, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4142/4625 (89.5568%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4055/4625 (87.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1032, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4681/5197 (90.0712%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4641/5197 (89.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1800, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4627/5083 (91.0289%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4597/5083 (90.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0871, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3561/3828 (93.0251%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3607/3828 (94.2268%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7657, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3336/3704 (90.0648%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3409/3704 (92.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8899, Accuracy: 5720/10000 (57.2000%)
time spent on training: 261.6253447532654
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1878, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.5227, Accuracy: 8615/9900 (87.0202%)
Done in 289.22747230529785 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4654/4885 (95.2712%), train_poison_data_count: 385
Global model norm: 43.20473409074013.
Norm before scaling: 43.18714809688396. Distance: 1.4899378890334625
Total norm for 4 adversaries is: 43.18714809688396. distance: 1.4899378890334625
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0963, Accuracy: 9646/9900 (97.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.20473409074013.
Norm before scaling: 43.18364304186468. Distance: 1.5050240462146935
Total norm for 4 adversaries is: 43.18364304186468. distance: 1.5050240462146935
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0541, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4489/4717 (95.1664%), train_poison_data_count: 370
Global model norm: 43.20473409074013.
Norm before scaling: 43.18581677481407. Distance: 1.4201091658578544
Total norm for 4 adversaries is: 43.18581677481407. distance: 1.4201091658578544
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1365, Accuracy: 9546/9900 (96.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4800/5066 (94.7493%), train_poison_data_count: 400
Global model norm: 43.20473409074013.
Norm before scaling: 43.18784059426116. Distance: 1.524951202362286
Total norm for 4 adversaries is: 43.18784059426116. distance: 1.524951202362286
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0803, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3548/3861 (91.8933%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3551/3861 (91.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9084, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3830/4184 (91.5392%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3827/4184 (91.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8537, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4536/5037 (90.0536%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4594/5037 (91.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9790, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4664/5197 (89.7441%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4506/5197 (86.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0927, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4537/5025 (90.2886%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4467/5025 (88.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9874, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4645/5116 (90.7936%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4543/5116 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0404, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4048/4481 (90.3370%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4011/4481 (89.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1220, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4242/4576 (92.7010%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4187/4576 (91.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0028, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4720/5232 (90.2141%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5232 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0330, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3941/4354 (90.5145%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3829/4354 (87.9421%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1502, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2931/3271 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9380, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4909/5455 (89.9908%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4876/5455 (89.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2047, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3763/4126 (91.2021%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3827/4126 (92.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0177, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3478/3797 (91.5986%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3550/3797 (93.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8651, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3357/3704 (90.6317%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3417/3704 (92.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8189, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4484/4934 (90.8796%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4259/4934 (86.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1842, Accuracy: 5091/10000 (50.9100%)
time spent on training: 261.71529746055603
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1889, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.4960, Accuracy: 8670/9900 (87.5758%)
Done in 289.07416462898254 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4686/4885 (95.9263%), train_poison_data_count: 385
Global model norm: 43.22694585158949.
Norm before scaling: 43.2065041626041. Distance: 1.3981767123553368
Total norm for 4 adversaries is: 43.2065041626041. distance: 1.3981767123553368
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0982, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5045/5305 (95.0990%), train_poison_data_count: 415
Global model norm: 43.22694585158949.
Norm before scaling: 43.20767381116316. Distance: 1.543351678773561
Total norm for 4 adversaries is: 43.20767381116316. distance: 1.543351678773561
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2001, Accuracy: 9387/9900 (94.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4464/4717 (94.6364%), train_poison_data_count: 370
Global model norm: 43.22694585158949.
Norm before scaling: 43.2077274899265. Distance: 1.440242638808676
Total norm for 4 adversaries is: 43.2077274899265. distance: 1.440242638808676
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0915, Accuracy: 9666/9900 (97.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4822/5066 (95.1836%), train_poison_data_count: 400
Global model norm: 43.22694585158949.
Norm before scaling: 43.20884766574506. Distance: 1.5059103555126818
Total norm for 4 adversaries is: 43.20884766574506. distance: 1.5059103555126818
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0677, Accuracy: 9719/9900 (98.1717%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4275/4618 (92.5725%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4095/4618 (88.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9927, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4123/4625 (89.1459%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4072/4625 (88.0432%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2210, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5248/5740 (91.4286%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5076/5740 (88.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3184, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3998/4416 (90.5344%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4038/4416 (91.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9811, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3805/4126 (92.2201%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3814/4126 (92.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8664, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3263/3616 (90.2378%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8227, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3674/4158 (88.3598%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3739/4158 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9898, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4028/4346 (92.6829%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4042/4346 (93.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8574, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4366/4874 (89.5773%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4309/4874 (88.4079%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3871, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4755/5265 (90.3134%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4708/5265 (89.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0155, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3720/4025 (92.4224%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3763/4025 (93.4907%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8305, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4230/4651 (90.9482%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4212/4651 (90.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1445, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3483/3837 (90.7740%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3521/3837 (91.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0901, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3288/3638 (90.3793%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3355/3638 (92.2210%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9215, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3227/3472 (92.9435%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3261/3472 (93.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9497, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4139/4456 (92.8860%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0816, Accuracy: 5397/10000 (53.9700%)
time spent on training: 257.56442046165466
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1859, Accuracy: 6923/10000 (69.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.4874, Accuracy: 8691/9900 (87.7879%)
Done in 284.8087544441223 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4650/4885 (95.1894%), train_poison_data_count: 385
Global model norm: 43.247355297571374.
Norm before scaling: 43.23280654229421. Distance: 1.5075603531227184
Total norm for 4 adversaries is: 43.23280654229421. distance: 1.5075603531227184
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1080, Accuracy: 9638/9900 (97.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5060/5305 (95.3817%), train_poison_data_count: 415
Global model norm: 43.247355297571374.
Norm before scaling: 43.22711952356631. Distance: 1.50899660726157
Total norm for 4 adversaries is: 43.22711952356631. distance: 1.50899660726157
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0613, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4485/4717 (95.0816%), train_poison_data_count: 370
Global model norm: 43.247355297571374.
Norm before scaling: 43.22791868806041. Distance: 1.4043650391738554
Total norm for 4 adversaries is: 43.22791868806041. distance: 1.4043650391738554
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1059, Accuracy: 9618/9900 (97.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4806/5066 (94.8677%), train_poison_data_count: 400
Global model norm: 43.247355297571374.
Norm before scaling: 43.23171522357024. Distance: 1.5520918758421802
Total norm for 4 adversaries is: 43.23171522357024. distance: 1.5520918758421802
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0640, Accuracy: 9738/9900 (98.3636%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4966/5424 (91.5560%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4942/5424 (91.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0696, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4547/4986 (91.1953%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4535/4986 (90.9547%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8792, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4710/5167 (91.1554%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4725/5167 (91.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1371, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4239/4716 (89.8855%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4239/4716 (89.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0793, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3931/4368 (89.9954%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3879/4368 (88.8049%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0051, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4024/4356 (92.3783%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3718/4356 (85.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.5549, Accuracy: 4664/10000 (46.6400%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4402/4804 (91.6320%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4318/4804 (89.8834%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1510, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4072/4481 (90.8726%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1448, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3712/4025 (92.2236%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3793/4025 (94.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8466, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4589/5017 (91.4690%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4560/5017 (90.8910%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9385, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3291/3616 (91.0122%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3329/3616 (92.0631%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8366, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3805/4184 (90.9417%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3822/4184 (91.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7982, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4662/5195 (89.7401%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4640/5195 (89.3167%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0056, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3968/4361 (90.9883%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3959/4361 (90.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2158, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3523/3756 (93.7966%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3539/3756 (94.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8489, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5038/5591 (90.1091%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4914/5591 (87.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1269, Accuracy: 5307/10000 (53.0700%)
time spent on training: 262.9592273235321
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1882, Accuracy: 6929/10000 (69.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.4549, Accuracy: 8760/9900 (88.4848%)
Done in 290.46867632865906 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4676/4885 (95.7216%), train_poison_data_count: 385
Global model norm: 43.269202407175534.
Norm before scaling: 43.24865367756406. Distance: 1.3981530097266852
Total norm for 4 adversaries is: 43.24865367756406. distance: 1.3981530097266852
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1617, Accuracy: 9476/9900 (95.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5010/5305 (94.4392%), train_poison_data_count: 415
Global model norm: 43.269202407175534.
Norm before scaling: 43.25370852055636. Distance: 1.6202643421340586
Total norm for 4 adversaries is: 43.25370852055636. distance: 1.6202643421340586
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1067, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4488/4717 (95.1452%), train_poison_data_count: 370
Global model norm: 43.269202407175534.
Norm before scaling: 43.24844622163827. Distance: 1.3789570828758864
Total norm for 4 adversaries is: 43.24844622163827. distance: 1.3789570828758864
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0716, Accuracy: 9718/9900 (98.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4803/5066 (94.8085%), train_poison_data_count: 400
Global model norm: 43.269202407175534.
Norm before scaling: 43.252887254602726. Distance: 1.569538134288738
Total norm for 4 adversaries is: 43.252887254602726. distance: 1.569538134288738
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0464, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3812/4175 (91.3054%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3797/4175 (90.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1011, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5011/5455 (91.8607%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4953/5455 (90.7974%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0025, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3398/3704 (91.7387%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3431/3704 (92.6296%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8243, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4472/4989 (89.6372%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4456/4989 (89.3165%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0010, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4512/4928 (91.5584%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4463/4928 (90.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9714, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3489/3804 (91.7192%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3516/3804 (92.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0885, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3947/4336 (91.0286%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3949/4336 (91.0747%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0089, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3715/4046 (91.8191%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3725/4046 (92.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8592, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4374/4793 (91.2581%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8420, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3486/3756 (92.8115%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3530/3756 (93.9830%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1436, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5720/6391 (89.5009%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5558/6391 (86.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2929, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3326/3672 (90.5773%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3361/3672 (91.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9291, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4147/4558 (90.9829%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4112/4558 (90.2150%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1179, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4220/4576 (92.2203%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4167/4576 (91.0621%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9436, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4132/4456 (92.7289%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4185/4456 (93.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8359, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3629/4356 (83.3104%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2818, Accuracy: 5078/10000 (50.7800%)
time spent on training: 261.4374499320984
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1891, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4414, Accuracy: 8784/9900 (88.7273%)
Done in 288.7192454338074 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4672/4885 (95.6397%), train_poison_data_count: 385
Global model norm: 43.29065782230041.
Norm before scaling: 43.269112129244405. Distance: 1.3940633207796336
Total norm for 4 adversaries is: 43.269112129244405. distance: 1.3940633207796336
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0654, Accuracy: 9738/9900 (98.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5040/5305 (95.0047%), train_poison_data_count: 415
Global model norm: 43.29065782230041.
Norm before scaling: 43.272787981449724. Distance: 1.5704427636618878
Total norm for 4 adversaries is: 43.272787981449724. distance: 1.5704427636618878
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1109, Accuracy: 9602/9900 (96.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4479/4717 (94.9544%), train_poison_data_count: 370
Global model norm: 43.29065782230041.
Norm before scaling: 43.27282888518571. Distance: 1.4528382541394758
Total norm for 4 adversaries is: 43.27282888518571. distance: 1.4528382541394758
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0456, Accuracy: 9768/9900 (98.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4831/5066 (95.3612%), train_poison_data_count: 400
Global model norm: 43.29065782230041.
Norm before scaling: 43.27365964580099. Distance: 1.514923956067309
Total norm for 4 adversaries is: 43.27365964580099. distance: 1.514923956067309
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0515, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4624/5116 (90.3831%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4533/5116 (88.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0605, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5186/5582 (92.9058%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1549, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4402/4928 (89.3263%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4461/4928 (90.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0433, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3847/4126 (93.2380%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7989, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3701/4158 (89.0091%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3673/4158 (88.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9676, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4553/5063 (89.9269%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4398/5063 (86.8655%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2000, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5476/6124 (89.4187%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5423/6124 (88.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9647, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3986/4354 (91.5480%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3814/4354 (87.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3988, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4580/5025 (91.1443%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5025 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0515, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4349/4679 (92.9472%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4139/4679 (88.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2746, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4402/4793 (91.8423%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4453/4793 (92.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8493, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4168/4518 (92.2532%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9571, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4733/5167 (91.6005%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2732, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4157/4433 (93.7740%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4068/4433 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8515, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4141/4503 (91.9609%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4067/4503 (90.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1213, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4347/4707 (92.3518%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4276/4707 (90.8434%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8675, Accuracy: 5743/10000 (57.4300%)
time spent on training: 265.7197263240814
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1902, Accuracy: 6911/10000 (69.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.4276, Accuracy: 8814/9900 (89.0303%)
Done in 293.0414204597473 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4677/4885 (95.7421%), train_poison_data_count: 385
Global model norm: 43.31393452260052.
Norm before scaling: 43.294608159713434. Distance: 1.4279045285385328
Total norm for 4 adversaries is: 43.294608159713434. distance: 1.4279045285385328
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2158, Accuracy: 9368/9900 (94.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5013/5305 (94.4958%), train_poison_data_count: 415
Global model norm: 43.31393452260052.
Norm before scaling: 43.29497469665937. Distance: 1.5749727246783785
Total norm for 4 adversaries is: 43.29497469665937. distance: 1.5749727246783785
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1160, Accuracy: 9593/9900 (96.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4497/4717 (95.3360%), train_poison_data_count: 370
Global model norm: 43.31393452260052.
Norm before scaling: 43.2918956898618. Distance: 1.3663337875877928
Total norm for 4 adversaries is: 43.2918956898618. distance: 1.3663337875877928
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0947, Accuracy: 9651/9900 (97.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4843/5066 (95.5981%), train_poison_data_count: 400
Global model norm: 43.31393452260052.
Norm before scaling: 43.296800286384475. Distance: 1.4922959053646467
Total norm for 4 adversaries is: 43.296800286384475. distance: 1.4922959053646467
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1806, Accuracy: 9449/9900 (95.4444%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3385/3704 (91.3877%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3384/3704 (91.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9220, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4913/5392 (91.1165%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4790/5392 (88.8353%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1311, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4074/4362 (93.3975%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4053/4362 (92.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9230, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4226/4538 (93.1247%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4241/4538 (93.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8751, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3847/4184 (91.9455%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3791/4184 (90.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8608, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3477/3756 (92.5719%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3514/3756 (93.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9661, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4322/4679 (92.3702%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1276, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3221/3472 (92.7707%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3214/3472 (92.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1540, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5704/6391 (89.2505%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5583/6391 (87.3572%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1795, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4771/5265 (90.6173%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4508/5265 (85.6220%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1492, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5277/5902 (89.4104%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5129/5902 (86.9027%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3312, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5429/6124 (88.6512%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5379/6124 (87.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1538, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4632/5083 (91.1273%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4589/5083 (90.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0323, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4134/4465 (92.5868%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4131/4465 (92.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8341, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3488/3804 (91.6930%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3502/3804 (92.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9564, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4546/4918 (92.4359%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4473/4918 (90.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9956, Accuracy: 5494/10000 (54.9400%)
time spent on training: 264.4968500137329
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1922, Accuracy: 6918/10000 (69.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.4200, Accuracy: 8833/9900 (89.2222%)
Done in 291.8824543952942 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4685/4885 (95.9058%), train_poison_data_count: 385
Global model norm: 43.33690014367087.
Norm before scaling: 43.31674988168549. Distance: 1.4138781179697757
Total norm for 4 adversaries is: 43.31674988168549. distance: 1.4138781179697757
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1134, Accuracy: 9617/9900 (97.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5028/5305 (94.7785%), train_poison_data_count: 415
Global model norm: 43.33690014367087.
Norm before scaling: 43.318233578385474. Distance: 1.5668551974116056
Total norm for 4 adversaries is: 43.318233578385474. distance: 1.5668551974116056
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0452, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4517/4717 (95.7600%), train_poison_data_count: 370
Global model norm: 43.33690014367087.
Norm before scaling: 43.31513508849274. Distance: 1.2984676922204008
Total norm for 4 adversaries is: 43.31513508849274. distance: 1.2984676922204008
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0952, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4843/5066 (95.5981%), train_poison_data_count: 400
Global model norm: 43.33690014367087.
Norm before scaling: 43.31922268128709. Distance: 1.4984605359801821
Total norm for 4 adversaries is: 43.31922268128709. distance: 1.4984605359801821
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1102, Accuracy: 9600/9900 (96.9697%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4231/4538 (93.2349%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4242/4538 (93.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8466, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4474/4989 (89.6773%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4494/4989 (90.0782%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9550, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4416/4793 (92.1344%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9643, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3703/4158 (89.0572%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3709/4158 (89.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9425, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3577/3861 (92.6444%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3492/3861 (90.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0862, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4730/5232 (90.4052%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4656/5232 (88.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3326, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4267/4663 (91.5076%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4346/4663 (93.2018%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9007, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4759/5197 (91.5721%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4649/5197 (89.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0365, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4766/5167 (92.2392%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0761, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4030/4416 (91.2591%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8512, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4018/4354 (92.2830%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3632/4354 (83.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.5245, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5002/5455 (91.6957%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4933/5455 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0488, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4146/4456 (93.0431%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4119/4456 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9202, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2968/3271 (90.7368%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2999/3271 (91.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8972, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3086/3297 (93.6002%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3072/3297 (93.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.6888, Accuracy: 5986/10000 (59.8600%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5069/5591 (90.6636%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4884/5591 (87.3547%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2640, Accuracy: 5021/10000 (50.2100%)
time spent on training: 262.7232577800751
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1940, Accuracy: 6912/10000 (69.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3890, Accuracy: 8892/9900 (89.8182%)
Done in 290.1007990837097 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4663/4885 (95.4555%), train_poison_data_count: 385
Global model norm: 43.358621896612874.
Norm before scaling: 43.338998590508815. Distance: 1.4433900161402105
Total norm for 4 adversaries is: 43.338998590508815. distance: 1.4433900161402105
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0546, Accuracy: 9745/9900 (98.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5063/5305 (95.4383%), train_poison_data_count: 415
Global model norm: 43.358621896612874.
Norm before scaling: 43.336035385007534. Distance: 1.4867751142408618
Total norm for 4 adversaries is: 43.336035385007534. distance: 1.4867751142408618
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1375, Accuracy: 9548/9900 (96.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4521/4717 (95.8448%), train_poison_data_count: 370
Global model norm: 43.358621896612874.
Norm before scaling: 43.33746772018916. Distance: 1.388534603496806
Total norm for 4 adversaries is: 43.33746772018916. distance: 1.388534603496806
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0362, Accuracy: 9803/9900 (99.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4792/5066 (94.5914%), train_poison_data_count: 400
Global model norm: 43.358621896612874.
Norm before scaling: 43.345487640908196. Distance: 1.6178781260221706
Total norm for 4 adversaries is: 43.345487640908196. distance: 1.6178781260221706
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0679, Accuracy: 9737/9900 (98.3535%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4710/5167 (91.1554%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4721/5167 (91.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0709, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3483/3775 (92.2649%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3553/3775 (94.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8764, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4726/5195 (90.9721%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4684/5195 (90.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2121, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3783/4126 (91.6869%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3797/4126 (92.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8666, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3607/3911 (92.2271%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3439/3911 (87.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1118, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4112/4433 (92.7589%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4120/4433 (92.9393%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8104, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2917/3271 (89.1776%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0262, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3361/3590 (93.6212%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3269/3590 (91.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0923, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4504/4918 (91.5819%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4555/4918 (92.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0319, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4556/4986 (91.3759%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4550/4986 (91.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9997, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3274/3616 (90.5420%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3338/3616 (92.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9335, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3933/4295 (91.5716%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3923/4295 (91.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9708, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4038/4356 (92.6997%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3820/4356 (87.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2707, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4446/4793 (92.7603%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4437/4793 (92.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8955, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4007/4315 (92.8621%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3964/4315 (91.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9223, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4374/4804 (91.0491%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4371/4804 (90.9867%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1844, Accuracy: 5387/10000 (53.8700%)
time spent on training: 258.41086983680725
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1932, Accuracy: 6909/10000 (69.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3706, Accuracy: 8928/9900 (90.1818%)
Done in 285.86084270477295 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4693/4885 (96.0696%), train_poison_data_count: 385
Global model norm: 43.37851632675947.
Norm before scaling: 43.35448874494932. Distance: 1.3470098299660425
Total norm for 4 adversaries is: 43.35448874494932. distance: 1.3470098299660425
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1124, Accuracy: 9611/9900 (97.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5061/5305 (95.4006%), train_poison_data_count: 415
Global model norm: 43.37851632675947.
Norm before scaling: 43.35630901322205. Distance: 1.5016843557780135
Total norm for 4 adversaries is: 43.35630901322205. distance: 1.5016843557780135
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0247, Accuracy: 9829/9900 (99.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4501/4717 (95.4208%), train_poison_data_count: 370
Global model norm: 43.37851632675947.
Norm before scaling: 43.355263037004086. Distance: 1.3521433998641126
Total norm for 4 adversaries is: 43.355263037004086. distance: 1.3521433998641126
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0291, Accuracy: 9819/9900 (99.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4821/5066 (95.1638%), train_poison_data_count: 400
Global model norm: 43.37851632675947.
Norm before scaling: 43.35967342239647. Distance: 1.5033944187878252
Total norm for 4 adversaries is: 43.35967342239647. distance: 1.5033944187878252
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0964, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4173/4503 (92.6716%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4090/4503 (90.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0164, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4430/4934 (89.7852%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4260/4934 (86.3397%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.5641, Accuracy: 4753/10000 (47.5300%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4405/4804 (91.6944%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4193/4804 (87.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2967, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4114/4456 (92.3250%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4147/4456 (93.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8069, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4256/4651 (91.5072%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4274/4651 (91.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0649, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3860/4184 (92.2562%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3839/4184 (91.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9422, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1059, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3490/3775 (92.4503%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3580/3775 (94.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9354, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4602/5083 (90.5371%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4523/5083 (88.9829%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1648, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5020/5455 (92.0257%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4915/5455 (90.1008%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0690, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3353/3638 (92.1660%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3368/3638 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8539, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3575/3911 (91.4088%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3499/3911 (89.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1188, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3553/3837 (92.5984%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3590/3837 (93.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8510, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4147/4501 (92.1351%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4114/4501 (91.4019%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9645, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4785/5197 (92.0723%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4696/5197 (90.3598%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2063, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3557/3861 (92.1264%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3503/3861 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9287, Accuracy: 5600/10000 (56.0000%)
time spent on training: 256.7534158229828
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.2081, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.3249, Accuracy: 9031/9900 (91.2222%)
Done in 283.87843132019043 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4689/4885 (95.9877%), train_poison_data_count: 385
Global model norm: 43.39963924416236.
Norm before scaling: 43.37749480622483. Distance: 1.3782363431417568
Total norm for 4 adversaries is: 43.37749480622483. distance: 1.3782363431417568
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1060, Accuracy: 9611/9900 (97.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5067/5305 (95.5137%), train_poison_data_count: 415
Global model norm: 43.39963924416236.
Norm before scaling: 43.37627485968712. Distance: 1.4957932451803861
Total norm for 4 adversaries is: 43.37627485968712. distance: 1.4957932451803861
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0527, Accuracy: 9770/9900 (98.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4542/4717 (96.2900%), train_poison_data_count: 370
Global model norm: 43.39963924416236.
Norm before scaling: 43.37509568613365. Distance: 1.2702290656548187
Total norm for 4 adversaries is: 43.37509568613365. distance: 1.2702290656548187
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0832, Accuracy: 9702/9900 (98.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4830/5066 (95.3415%), train_poison_data_count: 400
Global model norm: 43.39963924416236.
Norm before scaling: 43.3847152866976. Distance: 1.5243271797440248
Total norm for 4 adversaries is: 43.3847152866976. distance: 1.5243271797440248
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0592, Accuracy: 9748/9900 (98.4646%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2986/3271 (91.2871%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3028/3271 (92.5711%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9332, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4049/4511 (89.7584%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4030/4511 (89.3372%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1336, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3321/3638 (91.2864%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3357/3638 (92.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0198, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5184/5582 (92.8699%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5063/5582 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0038, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4126/4456 (92.5943%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4153/4456 (93.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0370, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5341/5902 (90.4947%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5043/5902 (85.4456%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1637, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4010/4416 (90.8062%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4044/4416 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8356, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4934 (90.7175%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4290/4934 (86.9477%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3507, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4228/4596 (91.9930%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4305/4596 (93.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9439, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3545/3837 (92.3899%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3533/3837 (92.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9156, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5719/6391 (89.4852%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5571/6391 (87.1695%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2192, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3991/4368 (91.3690%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3914/4368 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1045, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3513/3804 (92.3502%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3485/3804 (91.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8517, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5714/6263 (91.2342%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5642/6263 (90.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2005, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4430/4793 (92.4265%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4403/4793 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1064, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4954/5424 (91.3348%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3574, Accuracy: 5033/10000 (50.3300%)
time spent on training: 264.17043685913086
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2099, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.3086, Accuracy: 9079/9900 (91.7071%)
Done in 291.71724247932434 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.42201415729771.
Norm before scaling: 43.39974050136634. Distance: 1.3665053927625375
Total norm for 4 adversaries is: 43.39974050136634. distance: 1.3665053927625375
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0824, Accuracy: 9691/9900 (97.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.42201415729771.
Norm before scaling: 43.40120870427675. Distance: 1.5124641571842183
Total norm for 4 adversaries is: 43.40120870427675. distance: 1.5124641571842183
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1988, Accuracy: 9425/9900 (95.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4525/4717 (95.9296%), train_poison_data_count: 370
Global model norm: 43.42201415729771.
Norm before scaling: 43.39871948040705. Distance: 1.3197167310790285
Total norm for 4 adversaries is: 43.39871948040705. distance: 1.3197167310790285
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0654, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4832/5066 (95.3810%), train_poison_data_count: 400
Global model norm: 43.42201415729771.
Norm before scaling: 43.402565763371065. Distance: 1.497232267872537
Total norm for 4 adversaries is: 43.402565763371065. distance: 1.497232267872537
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1224, Accuracy: 9543/9900 (96.3939%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4649/5055 (91.9683%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4648/5055 (91.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9555, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3867/4184 (92.4235%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3821/4184 (91.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8599, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3593/3861 (93.0588%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3567/3861 (92.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8402, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4340/4804 (90.3414%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0133, Accuracy: 3646/4804 (75.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.7992, Accuracy: 4178/10000 (41.7800%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3214/3472 (92.5691%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0426, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3613/3969 (91.0305%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3604/3969 (90.8037%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8957, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4509/4989 (90.3788%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4473/4989 (89.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0697, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5173/5582 (92.6729%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5065/5582 (90.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0442, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4411/4793 (92.0300%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4436/4793 (92.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0270, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4253/4662 (91.2269%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4257/4662 (91.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0125, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4437/4934 (89.9270%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4281/4934 (86.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3632, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4605/4986 (92.3586%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4603/4986 (92.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0100, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4122/4433 (92.9844%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8796, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4254/4716 (90.2036%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4281/4716 (90.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9916, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4233/4596 (92.1018%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4268/4596 (92.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1320, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4002/4354 (91.9155%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3692/4354 (84.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2532, Accuracy: 5030/10000 (50.3000%)
time spent on training: 262.25678992271423
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2106, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3087, Accuracy: 9069/9900 (91.6061%)
Done in 289.6271493434906 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4700/4885 (96.2129%), train_poison_data_count: 385
Global model norm: 43.4442834181754.
Norm before scaling: 43.42216455912809. Distance: 1.3617169168430405
Total norm for 4 adversaries is: 43.42216455912809. distance: 1.3617169168430405
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0241, Accuracy: 9836/9900 (99.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5051/5305 (95.2121%), train_poison_data_count: 415
Global model norm: 43.4442834181754.
Norm before scaling: 43.42080951823388. Distance: 1.4989272096047905
Total norm for 4 adversaries is: 43.42080951823388. distance: 1.4989272096047905
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0321, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4509/4717 (95.5904%), train_poison_data_count: 370
Global model norm: 43.4442834181754.
Norm before scaling: 43.422843469318515. Distance: 1.367209167308776
Total norm for 4 adversaries is: 43.422843469318515. distance: 1.367209167308776
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1084, Accuracy: 9613/9900 (97.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4842/5066 (95.5784%), train_poison_data_count: 400
Global model norm: 43.4442834181754.
Norm before scaling: 43.426485226652005. Distance: 1.5036250656626435
Total norm for 4 adversaries is: 43.426485226652005. distance: 1.5036250656626435
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0921, Accuracy: 9653/9900 (97.5051%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4707/5116 (92.0055%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4598/5116 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9870, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4305/4662 (92.3423%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4304/4662 (92.3209%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9781, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5320/5902 (90.1389%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5126/5902 (86.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4048, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4586/5063 (90.5787%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4574/5063 (90.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1963, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3991/4354 (91.6628%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0209, Accuracy: 2794/4354 (64.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.9330, Accuracy: 3757/10000 (37.5700%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4708/5195 (90.6256%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4635/5195 (89.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1128, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3667/4356 (84.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4427, Accuracy: 4702/10000 (47.0200%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3972/4295 (92.4796%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3956/4295 (92.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9796, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5774/6263 (92.1922%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5670/6263 (90.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1111, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4111/4511 (91.1328%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4100/4511 (90.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9656, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4323/4663 (92.7086%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4329/4663 (92.8372%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9461, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3961/4336 (91.3515%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4005/4336 (92.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0594, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4382/4928 (88.9205%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0338, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3770/4046 (93.1784%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3796/4046 (93.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9611, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3370/3672 (91.7756%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3346/3672 (91.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8297, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4021/4356 (92.3095%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4045/4356 (92.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0244, Accuracy: 5520/10000 (55.2000%)
time spent on training: 264.2071771621704
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2081, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2899, Accuracy: 9118/9900 (92.1010%)
Done in 291.55477261543274 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4711/4885 (96.4381%), train_poison_data_count: 385
Global model norm: 43.46728127011885.
Norm before scaling: 43.442967000838436. Distance: 1.3186936244394787
Total norm for 4 adversaries is: 43.442967000838436. distance: 1.3186936244394787
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0794, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5063/5305 (95.4383%), train_poison_data_count: 415
Global model norm: 43.46728127011885.
Norm before scaling: 43.4476634917302. Distance: 1.5538296273559078
Total norm for 4 adversaries is: 43.4476634917302. distance: 1.5538296273559078
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0362, Accuracy: 9823/9900 (99.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4494/4717 (95.2724%), train_poison_data_count: 370
Global model norm: 43.46728127011885.
Norm before scaling: 43.44590324517448. Distance: 1.3841935066791782
Total norm for 4 adversaries is: 43.44590324517448. distance: 1.3841935066791782
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1296, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4836/5066 (95.4599%), train_poison_data_count: 400
Global model norm: 43.46728127011885.
Norm before scaling: 43.447753398658314. Distance: 1.5143520082372839
Total norm for 4 adversaries is: 43.447753398658314. distance: 1.5143520082372839
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0436, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4554/5037 (90.4110%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4659/5037 (92.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8979, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4241/4647 (91.2632%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4235/4647 (91.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0015, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4347/4663 (93.2232%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4272/4663 (91.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0950, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3991/4336 (92.0434%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3941/4336 (90.8902%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0726, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3517/3756 (93.6368%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3543/3756 (94.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8701, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4171/4625 (90.1838%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4091/4625 (88.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.3206, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4050/4362 (92.8473%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4106/4362 (94.1311%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1637, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4414/4874 (90.5622%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4423/4874 (90.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0376, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4308/4767 (90.3713%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4262/4767 (89.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2361, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3508/3775 (92.9272%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3560/3775 (94.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7769, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4327/4662 (92.8142%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4194/4662 (89.9614%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9622, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5523/6124 (90.1862%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5469/6124 (89.3044%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0359, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4103/4511 (90.9554%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4108/4511 (91.0663%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0487, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3641/3911 (93.0964%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3533/3911 (90.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8062, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5047/5591 (90.2701%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4932/5591 (88.2132%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2211, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3806/4126 (92.2443%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3812/4126 (92.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8317, Accuracy: 5770/10000 (57.7000%)
time spent on training: 263.3862051963806
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2075, Accuracy: 6892/10000 (68.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2833, Accuracy: 9132/9900 (92.2424%)
Done in 291.0838792324066 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4699/4885 (96.1924%), train_poison_data_count: 385
Global model norm: 43.48807195477571.
Norm before scaling: 43.465756322146866. Distance: 1.3979048753554737
Total norm for 4 adversaries is: 43.465756322146866. distance: 1.3979048753554737
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0164, Accuracy: 9857/9900 (99.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5072/5305 (95.6079%), train_poison_data_count: 415
Global model norm: 43.48807195477571.
Norm before scaling: 43.46781765714722. Distance: 1.5529634510659547
Total norm for 4 adversaries is: 43.46781765714722. distance: 1.5529634510659547
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0117, Accuracy: 9867/9900 (99.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4517/4717 (95.7600%), train_poison_data_count: 370
Global model norm: 43.48807195477571.
Norm before scaling: 43.46562994284248. Distance: 1.3471197857316477
Total norm for 4 adversaries is: 43.46562994284248. distance: 1.3471197857316477
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0198, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4840/5066 (95.5389%), train_poison_data_count: 400
Global model norm: 43.48807195477571.
Norm before scaling: 43.46981430670454. Distance: 1.4930585944960468
Total norm for 4 adversaries is: 43.46981430670454. distance: 1.4930585944960468
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0461, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4641/5025 (92.3582%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4558/5025 (90.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1343, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4673/5116 (91.3409%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4616/5116 (90.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1731, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4713/5167 (91.2135%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4708/5167 (91.1167%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0907, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4167/4558 (91.4217%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4105/4558 (90.0614%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1807, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4281/4651 (92.0447%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4218/4651 (90.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0859, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4029/4336 (92.9197%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3993/4336 (92.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9532, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4653/5055 (92.0475%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4666/5055 (92.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9382, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3542/3775 (93.8278%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3569/3775 (94.5430%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8416, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4763/5265 (90.4653%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4693/5265 (89.1358%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0398, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3736/4025 (92.8199%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3780/4025 (93.9130%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8484, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4572/4989 (91.6416%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4476/4989 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8682, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4451/4793 (92.8646%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4447/4793 (92.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8701, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3506/3804 (92.1661%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3535/3804 (92.9285%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8525, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3516/3797 (92.5994%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3521/3797 (92.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9590, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4131/4433 (93.1875%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4100/4433 (92.4882%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8221, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4363/4707 (92.6917%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4323/4707 (91.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8348, Accuracy: 5757/10000 (57.5700%)
time spent on training: 260.70711755752563
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2098, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2718, Accuracy: 9166/9900 (92.5859%)
Done in 287.9668116569519 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.508716630711625.
Norm before scaling: 43.484349734990865. Distance: 1.3107516133096397
Total norm for 4 adversaries is: 43.484349734990865. distance: 1.3107516133096397
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0780, Accuracy: 9697/9900 (97.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5078/5305 (95.7210%), train_poison_data_count: 415
Global model norm: 43.508716630711625.
Norm before scaling: 43.48385285349465. Distance: 1.4626816726397012
Total norm for 4 adversaries is: 43.48385285349465. distance: 1.4626816726397012
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0489, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4528/4717 (95.9932%), train_poison_data_count: 370
Global model norm: 43.508716630711625.
Norm before scaling: 43.48379951559546. Distance: 1.3089927862039983
Total norm for 4 adversaries is: 43.48379951559546. distance: 1.3089927862039983
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1717, Accuracy: 9456/9900 (95.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4835/5066 (95.4402%), train_poison_data_count: 400
Global model norm: 43.508716630711625.
Norm before scaling: 43.488281074564355. Distance: 1.45166015625
Total norm for 4 adversaries is: 43.488281074564355. distance: 1.45166015625
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0830, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4951/5392 (91.8212%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4875/5392 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1910, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4297/4663 (92.1510%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4320/4663 (92.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9802, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3530/3797 (92.9681%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3450/3797 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9825, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5184/5582 (92.8699%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5077/5582 (90.9531%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9946, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4731/5167 (91.5618%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4690/5167 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1189, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3502/3781 (92.6210%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3316/3781 (87.7017%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1288, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3693/3969 (93.0461%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3675/3969 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0387, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3533/3837 (92.0771%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3573/3837 (93.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9346, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5352/5902 (90.6811%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5203/5902 (88.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1678, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5010/5455 (91.8423%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4903/5455 (89.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0238, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4547/5037 (90.2720%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4521/5037 (89.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9943, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4606/5017 (91.8079%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4596/5017 (91.6085%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9244, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4553/4986 (91.3157%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4518/4986 (90.6137%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9723, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4761/5197 (91.6105%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4666/5197 (89.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1523, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3988/4361 (91.4469%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3795/4361 (87.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1652, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5785/6263 (92.3679%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5734/6263 (91.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1289, Accuracy: 5335/10000 (53.3500%)
time spent on training: 264.55325269699097
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2014, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2756, Accuracy: 9157/9900 (92.4949%)
Done in 291.61468601226807 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4727/4885 (96.7656%), train_poison_data_count: 385
Global model norm: 43.531736525906446.
Norm before scaling: 43.504478487133944. Distance: 1.2943200371316623
Total norm for 4 adversaries is: 43.504478487133944. distance: 1.2943200371316623
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1039, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5102/5305 (96.1734%), train_poison_data_count: 415
Global model norm: 43.531736525906446.
Norm before scaling: 43.50912625395748. Distance: 1.4935493047115145
Total norm for 4 adversaries is: 43.50912625395748. distance: 1.4935493047115145
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0462, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4521/4717 (95.8448%), train_poison_data_count: 370
Global model norm: 43.531736525906446.
Norm before scaling: 43.507099142338255. Distance: 1.3095594799666164
Total norm for 4 adversaries is: 43.507099142338255. distance: 1.3095594799666164
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0490, Accuracy: 9774/9900 (98.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4866/5066 (96.0521%), train_poison_data_count: 400
Global model norm: 43.531736525906446.
Norm before scaling: 43.50881342559373. Distance: 1.4266447613867514
Total norm for 4 adversaries is: 43.50881342559373. distance: 1.4266447613867514
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0729, Accuracy: 9698/9900 (97.9596%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4630/5017 (92.2862%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4588/5017 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7657, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4443/4928 (90.1583%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4439/4928 (90.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0912, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3910/4184 (93.4512%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3841/4184 (91.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9362, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4456/4793 (92.9689%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4439/4793 (92.6142%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9962, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5256/5740 (91.5679%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5159/5740 (89.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1571, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3518/3756 (93.6635%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3572/3756 (95.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8014, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3952/4235 (93.3176%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3862/4235 (91.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9133, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3869/4223 (91.6173%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3880/4223 (91.8778%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7626, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4544/5063 (89.7492%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4323/5063 (85.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2742, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4554/4989 (91.2808%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4446/4989 (89.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0851, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4532/4928 (91.9643%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4487/4928 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9226, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5318/5902 (90.1050%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5088/5902 (86.2081%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4191, Accuracy: 4870/10000 (48.7000%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4166/4456 (93.4919%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4169/4456 (93.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8595, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5505/6124 (89.8922%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5452/6124 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0224, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3583/3828 (93.5998%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3595/3828 (93.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7482, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3342/3616 (92.4226%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3336/3616 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8510, Accuracy: 5731/10000 (57.3100%)
time spent on training: 263.1299889087677
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2091, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2491, Accuracy: 9219/9900 (93.1212%)
Done in 290.44877314567566 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.553691832789845.
Norm before scaling: 43.528797658400094. Distance: 1.342378315445599
Total norm for 4 adversaries is: 43.528797658400094. distance: 1.342378315445599
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1149, Accuracy: 9595/9900 (96.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5058/5305 (95.3440%), train_poison_data_count: 415
Global model norm: 43.553691832789845.
Norm before scaling: 43.53149116049495. Distance: 1.5101876797787477
Total norm for 4 adversaries is: 43.53149116049495. distance: 1.5101876797787477
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1134, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4552/4717 (96.5020%), train_poison_data_count: 370
Global model norm: 43.553691832789845.
Norm before scaling: 43.53000211330543. Distance: 1.293447400147585
Total norm for 4 adversaries is: 43.53000211330543. distance: 1.293447400147585
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0601, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4869/5066 (96.1113%), train_poison_data_count: 400
Global model norm: 43.553691832789845.
Norm before scaling: 43.5306358759624. Distance: 1.437192718171237
Total norm for 4 adversaries is: 43.5306358759624. distance: 1.437192718171237
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0603, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3840/4223 (90.9306%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9917, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4089/4362 (93.7414%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2394, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5740/6391 (89.8138%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5543/6391 (86.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2594, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4414/4793 (92.0926%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4373/4793 (91.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0961, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3514/3756 (93.5570%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3547/3756 (94.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9404, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4293/4618 (92.9623%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4174/4618 (90.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0940, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3721/4025 (92.4472%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3742/4025 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8720, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3294/3638 (90.5443%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8558, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4043/4315 (93.6964%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4039/4315 (93.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8643, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3971/4295 (92.4563%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3596/4295 (83.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2035, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4519/4928 (91.7005%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4455/4928 (90.4018%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9004, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4567/4986 (91.5965%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4553/4986 (91.3157%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8907, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3831/4126 (92.8502%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3786/4126 (91.7596%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8506, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4544/4918 (92.3953%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4510/4918 (91.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1997, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4715/5195 (90.7603%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4570/5195 (87.9692%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1080, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5231/5740 (91.1324%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5207/5740 (90.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2655, Accuracy: 5181/10000 (51.8100%)
time spent on training: 262.4653573036194
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2115, Accuracy: 6873/10000 (68.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2438, Accuracy: 9235/9900 (93.2828%)
Done in 289.99702858924866 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4705/4885 (96.3153%), train_poison_data_count: 385
Global model norm: 43.57533773355922.
Norm before scaling: 43.550439114552134. Distance: 1.3686078786006373
Total norm for 4 adversaries is: 43.550439114552134. distance: 1.3686078786006373
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0349, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5075/5305 (95.6645%), train_poison_data_count: 415
Global model norm: 43.57533773355922.
Norm before scaling: 43.55218812895986. Distance: 1.4784595876981774
Total norm for 4 adversaries is: 43.55218812895986. distance: 1.4784595876981774
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0893, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4533/4717 (96.0992%), train_poison_data_count: 370
Global model norm: 43.57533773355922.
Norm before scaling: 43.55097728031269. Distance: 1.29940746264987
Total norm for 4 adversaries is: 43.55097728031269. distance: 1.29940746264987
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1016, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4841/5066 (95.5586%), train_poison_data_count: 400
Global model norm: 43.57533773355922.
Norm before scaling: 43.55391745395513. Distance: 1.4704586398298305
Total norm for 4 adversaries is: 43.55391745395513. distance: 1.4704586398298305
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0939, Accuracy: 9660/9900 (97.5758%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3068/3297 (93.0543%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3087/3297 (93.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7546, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3580/3828 (93.5214%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8924, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4568/5063 (90.2232%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4357/5063 (86.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0452, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4103/4501 (91.1575%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4098/4501 (91.0464%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1200, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4417/4793 (92.1552%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0047, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3898/4223 (92.3040%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9353, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3559/3756 (94.7551%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3569/3756 (95.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7407, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3330/3638 (91.5338%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3386/3638 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7849, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3347/3646 (91.7992%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3368/3646 (92.3752%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9520, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4438/4874 (91.0546%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4376/4874 (89.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2578, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5755/6263 (91.8889%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5682/6263 (90.7233%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1042, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4537/5037 (90.0735%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4545/5037 (90.2323%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0300, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4099/4362 (93.9707%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4042/4362 (92.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8950, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3840/4356 (88.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2026, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4676/5116 (91.3995%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4605/5116 (90.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9566, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4062/4346 (93.4653%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4078/4346 (93.8334%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8476, Accuracy: 5753/10000 (57.5300%)
time spent on training: 257.9976694583893
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2142, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2254, Accuracy: 9286/9900 (93.7980%)
Done in 285.4119830131531 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4712/4885 (96.4585%), train_poison_data_count: 385
Global model norm: 43.595375473727856.
Norm before scaling: 43.56941104836698. Distance: 1.3091204593856163
Total norm for 4 adversaries is: 43.56941104836698. distance: 1.3091204593856163
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1210, Accuracy: 9592/9900 (96.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5067/5305 (95.5137%), train_poison_data_count: 415
Global model norm: 43.595375473727856.
Norm before scaling: 43.57027257596342. Distance: 1.4634507536791985
Total norm for 4 adversaries is: 43.57027257596342. distance: 1.4634507536791985
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0975, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4549/4717 (96.4384%), train_poison_data_count: 370
Global model norm: 43.595375473727856.
Norm before scaling: 43.569572148318144. Distance: 1.2764661848323706
Total norm for 4 adversaries is: 43.569572148318144. distance: 1.2764661848323706
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0799, Accuracy: 9698/9900 (97.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4855/5066 (95.8350%), train_poison_data_count: 400
Global model norm: 43.595375473727856.
Norm before scaling: 43.573116196550885. Distance: 1.4644508750493268
Total norm for 4 adversaries is: 43.573116196550885. distance: 1.4644508750493268
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1333, Accuracy: 9526/9900 (96.2222%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4173/4518 (92.3639%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9340, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4164/4558 (91.3559%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4093/4558 (89.7982%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2139, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3527/3804 (92.7182%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3531/3804 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8626, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3525/3775 (93.3775%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3590/3775 (95.0993%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.6926, Accuracy: 6031/10000 (60.3100%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4639/5083 (91.2650%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4574/5083 (89.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1692, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4587/4928 (93.0804%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4524/4928 (91.8019%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8780, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4694/5244 (89.5118%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4585/5244 (87.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3503, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4494/4989 (90.0782%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4457/4989 (89.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0629, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4594/4986 (92.1380%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4553/4986 (91.3157%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8685, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3846/4175 (92.1198%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3796/4175 (90.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9429, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4763/5232 (91.0359%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4705/5232 (89.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1121, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4569/5063 (90.2429%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4272/5063 (84.3769%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3407, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4158/4441 (93.6276%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4144/4441 (93.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9626, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3339/3646 (91.5798%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3385/3646 (92.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8609, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4745/5167 (91.8328%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4746/5167 (91.8521%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1269, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4223/4538 (93.0586%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4180/4538 (92.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8680, Accuracy: 5645/10000 (56.4500%)
time spent on training: 261.2643690109253
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2155, Accuracy: 6872/10000 (68.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2225, Accuracy: 9291/9900 (93.8485%)
Done in 288.4299805164337 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4718/4885 (96.5814%), train_poison_data_count: 385
Global model norm: 43.616775393226.
Norm before scaling: 43.59162461216747. Distance: 1.3271816718267921
Total norm for 4 adversaries is: 43.59162461216747. distance: 1.3271816718267921
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0865, Accuracy: 9676/9900 (97.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5082/5305 (95.7964%), train_poison_data_count: 415
Global model norm: 43.616775393226.
Norm before scaling: 43.59119616175381. Distance: 1.447795734798358
Total norm for 4 adversaries is: 43.59119616175381. distance: 1.447795734798358
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0552, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4505/4717 (95.5056%), train_poison_data_count: 370
Global model norm: 43.616775393226.
Norm before scaling: 43.59372339828938. Distance: 1.3785453518618431
Total norm for 4 adversaries is: 43.59372339828938. distance: 1.3785453518618431
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0217, Accuracy: 9840/9900 (99.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4859/5066 (95.9139%), train_poison_data_count: 400
Global model norm: 43.616775393226.
Norm before scaling: 43.593136756439364. Distance: 1.4051835148653071
Total norm for 4 adversaries is: 43.593136756439364. distance: 1.4051835148653071
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0499, Accuracy: 9772/9900 (98.7071%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4091/4356 (93.9164%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3829/4356 (87.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2046, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4488/4928 (91.0714%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4420/4928 (89.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0742, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4587/5037 (91.0661%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4610/5037 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0102, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4393/4804 (91.4446%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4172/4804 (86.8443%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2839, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3547/3775 (93.9603%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3611/3775 (95.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7055, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4764/5167 (92.2005%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4730/5167 (91.5425%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0557, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3928/4235 (92.7509%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3940/4235 (93.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9928, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4503/4956 (90.8596%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4384/4956 (88.4584%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0288, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5248/5740 (91.4286%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5209/5740 (90.7491%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2160, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4362/4679 (93.2250%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4290/4679 (91.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1689, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3430/3704 (92.6026%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3448/3704 (93.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7964, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3245/3472 (93.4620%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3216/3472 (92.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9056, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4287/4651 (92.1737%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4273/4651 (91.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9772, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4206/4634 (90.7639%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4186/4634 (90.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9412, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5345/5902 (90.5625%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5126/5902 (86.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2332, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3552/3837 (92.5723%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3622/3837 (94.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8546, Accuracy: 5762/10000 (57.6200%)
time spent on training: 262.05173659324646
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2178, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2128, Accuracy: 9325/9900 (94.1919%)
Done in 289.5218873023987 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4715/4885 (96.5200%), train_poison_data_count: 385
Global model norm: 43.63786550307041.
Norm before scaling: 43.61092151727521. Distance: 1.3094648963094613
Total norm for 4 adversaries is: 43.61092151727521. distance: 1.3094648963094613
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0776, Accuracy: 9690/9900 (97.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5071/5305 (95.5891%), train_poison_data_count: 415
Global model norm: 43.63786550307041.
Norm before scaling: 43.61348539612992. Distance: 1.4896530277336024
Total norm for 4 adversaries is: 43.61348539612992. distance: 1.4896530277336024
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0708, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4537/4717 (96.1840%), train_poison_data_count: 370
Global model norm: 43.63786550307041.
Norm before scaling: 43.61299418428813. Distance: 1.329227259379882
Total norm for 4 adversaries is: 43.61299418428813. distance: 1.329227259379882
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0208, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4858/5066 (95.8942%), train_poison_data_count: 400
Global model norm: 43.63786550307041.
Norm before scaling: 43.61693631823609. Distance: 1.4712508803942694
Total norm for 4 adversaries is: 43.61693631823609. distance: 1.4712508803942694
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0897, Accuracy: 9657/9900 (97.5455%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3663/3969 (92.2902%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3661/3969 (92.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8912, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4334/4707 (92.0756%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4272/4707 (90.7584%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8538, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3603/3861 (93.3178%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3581/3861 (92.7480%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8219, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4233/4596 (92.1018%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4214/4596 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0108, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4170/4503 (92.6049%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4099/4503 (91.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1467, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4601/4928 (93.3644%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4557/4928 (92.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0036, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4617/5025 (91.8806%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4552/5025 (90.5871%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1679, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4242/4576 (92.7010%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4239/4576 (92.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9483, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4516/4918 (91.8259%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4503/4918 (91.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9638, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4056/4315 (93.9977%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3992/4315 (92.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9671, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3344/3590 (93.1476%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3312/3590 (92.2563%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9434, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4149/4456 (93.1104%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9062, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4014/4354 (92.1911%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3742/4354 (85.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.5044, Accuracy: 4759/10000 (47.5900%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4105/4501 (91.2020%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4063/4501 (90.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0613, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3608/3911 (92.2526%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3519/3911 (89.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0216, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4199/4558 (92.1237%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4120/4558 (90.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2227, Accuracy: 5076/10000 (50.7600%)
time spent on training: 258.42821049690247
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2191, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2067, Accuracy: 9344/9900 (94.3838%)
Done in 286.00879406929016 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4736/4885 (96.9498%), train_poison_data_count: 385
Global model norm: 43.65786615655591.
Norm before scaling: 43.63046588922627. Distance: 1.2743973186459923
Total norm for 4 adversaries is: 43.63046588922627. distance: 1.2743973186459923
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1221, Accuracy: 9582/9900 (96.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5086/5305 (95.8718%), train_poison_data_count: 415
Global model norm: 43.65786615655591.
Norm before scaling: 43.63194731125205. Distance: 1.4655100210023557
Total norm for 4 adversaries is: 43.63194731125205. distance: 1.4655100210023557
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1153, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4560/4717 (96.6716%), train_poison_data_count: 370
Global model norm: 43.65786615655591.
Norm before scaling: 43.631278649181255. Distance: 1.2534621453459887
Total norm for 4 adversaries is: 43.631278649181255. distance: 1.2534621453459887
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1000, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4834/5066 (95.4205%), train_poison_data_count: 400
Global model norm: 43.65786615655591.
Norm before scaling: 43.63692278648252. Distance: 1.4808708188463287
Total norm for 4 adversaries is: 43.63692278648252. distance: 1.4808708188463287
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0390, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4718/5116 (92.2205%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4614/5116 (90.1876%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4564, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4994/5392 (92.6187%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4838/5392 (89.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0828, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4305/4767 (90.3084%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4238/4767 (88.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1586, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4300/4618 (93.1139%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4201/4618 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9966, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3784/4046 (93.5245%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3789/4046 (93.6480%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9157, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4181/4625 (90.4000%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4150/4625 (89.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0604, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3335/3638 (91.6712%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3425/3638 (94.1451%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8568, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4011/4416 (90.8288%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3992/4416 (90.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0206, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4440/4874 (91.0956%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4304/4874 (88.3053%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2435, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3372/3646 (92.4849%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3347/3646 (91.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8062, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4594/5063 (90.7367%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4471/5063 (88.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2359, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3824/4126 (92.6806%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8667, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4469/4934 (90.5756%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4354/4934 (88.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2579, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4156/4511 (92.1303%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4128/4511 (91.5096%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9757, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4183/4518 (92.5852%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4197/4518 (92.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9212, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3071/3297 (93.1453%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.6736, Accuracy: 6039/10000 (60.3900%)
time spent on training: 259.2549705505371
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2206, Accuracy: 6850/10000 (68.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2022, Accuracy: 9364/9900 (94.5859%)
Done in 286.61529660224915 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4718/4885 (96.5814%), train_poison_data_count: 385
Global model norm: 43.678458526575916.
Norm before scaling: 43.65269172819916. Distance: 1.3351561732149855
Total norm for 4 adversaries is: 43.65269172819916. distance: 1.3351561732149855
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0286, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5073/5305 (95.6268%), train_poison_data_count: 415
Global model norm: 43.678458526575916.
Norm before scaling: 43.654299627603265. Distance: 1.4991090035635932
Total norm for 4 adversaries is: 43.654299627603265. distance: 1.4991090035635932
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0645, Accuracy: 9736/9900 (98.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4541/4717 (96.2688%), train_poison_data_count: 370
Global model norm: 43.678458526575916.
Norm before scaling: 43.65393890402031. Distance: 1.3003117169279506
Total norm for 4 adversaries is: 43.65393890402031. distance: 1.3003117169279506
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0790, Accuracy: 9679/9900 (97.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4878/5066 (96.2890%), train_poison_data_count: 400
Global model norm: 43.678458526575916.
Norm before scaling: 43.65249458167454. Distance: 1.4022099423126897
Total norm for 4 adversaries is: 43.65249458167454. distance: 1.4022099423126897
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0964, Accuracy: 9635/9900 (97.3232%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5550/6124 (90.6270%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5437/6124 (88.7818%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1631, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4575/5025 (91.0448%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4529/5025 (90.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1920, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3242/3472 (93.3756%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3218/3472 (92.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9751, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4629/5037 (91.8999%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4611/5037 (91.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9597, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5219/5582 (93.4970%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5170/5582 (92.6191%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0305, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4693/5116 (91.7318%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4596/5116 (89.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0601, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4147/4518 (91.7884%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4160/4518 (92.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0402, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4464/4928 (90.5844%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9659, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4175/4558 (91.5972%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4064/4558 (89.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2063, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3059/3297 (92.7813%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3068/3297 (93.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8639, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3539/3756 (94.2226%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3553/3756 (94.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9759, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4323/4651 (92.9478%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4261/4651 (91.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0664, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4108/4441 (92.5017%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4170/4441 (93.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9198, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3303/3638 (90.7916%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3341/3638 (91.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8618, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4250/4596 (92.4717%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4256/4596 (92.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1425, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3005/3271 (91.8679%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2948/3271 (90.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9102, Accuracy: 5633/10000 (56.3300%)
time spent on training: 261.2626326084137
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2226, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1939, Accuracy: 9383/9900 (94.7778%)
Done in 288.31050062179565 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.6981877909249.
Norm before scaling: 43.671708687071515. Distance: 1.3089950629389646
Total norm for 4 adversaries is: 43.671708687071515. distance: 1.3089950629389646
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0866, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5098/5305 (96.0980%), train_poison_data_count: 415
Global model norm: 43.6981877909249.
Norm before scaling: 43.670137767325485. Distance: 1.4163008198790739
Total norm for 4 adversaries is: 43.670137767325485. distance: 1.4163008198790739
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0288, Accuracy: 9810/9900 (99.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4524/4717 (95.9084%), train_poison_data_count: 370
Global model norm: 43.6981877909249.
Norm before scaling: 43.67214473306684. Distance: 1.3158805091636048
Total norm for 4 adversaries is: 43.67214473306684. distance: 1.3158805091636048
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0876, Accuracy: 9668/9900 (97.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4882/5066 (96.3679%), train_poison_data_count: 400
Global model norm: 43.6981877909249.
Norm before scaling: 43.672010565531984. Distance: 1.3569735218829775
Total norm for 4 adversaries is: 43.672010565531984. distance: 1.3569735218829775
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0889, Accuracy: 9672/9900 (97.6970%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4614/4989 (92.4835%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4510/4989 (90.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0276, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4179/4465 (93.5946%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4164/4465 (93.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8518, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4030/4315 (93.3951%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3993/4315 (92.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8609, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4331/4767 (90.8538%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4252/4767 (89.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2694, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5750/6391 (89.9703%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5666/6391 (88.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1656, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3403/3672 (92.6743%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3341/3672 (90.9858%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9689, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3689/3969 (92.9453%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3614/3969 (91.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8954, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3359/3590 (93.5655%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3166/3590 (88.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2324, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5386/5902 (91.2572%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5077/5902 (86.0217%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2213, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3765/4013 (93.8201%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3789/4013 (94.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7270, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4387/4804 (91.3197%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4028/4804 (83.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4648, Accuracy: 4778/10000 (47.7800%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3843/4175 (92.0479%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3769/4175 (90.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8849, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3331/3616 (92.1184%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8761, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4005/4361 (91.8367%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3816/4361 (87.5029%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2413, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4977/5424 (91.7588%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4966/5424 (91.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2416, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3582/3837 (93.3542%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3609/3837 (94.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8929, Accuracy: 5753/10000 (57.5300%)
time spent on training: 259.3216359615326
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2226, Accuracy: 6846/10000 (68.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1978, Accuracy: 9364/9900 (94.5859%)
Done in 286.7139117717743 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4745/4885 (97.1341%), train_poison_data_count: 385
Global model norm: 43.719226062901235.
Norm before scaling: 43.690938091199904. Distance: 1.2751686171689314
Total norm for 4 adversaries is: 43.690938091199904. distance: 1.2751686171689314
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1178, Accuracy: 9585/9900 (96.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5097/5305 (96.0792%), train_poison_data_count: 415
Global model norm: 43.719226062901235.
Norm before scaling: 43.69321510141406. Distance: 1.4364969651760782
Total norm for 4 adversaries is: 43.69321510141406. distance: 1.4364969651760782
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1157, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4560/4717 (96.6716%), train_poison_data_count: 370
Global model norm: 43.719226062901235.
Norm before scaling: 43.69303490063519. Distance: 1.2582256041552498
Total norm for 4 adversaries is: 43.69303490063519. distance: 1.2582256041552498
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1331, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4842/5066 (95.5784%), train_poison_data_count: 400
Global model norm: 43.719226062901235.
Norm before scaling: 43.6965982680038. Distance: 1.4528983975177072
Total norm for 4 adversaries is: 43.6965982680038. distance: 1.4528983975177072
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0417, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3974/4416 (89.9909%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3991/4416 (90.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9382, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5245/5740 (91.3763%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5202/5740 (90.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2075, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4580/5037 (90.9271%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4627/5037 (91.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0246, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4741/5116 (92.6701%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4627/5116 (90.4418%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9440, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4534/4918 (92.1919%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9116, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3558/3837 (92.7287%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3604/3837 (93.9275%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9067, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4294/4651 (92.3242%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1750, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3616/3861 (93.6545%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3575/3861 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8605, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3933/4223 (93.1328%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3954/4223 (93.6301%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8952, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4318/4662 (92.6212%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4347/4662 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9648, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5812/6263 (92.7990%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5686/6263 (90.7872%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1246, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3502/3781 (92.6210%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3241/3781 (85.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1047, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3542/3804 (93.1125%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3525/3804 (92.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9909, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3608/3828 (94.2529%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3597/3828 (93.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7890, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4045/4315 (93.7428%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4022/4315 (93.2097%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8263, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4485/4956 (90.4964%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4396/4956 (88.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0096, Accuracy: 5456/10000 (54.5600%)
time spent on training: 259.36807441711426
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2240, Accuracy: 6847/10000 (68.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2004, Accuracy: 9363/9900 (94.5758%)
Done in 286.86827993392944 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4717/4885 (96.5609%), train_poison_data_count: 385
Global model norm: 43.739571859865926.
Norm before scaling: 43.71248949992725. Distance: 1.305558650484317
Total norm for 4 adversaries is: 43.71248949992725. distance: 1.305558650484317
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0962, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 43.739571859865926.
Norm before scaling: 43.70980156589238. Distance: 1.3670771091036187
Total norm for 4 adversaries is: 43.70980156589238. distance: 1.3670771091036187
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1030, Accuracy: 9632/9900 (97.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4551/4717 (96.4808%), train_poison_data_count: 370
Global model norm: 43.739571859865926.
Norm before scaling: 43.7129795937195. Distance: 1.255170238544665
Total norm for 4 adversaries is: 43.7129795937195. distance: 1.255170238544665
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0577, Accuracy: 9734/9900 (98.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4884/5066 (96.4074%), train_poison_data_count: 400
Global model norm: 43.739571859865926.
Norm before scaling: 43.713653987305555. Distance: 1.3953243532777297
Total norm for 4 adversaries is: 43.713653987305555. distance: 1.3953243532777297
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0667, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4297/4662 (92.1707%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4290/4662 (92.0206%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9837, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3338/3616 (92.3119%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3330/3616 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8100, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3603/3828 (94.1223%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3633/3828 (94.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8542, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3064/3297 (92.9330%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7760, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4005/4361 (91.8367%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3821/4361 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0969, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4248/4576 (92.8322%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4204/4576 (91.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9967, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3955/4295 (92.0838%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3855/4295 (89.7555%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0095, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4643/5083 (91.3437%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4579/5083 (90.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0522, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4737/5116 (92.5919%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4648/5116 (90.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9920, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3796/4046 (93.8211%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3755/4046 (92.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8595, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5315/5902 (90.0542%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5081/5902 (86.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1796, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4832/5197 (92.9767%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4692/5197 (90.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0355, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4205/4465 (94.1769%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4180/4465 (93.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8392, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3425/3704 (92.4676%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3446/3704 (93.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8551, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3605/3861 (93.3696%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3561/3861 (92.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8768, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3812/4126 (92.3897%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3851/4126 (93.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7989, Accuracy: 5857/10000 (58.5700%)
time spent on training: 257.32513880729675
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2336, Accuracy: 6823/10000 (68.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1754, Accuracy: 9433/9900 (95.2828%)
Done in 284.89816784858704 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4726/4885 (96.7451%), train_poison_data_count: 385
Global model norm: 43.759171750670596.
Norm before scaling: 43.73317477810038. Distance: 1.311071572250879
Total norm for 4 adversaries is: 43.73317477810038. distance: 1.311071572250879
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0615, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5101/5305 (96.1546%), train_poison_data_count: 415
Global model norm: 43.759171750670596.
Norm before scaling: 43.7294455063962. Distance: 1.409651182396482
Total norm for 4 adversaries is: 43.7294455063962. distance: 1.409651182396482
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0138, Accuracy: 9868/9900 (99.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4551/4717 (96.4808%), train_poison_data_count: 370
Global model norm: 43.759171750670596.
Norm before scaling: 43.73114269941817. Distance: 1.251663055380849
Total norm for 4 adversaries is: 43.73114269941817. distance: 1.251663055380849
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0971, Accuracy: 9640/9900 (97.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4871/5066 (96.1508%), train_poison_data_count: 400
Global model norm: 43.759171750670596.
Norm before scaling: 43.7355751889623. Distance: 1.4162424892350953
Total norm for 4 adversaries is: 43.7355751889623. distance: 1.4162424892350953
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0450, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4164/4511 (92.3077%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4089/4511 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9506, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5254/5740 (91.5331%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5246/5740 (91.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0376, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4366/4662 (93.6508%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4305/4662 (92.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0731, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3938/4235 (92.9870%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3920/4235 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9619, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4858/5265 (92.2697%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4791/5265 (90.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1182, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4166/4433 (93.9770%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4082/4433 (92.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9186, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4259/4596 (92.6675%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4281/4596 (93.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9174, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4687/5055 (92.7201%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/5055 (91.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8751, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4590/5037 (91.1257%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4556/5037 (90.4507%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1535, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4256/4538 (93.7858%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4281/4538 (94.3367%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7889, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3549/3756 (94.4888%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3548/3756 (94.4622%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9035, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3786/4025 (94.0621%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3781/4025 (93.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9475, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4682/5244 (89.2830%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4539/5244 (86.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2388, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4362/4663 (93.5449%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4343/4663 (93.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0696, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3574/3837 (93.1457%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3607/3837 (94.0057%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7729, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4103/4481 (91.5644%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3963/4481 (88.4401%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9954, Accuracy: 5581/10000 (55.8100%)
time spent on training: 262.36534667015076
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2392, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1682, Accuracy: 9450/9900 (95.4545%)
Done in 289.65047240257263 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4723/4885 (96.6837%), train_poison_data_count: 385
Global model norm: 43.77923130606567.
Norm before scaling: 43.752081423702. Distance: 1.3089160579201453
Total norm for 4 adversaries is: 43.752081423702. distance: 1.3089160579201453
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0526, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5102/5305 (96.1734%), train_poison_data_count: 415
Global model norm: 43.77923130606567.
Norm before scaling: 43.75002511159994. Distance: 1.3919640427034023
Total norm for 4 adversaries is: 43.75002511159994. distance: 1.3919640427034023
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1021, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4543/4717 (96.3112%), train_poison_data_count: 370
Global model norm: 43.77923130606567.
Norm before scaling: 43.751994932195664. Distance: 1.2687716515107705
Total norm for 4 adversaries is: 43.751994932195664. distance: 1.2687716515107705
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0348, Accuracy: 9808/9900 (99.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4867/5066 (96.0719%), train_poison_data_count: 400
Global model norm: 43.77923130606567.
Norm before scaling: 43.75489509445272. Distance: 1.4251415751215788
Total norm for 4 adversaries is: 43.75489509445272. distance: 1.4251415751215788
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0851, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4116/4362 (94.3604%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3955/4362 (90.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2051, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5097/5591 (91.1644%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4987/5591 (89.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2175, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4047/4315 (93.7891%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4010/4315 (92.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8790, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3520/3781 (93.0971%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3493/3781 (92.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9481, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3767/4158 (90.5964%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8963, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4155/4511 (92.1082%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4084/4511 (90.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9233, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4429/4793 (92.4056%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0229, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5009/5424 (92.3488%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4997/5424 (92.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2631, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4263/4618 (92.3127%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4225/4618 (91.4898%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0820, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4008/4368 (91.7582%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3947/4368 (90.3617%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9212, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4934 (90.6364%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3902/4934 (79.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.5120, Accuracy: 4800/10000 (48.0000%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4816/5232 (92.0489%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4725/5232 (90.3096%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0263, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5376/5902 (91.0878%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5141/5902 (87.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4814, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4940/5392 (91.6172%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4880/5392 (90.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1758, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4646/5017 (92.6051%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4585/5017 (91.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0164, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4724/5195 (90.9336%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4609/5195 (88.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1382, Accuracy: 5342/10000 (53.4200%)
time spent on training: 264.5324685573578
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2423, Accuracy: 6812/10000 (68.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1596, Accuracy: 9470/9900 (95.6566%)
Done in 291.7985761165619 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.80201985478951.
Norm before scaling: 43.772255778935616. Distance: 1.2693261083506142
Total norm for 4 adversaries is: 43.772255778935616. distance: 1.2693261083506142
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0731, Accuracy: 9692/9900 (97.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 43.80201985478951.
Norm before scaling: 43.774630343599135. Distance: 1.43231235373614
Total norm for 4 adversaries is: 43.774630343599135. distance: 1.43231235373614
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0938, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4544/4717 (96.3324%), train_poison_data_count: 370
Global model norm: 43.80201985478951.
Norm before scaling: 43.774497884488206. Distance: 1.2690612862099049
Total norm for 4 adversaries is: 43.774497884488206. distance: 1.2690612862099049
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1330, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4890/5066 (96.5259%), train_poison_data_count: 400
Global model norm: 43.80201985478951.
Norm before scaling: 43.774284554761714. Distance: 1.3452447074441491
Total norm for 4 adversaries is: 43.774284554761714. distance: 1.3452447074441491
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0457, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4878/5265 (92.6496%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4763/5265 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9522, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3852/4126 (93.3592%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3859/4126 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7719, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4176/4501 (92.7794%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4047/4501 (89.9134%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1647, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5566/6124 (90.8883%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5361/6124 (87.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0667, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3013/3271 (92.1125%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2927/3271 (89.4833%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0974, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4332/4663 (92.9016%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4348/4663 (93.2447%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9364, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3767/4025 (93.5901%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3794/4025 (94.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8236, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4306/4651 (92.5822%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9571, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4416/4804 (91.9234%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4206/4804 (87.5520%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2351, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3331/3616 (92.1184%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3394/3616 (93.8606%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.6757, Accuracy: 6112/10000 (61.1200%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3672/3911 (93.8890%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3470/3911 (88.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.5557, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4784/5197 (92.0531%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5197 (90.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1876, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4274/4538 (94.1825%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4293/4538 (94.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8035, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5757/6391 (90.0798%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5622/6391 (87.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0737, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3436/3704 (92.7646%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3447/3704 (93.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8053, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3918/4235 (92.5148%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3775/4235 (89.1381%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2260, Accuracy: 5165/10000 (51.6500%)
time spent on training: 260.687331199646
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2460, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1555, Accuracy: 9483/9900 (95.7879%)
Done in 288.0400834083557 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4728/4885 (96.7861%), train_poison_data_count: 385
Global model norm: 43.82271858365818.
Norm before scaling: 43.79315812135712. Distance: 1.256839257201084
Total norm for 4 adversaries is: 43.79315812135712. distance: 1.256839257201084
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0815, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5107/5305 (96.2677%), train_poison_data_count: 415
Global model norm: 43.82271858365818.
Norm before scaling: 43.794130923222035. Distance: 1.4100945372035587
Total norm for 4 adversaries is: 43.794130923222035. distance: 1.4100945372035587
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0582, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4525/4717 (95.9296%), train_poison_data_count: 370
Global model norm: 43.82271858365818.
Norm before scaling: 43.79534062376456. Distance: 1.2900574514621899
Total norm for 4 adversaries is: 43.79534062376456. distance: 1.2900574514621899
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0841, Accuracy: 9669/9900 (97.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4865/5066 (96.0324%), train_poison_data_count: 400
Global model norm: 43.82271858365818.
Norm before scaling: 43.79621024959309. Distance: 1.3776381499840824
Total norm for 4 adversaries is: 43.79621024959309. distance: 1.3776381499840824
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0719, Accuracy: 9707/9900 (98.0505%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4757/5116 (92.9828%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4681/5116 (91.4973%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9351, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5243/5582 (93.9269%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5185/5582 (92.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1500, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3998/4235 (94.4038%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3736/4235 (88.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1298, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4234/4625 (91.5459%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4080/4625 (88.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2936, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4107/4481 (91.6536%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3949/4481 (88.1277%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0880, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4858/5232 (92.8517%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4760/5232 (90.9786%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8992, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4379/4662 (93.9296%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4335/4662 (92.9858%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9360, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4206/4441 (94.7084%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4161/4441 (93.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8941, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4173/4518 (92.3639%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4191/4518 (92.7623%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9096, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4592/4928 (93.1818%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4538/4928 (92.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8484, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4231/4634 (91.3034%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4263/4634 (91.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0047, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4547/4934 (92.1565%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4334/4934 (87.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2480, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3616/3861 (93.6545%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3610/3861 (93.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9383, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3339/3616 (92.3396%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3356/3616 (92.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8394, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4033/4416 (91.3270%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9911, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3563/3797 (93.8372%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3544/3797 (93.3368%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9806, Accuracy: 5629/10000 (56.2900%)
time spent on training: 261.4831602573395
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2493, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1557, Accuracy: 9492/9900 (95.8788%)
Done in 289.2041175365448 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.84303584370256.
Norm before scaling: 43.81556610392946. Distance: 1.315957556077776
Total norm for 4 adversaries is: 43.81556610392946. distance: 1.315957556077776
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0408, Accuracy: 9790/9900 (98.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5108/5305 (96.2865%), train_poison_data_count: 415
Global model norm: 43.84303584370256.
Norm before scaling: 43.81275632949267. Distance: 1.3817170540181163
Total norm for 4 adversaries is: 43.81275632949267. distance: 1.3817170540181163
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0956, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 43.84303584370256.
Norm before scaling: 43.814036561411314. Distance: 1.214508550096351
Total norm for 4 adversaries is: 43.814036561411314. distance: 1.214508550096351
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1059, Accuracy: 9615/9900 (97.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 43.84303584370256.
Norm before scaling: 43.81488352780009. Distance: 1.346014244313135
Total norm for 4 adversaries is: 43.81488352780009. distance: 1.346014244313135
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1855, Accuracy: 9406/9900 (95.0101%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5800/6263 (92.6074%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5708/6263 (91.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2011, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3990/4295 (92.8987%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3888/4295 (90.5239%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9179, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4516/4989 (90.5191%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4457/4989 (89.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0038, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3919/4223 (92.8013%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3918/4223 (92.7776%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8168, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5598/6124 (91.4108%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5495/6124 (89.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0956, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4136/4481 (92.3008%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3986/4481 (88.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3060, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4321/4618 (93.5686%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4146/4618 (89.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1817, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4229/4441 (95.2263%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4161/4441 (93.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0419, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3753/4013 (93.5211%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3781/4013 (94.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7453, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4149/4511 (91.9752%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4147/4511 (91.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9871, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3979/4416 (90.1042%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4005/4416 (90.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9351, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4503/4956 (90.8596%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4394/4956 (88.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1290, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4248/4538 (93.6095%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4289/4538 (94.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8283, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4764/5265 (90.4843%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4763/5265 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9746, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4825/5197 (92.8420%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4639/5197 (89.2630%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3582, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4325/4716 (91.7091%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4297/4716 (91.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0429, Accuracy: 5422/10000 (54.2200%)
time spent on training: 265.95868253707886
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2427, Accuracy: 6799/10000 (67.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1623, Accuracy: 9465/9900 (95.6061%)
Done in 293.41435647010803 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4718/4885 (96.5814%), train_poison_data_count: 385
Global model norm: 43.86465306013417.
Norm before scaling: 43.83620274269246. Distance: 1.308566010593935
Total norm for 4 adversaries is: 43.83620274269246. distance: 1.308566010593935
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0720, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5098/5305 (96.0980%), train_poison_data_count: 415
Global model norm: 43.86465306013417.
Norm before scaling: 43.83778720366782. Distance: 1.4444725276385206
Total norm for 4 adversaries is: 43.83778720366782. distance: 1.4444725276385206
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0155, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.86465306013417.
Norm before scaling: 43.83627792930545. Distance: 1.2270300878987797
Total norm for 4 adversaries is: 43.83627792930545. distance: 1.2270300878987797
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1106, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.86465306013417.
Norm before scaling: 43.83850283774171. Distance: 1.3745007475555706
Total norm for 4 adversaries is: 43.83850283774171. distance: 1.3745007475555706
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0966, Accuracy: 9645/9900 (97.4242%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3353/3616 (92.7268%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3372/3616 (93.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7863, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4096/4315 (94.9247%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9756, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5054/5455 (92.6489%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0794, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4420/4804 (92.0067%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4204/4804 (87.5104%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2481, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4091/4362 (93.7873%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3982/4362 (91.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0034, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5827/6263 (93.0385%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5736/6263 (91.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1387, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4264/4538 (93.9621%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4275/4538 (94.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8668, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4293/4634 (92.6413%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8652, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4768/5116 (93.1978%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4659/5116 (91.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9093, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4271/4716 (90.5640%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4273/4716 (90.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1081, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3780/4046 (93.4256%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3730/4046 (92.1898%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1347, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4161/4518 (92.0983%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4130/4518 (91.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9588, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4613/5063 (91.1120%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4480/5063 (88.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2879, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5297/5740 (92.2822%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5205/5740 (90.6794%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0856, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5224/5582 (93.5865%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5091/5582 (91.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0941, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4170/4433 (94.0672%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4141/4433 (93.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8259, Accuracy: 5779/10000 (57.7900%)
time spent on training: 266.66877698898315
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2432, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1596, Accuracy: 9470/9900 (95.6566%)
Done in 294.18868803977966 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4737/4885 (96.9703%), train_poison_data_count: 385
Global model norm: 43.88568663255638.
Norm before scaling: 43.85800841743444. Distance: 1.2981909085082486
Total norm for 4 adversaries is: 43.85800841743444. distance: 1.2981909085082486
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0827, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5108/5305 (96.2865%), train_poison_data_count: 415
Global model norm: 43.88568663255638.
Norm before scaling: 43.8567197272479. Distance: 1.3874695370740915
Total norm for 4 adversaries is: 43.8567197272479. distance: 1.3874695370740915
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0328, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4570/4717 (96.8836%), train_poison_data_count: 370
Global model norm: 43.88568663255638.
Norm before scaling: 43.85741835232952. Distance: 1.2099382276766844
Total norm for 4 adversaries is: 43.85741835232952. distance: 1.2099382276766844
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1245, Accuracy: 9557/9900 (96.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4872/5066 (96.1705%), train_poison_data_count: 400
Global model norm: 43.88568663255638.
Norm before scaling: 43.859405615415035. Distance: 1.388804197378342
Total norm for 4 adversaries is: 43.859405615415035. distance: 1.388804197378342
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0804, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4768/5197 (91.7452%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4576/5197 (88.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1442, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3779/4025 (93.8882%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3792/4025 (94.2112%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8196, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4129/4481 (92.1446%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4020/4481 (89.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0779, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4288/4651 (92.1952%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4292/4651 (92.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9142, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5358/5902 (90.7828%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5088/5902 (86.2081%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0714, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3818/4126 (92.5351%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3831/4126 (92.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8569, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4045/4368 (92.6053%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3941/4368 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0467, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5828/6391 (91.1907%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5637/6391 (88.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2917, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3877/4175 (92.8623%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0215, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4324/4596 (94.0818%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4265/4596 (92.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9757, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4317/4634 (93.1593%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4265/4634 (92.0371%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8958, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3942/4223 (93.3460%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3936/4223 (93.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9004, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3629/3911 (92.7896%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3384/3911 (86.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1640, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4126/4433 (93.0747%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4091/4433 (92.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9639, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3961/4336 (91.3515%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4000/4336 (92.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1197, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3334/3638 (91.6438%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9643, Accuracy: 5597/10000 (55.9700%)
time spent on training: 258.17465686798096
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2494, Accuracy: 6792/10000 (67.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1652, Accuracy: 9459/9900 (95.5455%)
Done in 285.5279951095581 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 43.90698258952882.
Norm before scaling: 43.87595707645589. Distance: 1.1940736022449057
Total norm for 4 adversaries is: 43.87595707645589. distance: 1.1940736022449057
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1390, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 43.90698258952882.
Norm before scaling: 43.879182882429426. Distance: 1.4126195975115026
Total norm for 4 adversaries is: 43.879182882429426. distance: 1.4126195975115026
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0672, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 43.90698258952882.
Norm before scaling: 43.878369150378354. Distance: 1.2172496069756495
Total norm for 4 adversaries is: 43.878369150378354. distance: 1.2172496069756495
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0630, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4893/5066 (96.5851%), train_poison_data_count: 400
Global model norm: 43.90698258952882.
Norm before scaling: 43.87937901046173. Distance: 1.3391169141932828
Total norm for 4 adversaries is: 43.87937901046173. distance: 1.3391169141932828
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1221, Accuracy: 9575/9900 (96.7172%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3555/3756 (94.6486%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3526/3756 (93.8765%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9648, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5037/5424 (92.8650%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4962/5424 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2436, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4130/4433 (93.1649%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4076/4433 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8351, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4124/4501 (91.6241%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4018/4501 (89.2691%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2451, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3773/4025 (93.7391%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3779/4025 (93.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8416, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3974/4235 (93.8371%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3890/4235 (91.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9106, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5620/6124 (91.7701%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5416/6124 (88.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1311, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4309/4634 (92.9866%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4276/4634 (92.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9084, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4322/4716 (91.6455%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4258/4716 (90.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0272, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4342/4767 (91.0845%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4255/4767 (89.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1773, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3528/3804 (92.7445%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3520/3804 (92.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9578, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3259/3472 (93.8652%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3282/3472 (94.5276%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9368, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5010/5392 (92.9154%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4886/5392 (90.6157%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1042, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5314/5740 (92.5784%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5249/5740 (91.4460%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0378, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4279/4596 (93.1027%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4280/4596 (93.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9088, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3337/3616 (92.2843%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3355/3616 (92.7821%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8953, Accuracy: 5718/10000 (57.1800%)
time spent on training: 261.95423579216003
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2465, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1725, Accuracy: 9442/9900 (95.3737%)
Done in 289.20754528045654 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4739/4885 (97.0113%), train_poison_data_count: 385
Global model norm: 43.92667590935277.
Norm before scaling: 43.896842019191. Distance: 1.2797167372944245
Total norm for 4 adversaries is: 43.896842019191. distance: 1.2797167372944245
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0364, Accuracy: 9797/9900 (98.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5100/5305 (96.1357%), train_poison_data_count: 415
Global model norm: 43.92667590935277.
Norm before scaling: 43.897510807312585. Distance: 1.436838163523418
Total norm for 4 adversaries is: 43.897510807312585. distance: 1.436838163523418
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0244, Accuracy: 9845/9900 (99.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4571/4717 (96.9048%), train_poison_data_count: 370
Global model norm: 43.92667590935277.
Norm before scaling: 43.89949625547399. Distance: 1.260552969043944
Total norm for 4 adversaries is: 43.89949625547399. distance: 1.260552969043944
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0659, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4881/5066 (96.3482%), train_poison_data_count: 400
Global model norm: 43.92667590935277.
Norm before scaling: 43.89974373501513. Distance: 1.3686976348753954
Total norm for 4 adversaries is: 43.89974373501513. distance: 1.3686976348753954
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0898, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4671/5063 (92.2576%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4508/5063 (89.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0155, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4457/4804 (92.7769%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4194/4804 (87.3022%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3022, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4199/4558 (92.1237%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4100/4558 (89.9517%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1749, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3552/3756 (94.5687%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3584/3756 (95.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7643, Accuracy: 5990/10000 (59.9000%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5061/5424 (93.3075%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4995/5424 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1074, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4174/4511 (92.5294%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4158/4511 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9060, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4831/5167 (93.4972%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4793/5167 (92.7618%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0354, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4065/4356 (93.3196%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4060/4356 (93.2048%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1045, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4722/5244 (90.0458%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4637/5244 (88.4249%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0738, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4473/4793 (93.3236%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4428/4793 (92.3847%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1278, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3588/3828 (93.7304%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3599/3828 (94.0178%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7208, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3801/4046 (93.9446%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3803/4046 (93.9941%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8672, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3771/4013 (93.9696%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3767/4013 (93.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8264, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3006/3271 (91.8985%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3027/3271 (92.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8360, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4116/4362 (94.3604%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4050/4362 (92.8473%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0047, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4093/4346 (94.1786%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4141/4346 (95.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7610, Accuracy: 5948/10000 (59.4800%)
time spent on training: 259.4728751182556
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2463, Accuracy: 6782/10000 (67.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1678, Accuracy: 9455/9900 (95.5051%)
Done in 286.9452521800995 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 43.945242361055136.
Norm before scaling: 43.915333524347595. Distance: 1.2533310375970417
Total norm for 4 adversaries is: 43.915333524347595. distance: 1.2533310375970417
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0497, Accuracy: 9779/9900 (98.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5096/5305 (96.0603%), train_poison_data_count: 415
Global model norm: 43.945242361055136.
Norm before scaling: 43.91774760489773. Distance: 1.439109150382019
Total norm for 4 adversaries is: 43.91774760489773. distance: 1.439109150382019
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0378, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.945242361055136.
Norm before scaling: 43.91781570311543. Distance: 1.2670729090270068
Total norm for 4 adversaries is: 43.91781570311543. distance: 1.2670729090270068
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0429, Accuracy: 9790/9900 (98.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 43.945242361055136.
Norm before scaling: 43.91857450468352. Distance: 1.359235471382957
Total norm for 4 adversaries is: 43.91857450468352. distance: 1.359235471382957
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0958, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3852/4126 (93.3592%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3838/4126 (93.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8418, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5021/5455 (92.0440%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4966/5455 (91.0357%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0365, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4254/4558 (93.3304%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4084/4558 (89.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1036, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4013/4235 (94.7580%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3945/4235 (93.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0115, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3531/3804 (92.8233%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3555/3804 (93.4543%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7817, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5836/6391 (91.3159%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5607/6391 (87.7327%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3211, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4008/4336 (92.4354%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3939/4336 (90.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2074, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4325/4663 (92.7514%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4368/4663 (93.6736%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0299, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4162/4511 (92.2634%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4125/4511 (91.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9382, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4200/4503 (93.2712%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4065/4503 (90.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1564, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4599/5063 (90.8355%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4358/5063 (86.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.4730, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4049/4315 (93.8355%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4021/4315 (93.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9200, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3360/3638 (92.3584%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3411/3638 (93.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8331, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4217/4441 (94.9561%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4183/4441 (94.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0071, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4360/4679 (93.1823%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4213/4679 (90.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1403, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4845/5265 (92.0228%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4672/5265 (88.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0555, Accuracy: 5433/10000 (54.3300%)
time spent on training: 263.17570972442627
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2518, Accuracy: 6776/10000 (67.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1661, Accuracy: 9451/9900 (95.4646%)
Done in 290.74820470809937 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4750/4885 (97.2364%), train_poison_data_count: 385
Global model norm: 43.965639049059526.
Norm before scaling: 43.93509672925934. Distance: 1.2671509950320898
Total norm for 4 adversaries is: 43.93509672925934. distance: 1.2671509950320898
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0754, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5114/5305 (96.3996%), train_poison_data_count: 415
Global model norm: 43.965639049059526.
Norm before scaling: 43.93693739638025. Distance: 1.4240315609874075
Total norm for 4 adversaries is: 43.93693739638025. distance: 1.4240315609874075
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0493, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4583/4717 (97.1592%), train_poison_data_count: 370
Global model norm: 43.965639049059526.
Norm before scaling: 43.93584411886837. Distance: 1.183158719025141
Total norm for 4 adversaries is: 43.93584411886837. distance: 1.183158719025141
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0509, Accuracy: 9766/9900 (98.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4880/5066 (96.3285%), train_poison_data_count: 400
Global model norm: 43.965639049059526.
Norm before scaling: 43.94047265015193. Distance: 1.3878289305365648
Total norm for 4 adversaries is: 43.94047265015193. distance: 1.3878289305365648
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0391, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4060/4336 (93.6347%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3997/4336 (92.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1686, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3583/3828 (93.5998%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3598/3828 (93.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8344, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3369/3672 (91.7484%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3314/3672 (90.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0229, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4340/4651 (93.3133%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9523, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4027/4361 (92.3412%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3916/4361 (89.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9918, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4644/5025 (92.4179%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1077, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5594/6124 (91.3455%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5441/6124 (88.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1562, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3438/3704 (92.8186%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3458/3704 (93.3585%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8423, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4546/4934 (92.1362%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4078/4934 (82.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3069, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4675/5017 (93.1832%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4600/5017 (91.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9567, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5194/5582 (93.0491%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5109/5582 (91.5263%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0997, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4781/5167 (92.5295%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4686/5167 (90.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2922, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3648/3861 (94.4833%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3567/3861 (92.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9766, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3375/3646 (92.5672%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3370/3646 (92.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7415, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4211/4558 (92.3870%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3987/4558 (87.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0890, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4782/5116 (93.4715%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4652/5116 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9947, Accuracy: 5501/10000 (55.0100%)
time spent on training: 261.567804813385
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2567, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1630, Accuracy: 9464/9900 (95.5960%)
Done in 288.68588757514954 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4748/4885 (97.1955%), train_poison_data_count: 385
Global model norm: 43.986543851944795.
Norm before scaling: 43.95615491245225. Distance: 1.2783115931622273
Total norm for 4 adversaries is: 43.95615491245225. distance: 1.2783115931622273
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0154, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5138/5305 (96.8520%), train_poison_data_count: 415
Global model norm: 43.986543851944795.
Norm before scaling: 43.95446363052193. Distance: 1.3537634860676446
Total norm for 4 adversaries is: 43.95446363052193. distance: 1.3537634860676446
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0566, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.986543851944795.
Norm before scaling: 43.95664228950145. Distance: 1.2627432239526635
Total norm for 4 adversaries is: 43.95664228950145. distance: 1.2627432239526635
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0256, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4890/5066 (96.5259%), train_poison_data_count: 400
Global model norm: 43.986543851944795.
Norm before scaling: 43.95987467059805. Distance: 1.3478512387951764
Total norm for 4 adversaries is: 43.95987467059805. distance: 1.3478512387951764
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1221, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4158/4511 (92.1747%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4209/4511 (93.3053%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8902, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4077/4346 (93.8104%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4111/4346 (94.5927%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8177, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4422/4804 (92.0483%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3919/4804 (81.5779%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.5522, Accuracy: 4802/10000 (48.0200%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4801/5232 (91.7622%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4648/5232 (88.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0320, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4331/4618 (93.7852%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4251/4618 (92.0528%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9870, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3382/3590 (94.2061%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3294/3590 (91.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9507, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5786/6391 (90.5336%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5568/6391 (87.1225%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1145, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4047/4354 (92.9490%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3502/4354 (80.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.5325, Accuracy: 4650/10000 (46.5000%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4682/5055 (92.6212%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4666/5055 (92.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9538, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3631/3837 (94.6312%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3631/3837 (94.6312%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8795, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4177/4503 (92.7604%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4109/4503 (91.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0051, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4316/4576 (94.3182%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4256/4576 (93.0070%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9998, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4442/4793 (92.6768%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0198, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4302/4634 (92.8356%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4285/4634 (92.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8899, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3758/4158 (90.3800%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3717/4158 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2559, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5305/5740 (92.4216%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5201/5740 (90.6098%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1119, Accuracy: 5357/10000 (53.5700%)
time spent on training: 264.08252596855164
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2583, Accuracy: 6776/10000 (67.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1637, Accuracy: 9464/9900 (95.5960%)
Done in 291.7141442298889 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4737/4885 (96.9703%), train_poison_data_count: 385
Global model norm: 44.00823481401308.
Norm before scaling: 43.978273055868875. Distance: 1.2755138577194824
Total norm for 4 adversaries is: 43.978273055868875. distance: 1.2755138577194824
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0728, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5106/5305 (96.2488%), train_poison_data_count: 415
Global model norm: 44.00823481401308.
Norm before scaling: 43.979671984356166. Distance: 1.4345688167431787
Total norm for 4 adversaries is: 43.979671984356166. distance: 1.4345688167431787
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0496, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 44.00823481401308.
Norm before scaling: 43.97915433048935. Distance: 1.2473298641379504
Total norm for 4 adversaries is: 43.97915433048935. distance: 1.2473298641379504
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0675, Accuracy: 9711/9900 (98.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4889/5066 (96.5061%), train_poison_data_count: 400
Global model norm: 44.00823481401308.
Norm before scaling: 43.980474127642005. Distance: 1.3697800823152126
Total norm for 4 adversaries is: 43.980474127642005. distance: 1.3697800823152126
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0716, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3885/4184 (92.8537%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3828/4184 (91.4914%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0014, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5795/6263 (92.5275%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5760/6263 (91.9687%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0827, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4190/4456 (94.0305%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4191/4456 (94.0530%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9130, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4291/4538 (94.5571%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8799, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3966/4235 (93.6482%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3740/4235 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1462, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3920/4223 (92.8250%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3947/4223 (93.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8657, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5001/5455 (91.6774%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4890/5455 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0578, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4609/5037 (91.5029%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4615/5037 (91.6220%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9953, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3546/3756 (94.4089%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3568/3756 (94.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8526, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4873/5265 (92.5546%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4670/5265 (88.6990%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1382, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4682/5055 (92.6212%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4580/5055 (90.6034%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0701, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4458/4804 (92.7977%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3971/4804 (82.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3493, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4648/5063 (91.8033%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4449/5063 (87.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2150, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4011/4295 (93.3877%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3864/4295 (89.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9142, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3029/3271 (92.6017%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2960/3271 (90.4922%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9710, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4050/4356 (92.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1790, Accuracy: 5311/10000 (53.1100%)
time spent on training: 263.26923871040344
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2583, Accuracy: 6775/10000 (67.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1677, Accuracy: 9457/9900 (95.5253%)
Done in 290.463431596756 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4727/4885 (96.7656%), train_poison_data_count: 385
Global model norm: 44.028770057468535.
Norm before scaling: 43.999862670684124. Distance: 1.3329812965969672
Total norm for 4 adversaries is: 43.999862670684124. distance: 1.3329812965969672
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0277, Accuracy: 9836/9900 (99.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5137/5305 (96.8332%), train_poison_data_count: 415
Global model norm: 44.028770057468535.
Norm before scaling: 43.99741702734519. Distance: 1.364766664298796
Total norm for 4 adversaries is: 43.99741702734519. distance: 1.364766664298796
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0512, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.028770057468535.
Norm before scaling: 43.99841028289403. Distance: 1.201833800007926
Total norm for 4 adversaries is: 43.99841028289403. distance: 1.201833800007926
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0531, Accuracy: 9765/9900 (98.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 44.028770057468535.
Norm before scaling: 43.998831993552685. Distance: 1.3163304519338426
Total norm for 4 adversaries is: 43.998831993552685. distance: 1.3163304519338426
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1747, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4200/4503 (93.2712%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4110/4503 (91.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1067, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4187/4456 (93.9632%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4147/4456 (93.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9458, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4899/5265 (93.0484%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4774/5265 (90.6743%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9906, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4453/4793 (92.9063%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4406/4793 (91.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1091, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4595/4928 (93.2427%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4482/4928 (90.9497%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9721, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3340/3638 (91.8087%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0241, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4348/4663 (93.2447%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4347/4663 (93.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9743, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4475/4928 (90.8076%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4432/4928 (89.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0319, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4176/4465 (93.5274%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4170/4465 (93.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9910, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3678/3911 (94.0424%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3476/3911 (88.8775%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1240, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4195/4518 (92.8508%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4180/4518 (92.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2315, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3980/4235 (93.9787%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3975/4235 (93.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0815, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4552/4934 (92.2578%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4068/4934 (82.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.5223, Accuracy: 4734/10000 (47.3400%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4314/4647 (92.8341%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4243/4647 (91.3062%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9973, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4357/4651 (93.6788%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4315/4651 (92.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9970, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4625/4989 (92.7039%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4525/4989 (90.6995%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9237, Accuracy: 5708/10000 (57.0800%)
time spent on training: 259.20823431015015
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2662, Accuracy: 6770/10000 (67.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1606, Accuracy: 9471/9900 (95.6667%)
Done in 286.46912908554077 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4728/4885 (96.7861%), train_poison_data_count: 385
Global model norm: 44.048730395030255.
Norm before scaling: 44.01961565597773. Distance: 1.3193283024361562
Total norm for 4 adversaries is: 44.01961565597773. distance: 1.3193283024361562
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0301, Accuracy: 9825/9900 (99.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5117/5305 (96.4562%), train_poison_data_count: 415
Global model norm: 44.048730395030255.
Norm before scaling: 44.01684247961228. Distance: 1.3970270556271835
Total norm for 4 adversaries is: 44.01684247961228. distance: 1.3970270556271835
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0626, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4569/4717 (96.8624%), train_poison_data_count: 370
Global model norm: 44.048730395030255.
Norm before scaling: 44.017968410283885. Distance: 1.2164168399651167
Total norm for 4 adversaries is: 44.017968410283885. distance: 1.2164168399651167
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1104, Accuracy: 9609/9900 (97.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4882/5066 (96.3679%), train_poison_data_count: 400
Global model norm: 44.048730395030255.
Norm before scaling: 44.02335223483313. Distance: 1.4047013974801774
Total norm for 4 adversaries is: 44.02335223483313. distance: 1.4047013974801774
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0437, Accuracy: 9795/9900 (98.9394%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4286/4538 (94.4469%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4255/4538 (93.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7844, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4103/4362 (94.0624%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3943/4362 (90.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0890, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4687/5244 (89.3783%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4643/5244 (88.5393%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2401, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3815/4046 (94.2907%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3699/4046 (91.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0876, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3751/4013 (93.4712%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3763/4013 (93.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9060, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4183/4465 (93.6842%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4145/4465 (92.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8398, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4775/5232 (91.2653%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4596/5232 (87.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0933, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4593/4928 (93.2021%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4556/4928 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8707, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4677/5063 (92.3761%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4613/5063 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9481, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5421/5902 (91.8502%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5230/5902 (88.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3277, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4170/4456 (93.5817%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4169/4456 (93.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8844, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4268/4596 (92.8634%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4267/4596 (92.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0226, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4162/4441 (93.7176%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4147/4441 (93.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0729, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5356/5740 (93.3101%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5143/5740 (89.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1603, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3276/3472 (94.3548%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3252/3472 (93.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9143, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3626/3861 (93.9135%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3574/3861 (92.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9090, Accuracy: 5622/10000 (56.2200%)
time spent on training: 262.7210485935211
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2725, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1505, Accuracy: 9500/9900 (95.9596%)
Done in 289.8732385635376 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 44.06876202178605.
Norm before scaling: 44.03568277456221. Distance: 1.2197422976429495
Total norm for 4 adversaries is: 44.03568277456221. distance: 1.2197422976429495
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0665, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 44.06876202178605.
Norm before scaling: 44.037991854335274. Distance: 1.389492945707739
Total norm for 4 adversaries is: 44.037991854335274. distance: 1.389492945707739
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0388, Accuracy: 9792/9900 (98.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4582/4717 (97.1380%), train_poison_data_count: 370
Global model norm: 44.06876202178605.
Norm before scaling: 44.03696206961048. Distance: 1.1818976004631923
Total norm for 4 adversaries is: 44.03696206961048. distance: 1.1818976004631923
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0537, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 44.06876202178605.
Norm before scaling: 44.03948035658601. Distance: 1.311947342912068
Total norm for 4 adversaries is: 44.03948035658601. distance: 1.311947342912068
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0426, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3577/3797 (94.2060%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3467/3797 (91.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0632, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3084/3297 (93.5396%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3108/3297 (94.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7755, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3677/3911 (94.0169%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3482/3911 (89.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2107, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3011/3271 (92.0514%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2942/3271 (89.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0015, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3825/4046 (94.5378%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3811/4046 (94.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9071, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5327/5740 (92.8049%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5237/5740 (91.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1829, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3713/3969 (93.5500%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3629/3969 (91.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9236, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3446/3704 (93.0346%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3429/3704 (92.5756%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9464, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4424/4767 (92.8047%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4315/4767 (90.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9724, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4555/4956 (91.9088%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4442/4956 (89.6287%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0956, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3395/3590 (94.5682%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3037/3590 (84.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3823, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5443/5902 (92.2230%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5143/5902 (87.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1481, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4580/4928 (92.9383%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4562/4928 (92.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8783, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3994/4235 (94.3093%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3981/4235 (94.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8602, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4847/5265 (92.0608%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4681/5265 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0109, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4095/4356 (94.0083%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3762/4356 (86.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2626, Accuracy: 5223/10000 (52.2300%)
time spent on training: 252.37924885749817
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2769, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1503, Accuracy: 9503/9900 (95.9899%)
Done in 279.7870831489563 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4755/4885 (97.3388%), train_poison_data_count: 385
Global model norm: 44.088632266347155.
Norm before scaling: 44.05699489102866. Distance: 1.2403828689708483
Total norm for 4 adversaries is: 44.05699489102866. distance: 1.2403828689708483
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0224, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5124/5305 (96.5881%), train_poison_data_count: 415
Global model norm: 44.088632266347155.
Norm before scaling: 44.05864344824974. Distance: 1.399465896700644
Total norm for 4 adversaries is: 44.05864344824974. distance: 1.399465896700644
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0479, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4546/4717 (96.3748%), train_poison_data_count: 370
Global model norm: 44.088632266347155.
Norm before scaling: 44.060886218231445. Distance: 1.300724795837627
Total norm for 4 adversaries is: 44.060886218231445. distance: 1.300724795837627
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0296, Accuracy: 9824/9900 (99.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4923/5066 (97.1773%), train_poison_data_count: 400
Global model norm: 44.088632266347155.
Norm before scaling: 44.05804775822035. Distance: 1.3047569393478493
Total norm for 4 adversaries is: 44.05804775822035. distance: 1.3047569393478493
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0325, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3806/4025 (94.5590%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3866/4025 (96.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7273, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5435/5902 (92.0874%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5225/5902 (88.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1707, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4492/4793 (93.7200%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4438/4793 (92.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8913, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4847/5265 (92.0608%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4740/5265 (90.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0375, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4009/4295 (93.3411%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3881/4295 (90.3609%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0923, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3454/3704 (93.2505%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3457/3704 (93.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8660, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4729/5116 (92.4355%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4560/5116 (89.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0095, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5327/5740 (92.8049%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1812, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3588/3797 (94.4957%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3498/3797 (92.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8467, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4349/4716 (92.2180%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4292/4716 (91.0093%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2469, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4159/4433 (93.8191%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8889, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4102/4416 (92.8895%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4094/4416 (92.7083%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0003, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3929/4223 (93.0381%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8619, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4636/5083 (91.2060%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4545/5083 (89.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0991, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4300/4576 (93.9685%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4222/4576 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0143, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5019/5392 (93.0823%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4838/5392 (89.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0851, Accuracy: 5507/10000 (55.0700%)
time spent on training: 262.5857253074646
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.2779, Accuracy: 6752/10000 (67.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1431, Accuracy: 9534/9900 (96.3030%)
Done in 289.96213269233704 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.10938606978253.
Norm before scaling: 44.076524253102974. Distance: 1.216370092894629
Total norm for 4 adversaries is: 44.076524253102974. distance: 1.216370092894629
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0417, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5135/5305 (96.7955%), train_poison_data_count: 415
Global model norm: 44.10938606978253.
Norm before scaling: 44.07735925203338. Distance: 1.3623555273051637
Total norm for 4 adversaries is: 44.07735925203338. distance: 1.3623555273051637
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0684, Accuracy: 9723/9900 (98.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4550/4717 (96.4596%), train_poison_data_count: 370
Global model norm: 44.10938606978253.
Norm before scaling: 44.081900926092246. Distance: 1.2967221733036123
Total norm for 4 adversaries is: 44.081900926092246. distance: 1.2967221733036123
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0488, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4902/5066 (96.7627%), train_poison_data_count: 400
Global model norm: 44.10938606978253.
Norm before scaling: 44.08022831520173. Distance: 1.3465952801825514
Total norm for 4 adversaries is: 44.08022831520173. distance: 1.3465952801825514
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0736, Accuracy: 9733/9900 (98.3131%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4898/5265 (93.0294%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4764/5265 (90.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9908, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3844/4356 (88.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2795, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3612/3756 (96.1661%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3597/3756 (95.7668%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7970, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3601/3837 (93.8494%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3613/3837 (94.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9239, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5342/5740 (93.0662%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5259/5740 (91.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0291, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3917/4223 (92.7540%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3913/4223 (92.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8849, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4171/4465 (93.4155%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4134/4465 (92.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8770, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5078/5591 (90.8245%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5004/5591 (89.5010%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.4114, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5471/5902 (92.6974%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5068/5902 (85.8692%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3348, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4601/4918 (93.5543%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2437, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3621/3861 (93.7840%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9799, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3991/4295 (92.9220%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3887/4295 (90.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9742, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3786/4158 (91.0534%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0171, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5826/6263 (93.0225%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5702/6263 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0476, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4009/4354 (92.0763%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3289/4354 (75.5397%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5759, Accuracy: 4501/10000 (45.0100%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3583/3797 (94.3640%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3484/3797 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9586, Accuracy: 5650/10000 (56.5000%)
time spent on training: 262.6651632785797
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.2896, Accuracy: 6722/10000 (67.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1349, Accuracy: 9549/9900 (96.4545%)
Done in 289.65451669692993 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4756/4885 (97.3593%), train_poison_data_count: 385
Global model norm: 44.13063908062133.
Norm before scaling: 44.09755780643853. Distance: 1.199546893327004
Total norm for 4 adversaries is: 44.09755780643853. distance: 1.199546893327004
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1055, Accuracy: 9628/9900 (97.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5139/5305 (96.8709%), train_poison_data_count: 415
Global model norm: 44.13063908062133.
Norm before scaling: 44.098602784874316. Distance: 1.3460766366677779
Total norm for 4 adversaries is: 44.098602784874316. distance: 1.3460766366677779
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0519, Accuracy: 9767/9900 (98.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4573/4717 (96.9472%), train_poison_data_count: 370
Global model norm: 44.13063908062133.
Norm before scaling: 44.10068574748512. Distance: 1.218916857130111
Total norm for 4 adversaries is: 44.10068574748512. distance: 1.218916857130111
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0826, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4915/5066 (97.0193%), train_poison_data_count: 400
Global model norm: 44.13063908062133.
Norm before scaling: 44.10344950015248. Distance: 1.383668709893963
Total norm for 4 adversaries is: 44.10344950015248. distance: 1.383668709893963
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0696, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3574/3797 (94.1269%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3538/3797 (93.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8672, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4614/5037 (91.6021%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5037 (91.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9061, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4545/4934 (92.1159%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4297/4934 (87.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1818, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5056/5455 (92.6856%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4926/5455 (90.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0296, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5440/5902 (92.1721%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5108/5902 (86.5469%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3178, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5818/6391 (91.0343%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5681/6391 (88.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1844, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3704/3911 (94.7072%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3487/3911 (89.1588%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1223, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4806/5195 (92.5120%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4602/5195 (88.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0562, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3977/4235 (93.9079%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3934/4235 (92.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8575, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4759/5116 (93.0219%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4637/5116 (90.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0089, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4336/4538 (95.5487%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4335/4538 (95.5267%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8779, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5233/5582 (93.7478%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5116/5582 (91.6517%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1494, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4229/4558 (92.7819%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4172/4558 (91.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1254, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3810/4046 (94.1671%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3765/4046 (93.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8293, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3618/3828 (94.5141%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8072, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4694/5055 (92.8586%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4643/5055 (91.8497%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0464, Accuracy: 5516/10000 (55.1600%)
time spent on training: 266.6924273967743
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.2922, Accuracy: 6719/10000 (67.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1320, Accuracy: 9561/9900 (96.5758%)
Done in 293.89274287223816 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.15225372264776.
Norm before scaling: 44.119812571316814. Distance: 1.211448463187624
Total norm for 4 adversaries is: 44.119812571316814. distance: 1.211448463187624
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0415, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 44.15225372264776.
Norm before scaling: 44.12009754989782. Distance: 1.4036874098509164
Total norm for 4 adversaries is: 44.12009754989782. distance: 1.4036874098509164
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0430, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4580/4717 (97.0956%), train_poison_data_count: 370
Global model norm: 44.15225372264776.
Norm before scaling: 44.12039774379094. Distance: 1.1843332932509174
Total norm for 4 adversaries is: 44.12039774379094. distance: 1.1843332932509174
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0745, Accuracy: 9707/9900 (98.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4900/5066 (96.7233%), train_poison_data_count: 400
Global model norm: 44.15225372264776.
Norm before scaling: 44.12423091574798. Distance: 1.362842959365603
Total norm for 4 adversaries is: 44.12423091574798. distance: 1.362842959365603
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0487, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5262/5582 (94.2673%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5150/5582 (92.2608%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9995, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4150/4501 (92.2017%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4078/4501 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1023, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3667/3911 (93.7612%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3365/3911 (86.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4910, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4383/4663 (93.9953%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4344/4663 (93.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0767, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4914/5265 (93.3333%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0888, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4061/4416 (91.9611%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3992/4416 (90.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2591, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4178/4433 (94.2477%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4145/4433 (93.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7843, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5833/6263 (93.1343%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5680/6263 (90.6914%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1344, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5081/5455 (93.1439%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4922/5455 (90.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9038, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4315/4634 (93.1161%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4247/4634 (91.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0788, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4378/4707 (93.0104%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4337/4707 (92.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9799, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3881/4126 (94.0620%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3815/4126 (92.4624%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8632, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4801/5116 (93.8428%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4666/5116 (91.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9649, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4673/5063 (92.2971%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4404/5063 (86.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4728, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4059/4361 (93.0750%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3883/4361 (89.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4595, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5563/6124 (90.8393%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5533/6124 (90.3494%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9867, Accuracy: 5469/10000 (54.6900%)
time spent on training: 269.562716960907
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3034, Accuracy: 6711/10000 (67.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1266, Accuracy: 9582/9900 (96.7879%)
Done in 296.9073009490967 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4752/4885 (97.2774%), train_poison_data_count: 385
Global model norm: 44.17387989569246.
Norm before scaling: 44.14320512370789. Distance: 1.280766279508416
Total norm for 4 adversaries is: 44.14320512370789. distance: 1.280766279508416
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0281, Accuracy: 9825/9900 (99.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5128/5305 (96.6635%), train_poison_data_count: 415
Global model norm: 44.17387989569246.
Norm before scaling: 44.14133572436668. Distance: 1.3571458275124304
Total norm for 4 adversaries is: 44.14133572436668. distance: 1.3571458275124304
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1060, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4570/4717 (96.8836%), train_poison_data_count: 370
Global model norm: 44.17387989569246.
Norm before scaling: 44.14344294102466. Distance: 1.2421564542141665
Total norm for 4 adversaries is: 44.14344294102466. distance: 1.2421564542141665
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1063, Accuracy: 9629/9900 (97.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4914/5066 (96.9996%), train_poison_data_count: 400
Global model norm: 44.17387989569246.
Norm before scaling: 44.14298942782421. Distance: 1.3246212687924441
Total norm for 4 adversaries is: 44.14298942782421. distance: 1.3246212687924441
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0544, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4083/4356 (93.7328%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3903/4356 (89.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1933, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4109/4362 (94.1999%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4012/4362 (91.9762%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9368, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4375/4679 (93.5029%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4294/4679 (91.7717%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2576, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3830/4158 (92.1116%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3769/4158 (90.6445%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9220, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4354/4651 (93.6143%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4298/4651 (92.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0140, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3891/4175 (93.1976%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3807/4175 (91.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0085, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4328/4618 (93.7202%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4273/4618 (92.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0102, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4231/4625 (91.4811%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4112/4625 (88.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1156, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5228/5582 (93.6582%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1631, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4485/4874 (92.0189%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4288/4874 (87.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2831, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4567/4934 (92.5618%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4143/4934 (83.9684%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3588, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5112/5424 (94.2478%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5046/5424 (93.0310%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2462, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4461/4804 (92.8601%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4117/4804 (85.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4025, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4623/4918 (94.0016%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4545/4918 (92.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0957, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3614/3861 (93.6027%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3561/3861 (92.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8065, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3965/4223 (93.8906%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3930/4223 (93.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8006, Accuracy: 5862/10000 (58.6200%)
time spent on training: 263.81653022766113
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3060, Accuracy: 6700/10000 (67.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1198, Accuracy: 9590/9900 (96.8687%)
Done in 291.1289105415344 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4779/4885 (97.8301%), train_poison_data_count: 385
Global model norm: 44.194520470850655.
Norm before scaling: 44.159221746248825. Distance: 1.1660096952712498
Total norm for 4 adversaries is: 44.159221746248825. distance: 1.1660096952712498
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0410, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5148/5305 (97.0405%), train_poison_data_count: 415
Global model norm: 44.194520470850655.
Norm before scaling: 44.16127697190223. Distance: 1.3679004663040077
Total norm for 4 adversaries is: 44.16127697190223. distance: 1.3679004663040077
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0776, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 44.194520470850655.
Norm before scaling: 44.164358940054115. Distance: 1.2170976049798172
Total norm for 4 adversaries is: 44.164358940054115. distance: 1.2170976049798172
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0530, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4914/5066 (96.9996%), train_poison_data_count: 400
Global model norm: 44.194520470850655.
Norm before scaling: 44.164447387983216. Distance: 1.3463185180824235
Total norm for 4 adversaries is: 44.164447387983216. distance: 1.3463185180824235
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0319, Accuracy: 9817/9900 (99.1616%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4279/4647 (92.0809%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4226/4647 (90.9404%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8704, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3557/3804 (93.5068%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3525/3804 (92.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9013, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5155/5591 (92.2018%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5012/5591 (89.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1856, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4326/4634 (93.3535%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4262/4634 (91.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9525, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4182/4433 (94.3379%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4130/4433 (93.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7414, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3451/3704 (93.1695%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3410/3704 (92.0626%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8782, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3631/3837 (94.6312%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3635/3837 (94.7355%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8086, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5065/5455 (92.8506%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4922/5455 (90.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3133, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5377/5740 (93.6760%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5273/5740 (91.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1316, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4614/4986 (92.5391%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4561/4986 (91.4761%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9709, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4217/4456 (94.6364%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0431, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3756/4356 (86.2259%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3078, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3393/3590 (94.5125%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3290/3590 (91.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0293, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4236/4503 (94.0706%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4131/4503 (91.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9635, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4659/5037 (92.4955%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4669/5037 (92.6941%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9095, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4809/5167 (93.0714%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4721/5167 (91.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0930, Accuracy: 5381/10000 (53.8100%)
time spent on training: 263.6119589805603
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3197, Accuracy: 6681/10000 (66.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1120, Accuracy: 9606/9900 (97.0303%)
Done in 291.2396647930145 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.21385518402998.
Norm before scaling: 44.17874736510758. Distance: 1.2039462667717444
Total norm for 4 adversaries is: 44.17874736510758. distance: 1.2039462667717444
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0108, Accuracy: 9876/9900 (99.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5107/5305 (96.2677%), train_poison_data_count: 415
Global model norm: 44.21385518402998.
Norm before scaling: 44.182074012686414. Distance: 1.3965008074453868
Total norm for 4 adversaries is: 44.182074012686414. distance: 1.3965008074453868
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0532, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4545/4717 (96.3536%), train_poison_data_count: 370
Global model norm: 44.21385518402998.
Norm before scaling: 44.185363113553365. Distance: 1.2892808671429195
Total norm for 4 adversaries is: 44.185363113553365. distance: 1.2892808671429195
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0597, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4905/5066 (96.8220%), train_poison_data_count: 400
Global model norm: 44.21385518402998.
Norm before scaling: 44.18398174863898. Distance: 1.3533090761356577
Total norm for 4 adversaries is: 44.18398174863898. distance: 1.3533090761356577
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0835, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3371/3638 (92.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9507, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4373/4716 (92.7269%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4277/4716 (90.6913%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9569, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4561/4956 (92.0299%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4428/4956 (89.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3060, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5060/5392 (93.8427%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4891/5392 (90.7085%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1540, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3893/4184 (93.0449%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3898/4184 (93.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7053, Accuracy: 5984/10000 (59.8400%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4125/4481 (92.0553%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3945/4481 (88.0384%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0517, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3403/3646 (93.3352%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3437/3646 (94.2677%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8448, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4669/5025 (92.9154%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4550/5025 (90.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1139, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3367/3590 (93.7883%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3255/3590 (90.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9553, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4277/4596 (93.0592%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4305/4596 (93.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0418, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4044/4336 (93.2657%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3965/4336 (91.4437%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2260, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4481/4874 (91.9368%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4150/4874 (85.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.4518, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4821/5167 (93.3037%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4783/5167 (92.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2149, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4322/4618 (93.5903%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4248/4618 (91.9879%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9599, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4539/4928 (92.1063%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4498/4928 (91.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2272, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4303/4647 (92.5974%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4299/4647 (92.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0043, Accuracy: 5584/10000 (55.8400%)
time spent on training: 261.7618124485016
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3226, Accuracy: 6662/10000 (66.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1155, Accuracy: 9604/9900 (97.0101%)
Done in 289.01337361335754 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.23365473186112.
Norm before scaling: 44.19907081973698. Distance: 1.179371620986052
Total norm for 4 adversaries is: 44.19907081973698. distance: 1.179371620986052
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1072, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5141/5305 (96.9086%), train_poison_data_count: 415
Global model norm: 44.23365473186112.
Norm before scaling: 44.20034262407858. Distance: 1.3505770668516308
Total norm for 4 adversaries is: 44.20034262407858. distance: 1.3505770668516308
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0711, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4578/4717 (97.0532%), train_poison_data_count: 370
Global model norm: 44.23365473186112.
Norm before scaling: 44.202054876141645. Distance: 1.2202341384247573
Total norm for 4 adversaries is: 44.202054876141645. distance: 1.2202341384247573
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0783, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.23365473186112.
Norm before scaling: 44.20161024932025. Distance: 1.2979815255130251
Total norm for 4 adversaries is: 44.20161024932025. distance: 1.2979815255130251
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0410, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4026/4368 (92.1703%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3924/4368 (89.8352%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0395, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4764/5195 (91.7036%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4507/5195 (86.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1685, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4038/4315 (93.5805%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4015/4315 (93.0475%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0516, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3397/3646 (93.1706%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3376/3646 (92.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8330, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3404/3590 (94.8189%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3288/3590 (91.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0903, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3878/4126 (93.9893%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3870/4126 (93.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9303, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4046/4361 (92.7769%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3946/4361 (90.4838%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0637, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3621/3837 (94.3706%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3600/3837 (93.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9001, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4025/4235 (95.0413%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3847/4235 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9901, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5486/5902 (92.9515%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5236/5902 (88.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1664, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4191/4433 (94.5409%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4141/4433 (93.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8576, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3372/3638 (92.6883%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3378/3638 (92.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8546, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4816/5232 (92.0489%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4687/5232 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1477, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4008/4336 (92.4354%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3981/4336 (91.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9818, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4577/4989 (91.7418%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4577/4989 (91.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0804, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4163/4481 (92.9034%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3940/4481 (87.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2145, Accuracy: 5406/10000 (54.0600%)
time spent on training: 258.7207946777344
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3375, Accuracy: 6649/10000 (66.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1088, Accuracy: 9616/9900 (97.1313%)
Done in 285.8716084957123 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4770/4885 (97.6459%), train_poison_data_count: 385
Global model norm: 44.25318336889732.
Norm before scaling: 44.21724130597631. Distance: 1.1842595610310147
Total norm for 4 adversaries is: 44.21724130597631. distance: 1.1842595610310147
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0255, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5132/5305 (96.7389%), train_poison_data_count: 415
Global model norm: 44.25318336889732.
Norm before scaling: 44.21821720085371. Distance: 1.3038910587767518
Total norm for 4 adversaries is: 44.21821720085371. distance: 1.3038910587767518
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0648, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.25318336889732.
Norm before scaling: 44.220112335462666. Distance: 1.170077356568883
Total norm for 4 adversaries is: 44.220112335462666. distance: 1.170077356568883
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0574, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4912/5066 (96.9601%), train_poison_data_count: 400
Global model norm: 44.25318336889732.
Norm before scaling: 44.223662216111045. Distance: 1.3235750687584196
Total norm for 4 adversaries is: 44.223662216111045. distance: 1.3235750687584196
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0497, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4771/5116 (93.2565%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4696/5116 (91.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8766, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4126/4362 (94.5896%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2082, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4211/4441 (94.8210%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4207/4441 (94.7309%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9377, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4417/4663 (94.7244%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4364/4663 (93.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9975, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4714/5083 (92.7405%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4593/5083 (90.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0627, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4356/4767 (91.3782%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4257/4767 (89.3014%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0722, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3614/3797 (95.1804%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3568/3797 (93.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9088, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4779/5195 (91.9923%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4633/5195 (89.1819%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1787, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4336/4618 (93.8935%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4307/4618 (93.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9665, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4208/4433 (94.9244%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4107/4433 (92.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8076, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4706/5055 (93.0959%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5055 (91.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9050, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3815/4158 (91.7508%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3772/4158 (90.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9012, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3526/3781 (93.2558%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3284/3781 (86.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3592, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3755/4175 (89.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9967, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4896/5265 (92.9915%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4739/5265 (90.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1111, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3620/3837 (94.3445%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3637/3837 (94.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8796, Accuracy: 5818/10000 (58.1800%)
time spent on training: 257.5667345523834
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3395, Accuracy: 6645/10000 (66.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1029, Accuracy: 9630/9900 (97.2727%)
Done in 284.7194390296936 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.272848146553805.
Norm before scaling: 44.23839421205224. Distance: 1.2268096771961798
Total norm for 4 adversaries is: 44.23839421205224. distance: 1.2268096771961798
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0318, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5147/5305 (97.0217%), train_poison_data_count: 415
Global model norm: 44.272848146553805.
Norm before scaling: 44.238025833975684. Distance: 1.3128511322446639
Total norm for 4 adversaries is: 44.238025833975684. distance: 1.3128511322446639
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0381, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4594/4717 (97.3924%), train_poison_data_count: 370
Global model norm: 44.272848146553805.
Norm before scaling: 44.239179247232315. Distance: 1.1575911193147157
Total norm for 4 adversaries is: 44.239179247232315. distance: 1.1575911193147157
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0803, Accuracy: 9691/9900 (97.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4918/5066 (97.0786%), train_poison_data_count: 400
Global model norm: 44.272848146553805.
Norm before scaling: 44.24061407342523. Distance: 1.3042911224375473
Total norm for 4 adversaries is: 44.24061407342523. distance: 1.3042911224375473
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0227, Accuracy: 9844/9900 (99.4343%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3694/3911 (94.4515%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3466/3911 (88.6218%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2562, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4823/5195 (92.8393%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4571/5195 (87.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3137, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3575/3775 (94.7020%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3589/3775 (95.0728%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8488, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4398/4679 (93.9944%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4263/4679 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1647, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4070/4361 (93.3272%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3931/4361 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1069, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3434/3672 (93.5185%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3401/3672 (92.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9195, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4189/4481 (93.4836%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4017/4481 (89.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1455, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3850/4126 (93.3107%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3878/4126 (93.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7848, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3730/3969 (93.9783%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3661/3969 (92.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9699, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4801/5116 (93.8428%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4700/5116 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9051, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4674/5063 (92.3168%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4343/5063 (85.7792%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2402, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3099/3297 (93.9945%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8308, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4599/5037 (91.3043%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4641/5037 (92.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0776, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4290/4596 (93.3420%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4254/4596 (92.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1365, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4158/4501 (92.3795%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1912, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4222/4465 (94.5577%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4219/4465 (94.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8334, Accuracy: 5875/10000 (58.7500%)
time spent on training: 252.01446413993835
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3452, Accuracy: 6634/10000 (66.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0981, Accuracy: 9643/9900 (97.4040%)
Done in 279.30997920036316 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4759/4885 (97.4207%), train_poison_data_count: 385
Global model norm: 44.29172837165465.
Norm before scaling: 44.257318096311764. Distance: 1.1857026703227853
Total norm for 4 adversaries is: 44.257318096311764. distance: 1.1857026703227853
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0456, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 44.29172837165465.
Norm before scaling: 44.25955631493963. Distance: 1.3721990667458115
Total norm for 4 adversaries is: 44.25955631493963. distance: 1.3721990667458115
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0315, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4574/4717 (96.9684%), train_poison_data_count: 370
Global model norm: 44.29172837165465.
Norm before scaling: 44.25948874252842. Distance: 1.1970191191514339
Total norm for 4 adversaries is: 44.25948874252842. distance: 1.1970191191514339
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0706, Accuracy: 9715/9900 (98.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4929/5066 (97.2957%), train_poison_data_count: 400
Global model norm: 44.29172837165465.
Norm before scaling: 44.25973283013932. Distance: 1.266460849119184
Total norm for 4 adversaries is: 44.25973283013932. distance: 1.266460849119184
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0528, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4030/4361 (92.4100%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3997/4361 (91.6533%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1028, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4096/4346 (94.2476%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4134/4346 (95.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7680, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5103/5455 (93.5472%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5028/5455 (92.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0147, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4203/4465 (94.1321%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4187/4465 (93.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8098, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4017/4336 (92.6430%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3986/4336 (91.9280%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2894, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4253/4441 (95.7667%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4211/4441 (94.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9546, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4113/4362 (94.2916%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4013/4362 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1459, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3698/3969 (93.1721%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3699/3969 (93.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9441, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3974/4295 (92.5262%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3896/4295 (90.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9945, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4691/5017 (93.5021%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4653/5017 (92.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8475, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4652/5063 (91.8823%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4444/5063 (87.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3981, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3057/3271 (93.4577%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2925/3271 (89.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0535, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5881/6263 (93.9007%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5733/6263 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0263, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4512/4874 (92.5728%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4385/4874 (89.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1158, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3689/3911 (94.3237%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3355/3911 (85.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1172, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4462/4804 (92.8809%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4227/4804 (87.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1449, Accuracy: 5323/10000 (53.2300%)
time spent on training: 257.7059807777405
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3546, Accuracy: 6614/10000 (66.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0899, Accuracy: 9659/9900 (97.5657%)
Done in 284.8520905971527 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.3108278289926.
Norm before scaling: 44.27727189699728. Distance: 1.2359402064548186
Total norm for 4 adversaries is: 44.27727189699728. distance: 1.2359402064548186
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0170, Accuracy: 9850/9900 (99.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5139/5305 (96.8709%), train_poison_data_count: 415
Global model norm: 44.3108278289926.
Norm before scaling: 44.27756137600907. Distance: 1.3818565124489661
Total norm for 4 adversaries is: 44.27756137600907. distance: 1.3818565124489661
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0890, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4566/4717 (96.7988%), train_poison_data_count: 370
Global model norm: 44.3108278289926.
Norm before scaling: 44.27975721945709. Distance: 1.217453340188524
Total norm for 4 adversaries is: 44.27975721945709. distance: 1.217453340188524
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0470, Accuracy: 9774/9900 (98.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.3108278289926.
Norm before scaling: 44.28033476471243. Distance: 1.3357666084789177
Total norm for 4 adversaries is: 44.28033476471243. distance: 1.3357666084789177
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0371, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5491/5902 (93.0363%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5253/5902 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0665, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4918 (94.0830%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4631/4918 (94.1643%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0614, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3792/4025 (94.2112%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3804/4025 (94.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7784, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3283/3472 (94.5565%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3212/3472 (92.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9369, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4461/4793 (93.0732%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4472/4793 (93.3027%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9251, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4564/4934 (92.5010%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4450/4934 (90.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9432, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3715/3911 (94.9885%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3641/3911 (93.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9819, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5025/5392 (93.1936%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4842/5392 (89.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0972, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3407/3638 (93.6504%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3407/3638 (93.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7684, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5618/6124 (91.7374%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5421/6124 (88.5206%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1066, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3910/4175 (93.6527%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3844/4175 (92.0719%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9259, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4262/4625 (92.1514%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4088/4625 (88.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1267, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4049/4354 (92.9949%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3640/4354 (83.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.6577, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4165/4511 (92.3299%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4160/4511 (92.2190%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0248, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3506/3704 (94.6544%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3455/3704 (93.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8213, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3660/3861 (94.7941%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3576/3861 (92.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8837, Accuracy: 5786/10000 (57.8600%)
time spent on training: 261.33207988739014
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3644, Accuracy: 6581/10000 (65.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0910, Accuracy: 9650/9900 (97.4747%)
Done in 289.02472138404846 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.33047254314393.
Norm before scaling: 44.296106144121175. Distance: 1.2122912315677732
Total norm for 4 adversaries is: 44.296106144121175. distance: 1.2122912315677732
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0172, Accuracy: 9852/9900 (99.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5305 (96.9274%), train_poison_data_count: 415
Global model norm: 44.33047254314393.
Norm before scaling: 44.293537682925596. Distance: 1.3118502052875458
Total norm for 4 adversaries is: 44.293537682925596. distance: 1.3118502052875458
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0460, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4591/4717 (97.3288%), train_poison_data_count: 370
Global model norm: 44.33047254314393.
Norm before scaling: 44.29830382395795. Distance: 1.1842953456373297
Total norm for 4 adversaries is: 44.29830382395795. distance: 1.1842953456373297
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0995, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4919/5066 (97.0983%), train_poison_data_count: 400
Global model norm: 44.33047254314393.
Norm before scaling: 44.29682677466511. Distance: 1.3027841080948073
Total norm for 4 adversaries is: 44.29682677466511. distance: 1.3027841080948073
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0227, Accuracy: 9850/9900 (99.4949%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4683/5083 (92.1306%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4528/5083 (89.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3324, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3449/3646 (94.5968%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3390/3646 (92.9786%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8594, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4229/4503 (93.9152%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4135/4503 (91.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9870, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4198/4501 (93.2682%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4101/4501 (91.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9748, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3755/4013 (93.5709%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3731/4013 (92.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8658, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4164/4362 (95.4608%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1863, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4093/4315 (94.8552%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4078/4315 (94.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8228, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4374/4651 (94.0443%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4296/4651 (92.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0640, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4081/4416 (92.4139%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4077/4416 (92.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0856, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3446/3704 (93.0346%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3471/3704 (93.7095%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7983, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4352/4707 (92.4580%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4326/4707 (91.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9550, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4323/4662 (92.7284%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4310/4662 (92.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9618, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5069/5424 (93.4550%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4956/5424 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1804, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4051/4336 (93.4271%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4036/4336 (93.0812%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9970, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4165/4481 (92.9480%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3965/4481 (88.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9934, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3632/3828 (94.8798%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3610/3828 (94.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7520, Accuracy: 6028/10000 (60.2800%)
time spent on training: 257.6503450870514
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3633, Accuracy: 6591/10000 (65.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0861, Accuracy: 9665/9900 (97.6263%)
Done in 284.9741494655609 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.34885343254378.
Norm before scaling: 44.31518994171539. Distance: 1.2773609218551416
Total norm for 4 adversaries is: 44.31518994171539. distance: 1.2773609218551416
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0226, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5149/5305 (97.0594%), train_poison_data_count: 415
Global model norm: 44.34885343254378.
Norm before scaling: 44.31582762540941. Distance: 1.372494452140449
Total norm for 4 adversaries is: 44.31582762540941. distance: 1.372494452140449
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0134, Accuracy: 9866/9900 (99.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 44.34885343254378.
Norm before scaling: 44.318246057281534. Distance: 1.2351842231647185
Total norm for 4 adversaries is: 44.318246057281534. distance: 1.2351842231647185
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0667, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4920/5066 (97.1180%), train_poison_data_count: 400
Global model norm: 44.34885343254378.
Norm before scaling: 44.31619535675911. Distance: 1.3095741357256832
Total norm for 4 adversaries is: 44.31619535675911. distance: 1.3095741357256832
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0852, Accuracy: 9699/9900 (97.9697%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3899/4184 (93.1883%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3890/4184 (92.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8788, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4610/5037 (91.5227%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5037 (91.5029%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9126, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3832/4158 (92.1597%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3814/4158 (91.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9086, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3044/3271 (93.0602%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3042/3271 (92.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7233, Accuracy: 6055/10000 (60.5500%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4639/4918 (94.3270%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4572/4918 (92.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0499, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5474/5902 (92.7482%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5167/5902 (87.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2191, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4091/4354 (93.9596%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3403/4354 (78.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.6679, Accuracy: 4530/10000 (45.3000%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3760/3969 (94.7342%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3709/3969 (93.4492%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9468, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3899/4356 (89.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2691, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4020/4295 (93.5972%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3674/4295 (85.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4027, Accuracy: 4820/10000 (48.2000%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3890/4126 (94.2802%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3881/4126 (94.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9531, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4630/4928 (93.9529%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4527/4928 (91.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9723, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4193/4511 (92.9506%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4131/4511 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0196, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4339/4618 (93.9584%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4188/4618 (90.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1790, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3475/3704 (93.8175%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3439/3704 (92.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8489, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3352/3616 (92.6991%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3346/3616 (92.5332%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0271, Accuracy: 5695/10000 (56.9500%)
time spent on training: 258.7109463214874
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3613, Accuracy: 6588/10000 (65.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0840, Accuracy: 9673/9900 (97.7071%)
Done in 286.06285667419434 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4769/4885 (97.6254%), train_poison_data_count: 385
Global model norm: 44.367855388748225.
Norm before scaling: 44.33196636951151. Distance: 1.1787480535723736
Total norm for 4 adversaries is: 44.33196636951151. distance: 1.1787480535723736
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0852, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5151/5305 (97.0971%), train_poison_data_count: 415
Global model norm: 44.367855388748225.
Norm before scaling: 44.33267953338006. Distance: 1.3159269824453583
Total norm for 4 adversaries is: 44.33267953338006. distance: 1.3159269824453583
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0900, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4581/4717 (97.1168%), train_poison_data_count: 370
Global model norm: 44.367855388748225.
Norm before scaling: 44.33424074396392. Distance: 1.1621252235165374
Total norm for 4 adversaries is: 44.33424074396392. distance: 1.1621252235165374
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0338, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4923/5066 (97.1773%), train_poison_data_count: 400
Global model norm: 44.367855388748225.
Norm before scaling: 44.336181855053496. Distance: 1.2935546285199293
Total norm for 4 adversaries is: 44.336181855053496. distance: 1.2935546285199293
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0575, Accuracy: 9759/9900 (98.5758%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3018/3271 (92.2654%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3040/3271 (92.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8530, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4201/4456 (94.2774%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4170/4456 (93.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8555, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3799/4013 (94.6673%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3787/4013 (94.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6937, Accuracy: 5972/10000 (59.7200%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3522/3781 (93.1500%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3460/3781 (91.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2330, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3541/3775 (93.8013%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3593/3775 (95.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7643, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4825/5232 (92.2209%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4710/5232 (90.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2089, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4604/4989 (92.2830%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4495/4989 (90.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1861, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3437/3646 (94.2677%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3434/3646 (94.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7504, Accuracy: 6000/10000 (60.0000%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4110/4315 (95.2491%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4031/4315 (93.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9556, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4616/4918 (93.8593%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0974, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4091/4416 (92.6404%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9210, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5831/6263 (93.1023%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5777/6263 (92.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9999, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5657/6124 (92.3743%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5449/6124 (88.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1767, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4378/4651 (94.1303%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4311/4651 (92.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8858, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4068/4356 (93.3884%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3762/4356 (86.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4858, Accuracy: 4799/10000 (47.9900%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4078/4356 (93.6180%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3692/4356 (84.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3807, Accuracy: 4840/10000 (48.4000%)
time spent on training: 255.32543969154358
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3619, Accuracy: 6578/10000 (65.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0862, Accuracy: 9662/9900 (97.5960%)
Done in 282.4601376056671 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.38689046240877.
Norm before scaling: 44.353935636483406. Distance: 1.2654098516252874
Total norm for 4 adversaries is: 44.353935636483406. distance: 1.2654098516252874
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0262, Accuracy: 9839/9900 (99.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.38689046240877.
Norm before scaling: 44.35207924769424. Distance: 1.3189342460467457
Total norm for 4 adversaries is: 44.35207924769424. distance: 1.3189342460467457
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0614, Accuracy: 9747/9900 (98.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.38689046240877.
Norm before scaling: 44.352669612525155. Distance: 1.165120405761252
Total norm for 4 adversaries is: 44.352669612525155. distance: 1.165120405761252
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0770, Accuracy: 9705/9900 (98.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4943/5066 (97.5720%), train_poison_data_count: 400
Global model norm: 44.38689046240877.
Norm before scaling: 44.351486122666316. Distance: 1.1939606345922262
Total norm for 4 adversaries is: 44.351486122666316. distance: 1.1939606345922262
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0664, Accuracy: 9739/9900 (98.3737%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4338/4716 (91.9847%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4249/4716 (90.0975%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9900, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4290/4634 (92.5766%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4226/4634 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9397, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3637/3828 (95.0104%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3592/3828 (93.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9217, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4625/4989 (92.7039%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4557/4989 (91.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0547, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4822/5116 (94.2533%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4697/5116 (91.8100%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1378, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4158/4362 (95.3232%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4025/4362 (92.2742%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0365, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4700/5017 (93.6815%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4566/5017 (91.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9450, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4098/4354 (94.1203%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3587/4354 (82.3840%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.6808, Accuracy: 4462/10000 (44.6200%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3368/3638 (92.5783%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3407/3638 (93.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8790, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4799/5195 (92.3773%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4532/5195 (87.2377%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1993, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4265/4596 (92.7981%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4311/4596 (93.7990%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0158, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4549/4928 (92.3093%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4531/4928 (91.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0672, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4795/5244 (91.4378%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4619/5244 (88.0816%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1034, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5495/5902 (93.1040%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5159/5902 (87.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2922, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4656/5025 (92.6567%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2341, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5653/6124 (92.3089%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5415/6124 (88.4226%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1240, Accuracy: 5237/10000 (52.3700%)
time spent on training: 263.5591313838959
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3655, Accuracy: 6585/10000 (65.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0790, Accuracy: 9689/9900 (97.8687%)
Done in 290.8725824356079 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.408502702801044.
Norm before scaling: 44.37342646858027. Distance: 1.2072348314960848
Total norm for 4 adversaries is: 44.37342646858027. distance: 1.2072348314960848
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0304, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5171/5305 (97.4741%), train_poison_data_count: 415
Global model norm: 44.408502702801044.
Norm before scaling: 44.37072217496719. Distance: 1.2552677736678373
Total norm for 4 adversaries is: 44.37072217496719. distance: 1.2552677736678373
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0581, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.408502702801044.
Norm before scaling: 44.374074319130166. Distance: 1.1736549084608976
Total norm for 4 adversaries is: 44.374074319130166. distance: 1.1736549084608976
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0256, Accuracy: 9827/9900 (99.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.408502702801044.
Norm before scaling: 44.3747826799256. Distance: 1.2695342078541263
Total norm for 4 adversaries is: 44.3747826799256. distance: 1.2695342078541263
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0580, Accuracy: 9756/9900 (98.5455%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4814/5116 (94.0970%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4657/5116 (91.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1523, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4827/5197 (92.8805%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4699/5197 (90.4175%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3178, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4116/4356 (94.4904%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3793/4356 (87.0753%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2325, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4423/4679 (94.5287%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4013/4679 (85.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3876, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4342/4647 (93.4366%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4285/4647 (92.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0237, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3717/3911 (95.0396%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3431/3911 (87.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3755, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4091/4315 (94.8088%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4081/4315 (94.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8480, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3406/3646 (93.4174%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3385/3646 (92.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7448, Accuracy: 6018/10000 (60.1800%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4337/4634 (93.5909%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4281/4634 (92.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9469, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4742/5055 (93.8081%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4696/5055 (92.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8261, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4176/4362 (95.7359%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3984/4362 (91.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9840, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4580/4934 (92.8253%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4197/4934 (85.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3718, Accuracy: 4866/10000 (48.6600%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4349/4767 (91.2314%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4233/4767 (88.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1772, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4185/4433 (94.4056%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4153/4433 (93.6837%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8884, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4480/4928 (90.9091%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4443/4928 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0852, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3624/3837 (94.4488%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3619/3837 (94.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9428, Accuracy: 5728/10000 (57.2800%)
time spent on training: 261.93647265434265
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3597, Accuracy: 6598/10000 (65.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0827, Accuracy: 9675/9900 (97.7273%)
Done in 289.2584385871887 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4768/4885 (97.6049%), train_poison_data_count: 385
Global model norm: 44.42857955911516.
Norm before scaling: 44.39360167994018. Distance: 1.1954638316779127
Total norm for 4 adversaries is: 44.39360167994018. distance: 1.1954638316779127
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0894, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5139/5305 (96.8709%), train_poison_data_count: 415
Global model norm: 44.42857955911516.
Norm before scaling: 44.39295686413133. Distance: 1.3506402634336765
Total norm for 4 adversaries is: 44.39295686413133. distance: 1.3506402634336765
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0312, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4581/4717 (97.1168%), train_poison_data_count: 370
Global model norm: 44.42857955911516.
Norm before scaling: 44.39537109439874. Distance: 1.2060700079682287
Total norm for 4 adversaries is: 44.39537109439874. distance: 1.2060700079682287
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0234, Accuracy: 9843/9900 (99.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4918/5066 (97.0786%), train_poison_data_count: 400
Global model norm: 44.42857955911516.
Norm before scaling: 44.39533259972973. Distance: 1.2921678073401903
Total norm for 4 adversaries is: 44.39533259972973. distance: 1.2921678073401903
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0722, Accuracy: 9724/9900 (98.2222%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4659/4986 (93.4416%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4559/4986 (91.4360%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9549, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4409/4767 (92.4900%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4277/4767 (89.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0480, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4095/4315 (94.9015%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4061/4315 (94.1136%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8700, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3453/3672 (94.0359%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3413/3672 (92.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9547, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4263/4558 (93.5279%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3971/4558 (87.1215%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.4727, Accuracy: 4877/10000 (48.7700%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3663/3828 (95.6897%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3637/3828 (95.0104%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7944, Accuracy: 5928/10000 (59.2800%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4388/4679 (93.7807%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4047/4679 (86.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3501, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4548/4956 (91.7676%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4415/4956 (89.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1254, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4094/4356 (93.9853%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3827/4356 (87.8558%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5139, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4294/4538 (94.6232%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4289/4538 (94.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8937, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3757/4013 (93.6207%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3785/4013 (94.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7784, Accuracy: 6003/10000 (60.0300%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4922/5265 (93.4853%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4806/5265 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9695, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4402/4663 (94.4027%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4377/4663 (93.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0105, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5859/6263 (93.5494%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5764/6263 (92.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2331, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4690/5063 (92.6328%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4306/5063 (85.0484%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2845, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4095/4416 (92.7310%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4133/4416 (93.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9559, Accuracy: 5623/10000 (56.2300%)
time spent on training: 262.8347246646881
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3635, Accuracy: 6603/10000 (66.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0854, Accuracy: 9667/9900 (97.6465%)
Done in 290.0603606700897 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.44834387733136.
Norm before scaling: 44.41256937353856. Distance: 1.2024972442151254
Total norm for 4 adversaries is: 44.41256937353856. distance: 1.2024972442151254
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0416, Accuracy: 9798/9900 (98.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5305 (97.4364%), train_poison_data_count: 415
Global model norm: 44.44834387733136.
Norm before scaling: 44.408484835565204. Distance: 1.203445342381832
Total norm for 4 adversaries is: 44.408484835565204. distance: 1.203445342381832
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0559, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.44834387733136.
Norm before scaling: 44.4140398251921. Distance: 1.1518215224570763
Total norm for 4 adversaries is: 44.4140398251921. distance: 1.1518215224570763
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0670, Accuracy: 9732/9900 (98.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4936/5066 (97.4339%), train_poison_data_count: 400
Global model norm: 44.44834387733136.
Norm before scaling: 44.41296928623792. Distance: 1.2581531229301268
Total norm for 4 adversaries is: 44.41296928623792. distance: 1.2581531229301268
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0406, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5391/5740 (93.9199%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5222/5740 (90.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2718, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4376/4651 (94.0873%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4310/4651 (92.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0091, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4255/4503 (94.4926%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4095/4503 (90.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0280, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4425/4767 (92.8257%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4328/4767 (90.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1345, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5157/5591 (92.2375%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4923/5591 (88.0522%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0795, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4182/4465 (93.6618%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4200/4465 (94.0649%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9158, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4601/4956 (92.8370%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4452/4956 (89.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2153, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3499/3704 (94.4654%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3462/3704 (93.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8523, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3828/4025 (95.1056%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3823/4025 (94.9814%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7863, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4754/5083 (93.5274%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4613/5083 (90.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1605, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5654/6124 (92.3253%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5472/6124 (89.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0307, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3993/4295 (92.9686%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3933/4295 (91.5716%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0012, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4468/4804 (93.0058%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4089/4804 (85.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4183, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4510/4793 (94.0956%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4471/4793 (93.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0040, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4193/4433 (94.5861%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4170/4433 (94.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9005, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4084/4361 (93.6482%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3885/4361 (89.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0735, Accuracy: 5451/10000 (54.5100%)
time spent on training: 264.8370213508606
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3665, Accuracy: 6600/10000 (66.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0849, Accuracy: 9675/9900 (97.7273%)
Done in 292.2877206802368 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4766/4885 (97.5640%), train_poison_data_count: 385
Global model norm: 44.46870745122701.
Norm before scaling: 44.434471316883446. Distance: 1.2353383421661672
Total norm for 4 adversaries is: 44.434471316883446. distance: 1.2353383421661672
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0262, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5151/5305 (97.0971%), train_poison_data_count: 415
Global model norm: 44.46870745122701.
Norm before scaling: 44.43177073870186. Distance: 1.329576977665095
Total norm for 4 adversaries is: 44.43177073870186. distance: 1.329576977665095
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0383, Accuracy: 9804/9900 (99.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4601/4717 (97.5408%), train_poison_data_count: 370
Global model norm: 44.46870745122701.
Norm before scaling: 44.43455373276171. Distance: 1.15674157905028
Total norm for 4 adversaries is: 44.43455373276171. distance: 1.15674157905028
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0533, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 44.46870745122701.
Norm before scaling: 44.43501113810764. Distance: 1.2967405134581762
Total norm for 4 adversaries is: 44.43501113810764. distance: 1.2967405134581762
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0396, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4273/4558 (93.7473%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4136/4558 (90.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1145, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4342/4596 (94.4735%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4287/4596 (93.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9380, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4559/4874 (93.5371%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4353/4874 (89.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2529, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3859/4158 (92.8090%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3802/4158 (91.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9119, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5113/5455 (93.7305%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4969/5455 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0591, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4114/4346 (94.6618%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4105/4346 (94.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8443, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4424/4679 (94.5501%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4376/4679 (93.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9610, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4099/4416 (92.8216%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4073/4416 (92.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8724, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3615/3828 (94.4357%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3625/3828 (94.6970%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8214, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3991/4223 (94.5063%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3989/4223 (94.4589%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8286, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4904/5265 (93.1434%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4677/5265 (88.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1314, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5621/6124 (91.7864%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5439/6124 (88.8145%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1283, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4100/4361 (94.0151%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3924/4361 (89.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0798, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4616/4956 (93.1396%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4368/4956 (88.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3541, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5351/5740 (93.2230%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1459, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3798/4013 (94.6424%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3800/4013 (94.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9336, Accuracy: 5680/10000 (56.8000%)
time spent on training: 262.84311747550964
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3642, Accuracy: 6601/10000 (66.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0853, Accuracy: 9672/9900 (97.6970%)
Done in 290.3989555835724 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.4884813809815.
Norm before scaling: 44.453085182319604. Distance: 1.2089106178278743
Total norm for 4 adversaries is: 44.453085182319604. distance: 1.2089106178278743
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0429, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5163/5305 (97.3233%), train_poison_data_count: 415
Global model norm: 44.4884813809815.
Norm before scaling: 44.451860427970985. Distance: 1.3000460084696535
Total norm for 4 adversaries is: 44.451860427970985. distance: 1.3000460084696535
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0541, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.4884813809815.
Norm before scaling: 44.45273231373129. Distance: 1.1448573666649566
Total norm for 4 adversaries is: 44.45273231373129. distance: 1.1448573666649566
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0820, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4926/5066 (97.2365%), train_poison_data_count: 400
Global model norm: 44.4884813809815.
Norm before scaling: 44.45547006116767. Distance: 1.268041399686047
Total norm for 4 adversaries is: 44.45547006116767. distance: 1.268041399686047
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0778, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3929/4184 (93.9054%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3897/4184 (93.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8913, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3420/3590 (95.2646%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3285/3590 (91.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1527, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3808/4158 (91.5825%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3780/4158 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9795, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3834/4025 (95.2547%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3794/4025 (94.2609%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8519, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3837/4046 (94.8344%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3715/4046 (91.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8663, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4679/5025 (93.1144%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4581/5025 (91.1642%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2361, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4650/5063 (91.8428%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4372/5063 (86.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3234, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4085/4356 (93.7787%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4100/4356 (94.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9130, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4382/4651 (94.2163%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4322/4651 (92.9263%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9984, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4122/4356 (94.6281%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3822/4356 (87.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2373, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4303/4576 (94.0341%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4229/4576 (92.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0157, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4239/4456 (95.1302%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4212/4456 (94.5242%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8629, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3122/3297 (94.6921%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3138/3297 (95.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8783, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4513/4804 (93.9425%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4097/4804 (85.2831%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4061, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3756/3969 (94.6334%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3647/3969 (91.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9170, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4811/5195 (92.6083%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4555/5195 (87.6805%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2241, Accuracy: 5125/10000 (51.2500%)
time spent on training: 256.87615728378296
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3669, Accuracy: 6609/10000 (66.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0837, Accuracy: 9681/9900 (97.7879%)
Done in 284.2699348926544 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4775/4885 (97.7482%), train_poison_data_count: 385
Global model norm: 44.50668319064916.
Norm before scaling: 44.470793665706175. Distance: 1.1595035348059435
Total norm for 4 adversaries is: 44.470793665706175. distance: 1.1595035348059435
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0611, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.50668319064916.
Norm before scaling: 44.46920293602782. Distance: 1.295862653018317
Total norm for 4 adversaries is: 44.46920293602782. distance: 1.295862653018317
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0307, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4591/4717 (97.3288%), train_poison_data_count: 370
Global model norm: 44.50668319064916.
Norm before scaling: 44.470823860197235. Distance: 1.1412815138110248
Total norm for 4 adversaries is: 44.470823860197235. distance: 1.1412815138110248
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0564, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4928/5066 (97.2760%), train_poison_data_count: 400
Global model norm: 44.50668319064916.
Norm before scaling: 44.47323660825759. Distance: 1.3040951052076355
Total norm for 4 adversaries is: 44.47323660825759. distance: 1.3040951052076355
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0690, Accuracy: 9714/9900 (98.1212%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3655/3837 (95.2567%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3662/3837 (95.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7044, Accuracy: 6130/10000 (61.3000%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5250/5582 (94.0523%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5032/5582 (90.1469%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1551, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5099/5455 (93.4739%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4937/5455 (90.5041%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0947, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4374/4679 (93.4815%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4301/4679 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9741, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4252/4518 (94.1124%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4232/4518 (93.6698%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9688, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4383/4618 (94.9112%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4324/4618 (93.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0426, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4335/4716 (91.9211%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4223/4716 (89.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1252, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4798/5244 (91.4950%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4702/5244 (89.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0908, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4545/4874 (93.2499%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4343/4874 (89.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3148, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4562/4928 (92.5731%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4507/4928 (91.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0445, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3898/4126 (94.4741%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3904/4126 (94.6195%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7767, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3627/3828 (94.7492%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3586/3828 (93.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9704, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3256/3472 (93.7788%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3212/3472 (92.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0399, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3396/3638 (93.3480%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3353/3638 (92.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9325, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3403/3590 (94.7911%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3234/3590 (90.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2081, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3956/4223 (93.6775%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3934/4223 (93.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8653, Accuracy: 5730/10000 (57.3000%)
time spent on training: 260.4008557796478
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3662, Accuracy: 6596/10000 (65.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0863, Accuracy: 9672/9900 (97.6970%)
Done in 287.77881240844727 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.52488715507177.
Norm before scaling: 44.48857055645023. Distance: 1.2133292420199517
Total norm for 4 adversaries is: 44.48857055645023. distance: 1.2133292420199517
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0984, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5169/5305 (97.4364%), train_poison_data_count: 415
Global model norm: 44.52488715507177.
Norm before scaling: 44.486330140122114. Distance: 1.2796586085820418
Total norm for 4 adversaries is: 44.486330140122114. distance: 1.2796586085820418
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0379, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4591/4717 (97.3288%), train_poison_data_count: 370
Global model norm: 44.52488715507177.
Norm before scaling: 44.49090003075769. Distance: 1.1628704752279948
Total norm for 4 adversaries is: 44.49090003075769. distance: 1.1628704752279948
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0457, Accuracy: 9794/9900 (98.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.52488715507177.
Norm before scaling: 44.4884347352805. Distance: 1.2380095945026546
Total norm for 4 adversaries is: 44.4884347352805. distance: 1.2380095945026546
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0261, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4234/4441 (95.3389%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4167/4441 (93.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0225, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4664/5017 (92.9639%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4638/5017 (92.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9928, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4660/4918 (94.7540%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4607/4918 (93.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9428, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4895/5197 (94.1890%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4708/5197 (90.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0377, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4140/4356 (95.0413%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3768/4356 (86.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3266, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5129/5455 (94.0238%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5008/5455 (91.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0506, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3126/3297 (94.8135%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3125/3297 (94.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7391, Accuracy: 6054/10000 (60.5400%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4846/5195 (93.2820%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4722/5195 (90.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1682, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3687/3828 (96.3166%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3638/3828 (95.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7373, Accuracy: 6125/10000 (61.2500%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4234/4456 (95.0180%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4173/4456 (93.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8520, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4107/4361 (94.1756%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3826/4361 (87.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3429, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4020/4235 (94.9233%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3901/4235 (92.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0710, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4664/5025 (92.8159%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4610/5025 (91.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0882, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3418/3646 (93.7466%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3430/3646 (94.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7197, Accuracy: 5969/10000 (59.6900%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3803/4158 (91.4622%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3725/4158 (89.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1354, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4328/4538 (95.3724%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4344/4538 (95.7250%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7460, Accuracy: 6018/10000 (60.1800%)
time spent on training: 256.39307832717896
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.3763, Accuracy: 6576/10000 (65.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0811, Accuracy: 9686/9900 (97.8384%)
Done in 283.8390734195709 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4779/4885 (97.8301%), train_poison_data_count: 385
Global model norm: 44.54296720846485.
Norm before scaling: 44.505358426946046. Distance: 1.1360637442475015
Total norm for 4 adversaries is: 44.505358426946046. distance: 1.1360637442475015
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0658, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5147/5305 (97.0217%), train_poison_data_count: 415
Global model norm: 44.54296720846485.
Norm before scaling: 44.506596794218325. Distance: 1.337159963860501
Total norm for 4 adversaries is: 44.506596794218325. distance: 1.337159963860501
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0094, Accuracy: 9876/9900 (99.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.54296720846485.
Norm before scaling: 44.5079722603329. Distance: 1.1849691626805763
Total norm for 4 adversaries is: 44.5079722603329. distance: 1.1849691626805763
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0231, Accuracy: 9847/9900 (99.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4940/5066 (97.5128%), train_poison_data_count: 400
Global model norm: 44.54296720846485.
Norm before scaling: 44.50814367636135. Distance: 1.2526162425177503
Total norm for 4 adversaries is: 44.50814367636135. distance: 1.2526162425177503
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0362, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4059/4295 (94.5052%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3933/4295 (91.5716%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0047, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5271/5582 (94.4285%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5180/5582 (92.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2123, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3415/3672 (93.0011%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3413/3672 (92.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9068, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4263/4518 (94.3559%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4176/4518 (92.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9800, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3601/3797 (94.8380%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3546/3797 (93.3895%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9300, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4187/4362 (95.9881%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3993/4362 (91.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0488, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4487/4804 (93.4013%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3830/4804 (79.7252%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.5975, Accuracy: 4719/10000 (47.1900%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4820/5116 (94.2142%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4693/5116 (91.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8915, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4672/5025 (92.9751%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1268, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3132/3297 (94.9955%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3129/3297 (94.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.6993, Accuracy: 6062/10000 (60.6200%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3498/3704 (94.4384%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3462/3704 (93.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0072, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5076/5424 (93.5841%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5031/5424 (92.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3456, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3653/3861 (94.6128%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3631/3861 (94.0430%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9220, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4553/4874 (93.4140%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4458/4874 (91.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2605, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4378/4647 (94.2113%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4320/4647 (92.9632%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9241, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4095/4356 (94.0083%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3764/4356 (86.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.4881, Accuracy: 4880/10000 (48.8000%)
time spent on training: 259.6302568912506
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.3790, Accuracy: 6560/10000 (65.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0763, Accuracy: 9697/9900 (97.9495%)
Done in 286.88316535949707 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 44.56107005945604.
Norm before scaling: 44.52403724482007. Distance: 1.1777524424822945
Total norm for 4 adversaries is: 44.52403724482007. distance: 1.1777524424822945
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0938, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5158/5305 (97.2290%), train_poison_data_count: 415
Global model norm: 44.56107005945604.
Norm before scaling: 44.52525453061021. Distance: 1.3331523216083987
Total norm for 4 adversaries is: 44.52525453061021. distance: 1.3331523216083987
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0392, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.56107005945604.
Norm before scaling: 44.5258042174528. Distance: 1.1593659146099433
Total norm for 4 adversaries is: 44.5258042174528. distance: 1.1593659146099433
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0592, Accuracy: 9741/9900 (98.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.56107005945604.
Norm before scaling: 44.52947227811248. Distance: 1.3323260565587587
Total norm for 4 adversaries is: 44.52947227811248. distance: 1.3323260565587587
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0227, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4235/4503 (94.0484%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4080/4503 (90.6063%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9553, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3636/3861 (94.1725%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3624/3861 (93.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8010, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3946/4184 (94.3117%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3856/4184 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9535, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4267/4518 (94.4444%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4237/4518 (93.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9549, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4768/5083 (93.8029%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4577/5083 (90.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2029, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4526/4804 (94.2132%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3763/4804 (78.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.5433, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4096/4356 (94.0312%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3817/4356 (87.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3872, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4735/5244 (90.2937%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4599/5244 (87.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1454, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4455/4679 (95.2127%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4153/4679 (88.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2906, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4074/4416 (92.2554%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4067/4416 (92.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9184, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4650/4918 (94.5506%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4526/4918 (92.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2220, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3374/3616 (93.3075%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3406/3616 (94.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7931, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4300/4576 (93.9685%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4245/4576 (92.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0074, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4663/4928 (94.6226%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4540/4928 (92.1266%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8906, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3814/4013 (95.0411%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3801/4013 (94.7172%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7900, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4070/4336 (93.8653%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4007/4336 (92.4124%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0947, Accuracy: 5440/10000 (54.4000%)
time spent on training: 257.18287110328674
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.3930, Accuracy: 6547/10000 (65.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0747, Accuracy: 9704/9900 (98.0202%)
Done in 284.7061507701874 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.58018281922263.
Norm before scaling: 44.54366329179859. Distance: 1.1819373396677244
Total norm for 4 adversaries is: 44.54366329179859. distance: 1.1819373396677244
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0355, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5162/5305 (97.3044%), train_poison_data_count: 415
Global model norm: 44.58018281922263.
Norm before scaling: 44.54153801114683. Distance: 1.2731156205668435
Total norm for 4 adversaries is: 44.54153801114683. distance: 1.2731156205668435
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0559, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.58018281922263.
Norm before scaling: 44.54542263504046. Distance: 1.1939275859138982
Total norm for 4 adversaries is: 44.54542263504046. distance: 1.1939275859138982
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0077, Accuracy: 9877/9900 (99.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4931/5066 (97.3352%), train_poison_data_count: 400
Global model norm: 44.58018281922263.
Norm before scaling: 44.5454240052184. Distance: 1.254281436488947
Total norm for 4 adversaries is: 44.5454240052184. distance: 1.254281436488947
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0437, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5893/6263 (94.0923%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5805/6263 (92.6872%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9718, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3320/3472 (95.6221%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0379, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3862/4158 (92.8812%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3842/4158 (92.4002%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9086, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3386/3638 (93.0731%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3434/3638 (94.3925%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9501, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4566/4874 (93.6808%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4285/4874 (87.9155%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2793, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4121/4356 (94.6051%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3469/4356 (79.6373%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5972, Accuracy: 4564/10000 (45.6400%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4270/4538 (94.0943%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4262/4538 (93.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9021, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4638/4928 (94.1153%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4576/4928 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0177, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4368/4618 (94.5864%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4307/4618 (93.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9314, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4423/4707 (93.9664%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4346/4707 (92.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9558, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4431/4679 (94.6997%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4371/4679 (93.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2021, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4358/4647 (93.7809%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4371/4647 (94.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9242, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4334/4576 (94.7115%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4269/4576 (93.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1684, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3818/4046 (94.3648%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3829/4046 (94.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9079, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4376/4651 (94.0873%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4364/4651 (93.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0723, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4724/5055 (93.4520%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4669/5055 (92.3640%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9308, Accuracy: 5740/10000 (57.4000%)
time spent on training: 261.4315481185913
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4002, Accuracy: 6522/10000 (65.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0753, Accuracy: 9706/9900 (98.0404%)
Done in 288.8304991722107 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4769/4885 (97.6254%), train_poison_data_count: 385
Global model norm: 44.598496374948.
Norm before scaling: 44.56244795316035. Distance: 1.2055868252909554
Total norm for 4 adversaries is: 44.56244795316035. distance: 1.2055868252909554
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0631, Accuracy: 9751/9900 (98.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5161/5305 (97.2856%), train_poison_data_count: 415
Global model norm: 44.598496374948.
Norm before scaling: 44.561641219372326. Distance: 1.3090911830765746
Total norm for 4 adversaries is: 44.561641219372326. distance: 1.3090911830765746
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0711, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 44.598496374948.
Norm before scaling: 44.56152616616505. Distance: 1.1150694823746978
Total norm for 4 adversaries is: 44.56152616616505. distance: 1.1150694823746978
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0268, Accuracy: 9826/9900 (99.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4918/5066 (97.0786%), train_poison_data_count: 400
Global model norm: 44.598496374948.
Norm before scaling: 44.564609215511474. Distance: 1.3100431699410022
Total norm for 4 adversaries is: 44.564609215511474. distance: 1.3100431699410022
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0408, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5353/5740 (93.2578%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0488, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3900/4175 (93.4132%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3803/4175 (91.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9619, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4599/4918 (93.5136%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4528/4918 (92.0699%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0925, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4051/4235 (95.6553%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3848/4235 (90.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0669, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5126/5455 (93.9688%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4978/5455 (91.2557%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2495, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4355/4662 (93.4148%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4288/4662 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9858, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4228/4465 (94.6920%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4203/4465 (94.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9415, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4420/4651 (95.0333%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4297/4651 (92.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2144, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4397/4618 (95.2144%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4344/4618 (94.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9506, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4661/5037 (92.5352%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4649/5037 (92.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0823, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4085/4354 (93.8218%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3600/4354 (82.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.8324, Accuracy: 4624/10000 (46.2400%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4221/4441 (95.0462%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4147/4441 (93.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0883, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4277/4538 (94.2486%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4258/4538 (93.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8167, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4820/5116 (94.2142%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4643/5116 (90.7545%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0085, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5652/6124 (92.2926%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5424/6124 (88.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1831, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4171/4362 (95.6213%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4076/4362 (93.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8734, Accuracy: 5770/10000 (57.7000%)
time spent on training: 265.606449842453
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.3971, Accuracy: 6520/10000 (65.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0757, Accuracy: 9701/9900 (97.9899%)
Done in 292.9261586666107 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.61806504674564.
Norm before scaling: 44.58178601773655. Distance: 1.1903795164455822
Total norm for 4 adversaries is: 44.58178601773655. distance: 1.1903795164455822
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0468, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5165/5305 (97.3610%), train_poison_data_count: 415
Global model norm: 44.61806504674564.
Norm before scaling: 44.580523726209464. Distance: 1.3178656663814696
Total norm for 4 adversaries is: 44.580523726209464. distance: 1.3178656663814696
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0576, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4594/4717 (97.3924%), train_poison_data_count: 370
Global model norm: 44.61806504674564.
Norm before scaling: 44.58240482872699. Distance: 1.1705676606611555
Total norm for 4 adversaries is: 44.58240482872699. distance: 1.1705676606611555
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0285, Accuracy: 9814/9900 (99.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4934/5066 (97.3944%), train_poison_data_count: 400
Global model norm: 44.61806504674564.
Norm before scaling: 44.58224738869231. Distance: 1.2721410131054798
Total norm for 4 adversaries is: 44.58224738869231. distance: 1.2721410131054798
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0281, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4116/4361 (94.3820%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3949/4361 (90.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9441, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3583/3797 (94.3640%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3542/3797 (93.2842%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9453, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4653/4918 (94.6116%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4608/4918 (93.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0509, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3390/3638 (93.1831%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3391/3638 (93.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8779, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3450/3590 (96.1003%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3441/3590 (95.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8288, Accuracy: 5978/10000 (59.7800%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4679/4986 (93.8428%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4556/4986 (91.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9443, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5063/5392 (93.8984%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4883/5392 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0385, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3580/3804 (94.1115%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8941, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4673/5025 (92.9950%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4629/5025 (92.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0617, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4513/4793 (94.1581%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0832, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4600/4956 (92.8168%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4485/4956 (90.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2068, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4779/5116 (93.4128%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4607/5116 (90.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0660, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4785/5055 (94.6588%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4705/5055 (93.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9448, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4682/5063 (92.4748%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4325/5063 (85.4237%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3378, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4208/4433 (94.9244%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4172/4433 (94.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8155, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4398/4662 (94.3372%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4365/4662 (93.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8813, Accuracy: 5738/10000 (57.3800%)
time spent on training: 259.8777916431427
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4044, Accuracy: 6493/10000 (64.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0751, Accuracy: 9707/9900 (98.0505%)
Done in 287.0581669807434 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4779/4885 (97.8301%), train_poison_data_count: 385
Global model norm: 44.63660918890247.
Norm before scaling: 44.598667443044896. Distance: 1.1850330930024382
Total norm for 4 adversaries is: 44.598667443044896. distance: 1.1850330930024382
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0585, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5139/5305 (96.8709%), train_poison_data_count: 415
Global model norm: 44.63660918890247.
Norm before scaling: 44.600468408151976. Distance: 1.3549331354345178
Total norm for 4 adversaries is: 44.600468408151976. distance: 1.3549331354345178
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0350, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4605/4717 (97.6256%), train_poison_data_count: 370
Global model norm: 44.63660918890247.
Norm before scaling: 44.60049988333931. Distance: 1.1393620017477375
Total norm for 4 adversaries is: 44.60049988333931. distance: 1.1393620017477375
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0272, Accuracy: 9836/9900 (99.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 44.63660918890247.
Norm before scaling: 44.599822477663096. Distance: 1.2722491939374965
Total norm for 4 adversaries is: 44.599822477663096. distance: 1.2722491939374965
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0248, Accuracy: 9836/9900 (99.3535%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4471/4804 (93.0683%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4093/4804 (85.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1887, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4532/4793 (94.5546%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4422/4793 (92.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9571, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3575/3781 (94.5517%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3309/3781 (87.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5238, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3928/4175 (94.0838%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3848/4175 (92.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8022, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4160/4362 (95.3691%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4101/4362 (94.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9828, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4723/5083 (92.9176%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4616/5083 (90.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1375, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4538/4874 (93.1063%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4220/4874 (86.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3415, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3458/3646 (94.8437%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3449/3646 (94.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.6895, Accuracy: 6131/10000 (61.3100%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3576/3756 (95.2077%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3553/3756 (94.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9287, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3979/4223 (94.2221%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3942/4223 (93.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2091, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4185/4356 (96.0744%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4122/4356 (94.6281%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8820, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4707/5025 (93.6716%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4610/5025 (91.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1399, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5870/6391 (91.8479%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5578/6391 (87.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2442, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4257/4518 (94.2231%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4214/4518 (93.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1133, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4844/5167 (93.7488%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4761/5167 (92.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2856, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4447/4679 (95.0417%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4389/4679 (93.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0314, Accuracy: 5565/10000 (55.6500%)
time spent on training: 260.0606677532196
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4157, Accuracy: 6480/10000 (64.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0739, Accuracy: 9712/9900 (98.1010%)
Done in 287.5271089076996 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4779/4885 (97.8301%), train_poison_data_count: 385
Global model norm: 44.6556472470693.
Norm before scaling: 44.61579830068955. Distance: 1.142550424093293
Total norm for 4 adversaries is: 44.61579830068955. distance: 1.142550424093293
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0366, Accuracy: 9804/9900 (99.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5177/5305 (97.5872%), train_poison_data_count: 415
Global model norm: 44.6556472470693.
Norm before scaling: 44.614212741184005. Distance: 1.2289403232863496
Total norm for 4 adversaries is: 44.614212741184005. distance: 1.2289403232863496
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0309, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.6556472470693.
Norm before scaling: 44.61830990861893. Distance: 1.1343482820921664
Total norm for 4 adversaries is: 44.61830990861893. distance: 1.1343482820921664
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0411, Accuracy: 9799/9900 (98.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4952/5066 (97.7497%), train_poison_data_count: 400
Global model norm: 44.6556472470693.
Norm before scaling: 44.61878458116043. Distance: 1.223878048908284
Total norm for 4 adversaries is: 44.61878458116043. distance: 1.223878048908284
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0231, Accuracy: 9843/9900 (99.4242%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4663/4956 (94.0880%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4580/4956 (92.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2021, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3604/3797 (94.9170%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3547/3797 (93.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9982, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4731/5017 (94.2994%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4667/5017 (93.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0507, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4225/4433 (95.3079%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4248/4433 (95.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7212, Accuracy: 6039/10000 (60.3900%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3573/3781 (94.4988%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3484/3781 (92.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0578, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4965/5265 (94.3020%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4797/5265 (91.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9347, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4912/5197 (94.5161%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4795/5197 (92.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1915, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3441/3646 (94.3774%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3436/3646 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7516, Accuracy: 6058/10000 (60.5800%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4084/4356 (93.7557%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3711/4356 (85.1928%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.6770, Accuracy: 4704/10000 (47.0400%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3571/3804 (93.8749%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3573/3804 (93.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9012, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3434/3590 (95.6546%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3325/3590 (92.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9923, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3864/4046 (95.5017%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3765/4046 (93.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9511, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4822/5244 (91.9527%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4702/5244 (89.6644%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1335, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4715/5025 (93.8308%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4594/5025 (91.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2148, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3588/3756 (95.5272%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3598/3756 (95.7934%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9980, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5078/5392 (94.1766%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4877/5392 (90.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0591, Accuracy: 5408/10000 (54.0800%)
time spent on training: 259.17399287223816
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4286, Accuracy: 6449/10000 (64.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0726, Accuracy: 9712/9900 (98.1010%)
Done in 286.84830260276794 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4793/4885 (98.1167%), train_poison_data_count: 385
Global model norm: 44.673151105417894.
Norm before scaling: 44.634259970183635. Distance: 1.1228843505021615
Total norm for 4 adversaries is: 44.634259970183635. distance: 1.1228843505021615
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1007, Accuracy: 9635/9900 (97.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 44.673151105417894.
Norm before scaling: 44.6382130955012. Distance: 1.3673127907155769
Total norm for 4 adversaries is: 44.6382130955012. distance: 1.3673127907155769
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0433, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.673151105417894.
Norm before scaling: 44.63682523424115. Distance: 1.143075375071606
Total norm for 4 adversaries is: 44.63682523424115. distance: 1.143075375071606
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0128, Accuracy: 9864/9900 (99.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4914/5066 (96.9996%), train_poison_data_count: 400
Global model norm: 44.673151105417894.
Norm before scaling: 44.63772358877074. Distance: 1.2893064325899875
Total norm for 4 adversaries is: 44.63772358877074. distance: 1.2893064325899875
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0435, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4379/4663 (93.9095%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4409/4663 (94.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0301, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4382/4618 (94.8896%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4295/4618 (93.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9399, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4419/4662 (94.7876%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4367/4662 (93.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9021, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4211/4511 (93.3496%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4175/4511 (92.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9443, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4153/4362 (95.2086%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4095/4362 (93.8790%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0235, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4316/4558 (94.6907%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4178/4558 (91.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2299, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3623/3828 (94.6447%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3625/3828 (94.6970%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7223, Accuracy: 5997/10000 (59.9700%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4395/4716 (93.1934%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4281/4716 (90.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1235, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4218/4465 (94.4681%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4205/4465 (94.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8962, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4577/4928 (92.8774%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4460/4928 (90.5032%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3252, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5096/5455 (93.4189%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4896/5455 (89.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9407, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4382/4647 (94.2974%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4320/4647 (92.9632%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0436, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5119/5591 (91.5579%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5009/5591 (89.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2616, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3408/3616 (94.2478%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3382/3616 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7963, Accuracy: 6041/10000 (60.4100%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4692/4986 (94.1035%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4584/4986 (91.9374%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9650, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4858/5167 (94.0197%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4748/5167 (91.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1906, Accuracy: 5328/10000 (53.2800%)
time spent on training: 261.13756561279297
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4258, Accuracy: 6463/10000 (64.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0711, Accuracy: 9718/9900 (98.1616%)
Done in 288.33194494247437 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4785/4885 (97.9529%), train_poison_data_count: 385
Global model norm: 44.69120668630603.
Norm before scaling: 44.652190486406994. Distance: 1.145413211906573
Total norm for 4 adversaries is: 44.652190486406994. distance: 1.145413211906573
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0403, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.69120668630603.
Norm before scaling: 44.654768388647476. Distance: 1.3189283259441986
Total norm for 4 adversaries is: 44.654768388647476. distance: 1.3189283259441986
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0342, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4603/4717 (97.5832%), train_poison_data_count: 370
Global model norm: 44.69120668630603.
Norm before scaling: 44.655270009803296. Distance: 1.138538019023798
Total norm for 4 adversaries is: 44.655270009803296. distance: 1.138538019023798
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0661, Accuracy: 9715/9900 (98.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4948/5066 (97.6707%), train_poison_data_count: 400
Global model norm: 44.69120668630603.
Norm before scaling: 44.65304479181333. Distance: 1.2030888836877005
Total norm for 4 adversaries is: 44.65304479181333. distance: 1.2030888836877005
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0404, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3912/4175 (93.7006%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3790/4175 (90.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1075, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4327/4596 (94.1471%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4277/4596 (93.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0742, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3435/3616 (94.9945%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3421/3616 (94.6073%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7863, Accuracy: 6064/10000 (60.6400%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4177/4356 (95.8907%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3981/4356 (91.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2832, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4794/5244 (91.4188%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4706/5244 (89.7407%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1375, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3147/3297 (95.4504%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3105/3297 (94.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7509, Accuracy: 6028/10000 (60.2800%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3420/3646 (93.8014%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3433/3646 (94.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7092, Accuracy: 6065/10000 (60.6500%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3618/3797 (95.2858%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3579/3797 (94.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7500, Accuracy: 5998/10000 (59.9800%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4241/4456 (95.1750%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4210/4456 (94.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8468, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3678/3828 (96.0815%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3654/3828 (95.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7002, Accuracy: 6087/10000 (60.8700%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5275/5582 (94.5002%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5138/5582 (92.0459%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0700, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3316/3472 (95.5069%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3295/3472 (94.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8529, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4190/4362 (96.0569%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4090/4362 (93.7643%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9917, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5110/5424 (94.2109%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5040/5424 (92.9204%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1463, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4451/4679 (95.1272%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4250/4679 (90.8314%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0457, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3438/3590 (95.7660%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3207/3590 (89.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1962, Accuracy: 5293/10000 (52.9300%)
time spent on training: 254.40285563468933
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4321, Accuracy: 6449/10000 (64.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0694, Accuracy: 9722/9900 (98.2020%)
Done in 281.6587989330292 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.70743245369345.
Norm before scaling: 44.668756995941806. Distance: 1.156822578318261
Total norm for 4 adversaries is: 44.668756995941806. distance: 1.156822578318261
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0962, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5161/5305 (97.2856%), train_poison_data_count: 415
Global model norm: 44.70743245369345.
Norm before scaling: 44.66971619477647. Distance: 1.306901936994596
Total norm for 4 adversaries is: 44.66971619477647. distance: 1.306901936994596
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0201, Accuracy: 9849/9900 (99.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 44.70743245369345.
Norm before scaling: 44.67100465880035. Distance: 1.1456201990904162
Total norm for 4 adversaries is: 44.67100465880035. distance: 1.1456201990904162
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0791, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.70743245369345.
Norm before scaling: 44.671917355261485. Distance: 1.2735048990024354
Total norm for 4 adversaries is: 44.671917355261485. distance: 1.2735048990024354
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0443, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3610/3804 (94.9001%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3546/3804 (93.2177%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0509, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3131/3297 (94.9651%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3098/3297 (93.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8073, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4084/4354 (93.7988%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3538/4354 (81.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.5869, Accuracy: 4572/10000 (45.7200%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4173/4433 (94.1349%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4433 (92.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9366, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3608/3775 (95.5762%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3579/3775 (94.8079%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9092, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4881/5195 (93.9557%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4683/5195 (90.1444%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2754, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5075/5392 (94.1209%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4935/5392 (91.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1077, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4866/5244 (92.7918%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4718/5244 (89.9695%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1452, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4119/4356 (94.5592%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3819/4356 (87.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3305, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4073/4416 (92.2328%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4031/4416 (91.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0437, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4170/4481 (93.0596%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4023/4481 (89.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1359, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4237/4441 (95.4064%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4193/4441 (94.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9770, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4071/4336 (93.8884%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4001/4336 (92.2740%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0812, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3473/3646 (95.2551%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3427/3646 (93.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7735, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4417/4647 (95.0506%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4308/4647 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9273, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3388/3638 (93.1281%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3391/3638 (93.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8996, Accuracy: 5836/10000 (58.3600%)
time spent on training: 258.14305567741394
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4367, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0667, Accuracy: 9730/9900 (98.2828%)
Done in 285.8182394504547 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4790/4885 (98.0553%), train_poison_data_count: 385
Global model norm: 44.72565842426889.
Norm before scaling: 44.685877374386976. Distance: 1.1253474017035245
Total norm for 4 adversaries is: 44.685877374386976. distance: 1.1253474017035245
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1042, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.72565842426889.
Norm before scaling: 44.68659035350398. Distance: 1.2947707512358781
Total norm for 4 adversaries is: 44.68659035350398. distance: 1.2947707512358781
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0629, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.72565842426889.
Norm before scaling: 44.68877975658781. Distance: 1.1255266758127074
Total norm for 4 adversaries is: 44.68877975658781. distance: 1.1255266758127074
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0346, Accuracy: 9814/9900 (99.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.72565842426889.
Norm before scaling: 44.689234559867714. Distance: 1.278882467693099
Total norm for 4 adversaries is: 44.689234559867714. distance: 1.278882467693099
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0278, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4348/4538 (95.8131%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4282/4538 (94.3587%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8069, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5402/5740 (94.1115%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5297/5740 (92.2822%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2250, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4593/4934 (93.0888%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4132/4934 (83.7454%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2651, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3816/4013 (95.0910%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3802/4013 (94.7421%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7441, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4173/4511 (92.5072%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4144/4511 (91.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0787, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4198/4501 (93.2682%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4020/4501 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9926, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4312/4518 (95.4405%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4238/4518 (93.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0180, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3608/3804 (94.8475%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3602/3804 (94.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7902, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3569/3781 (94.3930%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3416/3781 (90.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1106, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4257/4441 (95.8568%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4141/4441 (93.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0201, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4382/4662 (93.9940%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4333/4662 (92.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9800, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3284/3472 (94.5853%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3282/3472 (94.5276%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8117, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3720/3911 (95.1163%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3674/3911 (93.9402%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9043, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4332/4634 (93.4830%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4254/4634 (91.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2198, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4364/4618 (94.4998%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4186/4618 (90.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1894, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4865/5195 (93.6477%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4686/5195 (90.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1697, Accuracy: 5419/10000 (54.1900%)
time spent on training: 259.3850977420807
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4398, Accuracy: 6421/10000 (64.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0625, Accuracy: 9742/9900 (98.4040%)
Done in 286.98550605773926 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4779/4885 (97.8301%), train_poison_data_count: 385
Global model norm: 44.74316081205177.
Norm before scaling: 44.70324924615729. Distance: 1.159197889922639
Total norm for 4 adversaries is: 44.70324924615729. distance: 1.159197889922639
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0698, Accuracy: 9721/9900 (98.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5164/5305 (97.3421%), train_poison_data_count: 415
Global model norm: 44.74316081205177.
Norm before scaling: 44.703840434680494. Distance: 1.2809860608923027
Total norm for 4 adversaries is: 44.703840434680494. distance: 1.2809860608923027
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0473, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.74316081205177.
Norm before scaling: 44.706237876588595. Distance: 1.1339004553880323
Total norm for 4 adversaries is: 44.706237876588595. distance: 1.1339004553880323
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0281, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4956/5066 (97.8287%), train_poison_data_count: 400
Global model norm: 44.74316081205177.
Norm before scaling: 44.70395375629892. Distance: 1.183092319542978
Total norm for 4 adversaries is: 44.70395375629892. distance: 1.183092319542978
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0463, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3037/3271 (92.8462%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3033/3271 (92.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7894, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4665/4928 (94.6631%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0418, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4466/4804 (92.9642%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4114/4804 (85.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2929, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4390/4618 (95.0628%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4247/4618 (91.9662%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9669, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3590/3756 (95.5804%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3588/3756 (95.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8138, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4346/4634 (93.7851%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4274/4634 (92.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0610, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3428/3638 (94.2276%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3413/3638 (93.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8668, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3487/3704 (94.1415%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3462/3704 (93.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8352, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4453/4707 (94.6038%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4400/4707 (93.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9201, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4214/4481 (94.0415%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4017/4481 (89.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1651, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4096/4354 (94.0744%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3889/4354 (89.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4454, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3423/3646 (93.8837%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3446/3646 (94.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7643, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4000/4223 (94.7194%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3988/4223 (94.4352%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8000, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4244/4511 (94.0811%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4185/4511 (92.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9601, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4237/4456 (95.0853%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4182/4456 (93.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2294, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3653/3861 (94.6128%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3613/3861 (93.5768%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9368, Accuracy: 5734/10000 (57.3400%)
time spent on training: 257.31511402130127
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4385, Accuracy: 6433/10000 (64.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0678, Accuracy: 9728/9900 (98.2626%)
Done in 284.6781497001648 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4793/4885 (98.1167%), train_poison_data_count: 385
Global model norm: 44.75968956070085.
Norm before scaling: 44.71863808074744. Distance: 1.0962116876777748
Total norm for 4 adversaries is: 44.71863808074744. distance: 1.0962116876777748
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0609, Accuracy: 9746/9900 (98.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5152/5305 (97.1159%), train_poison_data_count: 415
Global model norm: 44.75968956070085.
Norm before scaling: 44.72166116703473. Distance: 1.3321461558072856
Total norm for 4 adversaries is: 44.72166116703473. distance: 1.3321461558072856
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0358, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4586/4717 (97.2228%), train_poison_data_count: 370
Global model norm: 44.75968956070085.
Norm before scaling: 44.724203676882276. Distance: 1.157064048204348
Total norm for 4 adversaries is: 44.724203676882276. distance: 1.157064048204348
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0858, Accuracy: 9671/9900 (97.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.75968956070085.
Norm before scaling: 44.72263697293016. Distance: 1.2388345342714369
Total norm for 4 adversaries is: 44.72263697293016. distance: 1.2388345342714369
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0515, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3557/3804 (93.5068%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3525/3804 (92.6656%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0041, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4209/4501 (93.5126%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4102/4501 (91.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9568, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4432/4663 (95.0461%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4379/4663 (93.9095%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0315, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5136/5591 (91.8619%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4894/5591 (87.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3370, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4840/5244 (92.2960%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4711/5244 (89.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0247, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4237/4433 (95.5786%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4159/4433 (93.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8073, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4425/4707 (94.0089%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4312/4707 (91.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9857, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4227/4456 (94.8609%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4147/4456 (93.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9610, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4123/4356 (94.6511%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3729/4356 (85.6061%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2608, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4331/4576 (94.6460%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4327/4576 (94.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8363, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4464/4679 (95.4050%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4156/4679 (88.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2866, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4371/4634 (94.3246%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4338/4634 (93.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8092, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3788/4013 (94.3932%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3774/4013 (94.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7805, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4874/5232 (93.1575%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4776/5232 (91.2844%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1061, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3928/4126 (95.2012%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3898/4126 (94.4741%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7327, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3590/3756 (95.5804%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3545/3756 (94.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9074, Accuracy: 5754/10000 (57.5400%)
time spent on training: 261.5482497215271
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4560, Accuracy: 6412/10000 (64.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0703, Accuracy: 9720/9900 (98.1818%)
Done in 288.92035937309265 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.77804828706179.
Norm before scaling: 44.7397435544764. Distance: 1.220512533949426
Total norm for 4 adversaries is: 44.7397435544764. distance: 1.220512533949426
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0477, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5188/5305 (97.7945%), train_poison_data_count: 415
Global model norm: 44.77804828706179.
Norm before scaling: 44.73772172470551. Distance: 1.2376846657346687
Total norm for 4 adversaries is: 44.73772172470551. distance: 1.2376846657346687
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0423, Accuracy: 9799/9900 (98.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4611/4717 (97.7528%), train_poison_data_count: 370
Global model norm: 44.77804828706179.
Norm before scaling: 44.74046522462216. Distance: 1.108135229107612
Total norm for 4 adversaries is: 44.74046522462216. distance: 1.108135229107612
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0411, Accuracy: 9793/9900 (98.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4956/5066 (97.8287%), train_poison_data_count: 400
Global model norm: 44.77804828706179.
Norm before scaling: 44.738717644176084. Distance: 1.2001437617654058
Total norm for 4 adversaries is: 44.738717644176084. distance: 1.2001437617654058
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0341, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4815/5055 (95.2522%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4672/5055 (92.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9400, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4207/4481 (93.8853%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4013/4481 (89.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3222, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4422/4767 (92.7627%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4273/4767 (89.6371%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2597, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4920/5265 (93.4473%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4730/5265 (89.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3144, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4290/4558 (94.1202%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4202/4558 (92.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0994, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5185/5591 (92.7383%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4959/5591 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3547, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4899/5232 (93.6353%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4782/5232 (91.3991%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8909, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3617/3756 (96.2993%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3625/3756 (96.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7821, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4264/4433 (96.1877%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4193/4433 (94.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7684, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4525/4793 (94.4085%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4451/4793 (92.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9134, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4056/4235 (95.7733%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4005/4235 (94.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9073, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4395/4707 (93.3716%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4343/4707 (92.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8783, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3854/4025 (95.7516%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3807/4025 (94.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8265, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3635/3837 (94.7355%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3629/3837 (94.5791%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9341, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5864/6391 (91.7540%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5550/6391 (86.8409%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3631, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4098/4354 (94.1203%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3367/4354 (77.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.9360, Accuracy: 4268/10000 (42.6800%)
time spent on training: 265.11441349983215
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4742, Accuracy: 6393/10000 (63.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0707, Accuracy: 9717/9900 (98.1515%)
Done in 292.74555110931396 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4793/4885 (98.1167%), train_poison_data_count: 385
Global model norm: 44.797755157903836.
Norm before scaling: 44.75854819717402. Distance: 1.1248040028546982
Total norm for 4 adversaries is: 44.75854819717402. distance: 1.1248040028546982
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0556, Accuracy: 9761/9900 (98.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5172/5305 (97.4929%), train_poison_data_count: 415
Global model norm: 44.797755157903836.
Norm before scaling: 44.75716679474012. Distance: 1.2548081906466924
Total norm for 4 adversaries is: 44.75716679474012. distance: 1.2548081906466924
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0284, Accuracy: 9823/9900 (99.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4625/4717 (98.0496%), train_poison_data_count: 370
Global model norm: 44.797755157903836.
Norm before scaling: 44.75884819996489. Distance: 1.0705408005972534
Total norm for 4 adversaries is: 44.75884819996489. distance: 1.0705408005972534
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0266, Accuracy: 9827/9900 (99.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4944/5066 (97.5918%), train_poison_data_count: 400
Global model norm: 44.797755157903836.
Norm before scaling: 44.76143495879363. Distance: 1.2708832100424532
Total norm for 4 adversaries is: 44.76143495879363. distance: 1.2708832100424532
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0125, Accuracy: 9869/9900 (99.6869%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5109/5424 (94.1925%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5011/5424 (92.3857%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0763, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4343/4576 (94.9082%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4295/4576 (93.8593%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9647, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4619/4934 (93.6157%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4154/4934 (84.1913%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3813, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5268/5582 (94.3748%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5060/5582 (90.6485%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1287, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4620/4956 (93.2203%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4506/4956 (90.9201%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0215, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5531/5902 (93.7140%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5130/5902 (86.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2633, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3149/3297 (95.5111%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3137/3297 (95.1471%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.6853, Accuracy: 6127/10000 (61.2700%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3286/3472 (94.6429%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3269/3472 (94.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9742, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4675/4928 (94.8661%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4604/4928 (93.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8693, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4223/4481 (94.2424%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4054/4481 (90.4709%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1186, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4683/5025 (93.1940%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1923, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4681/4986 (93.8829%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4626/4986 (92.7798%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9659, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4560/4928 (92.5325%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4542/4928 (92.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0219, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4508/4804 (93.8385%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4218/4804 (87.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.5343, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3463/3646 (94.9808%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3423/3646 (93.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7384, Accuracy: 6027/10000 (60.2700%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4476/4707 (95.0924%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4358/4707 (92.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0013, Accuracy: 5627/10000 (56.2700%)
time spent on training: 265.4772243499756
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4776, Accuracy: 6394/10000 (63.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0699, Accuracy: 9725/9900 (98.2323%)
Done in 292.579402923584 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4783/4885 (97.9120%), train_poison_data_count: 385
Global model norm: 44.817176904654815.
Norm before scaling: 44.77799785382186. Distance: 1.128146539625134
Total norm for 4 adversaries is: 44.77799785382186. distance: 1.128146539625134
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0472, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.817176904654815.
Norm before scaling: 44.77755485670597. Distance: 1.2718574222784074
Total norm for 4 adversaries is: 44.77755485670597. distance: 1.2718574222784074
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0727, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4598/4717 (97.4772%), train_poison_data_count: 370
Global model norm: 44.817176904654815.
Norm before scaling: 44.77961305233875. Distance: 1.1551289149584278
Total norm for 4 adversaries is: 44.77961305233875. distance: 1.1551289149584278
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0237, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4936/5066 (97.4339%), train_poison_data_count: 400
Global model norm: 44.817176904654815.
Norm before scaling: 44.779527182491556. Distance: 1.228627064900997
Total norm for 4 adversaries is: 44.779527182491556. distance: 1.228627064900997
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0166, Accuracy: 9860/9900 (99.5960%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4862/5116 (95.0352%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4728/5116 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1155, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4388/4651 (94.3453%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4258/4651 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1072, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5145/5591 (92.0229%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5017/5591 (89.7335%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5486, Accuracy: 4729/10000 (47.2900%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4500/4804 (93.6719%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4207/4804 (87.5729%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4108, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4255/4456 (95.4892%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4195/4456 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9481, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4693/5063 (92.6921%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4285/5063 (84.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3100, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4006/4223 (94.8615%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3999/4223 (94.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8192, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4619/4934 (93.6157%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4124/4934 (83.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4951, Accuracy: 4753/10000 (47.5300%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3680/3828 (96.1338%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3654/3828 (95.4545%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7578, Accuracy: 6001/10000 (60.0100%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5514/5902 (93.4260%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5055/5902 (85.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3110, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4082/4416 (92.4366%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4041/4416 (91.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0125, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4311/4538 (94.9978%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4303/4538 (94.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8594, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4661/5025 (92.7562%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4605/5025 (91.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0887, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4297/4625 (92.9081%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4134/4625 (89.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4495, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4881/5197 (93.9196%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4768/5197 (91.7452%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0802, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3591/3804 (94.4006%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3520/3804 (92.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1917, Accuracy: 5560/10000 (55.6000%)
time spent on training: 265.8093934059143
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4997, Accuracy: 6351/10000 (63.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0666, Accuracy: 9733/9900 (98.3131%)
Done in 293.1115388870239 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 44.837402915370916.
Norm before scaling: 44.79880832722074. Distance: 1.166557658870369
Total norm for 4 adversaries is: 44.79880832722074. distance: 1.166557658870369
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0637, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5305 (97.6626%), train_poison_data_count: 415
Global model norm: 44.837402915370916.
Norm before scaling: 44.79643627706338. Distance: 1.2142073752273363
Total norm for 4 adversaries is: 44.79643627706338. distance: 1.2142073752273363
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0462, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4599/4717 (97.4984%), train_poison_data_count: 370
Global model norm: 44.837402915370916.
Norm before scaling: 44.79819386792424. Distance: 1.0902106648473717
Total norm for 4 adversaries is: 44.79819386792424. distance: 1.0902106648473717
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0190, Accuracy: 9857/9900 (99.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.837402915370916.
Norm before scaling: 44.799835586246154. Distance: 1.2468122366116572
Total norm for 4 adversaries is: 44.799835586246154. distance: 1.2468122366116572
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0248, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4467/4804 (92.9850%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3901/4804 (81.2032%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4876, Accuracy: 4669/10000 (46.6900%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3705/3911 (94.7328%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3550/3911 (90.7696%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2033, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3802/4013 (94.7421%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3757/4013 (93.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9045, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4875/5232 (93.1766%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4735/5232 (90.5008%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2489, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5187/5591 (92.7741%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4834/5591 (86.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3711, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3663/3837 (95.4652%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3633/3837 (94.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9201, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5134/5424 (94.6534%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5020/5424 (92.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1804, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4855/5167 (93.9617%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4783/5167 (92.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1176, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4285/4456 (96.1625%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4223/4456 (94.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9054, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4668/4928 (94.7240%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4544/4928 (92.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9736, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4231/4433 (95.4433%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4068/4433 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9073, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3112/3297 (94.3888%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3094/3297 (93.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7099, Accuracy: 6027/10000 (60.2700%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4420/4716 (93.7235%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4244/4716 (89.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2599, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4346/4596 (94.5605%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4323/4596 (94.0601%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9197, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4519/4793 (94.2833%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4435/4793 (92.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9960, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4124/4416 (93.3877%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4057/4416 (91.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9926, Accuracy: 5602/10000 (56.0200%)
time spent on training: 262.8674647808075
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5034, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0665, Accuracy: 9732/9900 (98.3030%)
Done in 290.1239161491394 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.85579106634393.
Norm before scaling: 44.81544457288832. Distance: 1.1409369264265306
Total norm for 4 adversaries is: 44.81544457288832. distance: 1.1409369264265306
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0652, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5172/5305 (97.4929%), train_poison_data_count: 415
Global model norm: 44.85579106634393.
Norm before scaling: 44.81520759777031. Distance: 1.249680287482703
Total norm for 4 adversaries is: 44.81520759777031. distance: 1.249680287482703
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0346, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4616/4717 (97.8588%), train_poison_data_count: 370
Global model norm: 44.85579106634393.
Norm before scaling: 44.816480983823766. Distance: 1.0812964853867288
Total norm for 4 adversaries is: 44.816480983823766. distance: 1.0812964853867288
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0299, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4954/5066 (97.7892%), train_poison_data_count: 400
Global model norm: 44.85579106634393.
Norm before scaling: 44.8172123132536. Distance: 1.216011638984066
Total norm for 4 adversaries is: 44.8172123132536. distance: 1.216011638984066
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0249, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3074/3271 (93.9774%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 2974/3271 (90.9202%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9801, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4861/5116 (95.0156%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4705/5116 (91.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0315, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4239/4501 (94.1791%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4116/4501 (91.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1405, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4131/4356 (94.8347%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3921/4356 (90.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2418, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4061/4368 (92.9716%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0717, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3669/3837 (95.6216%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3639/3837 (94.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7359, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5419/5740 (94.4077%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5260/5740 (91.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2241, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3421/3590 (95.2925%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3449/3590 (96.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8419, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3164/3297 (95.9660%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3134/3297 (95.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7289, Accuracy: 6009/10000 (60.0900%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4355/4716 (92.3452%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4325/4716 (91.7091%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1672, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4764/5055 (94.2433%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4664/5055 (92.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1455, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3693/3911 (94.4260%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3294/3911 (84.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4872, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3854/4158 (92.6888%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3780/4158 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9083, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4270/4456 (95.8259%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4208/4456 (94.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0203, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4226/4511 (93.6821%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4183/4511 (92.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9222, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3418/3672 (93.0828%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3393/3672 (92.4020%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9116, Accuracy: 5739/10000 (57.3900%)
time spent on training: 257.81397438049316
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5114, Accuracy: 6332/10000 (63.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0643, Accuracy: 9731/9900 (98.2929%)
Done in 285.2591812610626 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.872861848435186.
Norm before scaling: 44.83354495162843. Distance: 1.1450171366912594
Total norm for 4 adversaries is: 44.83354495162843. distance: 1.1450171366912594
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0753, Accuracy: 9723/9900 (98.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.872861848435186.
Norm before scaling: 44.83019448865491. Distance: 1.223411010221559
Total norm for 4 adversaries is: 44.83019448865491. distance: 1.223411010221559
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0434, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4616/4717 (97.8588%), train_poison_data_count: 370
Global model norm: 44.872861848435186.
Norm before scaling: 44.83441213753951. Distance: 1.0915922952512165
Total norm for 4 adversaries is: 44.83441213753951. distance: 1.0915922952512165
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0491, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4947/5066 (97.6510%), train_poison_data_count: 400
Global model norm: 44.872861848435186.
Norm before scaling: 44.834228355426866. Distance: 1.2138209806012141
Total norm for 4 adversaries is: 44.834228355426866. distance: 1.2138209806012141
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0444, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4713/5063 (93.0871%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4190/5063 (82.7573%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.6175, Accuracy: 4748/10000 (47.4800%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4807/5083 (94.5701%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4567/5083 (89.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3366, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3608/3797 (95.0224%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3503/3797 (92.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0025, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5625/6124 (91.8517%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5458/6124 (89.1248%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1253, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4919/5232 (94.0176%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4775/5232 (91.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1364, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3622/3861 (93.8099%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3583/3861 (92.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8505, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4719/5037 (93.6867%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4652/5037 (92.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0412, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4844/5116 (94.6833%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4746/5116 (92.7678%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0254, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4104/4368 (93.9560%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3919/4368 (89.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0032, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3431/3672 (93.4368%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3391/3672 (92.3475%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9201, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5481/5902 (92.8668%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5207/5902 (88.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2351, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4130/4361 (94.7030%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3793/4361 (86.9755%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2516, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3817/4158 (91.7989%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3722/4158 (89.5142%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1842, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4721/5025 (93.9502%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4643/5025 (92.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1263, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4272/4456 (95.8707%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4201/4456 (94.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8803, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4254/4433 (95.9621%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4180/4433 (94.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8711, Accuracy: 5892/10000 (58.9200%)
time spent on training: 262.5450851917267
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5281, Accuracy: 6289/10000 (62.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0646, Accuracy: 9734/9900 (98.3232%)
Done in 289.8580975532532 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.89307908580884.
Norm before scaling: 44.85496919761232. Distance: 1.1912737663275945
Total norm for 4 adversaries is: 44.85496919761232. distance: 1.1912737663275945
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0159, Accuracy: 9860/9900 (99.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.89307908580884.
Norm before scaling: 44.852590591988104. Distance: 1.256420810910642
Total norm for 4 adversaries is: 44.852590591988104. distance: 1.256420810910642
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0223, Accuracy: 9845/9900 (99.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4621/4717 (97.9648%), train_poison_data_count: 370
Global model norm: 44.89307908580884.
Norm before scaling: 44.8537676637405. Distance: 1.0957206411882552
Total norm for 4 adversaries is: 44.8537676637405. distance: 1.0957206411882552
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1144, Accuracy: 9590/9900 (96.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4950/5066 (97.7102%), train_poison_data_count: 400
Global model norm: 44.89307908580884.
Norm before scaling: 44.85406702966368. Distance: 1.208112904842829
Total norm for 4 adversaries is: 44.85406702966368. distance: 1.208112904842829
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0533, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3796/4025 (94.3106%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3784/4025 (94.0124%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8697, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4567/4928 (92.6745%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0579, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3892/4175 (93.2216%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3760/4175 (90.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0014, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4115/4416 (93.1839%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4086/4416 (92.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1036, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3632/3797 (95.6545%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3510/3797 (92.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8758, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4887/5195 (94.0712%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4692/5195 (90.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1921, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4861/5232 (92.9090%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4751/5232 (90.8066%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0867, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5146/5455 (94.3355%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4980/5455 (91.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9702, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4436/4716 (94.0628%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4270/4716 (90.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1431, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4454/4679 (95.1913%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4254/4679 (90.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9815, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5917/6263 (94.4755%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5738/6263 (91.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.4629, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4670/4918 (94.9573%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4646/4918 (94.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9109, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4257/4456 (95.5341%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4203/4456 (94.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8862, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5498/5902 (93.1549%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5338/5902 (90.4439%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1687, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4244/4481 (94.7110%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4053/4481 (90.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1553, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5185/5591 (92.7383%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5041/5591 (90.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1353, Accuracy: 5358/10000 (53.5800%)
time spent on training: 267.34168124198914
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5315, Accuracy: 6284/10000 (62.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0712, Accuracy: 9724/9900 (98.2222%)
Done in 294.967316865921 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4797/4885 (98.1986%), train_poison_data_count: 385
Global model norm: 44.9128047908354.
Norm before scaling: 44.8727584746581. Distance: 1.101048505191023
Total norm for 4 adversaries is: 44.8727584746581. distance: 1.101048505191023
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0960, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5181/5305 (97.6626%), train_poison_data_count: 415
Global model norm: 44.9128047908354.
Norm before scaling: 44.87195051877481. Distance: 1.2655505876682724
Total norm for 4 adversaries is: 44.87195051877481. distance: 1.2655505876682724
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0305, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4615/4717 (97.8376%), train_poison_data_count: 370
Global model norm: 44.9128047908354.
Norm before scaling: 44.87222664001434. Distance: 1.0621085287233147
Total norm for 4 adversaries is: 44.87222664001434. distance: 1.0621085287233147
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0414, Accuracy: 9801/9900 (99.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 44.9128047908354.
Norm before scaling: 44.87451715661197. Distance: 1.2175128722244737
Total norm for 4 adversaries is: 44.87451715661197. distance: 1.2175128722244737
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0348, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4214/4501 (93.6236%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4147/4501 (92.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1092, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4784/5083 (94.1176%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4591/5083 (90.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1721, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3572/3804 (93.9012%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3578/3804 (94.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8636, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3621/3756 (96.4058%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3588/3756 (95.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.7752, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3949/4175 (94.5868%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3808/4175 (91.2096%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9344, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4614/4934 (93.5144%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4044/4934 (81.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4015, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4081/4336 (94.1190%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4034/4336 (93.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8814, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4087/4356 (93.8246%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4093/4356 (93.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0657, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4835/5244 (92.2006%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4673/5244 (89.1114%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4248, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4751/5017 (94.6980%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4617/5017 (92.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9505, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3659/3828 (95.5852%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3637/3828 (95.0104%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8349, Accuracy: 5944/10000 (59.4400%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4339/4538 (95.6148%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4280/4538 (94.3147%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9879, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3372/3638 (92.6883%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3396/3638 (93.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8429, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4407/4662 (94.5302%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4319/4662 (92.6426%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0445, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3632/3797 (95.6545%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3587/3797 (94.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8361, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4345/4634 (93.7635%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4272/4634 (92.1882%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9013, Accuracy: 5732/10000 (57.3200%)
time spent on training: 258.4160044193268
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5379, Accuracy: 6267/10000 (62.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0670, Accuracy: 9730/9900 (98.2828%)
Done in 285.82739305496216 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4770/4885 (97.6459%), train_poison_data_count: 385
Global model norm: 44.930236993466465.
Norm before scaling: 44.88998596395136. Distance: 1.1720795516463776
Total norm for 4 adversaries is: 44.88998596395136. distance: 1.1720795516463776
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0318, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5195/5305 (97.9265%), train_poison_data_count: 415
Global model norm: 44.930236993466465.
Norm before scaling: 44.88732638855315. Distance: 1.201732374467943
Total norm for 4 adversaries is: 44.88732638855315. distance: 1.201732374467943
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0419, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.930236993466465.
Norm before scaling: 44.89139998895946. Distance: 1.1013420371349765
Total norm for 4 adversaries is: 44.89139998895946. distance: 1.1013420371349765
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0727, Accuracy: 9720/9900 (98.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4957/5066 (97.8484%), train_poison_data_count: 400
Global model norm: 44.930236993466465.
Norm before scaling: 44.88883567613862. Distance: 1.168959793600257
Total norm for 4 adversaries is: 44.88883567613862. distance: 1.168959793600257
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0938, Accuracy: 9644/9900 (97.4141%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3945/4175 (94.4910%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3806/4175 (91.1617%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0786, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4218/4465 (94.4681%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4188/4465 (93.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8407, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4659/4918 (94.7336%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4559/4918 (92.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1785, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4694/5037 (93.1904%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4664/5037 (92.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9232, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3538/3781 (93.5731%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3169/3781 (83.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.6322, Accuracy: 4673/10000 (46.7300%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4391/4634 (94.7562%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4338/4634 (93.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8685, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4348/4576 (95.0175%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4321/4576 (94.4274%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8614, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3678/3861 (95.2603%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3554/3861 (92.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8738, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5681/6124 (92.7662%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5463/6124 (89.2064%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1216, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3984/4223 (94.3405%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3983/4223 (94.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0445, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4752/5083 (93.4881%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4563/5083 (89.7698%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2022, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4146/4356 (95.1791%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3662/4356 (84.0680%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 3.0144, Accuracy: 4360/10000 (43.6000%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4553/4793 (94.9927%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4483/4793 (93.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0483, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4727/5055 (93.5114%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4723/5055 (93.4322%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0604, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4176/4362 (95.7359%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4028/4362 (92.3430%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1717, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4206/4433 (94.8793%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4183/4433 (94.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7962, Accuracy: 5969/10000 (59.6900%)
time spent on training: 263.9466745853424
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5379, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0641, Accuracy: 9734/9900 (98.3232%)
Done in 291.40235567092896 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4777/4885 (97.7892%), train_poison_data_count: 385
Global model norm: 44.94874468144244.
Norm before scaling: 44.90863255901155. Distance: 1.1413981286607893
Total norm for 4 adversaries is: 44.90863255901155. distance: 1.1413981286607893
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0359, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.94874468144244.
Norm before scaling: 44.90784699448068. Distance: 1.2681902096801043
Total norm for 4 adversaries is: 44.90784699448068. distance: 1.2681902096801043
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0495, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 44.94874468144244.
Norm before scaling: 44.909704873188325. Distance: 1.0972407087279024
Total norm for 4 adversaries is: 44.909704873188325. distance: 1.0972407087279024
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0263, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4936/5066 (97.4339%), train_poison_data_count: 400
Global model norm: 44.94874468144244.
Norm before scaling: 44.91102450479517. Distance: 1.2519337478542618
Total norm for 4 adversaries is: 44.91102450479517. distance: 1.2519337478542618
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0187, Accuracy: 9856/9900 (99.5556%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4723/5025 (93.9900%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4698/5025 (93.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0345, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4238/4441 (95.4290%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4204/4441 (94.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9832, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5212/5591 (93.2212%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5038/5591 (90.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0172, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4243/4481 (94.6887%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4051/4481 (90.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0835, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4442/4767 (93.1823%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4281/4767 (89.8049%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2193, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4791/5055 (94.7774%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4740/5055 (93.7685%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8867, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4288/4518 (94.9093%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4264/4518 (94.3780%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8200, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4264/4625 (92.1946%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4081/4625 (88.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1956, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4542/4793 (94.7632%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4495/4793 (93.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8686, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4814/5083 (94.7078%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4680/5083 (92.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0053, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4841/5244 (92.3150%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4700/5244 (89.6262%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1256, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5908/6263 (94.3318%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5718/6263 (91.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0887, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3975/4175 (95.2096%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3839/4175 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9414, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4138/4416 (93.7047%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4114/4416 (93.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9289, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4950/5265 (94.0171%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4766/5265 (90.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0985, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3822/4025 (94.9565%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3804/4025 (94.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8928, Accuracy: 5775/10000 (57.7500%)
time spent on training: 266.87471532821655
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5444, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0598, Accuracy: 9739/9900 (98.3737%)
Done in 294.06511545181274 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.96807271249862.
Norm before scaling: 44.92740183392397. Distance: 1.16453470982752
Total norm for 4 adversaries is: 44.92740183392397. distance: 1.16453470982752
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0497, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5184/5305 (97.7191%), train_poison_data_count: 415
Global model norm: 44.96807271249862.
Norm before scaling: 44.92655953835242. Distance: 1.2467389962349662
Total norm for 4 adversaries is: 44.92655953835242. distance: 1.2467389962349662
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0145, Accuracy: 9859/9900 (99.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4603/4717 (97.5832%), train_poison_data_count: 370
Global model norm: 44.96807271249862.
Norm before scaling: 44.92958765312328. Distance: 1.129028419299126
Total norm for 4 adversaries is: 44.92958765312328. distance: 1.129028419299126
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0192, Accuracy: 9838/9900 (99.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4964/5066 (97.9866%), train_poison_data_count: 400
Global model norm: 44.96807271249862.
Norm before scaling: 44.92862720992875. Distance: 1.1908816323830895
Total norm for 4 adversaries is: 44.92862720992875. distance: 1.1908816323830895
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0446, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4055/4295 (94.4121%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3885/4295 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0286, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4013/4223 (95.0272%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3972/4223 (94.0564%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8801, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4558/4793 (95.0970%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4418/4793 (92.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0653, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4463/4707 (94.8162%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4390/4707 (93.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8565, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5122/5455 (93.8955%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4984/5455 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3345, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4411/4651 (94.8398%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4341/4651 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0377, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3638/3837 (94.8137%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3642/3837 (94.9179%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9127, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4284/4441 (96.4648%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4220/4441 (95.0236%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8848, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3461/3638 (95.1347%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3419/3638 (93.9802%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7807, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4050/4235 (95.6316%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4034/4235 (95.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9116, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4149/4362 (95.1169%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4102/4362 (94.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9693, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3657/3797 (96.3129%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3594/3797 (94.6537%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9632, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3892/4158 (93.6027%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3802/4158 (91.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0211, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3951/4126 (95.7586%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3908/4126 (94.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7246, Accuracy: 6017/10000 (60.1700%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4907/5195 (94.4562%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4590/5195 (88.3542%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4451, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3841/4046 (94.9333%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3795/4046 (93.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9192, Accuracy: 5746/10000 (57.4600%)
time spent on training: 258.6365079879761
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5554, Accuracy: 6237/10000 (62.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0559, Accuracy: 9751/9900 (98.4949%)
Done in 285.7686514854431 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4791/4885 (98.0757%), train_poison_data_count: 385
Global model norm: 44.983860766859344.
Norm before scaling: 44.942912193640865. Distance: 1.1003569912332192
Total norm for 4 adversaries is: 44.942912193640865. distance: 1.1003569912332192
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0283, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5192/5305 (97.8699%), train_poison_data_count: 415
Global model norm: 44.983860766859344.
Norm before scaling: 44.942015865324315. Distance: 1.228034138897701
Total norm for 4 adversaries is: 44.942015865324315. distance: 1.228034138897701
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0609, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.983860766859344.
Norm before scaling: 44.94513392433671. Distance: 1.0835141923517988
Total norm for 4 adversaries is: 44.94513392433671. distance: 1.0835141923517988
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0814, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4958/5066 (97.8681%), train_poison_data_count: 400
Global model norm: 44.983860766859344.
Norm before scaling: 44.943665910434476. Distance: 1.1751649578447965
Total norm for 4 adversaries is: 44.943665910434476. distance: 1.1751649578447965
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0232, Accuracy: 9846/9900 (99.4545%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4075/4361 (93.4419%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3770/4361 (86.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1749, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3120/3297 (94.6315%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3108/3297 (94.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9334, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4412/4716 (93.5539%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4265/4716 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0128, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4833/5167 (93.5359%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4776/5167 (92.4327%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1217, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4076/4368 (93.3150%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4037/4368 (92.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9505, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4397/4679 (93.9731%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4310/4679 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1964, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4103/4356 (94.1919%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3838/4356 (88.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.7101, Accuracy: 4688/10000 (46.8800%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5442/5902 (92.2060%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5172/5902 (87.6313%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2764, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3685/3861 (95.4416%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3612/3861 (93.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8326, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4168/4356 (95.6841%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3835/4356 (88.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1613, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5881/6263 (93.9007%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5736/6263 (91.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2967, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4026/4235 (95.0649%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3950/4235 (93.2704%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1143, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4868/5232 (93.0428%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4742/5232 (90.6346%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1160, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4731/5017 (94.2994%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4614/5017 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9242, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4500/4804 (93.6719%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4062/4804 (84.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4481, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4528/4793 (94.4711%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4479/4793 (93.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0125, Accuracy: 5609/10000 (56.0900%)
time spent on training: 265.94126319885254
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5653, Accuracy: 6214/10000 (62.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0501, Accuracy: 9760/9900 (98.5859%)
Done in 293.42515563964844 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4773/4885 (97.7073%), train_poison_data_count: 385
Global model norm: 45.00384776301425.
Norm before scaling: 44.964964388520734. Distance: 1.1776765774388034
Total norm for 4 adversaries is: 44.964964388520734. distance: 1.1776765774388034
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0484, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5176/5305 (97.5683%), train_poison_data_count: 415
Global model norm: 45.00384776301425.
Norm before scaling: 44.96287531119423. Distance: 1.247638713257189
Total norm for 4 adversaries is: 44.96287531119423. distance: 1.247638713257189
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0509, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 45.00384776301425.
Norm before scaling: 44.96432369416266. Distance: 1.090080481629007
Total norm for 4 adversaries is: 44.96432369416266. distance: 1.090080481629007
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0203, Accuracy: 9851/9900 (99.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4958/5066 (97.8681%), train_poison_data_count: 400
Global model norm: 45.00384776301425.
Norm before scaling: 44.96332191222989. Distance: 1.168812220748053
Total norm for 4 adversaries is: 44.96332191222989. distance: 1.168812220748053
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0628, Accuracy: 9744/9900 (98.4242%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3644/3837 (94.9700%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3642/3837 (94.9179%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8411, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3692/3861 (95.6229%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3637/3861 (94.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7870, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3926/4175 (94.0359%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1761, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4216/4441 (94.9336%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4177/4441 (94.0554%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9964, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4112/4336 (94.8339%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4058/4336 (93.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0591, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3834/4046 (94.7603%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3827/4046 (94.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9139, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4633/4956 (93.4826%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4444/4956 (89.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2285, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4387/4618 (94.9978%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4320/4618 (93.5470%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8942, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3393/3616 (93.8330%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3392/3616 (93.8053%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8428, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4361/4576 (95.3016%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4232/4576 (92.4825%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9279, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4013/4223 (95.0272%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3987/4223 (94.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8848, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4253/4503 (94.4481%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4198/4503 (93.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9725, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3467/3590 (96.5738%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3352/3590 (93.3705%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9136, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4490/4707 (95.3898%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4377/4707 (92.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9079, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3845/4013 (95.8136%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3820/4013 (95.1906%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7374, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3495/3704 (94.3575%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3465/3704 (93.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0235, Accuracy: 5593/10000 (55.9300%)
time spent on training: 255.2881932258606
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5767, Accuracy: 6194/10000 (61.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0457, Accuracy: 9774/9900 (98.7273%)
Done in 282.6973354816437 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4776/4885 (97.7687%), train_poison_data_count: 385
Global model norm: 45.018977931794915.
Norm before scaling: 44.97869097252123. Distance: 1.1726706791751809
Total norm for 4 adversaries is: 44.97869097252123. distance: 1.1726706791751809
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0628, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5183/5305 (97.7003%), train_poison_data_count: 415
Global model norm: 45.018977931794915.
Norm before scaling: 44.977320402464365. Distance: 1.2504904738425233
Total norm for 4 adversaries is: 44.977320402464365. distance: 1.2504904738425233
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0635, Accuracy: 9745/9900 (98.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4608/4717 (97.6892%), train_poison_data_count: 370
Global model norm: 45.018977931794915.
Norm before scaling: 44.97935724446271. Distance: 1.0871900840349182
Total norm for 4 adversaries is: 44.97935724446271. distance: 1.0871900840349182
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0326, Accuracy: 9815/9900 (99.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4970/5066 (98.1050%), train_poison_data_count: 400
Global model norm: 45.018977931794915.
Norm before scaling: 44.97729190501997. Distance: 1.1314141423129647
Total norm for 4 adversaries is: 44.97729190501997. distance: 1.1314141423129647
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0306, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4411/4596 (95.9748%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4366/4596 (94.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9058, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4112/4356 (94.3985%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3844/4356 (88.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4601, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4058/4295 (94.4820%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3965/4295 (92.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9211, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4395/4634 (94.8425%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4265/4634 (92.0371%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9365, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4432/4767 (92.9725%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4316/4767 (90.5391%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2767, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4030/4223 (95.4298%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3999/4223 (94.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8293, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3879/4046 (95.8725%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3799/4046 (93.8952%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7702, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4741/5083 (93.2717%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4539/5083 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0914, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4151/4362 (95.1628%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4151/4362 (95.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8783, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4427/4663 (94.9389%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0341, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3166/3297 (96.0267%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3131/3297 (94.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7643, Accuracy: 6027/10000 (60.2700%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4247/4433 (95.8042%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4185/4433 (94.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0301, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4978/5265 (94.5489%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4826/5265 (91.6619%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9889, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4720/4986 (94.6651%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4584/4986 (91.9374%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9132, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4406/4647 (94.8139%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4306/4647 (92.6619%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9886, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4733/5017 (94.3392%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4605/5017 (91.7879%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9293, Accuracy: 5803/10000 (58.0300%)
time spent on training: 262.37710905075073
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5742, Accuracy: 6205/10000 (62.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0458, Accuracy: 9775/9900 (98.7374%)
Done in 289.9522557258606 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4789/4885 (98.0348%), train_poison_data_count: 385
Global model norm: 45.035932648188684.
Norm before scaling: 44.994004591931464. Distance: 1.1248712995875045
Total norm for 4 adversaries is: 44.994004591931464. distance: 1.1248712995875045
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0632, Accuracy: 9750/9900 (98.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 45.035932648188684.
Norm before scaling: 44.99275929160019. Distance: 1.218957932169593
Total norm for 4 adversaries is: 44.99275929160019. distance: 1.218957932169593
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0346, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 45.035932648188684.
Norm before scaling: 44.997715870850044. Distance: 1.1614138789999628
Total norm for 4 adversaries is: 44.997715870850044. distance: 1.1614138789999628
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0212, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4959/5066 (97.8879%), train_poison_data_count: 400
Global model norm: 45.035932648188684.
Norm before scaling: 44.99572733622188. Distance: 1.1890611926759609
Total norm for 4 adversaries is: 44.99572733622188. distance: 1.1890611926759609
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0398, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3971/4184 (94.9092%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3879/4184 (92.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0248, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5963/6391 (93.3031%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5732/6391 (89.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2163, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4591/4934 (93.0482%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4152/4934 (84.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4371, Accuracy: 4806/10000 (48.0600%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4414/4618 (95.5825%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4280/4618 (92.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0279, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4060/4235 (95.8678%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4020/4235 (94.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9741, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4224/4465 (94.6025%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4231/4465 (94.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8172, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4272/4503 (94.8701%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4195/4503 (93.1601%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9502, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4696/5025 (93.4527%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0346, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5323/5582 (95.3601%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5137/5582 (92.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1861, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3584/3804 (94.2166%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3603/3804 (94.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9310, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3854/4158 (92.6888%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3760/4158 (90.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9919, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4336/4538 (95.5487%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4281/4538 (94.3367%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9160, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4073/4368 (93.2463%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3966/4368 (90.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0659, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4752/5083 (93.4881%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4623/5083 (90.9502%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9609, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4846/5116 (94.7224%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4717/5116 (92.2009%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9622, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3803/4356 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4838, Accuracy: 4899/10000 (48.9900%)
time spent on training: 265.2623088359833
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.5774, Accuracy: 6205/10000 (62.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0468, Accuracy: 9769/9900 (98.6768%)
Done in 292.64428782463074 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 45.05488325234916.
Norm before scaling: 45.01441148355644. Distance: 1.1663409981996777
Total norm for 4 adversaries is: 45.01441148355644. distance: 1.1663409981996777
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0561, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5305 (98.1338%), train_poison_data_count: 415
Global model norm: 45.05488325234916.
Norm before scaling: 45.01099583539282. Distance: 1.194801720086626
Total norm for 4 adversaries is: 45.01099583539282. distance: 1.194801720086626
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0657, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4617/4717 (97.8800%), train_poison_data_count: 370
Global model norm: 45.05488325234916.
Norm before scaling: 45.01507993856059. Distance: 1.09364100321856
Total norm for 4 adversaries is: 45.01507993856059. distance: 1.09364100321856
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0359, Accuracy: 9805/9900 (99.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 45.05488325234916.
Norm before scaling: 45.0159137985356. Distance: 1.2638366686101912
Total norm for 4 adversaries is: 45.0159137985356. distance: 1.2638366686101912
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0133, Accuracy: 9867/9900 (99.6667%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5869/6263 (93.7091%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5751/6263 (91.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3008, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4260/4433 (96.0975%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4197/4433 (94.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9032, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3462/3672 (94.2810%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3404/3672 (92.7015%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9227, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5146/5455 (94.3355%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4968/5455 (91.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2095, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4706/5025 (93.6517%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4631/5025 (92.1592%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0996, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4421/4618 (95.7341%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4193/4618 (90.7969%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2145, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4437/4707 (94.2639%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4360/4707 (92.6280%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9594, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4196/4362 (96.1944%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4045/4362 (92.7327%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2251, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4639/4989 (92.9846%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4544/4989 (91.0804%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2207, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4791/5083 (94.2554%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4672/5083 (91.9142%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1585, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4400/4647 (94.6847%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4322/4647 (93.0062%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9561, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4112/4368 (94.1392%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4000/4368 (91.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9747, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4116/4354 (94.5338%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3715/4354 (85.3238%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.6029, Accuracy: 4854/10000 (48.5400%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4420/4767 (92.7208%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4320/4767 (90.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2950, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4455/4662 (95.5598%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4371/4662 (93.7580%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8954, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4558/4804 (94.8793%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4492/4804 (93.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0536, Accuracy: 5650/10000 (56.5000%)
time spent on training: 265.0130090713501
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.5910, Accuracy: 6169/10000 (61.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0475, Accuracy: 9766/9900 (98.6465%)
Done in 292.36377000808716 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4802/4885 (98.3009%), train_poison_data_count: 385
Global model norm: 45.07333163423107.
Norm before scaling: 45.031487193598075. Distance: 1.104102594687902
Total norm for 4 adversaries is: 45.031487193598075. distance: 1.104102594687902
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0611, Accuracy: 9743/9900 (98.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5189/5305 (97.8134%), train_poison_data_count: 415
Global model norm: 45.07333163423107.
Norm before scaling: 45.03095181198983. Distance: 1.2159159549950445
Total norm for 4 adversaries is: 45.03095181198983. distance: 1.2159159549950445
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0322, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4620/4717 (97.9436%), train_poison_data_count: 370
Global model norm: 45.07333163423107.
Norm before scaling: 45.03230584076211. Distance: 1.0406963724857001
Total norm for 4 adversaries is: 45.03230584076211. distance: 1.0406963724857001
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0550, Accuracy: 9766/9900 (98.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4963/5066 (97.9668%), train_poison_data_count: 400
Global model norm: 45.07333163423107.
Norm before scaling: 45.030673953203134. Distance: 1.1438114650032318
Total norm for 4 adversaries is: 45.030673953203134. distance: 1.1438114650032318
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0503, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4037/4235 (95.3247%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3937/4235 (92.9634%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9986, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3590/3775 (95.0993%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3594/3775 (95.2053%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7610, Accuracy: 6066/10000 (60.6600%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4576/4874 (93.8859%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4324/4874 (88.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5283, Accuracy: 4905/10000 (49.0500%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4904/5265 (93.1434%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0134, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4813/5083 (94.6882%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4608/5083 (90.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0845, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4238/4511 (93.9481%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4147/4511 (91.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9607, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4338/4538 (95.5928%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4316/4538 (95.1080%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9248, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4411/4716 (93.5327%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4269/4716 (90.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1508, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4434/4663 (95.0890%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4395/4663 (94.2526%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9071, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4270/4441 (96.1495%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4171/4441 (93.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9930, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4553/4793 (94.9927%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4487/4793 (93.6157%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9997, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4431/4662 (95.0450%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4394/4662 (94.2514%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8821, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3502/3704 (94.5464%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3494/3704 (94.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8203, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4689/4989 (93.9868%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4516/4989 (90.5191%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0701, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4153/4346 (95.5591%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4119/4346 (94.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8236, Accuracy: 5972/10000 (59.7200%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4190/4362 (96.0569%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4096/4362 (93.9019%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8474, Accuracy: 5745/10000 (57.4500%)
time spent on training: 261.99972438812256
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.5927, Accuracy: 6178/10000 (61.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0489, Accuracy: 9765/9900 (98.6364%)
Done in 289.6718695163727 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 45.09021853592182.
Norm before scaling: 45.04795350772746. Distance: 1.1167694056395974
Total norm for 4 adversaries is: 45.04795350772746. distance: 1.1167694056395974
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0378, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 45.09021853592182.
Norm before scaling: 45.04643329214589. Distance: 1.205136042707038
Total norm for 4 adversaries is: 45.04643329214589. distance: 1.205136042707038
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0776, Accuracy: 9717/9900 (98.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4604/4717 (97.6044%), train_poison_data_count: 370
Global model norm: 45.09021853592182.
Norm before scaling: 45.04987876951987. Distance: 1.1124081048622874
Total norm for 4 adversaries is: 45.04987876951987. distance: 1.1124081048622874
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0296, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4963/5066 (97.9668%), train_poison_data_count: 400
Global model norm: 45.09021853592182.
Norm before scaling: 45.048095771266375. Distance: 1.1317913846453966
Total norm for 4 adversaries is: 45.048095771266375. distance: 1.1317913846453966
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0403, Accuracy: 9800/9900 (98.9899%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3746/3969 (94.3815%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3671/3969 (92.4918%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9105, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4313/4558 (94.6248%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4129/4558 (90.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2128, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4636/4918 (94.2660%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4591/4918 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1029, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5515/5902 (93.4429%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5166/5902 (87.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3748, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4972/5265 (94.4349%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4702/5265 (89.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1754, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4239/4511 (93.9703%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4178/4511 (92.6180%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0282, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4318/4625 (93.3622%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4179/4625 (90.3568%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1900, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4142/4416 (93.7953%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4090/4416 (92.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9927, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3166/3297 (96.0267%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3147/3297 (95.4504%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6371, Accuracy: 6287/10000 (62.8700%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4794/5025 (95.4030%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4755/5025 (94.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0253, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4268/4441 (96.1045%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4215/4441 (94.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0388, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4217/4481 (94.1085%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4022/4481 (89.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2511, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3637/3797 (95.7861%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3581/3797 (94.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8132, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3458/3646 (94.8437%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3438/3646 (94.2951%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7777, Accuracy: 6027/10000 (60.2700%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3849/4025 (95.6273%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3821/4025 (94.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8464, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4607/4928 (93.4862%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4475/4928 (90.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1174, Accuracy: 5473/10000 (54.7300%)
time spent on training: 253.57641410827637
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6140, Accuracy: 6137/10000 (61.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0473, Accuracy: 9769/9900 (98.6768%)
Done in 281.1200785636902 sec.
Saving all the graphs.
This run has a label: Dec.09_11.41.48. Visdom environment: cifar100_CerP
