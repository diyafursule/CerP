current path: saved_models/model_cifar100_Oct.22_00.45.17_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4307/4885 (88.1679%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43993917879713. Distance: 2.2940768889867242
Total norm for 4 adversaries is: 42.43993917879713. distance: 2.2940768889867242
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4352, Accuracy: 8847/9900 (89.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435358411997505. Distance: 2.2515171022623357
Total norm for 4 adversaries is: 42.435358411997505. distance: 2.2515171022623357
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7209, Accuracy: 8323/9900 (84.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438731112481435. Distance: 2.17806454195595
Total norm for 4 adversaries is: 42.438731112481435. distance: 2.17806454195595
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4343, Accuracy: 8872/9900 (89.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4457/5066 (87.9787%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440442529612895. Distance: 2.3057631229381657
Total norm for 4 adversaries is: 42.440442529612895. distance: 2.3057631229381657
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6010, Accuracy: 8502/9900 (85.8788%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3659/4356 (83.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3724, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3941/4465 (88.2643%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4103/4465 (91.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9692, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4042/4647 (86.9808%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4163/4647 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0081, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4450/5055 (88.0317%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4544/5055 (89.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1230, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4452/5116 (87.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9325, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3624/4126 (87.8333%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3748/4126 (90.8386%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9513, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0196, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4438/4986 (89.0092%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4466/4986 (89.5708%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0309, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/4013 (88.1136%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3681/4013 (91.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8697, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4106/4618 (88.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0016, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4432/5083 (87.1926%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4433/5083 (87.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0686, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3971/4511 (88.0293%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4048/4511 (89.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1200, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3390/3797 (89.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9631, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5004/5582 (89.6453%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5062/5582 (90.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1096, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3149/3616 (87.0852%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3211/3616 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0990, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4819/5455 (88.3410%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4830/5455 (88.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8932, Accuracy: 5458/10000 (54.5800%)
time spent on training: 232.83715629577637
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1285, Accuracy: 7029/10000 (70.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 10.1650, Accuracy: 27/9900 (0.2727%)
Done in 254.21890950202942 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4360/4885 (89.2528%), train_poison_data_count: 385
Global model norm: 42.46442387366012.
Norm before scaling: 42.46658986642102. Distance: 2.210041740851827
Total norm for 4 adversaries is: 42.46658986642102. distance: 2.210041740851827
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1905, Accuracy: 9432/9900 (95.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 42.46442387366012.
Norm before scaling: 42.47034667482345. Distance: 2.238556370628446
Total norm for 4 adversaries is: 42.47034667482345. distance: 2.238556370628446
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3754, Accuracy: 8989/9900 (90.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 42.46442387366012.
Norm before scaling: 42.47172772857257. Distance: 2.1531749304309615
Total norm for 4 adversaries is: 42.47172772857257. distance: 2.1531749304309615
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3412, Accuracy: 9054/9900 (91.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4475/5066 (88.3340%), train_poison_data_count: 400
Global model norm: 42.46442387366012.
Norm before scaling: 42.47477997110462. Distance: 2.301005276458009
Total norm for 4 adversaries is: 42.47477997110462. distance: 2.301005276458009
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3297, Accuracy: 9089/9900 (91.8081%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3591/4025 (89.2174%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9139, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3392/3797 (89.3337%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3475/3797 (91.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0970, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4014/4625 (86.7892%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4019/4625 (86.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1656, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3833/4481 (85.5389%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3890/4481 (86.8110%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1199, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3882/4315 (89.9652%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3963/4315 (91.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0534, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3704/4235 (87.4616%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3794/4235 (89.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1154, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3377/3828 (88.2184%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3501/3828 (91.4577%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8102, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3837/4416 (86.8886%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3935/4416 (89.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0931, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3295/3638 (90.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9991, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4551/5265 (86.4387%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4558/5265 (86.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0574, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3340/3781 (88.3364%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3405/3781 (90.0555%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2816, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3974/4441 (89.4844%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4061/4441 (91.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0754, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3946/4433 (89.0142%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3996/4433 (90.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8936, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4431/5083 (87.1729%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4374/5083 (86.0515%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1740, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4299/4928 (87.2362%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4413/4928 (89.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8524, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4154/4793 (86.6681%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4316/4793 (90.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0164, Accuracy: 5436/10000 (54.3600%)
time spent on training: 230.1625816822052
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1549, Accuracy: 6945/10000 (69.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.8495, Accuracy: 35/9900 (0.3535%)
Done in 251.53902006149292 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4381/4885 (89.6827%), train_poison_data_count: 385
Global model norm: 42.49983340959997.
Norm before scaling: 42.499570597555014. Distance: 2.118824231133041
Total norm for 4 adversaries is: 42.499570597555014. distance: 2.118824231133041
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2340, Accuracy: 9342/9900 (94.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.49983340959997.
Norm before scaling: 42.504329685247214. Distance: 2.1933113289901334
Total norm for 4 adversaries is: 42.504329685247214. distance: 2.1933113289901334
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1226, Accuracy: 9598/9900 (96.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.49983340959997.
Norm before scaling: 42.504823657788386. Distance: 2.1437761266245143
Total norm for 4 adversaries is: 42.504823657788386. distance: 2.1437761266245143
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2623, Accuracy: 9230/9900 (93.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 42.49983340959997.
Norm before scaling: 42.50316940158331. Distance: 2.2137877084459583
Total norm for 4 adversaries is: 42.50316940158331. distance: 2.2137877084459583
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3928, Accuracy: 8956/9900 (90.4646%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3135/3616 (86.6980%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3259/3616 (90.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8977, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3544/3837 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9659, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4103/4679 (87.6897%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4040/4679 (86.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2081, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3122/3638 (85.8164%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3299/3638 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0256, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3611/4046 (89.2486%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3667/4046 (90.6327%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8624, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4007/4518 (88.6897%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4035/4518 (89.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9647, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3797 (88.9913%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3407/3797 (89.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0701, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4497/5025 (89.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0029, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3855/4362 (88.3769%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3931/4362 (90.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0142, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3966/4558 (87.0118%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4046/4558 (88.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3071, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3178/3672 (86.5468%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3357/3672 (91.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9363, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4285/4874 (87.9155%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4295/4874 (88.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1234, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3612/4025 (89.7391%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3672/4025 (91.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9053, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4113/4663 (88.2050%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4234/4663 (90.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0089, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3456/3911 (88.3661%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3327/3911 (85.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2252, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4415/5017 (88.0008%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4488/5017 (89.4559%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9048, Accuracy: 5535/10000 (55.3500%)
time spent on training: 230.2902901172638
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1451, Accuracy: 6999/10000 (69.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3882, Accuracy: 46/9900 (0.4646%)
Done in 251.41253185272217 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.53281275830241.
Norm before scaling: 42.53678612481348. Distance: 2.1315396601481345
Total norm for 4 adversaries is: 42.53678612481348. distance: 2.1315396601481345
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1099, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.53281275830241.
Norm before scaling: 42.534794465641596. Distance: 2.2017374200687856
Total norm for 4 adversaries is: 42.534794465641596. distance: 2.2017374200687856
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0709, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4195/4717 (88.9336%), train_poison_data_count: 370
Global model norm: 42.53281275830241.
Norm before scaling: 42.5381521080268. Distance: 2.105658641171657
Total norm for 4 adversaries is: 42.5381521080268. distance: 2.105658641171657
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3494, Accuracy: 9057/9900 (91.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.53281275830241.
Norm before scaling: 42.53900582526069. Distance: 2.264142412943335
Total norm for 4 adversaries is: 42.53900582526069. distance: 2.264142412943335
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1203, Accuracy: 9578/9900 (96.7475%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5248/6124 (85.6956%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5294/6124 (86.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0365, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3779/4356 (86.7539%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3714/4356 (85.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1711, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3583/4158 (86.1712%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3613/4158 (86.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0967, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4793/5455 (87.8643%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4925/5455 (90.2841%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9945, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3928/4511 (87.0760%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4062/4511 (90.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8221, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4501/5232 (86.0283%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4587/5232 (87.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9774, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4432/5244 (84.5156%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4539/5244 (86.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0714, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4331/4918 (88.0643%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4439/4918 (90.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0892, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3625/4126 (87.8575%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3745/4126 (90.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9479, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4320/4928 (87.6623%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4379/4928 (88.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8975, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3680/4223 (87.1418%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3832/4223 (90.7412%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9742, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4508/5195 (86.7757%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4522/5195 (87.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0576, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4125/4679 (88.1599%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4234/4679 (90.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9500, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3221/3646 (88.3434%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8669, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3149/3616 (87.0852%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3275/3616 (90.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0264, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4088/4716 (86.6836%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4174/4716 (88.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9237, Accuracy: 5488/10000 (54.8800%)
time spent on training: 235.65321969985962
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1543, Accuracy: 6974/10000 (69.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.5573, Accuracy: 43/9900 (0.4343%)
Done in 257.5607740879059 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 42.57149747731383.
Norm before scaling: 42.57400352758932. Distance: 2.0932487912732083
Total norm for 4 adversaries is: 42.57400352758932. distance: 2.0932487912732083
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.3097, Accuracy: 9109/9900 (92.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.57149747731383.
Norm before scaling: 42.57437913568514. Distance: 2.149714198079096
Total norm for 4 adversaries is: 42.57437913568514. distance: 2.149714198079096
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2069, Accuracy: 9376/9900 (94.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 42.57149747731383.
Norm before scaling: 42.56919057637959. Distance: 2.0399098006110234
Total norm for 4 adversaries is: 42.56919057637959. distance: 2.0399098006110234
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.0726, Accuracy: 9692/9900 (97.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.57149747731383.
Norm before scaling: 42.578276949270155. Distance: 2.2355249820099146
Total norm for 4 adversaries is: 42.578276949270155. distance: 2.2355249820099146
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1503, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5305/6124 (86.6264%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5297/6124 (86.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1072, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3954/4433 (89.1947%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4009/4433 (90.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8851, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3317/3781 (87.7281%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3286/3781 (86.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1755, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3549/3969 (89.4180%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3566/3969 (89.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9820, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4446/5025 (88.4776%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4526/5025 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2268, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4145/4679 (88.5873%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0007, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4108/4707 (87.2743%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4272/4707 (90.7584%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9515, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4378/4986 (87.8059%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4505/4986 (90.3530%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8781, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3879/4315 (89.8957%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3947/4315 (91.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9626, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3858/4416 (87.3641%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3902/4416 (88.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9889, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4191/4804 (87.2398%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4028/4804 (83.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2665, Accuracy: 5009/10000 (50.0900%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4283/4793 (89.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0464, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4652/5232 (88.9144%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4674/5232 (89.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0230, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4150/4662 (89.0176%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4215/4662 (90.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9171, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4291/4956 (86.5819%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4338/4956 (87.5303%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1540, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3814/4368 (87.3168%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3856/4368 (88.2784%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1465, Accuracy: 5237/10000 (52.3700%)
time spent on training: 234.28977298736572
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1683, Accuracy: 6943/10000 (69.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.5061, Accuracy: 43/9900 (0.4343%)
Done in 254.93538069725037 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 42.60698706409182.
Norm before scaling: 42.60870031781582. Distance: 2.0902645649990514
Total norm for 4 adversaries is: 42.60870031781582. distance: 2.0902645649990514
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2623, Accuracy: 9251/9900 (93.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.60698706409182.
Norm before scaling: 42.606495708547776. Distance: 2.185290937804191
Total norm for 4 adversaries is: 42.606495708547776. distance: 2.185290937804191
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2415, Accuracy: 9295/9900 (93.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.60698706409182.
Norm before scaling: 42.60609173268976. Distance: 2.036461585417067
Total norm for 4 adversaries is: 42.60609173268976. distance: 2.036461585417067
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1513, Accuracy: 9521/9900 (96.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 42.60698706409182.
Norm before scaling: 42.61029031607638. Distance: 2.226965937956474
Total norm for 4 adversaries is: 42.61029031607638. distance: 2.226965937956474
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2282, Accuracy: 9299/9900 (93.9293%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5248/6124 (85.6956%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5401/6124 (88.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9009, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5024/5902 (85.1237%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5034/5902 (85.2931%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1627, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4133/4707 (87.8054%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4279/4707 (90.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9692, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4052/4647 (87.1960%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4218/4647 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9644, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2943/3297 (89.2630%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8280, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5555/6263 (88.6955%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5677/6263 (90.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0074, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4158/4663 (89.1701%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4240/4663 (90.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0238, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4354/4956 (87.8531%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4365/4956 (88.0751%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1291, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3620/4046 (89.4711%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3606/4046 (89.1251%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0967, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3689/4184 (88.1692%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3750/4184 (89.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9728, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4841/5591 (86.5856%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4869/5591 (87.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0049, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4149/4634 (89.5339%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9616, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3382/3828 (88.3490%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3542/3828 (92.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9102, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3172/3638 (87.1908%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3286/3638 (90.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0032, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3332/3781 (88.1248%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3299/3781 (87.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0343, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3479/3837 (90.6698%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9976, Accuracy: 5471/10000 (54.7100%)
time spent on training: 235.47601318359375
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1825, Accuracy: 6938/10000 (69.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.6165, Accuracy: 39/9900 (0.3939%)
Done in 256.3102779388428 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4885 (89.1505%), train_poison_data_count: 385
Global model norm: 42.64360503969206.
Norm before scaling: 42.648063259715414. Distance: 2.167118159960868
Total norm for 4 adversaries is: 42.648063259715414. distance: 2.167118159960868
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2759, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.64360503969206.
Norm before scaling: 42.64469709623563. Distance: 2.2212962194817325
Total norm for 4 adversaries is: 42.64469709623563. distance: 2.2212962194817325
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1046, Accuracy: 9631/9900 (97.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.64360503969206.
Norm before scaling: 42.64483592710845. Distance: 2.091660553010109
Total norm for 4 adversaries is: 42.64483592710845. distance: 2.091660553010109
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.0321, Accuracy: 9803/9900 (99.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 42.64360503969206.
Norm before scaling: 42.6492281880817. Distance: 2.21305104521822
Total norm for 4 adversaries is: 42.6492281880817. distance: 2.21305104521822
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1135, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3920/4501 (87.0918%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4003/4501 (88.9358%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1159, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3609/4175 (86.4431%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3720/4175 (89.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9661, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3279/3616 (90.6803%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8965, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4117/4634 (88.8433%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4175/4634 (90.0950%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1659, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3979/4558 (87.2971%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3947/4558 (86.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1289, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4498/5167 (87.0524%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4591/5167 (88.8523%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2654, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3904/4356 (89.6235%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3930/4356 (90.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1898, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4098/4716 (86.8957%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4147/4716 (87.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0259, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5310/6124 (86.7080%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5342/6124 (87.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0578, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4397/5055 (86.9832%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4536/5055 (89.7329%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8777, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4601/5025 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9440, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4365/4918 (88.7556%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4431/4918 (90.0976%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1616, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3708/4223 (87.8049%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3836/4223 (90.8359%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0369, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3849/4481 (85.8960%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3848/4481 (85.8737%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1096, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3166/3638 (87.0258%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3297/3638 (90.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9248, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3560/4013 (88.7117%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3694/4013 (92.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8657, Accuracy: 5587/10000 (55.8700%)
time spent on training: 231.48756194114685
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1899, Accuracy: 6933/10000 (69.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.5508, Accuracy: 50/9900 (0.5051%)
Done in 252.08528065681458 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 42.67811224326162.
Norm before scaling: 42.67882730118867. Distance: 2.1498276530540057
Total norm for 4 adversaries is: 42.67882730118867. distance: 2.1498276530540057
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1606, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.67811224326162.
Norm before scaling: 42.67797924116575. Distance: 2.2102760430803636
Total norm for 4 adversaries is: 42.67797924116575. distance: 2.2102760430803636
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1339, Accuracy: 9546/9900 (96.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4228/4717 (89.6332%), train_poison_data_count: 370
Global model norm: 42.67811224326162.
Norm before scaling: 42.67694953349378. Distance: 2.055481615827335
Total norm for 4 adversaries is: 42.67694953349378. distance: 2.055481615827335
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1897, Accuracy: 9411/9900 (95.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.67811224326162.
Norm before scaling: 42.68283712408229. Distance: 2.2301957319088634
Total norm for 4 adversaries is: 42.68283712408229. distance: 2.2301957319088634
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1569, Accuracy: 9484/9900 (95.7980%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3209/3646 (88.0143%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3343/3646 (91.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8598, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3927/4501 (87.2473%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4020/4501 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0947, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4116/4651 (88.4971%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4166/4651 (89.5721%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0597, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4576/5167 (88.5620%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4597/5167 (88.9685%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2380, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4856/5455 (89.0192%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4823/5455 (88.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8931, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4825/5591 (86.2994%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4892/5591 (87.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2065, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4142/4679 (88.5232%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4146/4679 (88.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0764, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4550/5017 (90.6916%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4558/5017 (90.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0357, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4289/4793 (89.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0142, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3992/4456 (89.5871%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4009/4456 (89.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1595, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4764/5424 (87.8319%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4845/5424 (89.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2995, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3671/4175 (87.9281%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3710/4175 (88.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9751, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4480/5116 (87.5684%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4583/5116 (89.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0937, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3270/3704 (88.2829%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3365/3704 (90.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9529, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4651/5232 (88.8953%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4669/5232 (89.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0837, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3077/3472 (88.6233%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3210/3472 (92.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9678, Accuracy: 5581/10000 (55.8100%)
time spent on training: 235.44690585136414
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1991, Accuracy: 6898/10000 (68.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.6176, Accuracy: 47/9900 (0.4747%)
Done in 256.43402910232544 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4394/4885 (89.9488%), train_poison_data_count: 385
Global model norm: 42.70731118568503.
Norm before scaling: 42.70869458053521. Distance: 2.113020170376393
Total norm for 4 adversaries is: 42.70869458053521. distance: 2.113020170376393
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1778, Accuracy: 9452/9900 (95.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 42.70731118568503.
Norm before scaling: 42.71189565300793. Distance: 2.237514184661742
Total norm for 4 adversaries is: 42.71189565300793. distance: 2.237514184661742
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1479, Accuracy: 9512/9900 (96.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4190/4717 (88.8276%), train_poison_data_count: 370
Global model norm: 42.70731118568503.
Norm before scaling: 42.70615212926002. Distance: 2.101131352439699
Total norm for 4 adversaries is: 42.70615212926002. distance: 2.101131352439699
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1923, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.70731118568503.
Norm before scaling: 42.715429415566575. Distance: 2.2865004017869373
Total norm for 4 adversaries is: 42.715429415566575. distance: 2.2865004017869373
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.0866, Accuracy: 9669/9900 (97.6667%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3199/3590 (89.1086%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3073/3590 (85.5989%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2072, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3780/4368 (86.5385%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3828/4368 (87.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2233, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3273/3704 (88.3639%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3333/3704 (89.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8628, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4348/4928 (88.2305%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4447/4928 (90.2394%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9343, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3859/4356 (88.5904%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3646/4356 (83.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3144, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3458/3911 (88.4173%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3382/3911 (86.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2522, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4094/4651 (88.0241%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4215/4651 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1948, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3718/4184 (88.8623%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3756/4184 (89.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0908, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3856/4346 (88.7253%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3991/4346 (91.8316%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9249, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4118/4793 (85.9170%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4319/4793 (90.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1390, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3332/3804 (87.5920%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3406/3804 (89.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0356, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4422/4986 (88.6883%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4450/4986 (89.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9492, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5344/6124 (87.2632%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5393/6124 (88.0634%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0868, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4133/4707 (87.8054%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4245/4707 (90.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8457, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3741/4235 (88.3353%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3745/4235 (88.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9653, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3645/4046 (90.0890%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3654/4046 (90.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0742, Accuracy: 5376/10000 (53.7600%)
time spent on training: 231.15498900413513
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1807, Accuracy: 6927/10000 (69.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.4823, Accuracy: 60/9900 (0.6061%)
Done in 252.3659176826477 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4429/4885 (90.6653%), train_poison_data_count: 385
Global model norm: 42.73755272691614.
Norm before scaling: 42.74258376369958. Distance: 2.1522001852074615
Total norm for 4 adversaries is: 42.74258376369958. distance: 2.1522001852074615
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3462, Accuracy: 9087/9900 (91.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.73755272691614.
Norm before scaling: 42.74125715835418. Distance: 2.234279923983797
Total norm for 4 adversaries is: 42.74125715835418. distance: 2.234279923983797
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0612, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 42.73755272691614.
Norm before scaling: 42.73776980345883. Distance: 2.049202331174693
Total norm for 4 adversaries is: 42.73776980345883. distance: 2.049202331174693
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3751, Accuracy: 8933/9900 (90.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 42.73755272691614.
Norm before scaling: 42.74245667412043. Distance: 2.2177568818872375
Total norm for 4 adversaries is: 42.74245667412043. distance: 2.2177568818872375
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1865, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4449/4986 (89.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8838, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4079/4634 (88.0233%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4120/4634 (88.9081%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8684, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4244/4716 (89.9915%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4241/4716 (89.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0507, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5321/6124 (86.8877%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5348/6124 (87.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0963, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4376/4918 (88.9793%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4430/4918 (90.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9107, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3395/3797 (89.4127%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3454/3797 (90.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0011, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5038/5582 (90.2544%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4976/5582 (89.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2070, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4488/4956 (90.5569%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0341, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3963/4433 (89.3977%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8680, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3815/4354 (87.6206%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0120, Accuracy: 3390/4354 (77.8594%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.6492, Accuracy: 4310/10000 (43.1000%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4337/4928 (88.0073%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4408/4928 (89.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9321, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3468/3911 (88.6730%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3544/3911 (90.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1627, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3881/4481 (86.6101%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3940/4481 (87.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1459, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4590/5197 (88.3202%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4580/5197 (88.1278%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0444, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4818/5455 (88.3226%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4868/5455 (89.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1020, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3816/4361 (87.5029%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3857/4361 (88.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1194, Accuracy: 5252/10000 (52.5200%)
time spent on training: 237.25712132453918
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1715, Accuracy: 6925/10000 (69.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.4357, Accuracy: 49/9900 (0.4949%)
Done in 258.1170349121094 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.774125993317355.
Norm before scaling: 42.777424899760945. Distance: 2.122629077163212
Total norm for 4 adversaries is: 42.777424899760945. distance: 2.122629077163212
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2177, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 42.774125993317355.
Norm before scaling: 42.77576120971212. Distance: 2.2421976016146035
Total norm for 4 adversaries is: 42.77576120971212. distance: 2.2421976016146035
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1076, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4211/4717 (89.2728%), train_poison_data_count: 370
Global model norm: 42.774125993317355.
Norm before scaling: 42.78016713613111. Distance: 2.141743833979831
Total norm for 4 adversaries is: 42.78016713613111. distance: 2.141743833979831
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0786, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 42.774125993317355.
Norm before scaling: 42.77618641280961. Distance: 2.151159275586741
Total norm for 4 adversaries is: 42.77618641280961. distance: 2.151159275586741
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1958, Accuracy: 9393/9900 (94.8788%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4239/4928 (86.0187%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4425/4928 (89.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9589, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3698/4184 (88.3843%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3746/4184 (89.5315%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1025, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4143/4707 (88.0178%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4301/4707 (91.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9794, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3400/3828 (88.8192%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7903, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4015/4503 (89.1628%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4041/4503 (89.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0609, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4156/4662 (89.1463%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4250/4662 (91.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0238, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3783/4235 (89.3270%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3807/4235 (89.8937%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9854, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4452/5244 (84.8970%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4505/5244 (85.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0683, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4191/4793 (87.4400%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4310/4793 (89.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9476, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3885/4481 (86.6994%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3887/4481 (86.7440%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0661, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3882/4346 (89.3235%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4023/4346 (92.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7836, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3845/4361 (88.1679%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3766/4361 (86.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0693, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4476/5055 (88.5460%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4563/5055 (90.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0312, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4541/5195 (87.4110%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4598/5195 (88.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1013, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3887/4315 (90.0811%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3970/4315 (92.0046%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9548, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4148/4663 (88.9556%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4244/4663 (91.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1165, Accuracy: 5227/10000 (52.2700%)
time spent on training: 233.72255301475525
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1836, Accuracy: 6901/10000 (69.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.5449, Accuracy: 46/9900 (0.4646%)
Done in 254.59322571754456 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.80237106458006.
Norm before scaling: 42.80123026853317. Distance: 2.0634979376924716
Total norm for 4 adversaries is: 42.80123026853317. distance: 2.0634979376924716
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1439, Accuracy: 9540/9900 (96.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 42.80237106458006.
Norm before scaling: 42.806527582962595. Distance: 2.215511698980141
Total norm for 4 adversaries is: 42.806527582962595. distance: 2.215511698980141
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1700, Accuracy: 9495/9900 (95.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.80237106458006.
Norm before scaling: 42.80469676834176. Distance: 2.096323282397371
Total norm for 4 adversaries is: 42.80469676834176. distance: 2.096323282397371
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1427, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 42.80237106458006.
Norm before scaling: 42.80638642480815. Distance: 2.2476530550396023
Total norm for 4 adversaries is: 42.80638642480815. distance: 2.2476530550396023
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1320, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3897/4315 (90.3129%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3965/4315 (91.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9611, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3223/3590 (89.7772%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0095, Accuracy: 2955/3590 (82.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3533, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4184/4679 (89.4208%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4137/4679 (88.4163%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0068, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4611/5167 (89.2394%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4619/5167 (89.3942%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1959, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3358/3775 (88.9536%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3485/3775 (92.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9081, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3428/3828 (89.5507%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3514/3828 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8929, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3853/4235 (90.9799%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3824/4235 (90.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1197, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4060/4647 (87.3682%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9748, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4340/4918 (88.2473%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4486/4918 (91.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9351, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3944/4433 (88.9691%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4048/4433 (91.3151%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9381, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3893/4481 (86.8779%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3836/4481 (85.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1733, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3772/4295 (87.8231%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3765/4295 (87.6601%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0366, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3967/4503 (88.0968%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3999/4503 (88.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1602, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3831/4354 (87.9881%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3681/4354 (84.5429%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2842, Accuracy: 4923/10000 (49.2300%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4396/4986 (88.1669%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4471/4986 (89.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8726, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5573/6263 (88.9829%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5669/6263 (90.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0843, Accuracy: 5269/10000 (52.6900%)
time spent on training: 233.69091320037842
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.2070, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.1778, Accuracy: 51/9900 (0.5152%)
Done in 254.59912705421448 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 42.83403455899949.
Norm before scaling: 42.8316078481695. Distance: 2.053700605322024
Total norm for 4 adversaries is: 42.8316078481695. distance: 2.053700605322024
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1836, Accuracy: 9455/9900 (95.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.83403455899949.
Norm before scaling: 42.835670338169244. Distance: 2.1878692315337296
Total norm for 4 adversaries is: 42.835670338169244. distance: 2.1878692315337296
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1708, Accuracy: 9460/9900 (95.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.83403455899949.
Norm before scaling: 42.83669480568033. Distance: 2.0797122257405065
Total norm for 4 adversaries is: 42.83669480568033. distance: 2.0797122257405065
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4316, Accuracy: 8839/9900 (89.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4484/5066 (88.5116%), train_poison_data_count: 400
Global model norm: 42.83403455899949.
Norm before scaling: 42.83949166246534. Distance: 2.253285234867173
Total norm for 4 adversaries is: 42.83949166246534. distance: 2.253285234867173
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2644, Accuracy: 9246/9900 (93.3939%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3748/4223 (88.7521%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3867/4223 (91.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0094, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4850/5455 (88.9093%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4844/5455 (88.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1540, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5033/5582 (90.1648%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5025/5582 (90.0215%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0931, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3967/4465 (88.8466%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4049/4465 (90.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9664, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4830/5591 (86.3888%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4935/5591 (88.2669%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0879, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3488/3911 (89.1844%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3463/3911 (88.5451%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1086, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3871/4356 (88.8659%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3586/4356 (82.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2083, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4411/5037 (87.5720%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4506/5037 (89.4580%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0729, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4301/4679 (91.9214%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4273/4679 (91.3229%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1170, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3941/4362 (90.3485%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3962/4362 (90.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9847, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4049/4518 (89.6193%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4092/4518 (90.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1631, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4464/5083 (87.8222%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4445/5083 (87.4484%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1848, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3589/4013 (89.4343%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3685/4013 (91.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9022, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4691/5197 (90.2636%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4615/5197 (88.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1412, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2934/3297 (88.9900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3033/3297 (91.9927%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7711, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4001/4441 (90.0923%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4092/4441 (92.1414%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0048, Accuracy: 5493/10000 (54.9300%)
time spent on training: 234.89388489723206
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.2247, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.2167, Accuracy: 51/9900 (0.5152%)
Done in 255.801664352417 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.86990050304088.
Norm before scaling: 42.86877431795126. Distance: 2.039064487734005
Total norm for 4 adversaries is: 42.86877431795126. distance: 2.039064487734005
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3002, Accuracy: 9198/9900 (92.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.86990050304088.
Norm before scaling: 42.871297159255484. Distance: 2.1821320201470007
Total norm for 4 adversaries is: 42.871297159255484. distance: 2.1821320201470007
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2737, Accuracy: 9258/9900 (93.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 42.86990050304088.
Norm before scaling: 42.86990050304088. Distance: 2.026313417020023
Total norm for 4 adversaries is: 42.86990050304088. distance: 2.026313417020023
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1519, Accuracy: 9530/9900 (96.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4499/5066 (88.8077%), train_poison_data_count: 400
Global model norm: 42.86990050304088.
Norm before scaling: 42.87593953963283. Distance: 2.279438815236866
Total norm for 4 adversaries is: 42.87593953963283. distance: 2.279438815236866
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2184, Accuracy: 9328/9900 (94.2222%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3959/4501 (87.9582%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3981/4501 (88.4470%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1389, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3931/4511 (87.1425%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4068/4511 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9364, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3786/4354 (86.9545%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3418/4354 (78.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5568, Accuracy: 4503/10000 (45.0300%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3930/4346 (90.4280%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4008/4346 (92.2227%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9260, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4163/4707 (88.4427%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4197/4707 (89.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8912, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4873/5591 (87.1579%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5001/5591 (89.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0306, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4085/4647 (87.9062%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8825, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4071/4538 (89.7091%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4173/4538 (91.9568%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8379, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4285/4934 (86.8464%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4164/4934 (84.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1361, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4244/4804 (88.3430%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4188/4804 (87.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1322, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5584/6263 (89.1586%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5650/6263 (90.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0628, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3840/4481 (85.6952%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1151, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4385/5063 (86.6087%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4473/5063 (88.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1000, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3726/4223 (88.2311%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8410, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3992/4441 (89.8897%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4122/4441 (92.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0357, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3372/3756 (89.7764%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3485/3756 (92.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9097, Accuracy: 5713/10000 (57.1300%)
time spent on training: 234.51221823692322
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.2810, Accuracy: 6740/10000 (67.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 8.9125, Accuracy: 70/9900 (0.7071%)
Done in 255.3944263458252 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 42.904991048081314.
Norm before scaling: 42.90213159631829. Distance: 2.0451219346085434
Total norm for 4 adversaries is: 42.90213159631829. distance: 2.0451219346085434
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2093, Accuracy: 9394/9900 (94.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 42.904991048081314.
Norm before scaling: 42.90657575668399. Distance: 2.1772825037428505
Total norm for 4 adversaries is: 42.90657575668399. distance: 2.1772825037428505
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2737, Accuracy: 9250/9900 (93.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.904991048081314.
Norm before scaling: 42.90633535133536. Distance: 2.1131922338215565
Total norm for 4 adversaries is: 42.90633535133536. distance: 2.1131922338215565
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1592, Accuracy: 9460/9900 (95.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4513/5066 (89.0841%), train_poison_data_count: 400
Global model norm: 42.904991048081314.
Norm before scaling: 42.909254264814486. Distance: 2.241842741828551
Total norm for 4 adversaries is: 42.909254264814486. distance: 2.241842741828551
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1618, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4520/5244 (86.1937%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4601/5244 (87.7384%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9240, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4333/4928 (87.9261%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8992, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3349/3804 (88.0389%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3500/3804 (92.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9368, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3664/4013 (91.3033%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7900, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3550/4158 (85.3776%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3610/4158 (86.8206%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0623, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5093/5582 (91.2397%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5140/5582 (92.0817%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0030, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4809/5455 (88.1577%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4874/5455 (89.3492%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9508, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3808/4354 (87.4598%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0132, Accuracy: 3290/4354 (75.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5058, Accuracy: 4509/10000 (45.0900%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4016/4433 (90.5933%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4069/4433 (91.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8988, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3212/3646 (88.0965%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3310/3646 (90.7844%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8920, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4048/4518 (89.5972%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9176, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3883/4235 (91.6883%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3778/4235 (89.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9307, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3926/4362 (90.0046%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3937/4362 (90.2568%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1664, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4779/5392 (88.6313%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4839/5392 (89.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0370, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4887/5591 (87.4083%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4900/5591 (87.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0388, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3376/3756 (89.8829%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9678, Accuracy: 5602/10000 (56.0200%)
time spent on training: 231.95829582214355
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.2637, Accuracy: 6791/10000 (67.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 8.3937, Accuracy: 187/9900 (1.8889%)
Done in 253.49658393859863 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 42.94038410301033.
Norm before scaling: 42.941214188429306. Distance: 2.111225700893565
Total norm for 4 adversaries is: 42.941214188429306. distance: 2.111225700893565
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.3937, Accuracy: 8938/9900 (90.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 42.94038410301033.
Norm before scaling: 42.941949028055596. Distance: 2.205625697519825
Total norm for 4 adversaries is: 42.941949028055596. distance: 2.205625697519825
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.3124, Accuracy: 9167/9900 (92.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.94038410301033.
Norm before scaling: 42.93978711385063. Distance: 2.0551854679661536
Total norm for 4 adversaries is: 42.93978711385063. distance: 2.0551854679661536
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2121, Accuracy: 9386/9900 (94.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.94038410301033.
Norm before scaling: 42.94457558604608. Distance: 2.2198212952040985
Total norm for 4 adversaries is: 42.94457558604608. distance: 2.2198212952040985
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1953, Accuracy: 9396/9900 (94.9091%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4166/4634 (89.9007%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4208/4634 (90.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8993, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4012/4503 (89.0962%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4058/4503 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0189, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4330/4928 (87.8653%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4410/4928 (89.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9886, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3337/3804 (87.7234%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3431/3804 (90.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1685, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3237/3590 (90.1671%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3108/3590 (86.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.4075, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4100/4647 (88.2290%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4228/4647 (90.9834%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8187, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4138/4625 (89.4703%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4108/4625 (88.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0698, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3862/4356 (88.6593%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3530/4356 (81.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2878, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3389/3797 (89.2547%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3434/3797 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8274, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3994/4456 (89.6320%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4078/4456 (91.5171%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9399, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3624/4025 (90.0373%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3737/4025 (92.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9396, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3131/3472 (90.1786%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3195/3472 (92.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9193, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2964/3297 (89.8999%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3053/3297 (92.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7886, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3837/4416 (86.8886%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3927/4416 (88.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9148, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3908/4356 (89.7153%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3772/4356 (86.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3185, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3158/3638 (86.8059%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3296/3638 (90.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9455, Accuracy: 5592/10000 (55.9200%)
time spent on training: 226.09835195541382
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.2632, Accuracy: 6791/10000 (67.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 8.2462, Accuracy: 223/9900 (2.2525%)
Done in 246.912024974823 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 42.973610520549414.
Norm before scaling: 42.974300777834074. Distance: 2.0399677707893757
Total norm for 4 adversaries is: 42.974300777834074. distance: 2.0399677707893757
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2548, Accuracy: 9268/9900 (93.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.973610520549414.
Norm before scaling: 42.97530915846476. Distance: 2.193664366526089
Total norm for 4 adversaries is: 42.97530915846476. distance: 2.193664366526089
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2873, Accuracy: 9207/9900 (93.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.973610520549414.
Norm before scaling: 42.97755733601332. Distance: 2.081663976056223
Total norm for 4 adversaries is: 42.97755733601332. distance: 2.081663976056223
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2267, Accuracy: 9329/9900 (94.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 42.973610520549414.
Norm before scaling: 42.976703809302315. Distance: 2.2129107724355888
Total norm for 4 adversaries is: 42.976703809302315. distance: 2.2129107724355888
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1017, Accuracy: 9622/9900 (97.1919%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3713/4175 (88.9341%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3755/4175 (89.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0243, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4528/4956 (91.3640%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4523/4956 (91.2631%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1537, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4405/5037 (87.4528%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4557/5037 (90.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9615, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4231/4793 (88.2746%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4303/4793 (89.7768%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0096, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3413/3804 (89.7213%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3447/3804 (90.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9574, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4766/5392 (88.3902%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4769/5392 (88.4458%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0552, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4035/4465 (90.3695%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4083/4465 (91.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9933, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4089/4596 (88.9687%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4166/4596 (90.6440%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0626, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5324/6124 (86.9366%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5382/6124 (87.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9521, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2886/3271 (88.2299%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2966/3271 (90.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9169, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3235/3590 (90.1114%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3087/3590 (85.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0783, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3960/4501 (87.9804%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4007/4501 (89.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8862, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4682/5232 (89.4878%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5232 (89.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0422, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3238/3672 (88.1808%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3339/3672 (90.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8360, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3773/4223 (89.3441%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3866/4223 (91.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0557, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3851/4354 (88.4474%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0146, Accuracy: 3221/4354 (73.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5460, Accuracy: 4503/10000 (45.0300%)
time spent on training: 230.28212118148804
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2796, Accuracy: 6752/10000 (67.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 8.3109, Accuracy: 221/9900 (2.2323%)
Done in 251.21121907234192 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 43.003449057713674.
Norm before scaling: 43.00383652715985. Distance: 2.1346972734654486
Total norm for 4 adversaries is: 43.00383652715985. distance: 2.1346972734654486
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1649, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4744/5305 (89.4251%), train_poison_data_count: 415
Global model norm: 43.003449057713674.
Norm before scaling: 43.007965059901984. Distance: 2.2870658003828317
Total norm for 4 adversaries is: 43.007965059901984. distance: 2.2870658003828317
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1827, Accuracy: 9433/9900 (95.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4231/4717 (89.6968%), train_poison_data_count: 370
Global model norm: 43.003449057713674.
Norm before scaling: 43.0046100363089. Distance: 2.1073687019039076
Total norm for 4 adversaries is: 43.0046100363089. distance: 2.1073687019039076
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2137, Accuracy: 9363/9900 (94.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4571/5066 (90.2290%), train_poison_data_count: 400
Global model norm: 43.003449057713674.
Norm before scaling: 43.00601934840415. Distance: 2.1587431495261824
Total norm for 4 adversaries is: 43.00601934840415. distance: 2.1587431495261824
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1372, Accuracy: 9561/9900 (96.5758%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5160/5582 (92.4400%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5150/5582 (92.2608%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9995, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4076/4647 (87.7125%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4165/4647 (89.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0467, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3986/4465 (89.2721%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4067/4465 (91.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9799, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4486/5083 (88.2550%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4438/5083 (87.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2855, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3823/4416 (86.5716%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3942/4416 (89.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9113, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4448/4956 (89.7498%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4522/4956 (91.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0807, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3939/4362 (90.3026%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3970/4362 (91.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9699, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3857/4356 (88.5445%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3722/4356 (85.4454%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2119, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3380/3781 (89.3943%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3314/3781 (87.6488%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1663, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3209/3590 (89.3872%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3164/3590 (88.1337%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1548, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4150/4651 (89.2281%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4213/4651 (90.5827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1270, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4159/4662 (89.2106%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4247/4662 (91.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9222, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3094/3472 (89.1129%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3195/3472 (92.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9432, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4853/5424 (89.4727%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4946/5424 (91.1873%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2982, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2911/3271 (88.9942%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2956/3271 (90.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9153, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4461/5037 (88.5646%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4550/5037 (90.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8930, Accuracy: 5610/10000 (56.1000%)
time spent on training: 233.06661701202393
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2848, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 7.9220, Accuracy: 333/9900 (3.3636%)
Done in 253.9653079509735 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 43.034132074871685.
Norm before scaling: 43.03215350585609. Distance: 2.0689560387109265
Total norm for 4 adversaries is: 43.03215350585609. distance: 2.0689560387109265
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2239, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 43.034132074871685.
Norm before scaling: 43.0357148645895. Distance: 2.1749834827365935
Total norm for 4 adversaries is: 43.0357148645895. distance: 2.1749834827365935
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3064, Accuracy: 9161/9900 (92.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 43.034132074871685.
Norm before scaling: 43.031581902314784. Distance: 2.047180968268218
Total norm for 4 adversaries is: 43.031581902314784. distance: 2.047180968268218
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1610, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4581/5066 (90.4264%), train_poison_data_count: 400
Global model norm: 43.034132074871685.
Norm before scaling: 43.037717378916604. Distance: 2.1420058648521567
Total norm for 4 adversaries is: 43.037717378916604. distance: 2.1420058648521567
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3143, Accuracy: 9147/9900 (92.3939%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4386/4989 (87.9134%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9282, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3610/4013 (89.9576%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8919, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4595/5195 (88.4504%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4598/5195 (88.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0847, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3551/3969 (89.4684%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3633/3969 (91.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9143, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3906/4356 (89.6694%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3913/4356 (89.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0776, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4021/4441 (90.5427%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4066/4441 (91.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0920, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4030/4518 (89.1988%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4133/4518 (91.4785%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0383, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3435/3911 (87.8292%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3372/3911 (86.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0637, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3955/4362 (90.6694%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3929/4362 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1956, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3481/3804 (91.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9407, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3738/4223 (88.5153%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3846/4223 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1488, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4104/4634 (88.5628%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4183/4634 (90.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0167, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3838/4354 (88.1488%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3683/4354 (84.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.6413, Accuracy: 4621/10000 (46.2100%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4537/5244 (86.5179%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4575/5244 (87.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1117, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4432/5037 (87.9889%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4574/5037 (90.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0021, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3239/3704 (87.4460%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3382/3704 (91.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8286, Accuracy: 5802/10000 (58.0200%)
time spent on training: 232.82485580444336
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.3072, Accuracy: 6662/10000 (66.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.3834, Accuracy: 238/9900 (2.4040%)
Done in 253.6802589893341 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 43.06129380794384.
Norm before scaling: 43.06274803765648. Distance: 2.0846610860933894
Total norm for 4 adversaries is: 43.06274803765648. distance: 2.0846610860933894
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2047, Accuracy: 9393/9900 (94.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 43.06129380794384.
Norm before scaling: 43.063232769980964. Distance: 2.2322458646712278
Total norm for 4 adversaries is: 43.063232769980964. distance: 2.2322458646712278
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1081, Accuracy: 9640/9900 (97.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 43.06129380794384.
Norm before scaling: 43.06214707538614. Distance: 2.044158530744599
Total norm for 4 adversaries is: 43.06214707538614. distance: 2.044158530744599
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2686, Accuracy: 9232/9900 (93.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 43.06129380794384.
Norm before scaling: 43.065861851717884. Distance: 2.177659598807304
Total norm for 4 adversaries is: 43.065861851717884. distance: 2.177659598807304
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2422, Accuracy: 9262/9900 (93.5556%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3851/4416 (87.2056%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3956/4416 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9335, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4674/5197 (89.9365%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4692/5197 (90.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9685, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4405/4918 (89.5689%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4490/4918 (91.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1453, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5610/6263 (89.5737%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5660/6263 (90.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0605, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3244/3646 (88.9742%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3367/3646 (92.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8291, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4136/4707 (87.8691%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4260/4707 (90.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8603, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4502/5063 (88.9196%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4401/5063 (86.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2246, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3798/4295 (88.4284%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3767/4295 (87.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1799, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4398/4793 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9865, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4085/4538 (90.0176%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4180/4538 (92.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8964, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4445/5083 (87.4484%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4438/5083 (87.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1085, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3152/3638 (86.6410%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3326/3638 (91.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8472, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5316/6124 (86.8060%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5372/6124 (87.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9287, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4178/4618 (90.4721%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4266/4618 (92.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9909, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3628/3969 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0334, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3558/4158 (85.5700%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3679/4158 (88.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9727, Accuracy: 5446/10000 (54.4600%)
time spent on training: 251.4063057899475
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2964, Accuracy: 6721/10000 (67.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 8.3029, Accuracy: 267/9900 (2.6970%)
Done in 274.9480984210968 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.09211410283281.
Norm before scaling: 43.09145831016717. Distance: 2.065035330998946
Total norm for 4 adversaries is: 43.09145831016717. distance: 2.065035330998946
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2677, Accuracy: 9249/9900 (93.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 43.09211410283281.
Norm before scaling: 43.09277271825143. Distance: 2.185430146919134
Total norm for 4 adversaries is: 43.09277271825143. distance: 2.185430146919134
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1662, Accuracy: 9497/9900 (95.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 43.09211410283281.
Norm before scaling: 43.09490146440252. Distance: 2.070164513247186
Total norm for 4 adversaries is: 43.09490146440252. distance: 2.070164513247186
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1600, Accuracy: 9515/9900 (96.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 43.09211410283281.
Norm before scaling: 43.09657691054186. Distance: 2.24928844644697
Total norm for 4 adversaries is: 43.09657691054186. distance: 2.24928844644697
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2575, Accuracy: 9243/9900 (93.3636%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4194/4716 (88.9313%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4223/4716 (89.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9773, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3919/4481 (87.4582%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3904/4481 (87.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1726, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3846/4361 (88.1908%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3897/4361 (89.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9943, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4202/4793 (87.6695%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4379/4793 (91.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9140, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3924/4295 (91.3620%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3917/4295 (91.1991%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9840, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4502/5244 (85.8505%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4569/5244 (87.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9462, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4393/4989 (88.0537%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4457/4989 (89.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3013, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4631/5197 (89.1091%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4659/5197 (89.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0313, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3937/4356 (90.3811%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4009/4356 (92.0340%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0219, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4218/4647 (90.7682%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4227/4647 (90.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9214, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9330, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4127/4538 (90.9431%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4220/4538 (92.9925%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8004, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4195/4707 (89.1226%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4273/4707 (90.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8486, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5607/6263 (89.5258%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5681/6263 (90.7073%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1159, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3858/4235 (91.0980%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3911/4235 (92.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9415, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3441/3861 (89.1220%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3530/3861 (91.4271%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7616, Accuracy: 5770/10000 (57.7000%)
time spent on training: 256.57441663742065
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.2720, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.9079, Accuracy: 145/9900 (1.4646%)
Done in 280.3765287399292 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4441/4885 (90.9110%), train_poison_data_count: 385
Global model norm: 43.12596239868161.
Norm before scaling: 43.12617610488655. Distance: 2.0584939139838845
Total norm for 4 adversaries is: 43.12617610488655. distance: 2.0584939139838845
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2275, Accuracy: 9341/9900 (94.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 43.12596239868161.
Norm before scaling: 43.12189611792004. Distance: 2.1363670157252725
Total norm for 4 adversaries is: 43.12189611792004. distance: 2.1363670157252725
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1726, Accuracy: 9513/9900 (96.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 43.12596239868161.
Norm before scaling: 43.121831009018074. Distance: 2.0120223621771403
Total norm for 4 adversaries is: 43.121831009018074. distance: 2.0120223621771403
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1462, Accuracy: 9510/9900 (96.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.12596239868161.
Norm before scaling: 43.12562131572353. Distance: 2.1622113735327146
Total norm for 4 adversaries is: 43.12562131572353. distance: 2.1622113735327146
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2701, Accuracy: 9291/9900 (93.8485%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4474/5055 (88.5064%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4617/5055 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9296, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3408/3828 (89.0282%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3477/3828 (90.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9671, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3831/4361 (87.8468%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3719/4361 (85.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0810, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3586/4013 (89.3596%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8782, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4015/4518 (88.8668%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4136/4518 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1445, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4059/4558 (89.0522%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4095/4558 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0408, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3742/4126 (90.6932%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3820/4126 (92.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8133, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4312/4679 (92.1564%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4263/4679 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9215, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3899/4235 (92.0661%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3798/4235 (89.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9999, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4488/5037 (89.1007%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4538/5037 (90.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0902, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3235/3672 (88.0991%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3361/3672 (91.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9032, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4483/4928 (90.9700%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4500/4928 (91.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0331, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3887/4356 (89.2332%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0383, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4001/4456 (89.7890%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4057/4456 (91.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9208, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4793 (88.5458%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4328/4793 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3347, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4468/5025 (88.9154%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4561/5025 (90.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1276, Accuracy: 5302/10000 (53.0200%)
time spent on training: 255.09257984161377
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.2615, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.2867, Accuracy: 89/9900 (0.8990%)
Done in 279.2040319442749 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 43.15557538167505.
Norm before scaling: 43.15390081178569. Distance: 2.058306274030277
Total norm for 4 adversaries is: 43.15390081178569. distance: 2.058306274030277
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1624, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 43.15557538167505.
Norm before scaling: 43.15287255972944. Distance: 2.1289581012535947
Total norm for 4 adversaries is: 43.15287255972944. distance: 2.1289581012535947
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1742, Accuracy: 9468/9900 (95.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 43.15557538167505.
Norm before scaling: 43.15514967369914. Distance: 2.0690735762702532
Total norm for 4 adversaries is: 43.15514967369914. distance: 2.0690735762702532
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2772, Accuracy: 9231/9900 (93.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 43.15557538167505.
Norm before scaling: 43.160762741518916. Distance: 2.2712943866026687
Total norm for 4 adversaries is: 43.160762741518916. distance: 2.2712943866026687
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1842, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3902/4346 (89.7837%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4062/4346 (93.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9543, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3732/4184 (89.1969%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3798/4184 (90.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0622, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4025/4356 (92.4013%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3630/4356 (83.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2270, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3213/3646 (88.1240%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3295/3646 (90.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8513, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4475/5083 (88.0386%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4553/5083 (89.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9470, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3932/4356 (90.2663%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3695/4356 (84.8255%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3282, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4055/4558 (88.9645%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4080/4558 (89.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1402, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3827/4175 (91.6647%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3780/4175 (90.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9611, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3128/3472 (90.0922%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3236/3472 (93.2028%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9284, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4010/4501 (89.0913%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4021/4501 (89.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9007, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4898/5424 (90.3024%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4940/5424 (91.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0613, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3877/4481 (86.5209%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3874/4481 (86.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2266, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4940/5455 (90.5591%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4943/5455 (90.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1142, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4631/5232 (88.5130%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4674/5232 (89.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0670, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5595/6391 (87.5450%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5633/6391 (88.1396%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1568, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3454/3775 (91.4967%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3542/3775 (93.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9875, Accuracy: 5601/10000 (56.0100%)
time spent on training: 256.17852759361267
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.2449, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.2833, Accuracy: 90/9900 (0.9091%)
Done in 277.12611651420593 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 43.19067689111274.
Norm before scaling: 43.18907010306181. Distance: 2.037339341084042
Total norm for 4 adversaries is: 43.18907010306181. distance: 2.037339341084042
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1716, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 43.19067689111274.
Norm before scaling: 43.19074189623136. Distance: 2.213432171675287
Total norm for 4 adversaries is: 43.19074189623136. distance: 2.213432171675287
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1818, Accuracy: 9434/9900 (95.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.19067689111274.
Norm before scaling: 43.19011303826157. Distance: 2.048965202233405
Total norm for 4 adversaries is: 43.19011303826157. distance: 2.048965202233405
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1874, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 43.19067689111274.
Norm before scaling: 43.19287711867621. Distance: 2.180177695005459
Total norm for 4 adversaries is: 43.19287711867621. distance: 2.180177695005459
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2502, Accuracy: 9290/9900 (93.8384%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3625/4025 (90.0621%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3735/4025 (92.7950%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8525, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3775/4223 (89.3914%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3834/4223 (90.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9694, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3193/3638 (87.7680%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3315/3638 (91.1215%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8520, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4509/5063 (89.0579%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4418/5063 (87.2605%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2484, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4333/4874 (88.9003%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4249/4874 (87.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1516, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4303/4804 (89.5712%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4134/4804 (86.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0484, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3626/4158 (87.2054%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3680/4158 (88.5041%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9928, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4048/4518 (89.5972%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4106/4518 (90.8809%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9580, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3872/4235 (91.4286%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3889/4235 (91.8300%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8878, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4311/4934 (87.3733%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4014/4934 (81.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3453, Accuracy: 4868/10000 (48.6800%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5546/6391 (86.7783%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5633/6391 (88.1396%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1559, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3962/4295 (92.2468%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3859/4295 (89.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9379, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3424/3756 (91.1608%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3466/3756 (92.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9946, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3931/4481 (87.7260%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3910/4481 (87.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2681, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3833/4175 (91.8084%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3757/4175 (89.9880%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9978, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3252/3590 (90.5850%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3269/3590 (91.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0607, Accuracy: 5519/10000 (55.1900%)
time spent on training: 231.23803687095642
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.2789, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.6916, Accuracy: 71/9900 (0.7172%)
Done in 252.2008810043335 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4439/4885 (90.8700%), train_poison_data_count: 385
Global model norm: 43.22494504361385.
Norm before scaling: 43.22270267309979. Distance: 2.0421160638014406
Total norm for 4 adversaries is: 43.22270267309979. distance: 2.0421160638014406
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2792, Accuracy: 9217/9900 (93.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 43.22494504361385.
Norm before scaling: 43.225290990923355. Distance: 2.2215767704527747
Total norm for 4 adversaries is: 43.225290990923355. distance: 2.2215767704527747
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2006, Accuracy: 9381/9900 (94.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 43.22494504361385.
Norm before scaling: 43.22453272728564. Distance: 2.0614301045087964
Total norm for 4 adversaries is: 43.22453272728564. distance: 2.0614301045087964
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2207, Accuracy: 9313/9900 (94.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4528/5066 (89.3802%), train_poison_data_count: 400
Global model norm: 43.22494504361385.
Norm before scaling: 43.2296482779397. Distance: 2.2657586420040237
Total norm for 4 adversaries is: 43.2296482779397. distance: 2.2657586420040237
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1778, Accuracy: 9436/9900 (95.3131%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3422/3828 (89.3939%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3509/3828 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8744, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3515/3911 (89.8747%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3521/3911 (90.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9638, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4025/4362 (92.2742%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4069/4362 (93.2829%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9086, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4780/5197 (91.9761%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4792/5197 (92.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9348, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4269/4679 (91.2374%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4302/4679 (91.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9144, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4233/4793 (88.3163%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0931, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4543/5116 (88.7998%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4557/5116 (89.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1527, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4096/4625 (88.5622%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0882, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4183/4618 (90.5803%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4185/4618 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0114, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2931/3271 (89.6056%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2932/3271 (89.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9807, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3819/4175 (91.4731%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3820/4175 (91.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9981, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3173/3616 (87.7489%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3299/3616 (91.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8618, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3876/4481 (86.4985%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3914/4481 (87.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1236, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3985/4368 (91.2317%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9478, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5102/5740 (88.8850%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5182/5740 (90.2787%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1682, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4234/4647 (91.1125%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4275/4647 (91.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0868, Accuracy: 5372/10000 (53.7200%)
time spent on training: 244.92910933494568
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.2978, Accuracy: 6708/10000 (67.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 9.8758, Accuracy: 47/9900 (0.4747%)
Done in 268.7004406452179 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 43.25447332809203.
Norm before scaling: 43.24701093807669. Distance: 2.061612024757568
Total norm for 4 adversaries is: 43.24701093807669. distance: 2.061612024757568
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2709, Accuracy: 9195/9900 (92.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 43.25447332809203.
Norm before scaling: 43.25316665611028. Distance: 2.189424158971528
Total norm for 4 adversaries is: 43.25316665611028. distance: 2.189424158971528
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1588, Accuracy: 9512/9900 (96.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.25447332809203.
Norm before scaling: 43.25012700938721. Distance: 2.031246126611391
Total norm for 4 adversaries is: 43.25012700938721. distance: 2.031246126611391
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1110, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4514/5066 (89.1038%), train_poison_data_count: 400
Global model norm: 43.25447332809203.
Norm before scaling: 43.2591931048874. Distance: 2.267159724837671
Total norm for 4 adversaries is: 43.2591931048874. distance: 2.267159724837671
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1907, Accuracy: 9422/9900 (95.1717%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4887/5591 (87.4083%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4936/5591 (88.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0761, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4552/4956 (91.8483%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4501/4956 (90.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0352, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3979/4511 (88.2066%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4075/4511 (90.3347%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9330, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3636/4013 (90.6055%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3713/4013 (92.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8677, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3262/3590 (90.8635%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3297/3590 (91.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9792, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4290/4793 (89.5055%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4375/4793 (91.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9624, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3378/3804 (88.8013%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3450/3804 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8499, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3457/3837 (90.0964%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8893, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3830/4361 (87.8239%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3822/4361 (87.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1480, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4490/5063 (88.6826%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4358/5063 (86.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1775, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3922/4368 (89.7894%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3964/4368 (90.7509%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0130, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4295/4679 (91.7931%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4307/4679 (92.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0923, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4668/5265 (88.6610%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4656/5265 (88.4330%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0938, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4200/4767 (88.1057%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4219/4767 (88.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1188, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5127/5902 (86.8689%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5130/5902 (86.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2179, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3719/4223 (88.0654%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8689, Accuracy: 5659/10000 (56.5900%)
time spent on training: 258.55797362327576
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.3002, Accuracy: 6705/10000 (67.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 9.7801, Accuracy: 45/9900 (0.4545%)
Done in 282.432945728302 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 43.291781491716904.
Norm before scaling: 43.287251388977104. Distance: 2.0829667213847274
Total norm for 4 adversaries is: 43.287251388977104. distance: 2.0829667213847274
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1468, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 43.291781491716904.
Norm before scaling: 43.288339897641606. Distance: 2.1840252117336654
Total norm for 4 adversaries is: 43.288339897641606. distance: 2.1840252117336654
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2961, Accuracy: 9187/9900 (92.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 43.291781491716904.
Norm before scaling: 43.28886158250613. Distance: 2.060431743858518
Total norm for 4 adversaries is: 43.28886158250613. distance: 2.060431743858518
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2718, Accuracy: 9248/9900 (93.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4528/5066 (89.3802%), train_poison_data_count: 400
Global model norm: 43.291781491716904.
Norm before scaling: 43.29062398487691. Distance: 2.219598097635438
Total norm for 4 adversaries is: 43.29062398487691. distance: 2.219598097635438
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1859, Accuracy: 9417/9900 (95.1212%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3387/3797 (89.2020%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3401/3797 (89.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9780, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3412/3861 (88.3709%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3507/3861 (90.8314%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9444, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4193/4707 (89.0801%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4332/4707 (92.0331%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9438, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4057/4518 (89.7964%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4151/4518 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9136, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3636/4013 (90.6055%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3743/4013 (93.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8767, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4591/5167 (88.8523%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4721/5167 (91.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1493, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3573/3969 (90.0227%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3642/3969 (91.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8429, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3997/4441 (90.0023%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4077/4441 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9894, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4000/4558 (87.7578%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4068/4558 (89.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9971, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4015/4465 (89.9216%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4113/4465 (92.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9119, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3197/3638 (87.8780%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3337/3638 (91.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8113, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4131/4538 (91.0313%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4203/4538 (92.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8481, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5086/5740 (88.6063%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5115/5740 (89.1115%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0442, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3473/3837 (90.5134%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3568/3837 (92.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8672, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3870/4361 (88.7411%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3915/4361 (89.7730%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0281, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4260/4793 (88.8796%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4377/4793 (91.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8788, Accuracy: 5649/10000 (56.4900%)
time spent on training: 255.81979966163635
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.2595, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 9.9733, Accuracy: 43/9900 (0.4343%)
Done in 279.5336871147156 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 43.31508577012676.
Norm before scaling: 43.31046368544716. Distance: 2.0734398595340875
Total norm for 4 adversaries is: 43.31046368544716. distance: 2.0734398595340875
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1531, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 43.31508577012676.
Norm before scaling: 43.31420648469088. Distance: 2.2158320406876153
Total norm for 4 adversaries is: 43.31420648469088. distance: 2.2158320406876153
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1137, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 43.31508577012676.
Norm before scaling: 43.31491104174967. Distance: 2.069175782426206
Total norm for 4 adversaries is: 43.31491104174967. distance: 2.069175782426206
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1953, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 43.31508577012676.
Norm before scaling: 43.314547491738416. Distance: 2.193511441293324
Total norm for 4 adversaries is: 43.314547491738416. distance: 2.193511441293324
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2067, Accuracy: 9369/9900 (94.6364%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4168/4767 (87.4344%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4244/4767 (89.0287%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1350, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4031/4441 (90.7678%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0653, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3986/4356 (91.5060%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3948/4356 (90.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0443, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5551/6391 (86.8565%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5515/6391 (86.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1742, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3741/4184 (89.4120%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8901, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3957/4346 (91.0492%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4041/4346 (92.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7808, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4500/5037 (89.3389%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4620/5037 (91.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9976, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4160/4634 (89.7713%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4237/4634 (91.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8813, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4337/4934 (87.9003%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4011/4934 (81.2931%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3346, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4861/5424 (89.6202%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4899/5424 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2295, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3400/3781 (89.9233%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3427/3781 (90.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9274, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3439/3861 (89.0702%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3494/3861 (90.4947%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9038, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4519/5055 (89.3966%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4608/5055 (91.1573%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0204, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4023/4433 (90.7512%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4433 (90.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8179, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4593/5167 (88.8910%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4666/5167 (90.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1342, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3255/3590 (90.6685%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3167/3590 (88.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1195, Accuracy: 5328/10000 (53.2800%)
time spent on training: 259.22885155677795
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.2659, Accuracy: 6777/10000 (67.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 10.1577, Accuracy: 29/9900 (0.2929%)
Done in 283.15623235702515 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 43.346233932070156.
Norm before scaling: 43.347530758413015. Distance: 2.0633303964662786
Total norm for 4 adversaries is: 43.347530758413015. distance: 2.0633303964662786
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2405, Accuracy: 9262/9900 (93.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 43.346233932070156.
Norm before scaling: 43.34390630604477. Distance: 2.167961381779427
Total norm for 4 adversaries is: 43.34390630604477. distance: 2.167961381779427
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1785, Accuracy: 9458/9900 (95.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.346233932070156.
Norm before scaling: 43.33997595321206. Distance: 2.003036935093407
Total norm for 4 adversaries is: 43.33997595321206. distance: 2.003036935093407
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2718, Accuracy: 9243/9900 (93.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 43.346233932070156.
Norm before scaling: 43.345532700361694. Distance: 2.178605224561647
Total norm for 4 adversaries is: 43.345532700361694. distance: 2.178605224561647
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2860, Accuracy: 9173/9900 (92.6566%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3891/4368 (89.0797%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3976/4368 (91.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8970, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3439/3828 (89.8380%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3526/3828 (92.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8956, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4012/4356 (92.1028%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3809/4356 (87.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0154, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3437/3861 (89.0184%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3507/3861 (90.8314%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9466, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3147/3472 (90.6394%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3205/3472 (92.3099%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9832, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4106/4538 (90.4804%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4170/4538 (91.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8882, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4815/5392 (89.2990%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4727/5392 (87.6669%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1251, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3896/4295 (90.7101%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3963/4295 (92.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9376, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3911/4235 (92.3495%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3843/4235 (90.7438%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0710, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4037/4456 (90.5969%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4077/4456 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9281, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4796/5265 (91.0921%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4760/5265 (90.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9214, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4016/4441 (90.4301%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4441 (92.9520%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0237, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3639/4013 (90.6803%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3751/4013 (93.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7388, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4034/4465 (90.3471%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4067/4465 (91.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8444, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5608/6263 (89.5418%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5643/6263 (90.1006%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1383, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4461/4986 (89.4705%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4510/4986 (90.4533%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9408, Accuracy: 5578/10000 (55.7800%)
time spent on training: 256.4716830253601
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.2667, Accuracy: 6781/10000 (67.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 10.1364, Accuracy: 39/9900 (0.3939%)
Done in 280.1998062133789 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4438/4885 (90.8495%), train_poison_data_count: 385
Global model norm: 43.37721198430404.
Norm before scaling: 43.37498170703865. Distance: 2.0759071619153295
Total norm for 4 adversaries is: 43.37498170703865. distance: 2.0759071619153295
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2291, Accuracy: 9357/9900 (94.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4765/5305 (89.8209%), train_poison_data_count: 415
Global model norm: 43.37721198430404.
Norm before scaling: 43.375595220609796. Distance: 2.1941069961858446
Total norm for 4 adversaries is: 43.375595220609796. distance: 2.1941069961858446
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3284, Accuracy: 9153/9900 (92.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 43.37721198430404.
Norm before scaling: 43.37501970010359. Distance: 2.0879034143668163
Total norm for 4 adversaries is: 43.37501970010359. distance: 2.0879034143668163
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1109, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4540/5066 (89.6171%), train_poison_data_count: 400
Global model norm: 43.37721198430404.
Norm before scaling: 43.37677860186254. Distance: 2.215433677946188
Total norm for 4 adversaries is: 43.37677860186254. distance: 2.215433677946188
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0595, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3636/4158 (87.4459%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3719/4158 (89.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0508, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4600/5167 (89.0265%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4691/5167 (90.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1014, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3422/3828 (89.3939%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3496/3828 (91.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9519, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4217/4663 (90.4353%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4289/4663 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1359, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3979/4433 (89.7586%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9054, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3747/4184 (89.5554%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3771/4184 (90.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9953, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4242/4716 (89.9491%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4270/4716 (90.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8963, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3803/4223 (90.0545%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3857/4223 (91.3332%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8941, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4273/4679 (91.3229%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4253/4679 (90.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2134, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3317/3704 (89.5518%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3362/3704 (90.7667%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9402, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3433/3837 (89.4709%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3568/3837 (92.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9440, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3412/3861 (88.3709%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3445/3861 (89.2256%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9655, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4819/5424 (88.8459%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5016/5424 (92.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0206, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4135/4576 (90.3628%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4174/4576 (91.2150%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9739, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3665/4025 (91.0559%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8975, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3442/3775 (91.1788%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3489/3775 (92.4238%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0595, Accuracy: 5428/10000 (54.2800%)
time spent on training: 255.06926441192627
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.2602, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 10.1014, Accuracy: 30/9900 (0.3030%)
Done in 278.77150440216064 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 43.40654950625611.
Norm before scaling: 43.405233350675154. Distance: 2.1338420241568063
Total norm for 4 adversaries is: 43.405233350675154. distance: 2.1338420241568063
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1554, Accuracy: 9503/9900 (95.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 43.40654950625611.
Norm before scaling: 43.40590971338897. Distance: 2.2186796150326384
Total norm for 4 adversaries is: 43.40590971338897. distance: 2.2186796150326384
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0447, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 43.40654950625611.
Norm before scaling: 43.40313529366643. Distance: 2.0409336201378725
Total norm for 4 adversaries is: 43.40313529366643. distance: 2.0409336201378725
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2616, Accuracy: 9271/9900 (93.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 43.40654950625611.
Norm before scaling: 43.40739176864063. Distance: 2.216480222428347
Total norm for 4 adversaries is: 43.40739176864063. distance: 2.216480222428347
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2698, Accuracy: 9227/9900 (93.2020%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4119/4576 (90.0131%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4252/4576 (92.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8816, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3298/3672 (89.8148%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3364/3672 (91.6122%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9184, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4287/4618 (92.8324%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4280/4618 (92.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9215, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4193/4538 (92.3975%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4193/4538 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8003, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4453/5025 (88.6169%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4524/5025 (90.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0505, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3258/3590 (90.7521%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3292/3590 (91.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1479, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4205/4707 (89.3350%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4247/4707 (90.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9345, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4404/4918 (89.5486%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4471/4918 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0778, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3903/4336 (90.0138%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3998/4336 (92.2048%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1803, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5213/5902 (88.3260%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5189/5902 (87.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0895, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4148/4441 (93.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9817, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4662/5232 (89.1055%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4698/5232 (89.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9548, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4329/4804 (90.1124%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4306/4804 (89.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1052, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3644/3969 (91.8115%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3704/3969 (93.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9017, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4865/5392 (90.2263%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4796/5392 (88.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0323, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3417/3828 (89.2633%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3499/3828 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8973, Accuracy: 5646/10000 (56.4600%)
time spent on training: 258.4771978855133
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.2620, Accuracy: 6807/10000 (68.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 10.3012, Accuracy: 34/9900 (0.3434%)
Done in 282.2214529514313 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 43.44057149662197.
Norm before scaling: 43.43709110643877. Distance: 2.0832823810704504
Total norm for 4 adversaries is: 43.43709110643877. distance: 2.0832823810704504
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1877, Accuracy: 9422/9900 (95.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 43.44057149662197.
Norm before scaling: 43.43768126086282. Distance: 2.2015226773409435
Total norm for 4 adversaries is: 43.43768126086282. distance: 2.2015226773409435
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3961, Accuracy: 8936/9900 (90.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 43.44057149662197.
Norm before scaling: 43.4329850958455. Distance: 1.9802573427907693
Total norm for 4 adversaries is: 43.4329850958455. distance: 1.9802573427907693
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2625, Accuracy: 9247/9900 (93.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 43.44057149662197.
Norm before scaling: 43.43891774889555. Distance: 2.201538596960928
Total norm for 4 adversaries is: 43.43891774889555. distance: 2.201538596960928
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1554, Accuracy: 9503/9900 (95.9899%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4778/5232 (91.3226%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4749/5232 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9554, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4489/4956 (90.5771%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4415/4956 (89.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0311, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4506/5063 (88.9986%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4564/5063 (90.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0028, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3657/4025 (90.8571%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3775/4025 (93.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7624, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4083/4441 (91.9388%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1215, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4092/4625 (88.4757%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4141/4625 (89.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1098, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4940/5591 (88.3563%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4958/5591 (88.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1092, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5113/5582 (91.5980%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5027/5582 (90.0573%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2330, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5151/5902 (87.2755%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5074/5902 (85.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1607, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4165/4538 (91.7805%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4229/4538 (93.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8140, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4505/5025 (89.6517%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0684, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3804/4223 (90.0781%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3887/4223 (92.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8265, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3894/4361 (89.2914%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3774/4361 (86.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1036, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3910/4354 (89.8025%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3630/4354 (83.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1831, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3305/3672 (90.0054%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3358/3672 (91.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9657, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3937/4356 (90.3811%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4026/4356 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0172, Accuracy: 5581/10000 (55.8100%)
time spent on training: 256.76879835128784
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.3022, Accuracy: 6762/10000 (67.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 9.9691, Accuracy: 53/9900 (0.5354%)
Done in 280.8313343524933 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 43.46389570082493.
Norm before scaling: 43.462471745119515. Distance: 2.075512154121073
Total norm for 4 adversaries is: 43.462471745119515. distance: 2.075512154121073
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1327, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 43.46389570082493.
Norm before scaling: 43.464609065433194. Distance: 2.2349292627870496
Total norm for 4 adversaries is: 43.464609065433194. distance: 2.2349292627870496
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2679, Accuracy: 9274/9900 (93.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.46389570082493.
Norm before scaling: 43.45843273723251. Distance: 2.0238889683963603
Total norm for 4 adversaries is: 43.45843273723251. distance: 2.0238889683963603
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1381, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 43.46389570082493.
Norm before scaling: 43.46806759439192. Distance: 2.230343469418365
Total norm for 4 adversaries is: 43.46806759439192. distance: 2.230343469418365
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2478, Accuracy: 9290/9900 (93.8384%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3472/3828 (90.7001%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9026, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3882/4235 (91.6647%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3851/4235 (90.9327%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8769, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3292/3704 (88.8769%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3368/3704 (90.9287%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8216, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3650/4046 (90.2126%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3638/4046 (89.9160%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9837, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4491/4928 (91.1323%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4525/4928 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8418, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5054/5740 (88.0488%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5174/5740 (90.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0043, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4604/5083 (90.5764%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4597/5083 (90.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0310, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4126/4576 (90.1661%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4226/4576 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0079, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4251/4647 (91.4784%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4288/4647 (92.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8822, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4888/5424 (90.1180%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4949/5424 (91.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1968, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4015/4503 (89.1628%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4042/4503 (89.7624%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9742, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5506/6391 (86.1524%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5581/6391 (87.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1439, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3996/4511 (88.5835%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7958, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4090/4456 (91.7864%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4120/4456 (92.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9546, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4335/4804 (90.2373%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4304/4804 (89.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1702, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3403/3804 (89.4585%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3481/3804 (91.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9369, Accuracy: 5623/10000 (56.2300%)
time spent on training: 260.209703207016
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.3135, Accuracy: 6757/10000 (67.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 9.6674, Accuracy: 96/9900 (0.9697%)
Done in 283.9126629829407 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 43.49429178603498.
Norm before scaling: 43.48784318499611. Distance: 2.0650012715037867
Total norm for 4 adversaries is: 43.48784318499611. distance: 2.0650012715037867
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2957, Accuracy: 9190/9900 (92.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 43.49429178603498.
Norm before scaling: 43.49555753626599. Distance: 2.2148193142735484
Total norm for 4 adversaries is: 43.49555753626599. distance: 2.2148193142735484
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2622, Accuracy: 9253/9900 (93.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 43.49429178603498.
Norm before scaling: 43.48952314117591. Distance: 2.0003223159470527
Total norm for 4 adversaries is: 43.48952314117591. distance: 2.0003223159470527
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1344, Accuracy: 9532/9900 (96.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 43.49429178603498.
Norm before scaling: 43.49299652898513. Distance: 2.188216500786699
Total norm for 4 adversaries is: 43.49299652898513. distance: 2.188216500786699
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0528, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4495/4928 (91.2135%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4561/4928 (92.5528%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9681, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4406/5037 (87.4727%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4539/5037 (90.1132%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0080, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4828/5392 (89.5401%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4783/5392 (88.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0062, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3946/4501 (87.6694%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4008/4501 (89.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0690, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3413/3804 (89.7213%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3543/3804 (93.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8871, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3466/3837 (90.3310%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3542/3837 (92.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9357, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4501/5063 (88.8999%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4365/5063 (86.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2219, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3952/4481 (88.1946%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3940/4481 (87.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0610, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4107/4518 (90.9031%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4186/4518 (92.6516%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9265, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3202/3638 (88.0154%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8820, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4233/4663 (90.7785%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4323/4663 (92.7086%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0983, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4090/4625 (88.4324%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4053/4625 (87.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0773, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4745/5197 (91.3027%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4756/5197 (91.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0709, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4669/5083 (91.8552%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4566/5083 (89.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0137, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3402/3828 (88.8715%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3516/3828 (91.8495%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8944, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3307/3704 (89.2819%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3381/3704 (91.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9089, Accuracy: 5639/10000 (56.3900%)
time spent on training: 257.4179494380951
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.3258, Accuracy: 6733/10000 (67.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 10.0574, Accuracy: 85/9900 (0.8586%)
Done in 281.1321783065796 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 43.52666068548893.
Norm before scaling: 43.525238783179724. Distance: 2.142414319741081
Total norm for 4 adversaries is: 43.525238783179724. distance: 2.142414319741081
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0437, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 43.52666068548893.
Norm before scaling: 43.523126878042525. Distance: 2.2254685240803482
Total norm for 4 adversaries is: 43.523126878042525. distance: 2.2254685240803482
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1738, Accuracy: 9495/9900 (95.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.52666068548893.
Norm before scaling: 43.52069371287641. Distance: 2.046041653884977
Total norm for 4 adversaries is: 43.52069371287641. distance: 2.046041653884977
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1248, Accuracy: 9573/9900 (96.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.52666068548893.
Norm before scaling: 43.52672939556796. Distance: 2.197826968226385
Total norm for 4 adversaries is: 43.52672939556796. distance: 2.197826968226385
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2248, Accuracy: 9357/9900 (94.5152%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3486/3861 (90.2875%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3493/3861 (90.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8324, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3773/4184 (90.1769%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3788/4184 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8898, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4448/5037 (88.3065%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4485/5037 (89.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9683, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4763/5197 (91.6490%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4661/5197 (89.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0643, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4480/5025 (89.1542%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4549/5025 (90.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1579, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4527/5116 (88.4871%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4592/5116 (89.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0177, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3895/4481 (86.9226%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3935/4481 (87.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2267, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4132/4576 (90.2972%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4186/4576 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9699, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4730/5232 (90.4052%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4741/5232 (90.6154%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0950, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3855/4354 (88.5393%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3737/4354 (85.8291%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3437, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2906/3271 (88.8413%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0067, Accuracy: 2866/3271 (87.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1963, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4937/5455 (90.5041%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4891/5455 (89.6609%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0338, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3694/4126 (89.5298%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3774/4126 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9905, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3412/3797 (89.8604%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3452/3797 (90.9139%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8533, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3270/3704 (88.2829%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3380/3704 (91.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9093, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4303/4934 (87.2112%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4109/4934 (83.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1724, Accuracy: 5021/10000 (50.2100%)
time spent on training: 255.45368337631226
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.3677, Accuracy: 6689/10000 (66.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 10.6777, Accuracy: 45/9900 (0.4545%)
Done in 279.32238268852234 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 43.54845737392356.
Norm before scaling: 43.543668028665486. Distance: 2.0503057019319124
Total norm for 4 adversaries is: 43.543668028665486. distance: 2.0503057019319124
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2316, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 43.54845737392356.
Norm before scaling: 43.54390912038531. Distance: 2.2150824954685
Total norm for 4 adversaries is: 43.54390912038531. distance: 2.2150824954685
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1163, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 43.54845737392356.
Norm before scaling: 43.546852574447044. Distance: 2.049795382452677
Total norm for 4 adversaries is: 43.546852574447044. distance: 2.049795382452677
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.3107, Accuracy: 9116/9900 (92.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4533/5066 (89.4789%), train_poison_data_count: 400
Global model norm: 43.54845737392356.
Norm before scaling: 43.55003969035218. Distance: 2.235986088745299
Total norm for 4 adversaries is: 43.55003969035218. distance: 2.235986088745299
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0758, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4285/4618 (92.7891%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4216/4618 (91.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0701, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4077/4625 (88.1514%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4133/4625 (89.3622%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1205, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5118/5740 (89.1638%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5188/5740 (90.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1371, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3913/4416 (88.6096%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3926/4416 (88.9040%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1061, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3688/4126 (89.3844%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3813/4126 (92.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9558, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3169/3616 (87.6383%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3301/3616 (91.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9220, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3708/4158 (89.1775%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3756/4158 (90.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0550, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3955/4346 (91.0032%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4063/4346 (93.4883%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8487, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4270/4874 (87.6077%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4306/4874 (88.3463%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2862, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4781/5265 (90.8072%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4782/5265 (90.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9795, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3642/4025 (90.4845%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3748/4025 (93.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8734, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4126/4651 (88.7121%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4239/4651 (91.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9244, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3423/3837 (89.2103%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3527/3837 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9189, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3257/3638 (89.5272%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3298/3638 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8582, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3131/3472 (90.1786%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3178/3472 (91.5323%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9222, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4055/4456 (91.0009%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4071/4456 (91.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9584, Accuracy: 5624/10000 (56.2400%)
time spent on training: 254.3719038963318
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.3844, Accuracy: 6657/10000 (66.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 10.6501, Accuracy: 43/9900 (0.4343%)
Done in 278.122695684433 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 43.5812706152253.
Norm before scaling: 43.57689106132185. Distance: 2.066604921997789
Total norm for 4 adversaries is: 43.57689106132185. distance: 2.066604921997789
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2885, Accuracy: 9172/9900 (92.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 43.5812706152253.
Norm before scaling: 43.581354644575356. Distance: 2.2661850861785573
Total norm for 4 adversaries is: 43.581354644575356. distance: 2.2661850861785573
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2174, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 43.5812706152253.
Norm before scaling: 43.57770622109644. Distance: 2.060161305010152
Total norm for 4 adversaries is: 43.57770622109644. distance: 2.060161305010152
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1721, Accuracy: 9419/9900 (95.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 43.5812706152253.
Norm before scaling: 43.587082263376786. Distance: 2.2812657812957458
Total norm for 4 adversaries is: 43.587082263376786. distance: 2.2812657812957458
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1888, Accuracy: 9445/9900 (95.4040%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4838/5424 (89.1962%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4932/5424 (90.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9941, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4555/4986 (91.3558%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4580/4986 (91.8572%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8641, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4578/5167 (88.6007%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4703/5167 (91.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1733, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4246/4716 (90.0339%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0653, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3858/4368 (88.3242%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3834/4368 (87.7747%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0282, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3996/4356 (91.7355%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3921/4356 (90.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1039, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4328/4804 (90.0916%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4276/4804 (89.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3682, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3922/4481 (87.5251%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3965/4481 (88.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1834, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3630/4025 (90.1863%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8919, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4525/5017 (90.1933%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4563/5017 (90.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9112, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3171/3616 (87.6936%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8774, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3665/4184 (87.5956%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3792/4184 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8606, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4577/5195 (88.1039%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4583/5195 (88.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2845, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3855/4361 (88.3972%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3792/4361 (86.9525%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1573, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3417/3756 (90.9744%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3486/3756 (92.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9568, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4927/5591 (88.1238%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4894/5591 (87.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1471, Accuracy: 5258/10000 (52.5800%)
time spent on training: 256.7937536239624
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.4225, Accuracy: 6575/10000 (65.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 10.9369, Accuracy: 32/9900 (0.3232%)
Done in 280.7432277202606 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.60727136855662.
Norm before scaling: 43.60506545572931. Distance: 2.0928400823864006
Total norm for 4 adversaries is: 43.60506545572931. distance: 2.0928400823864006
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1792, Accuracy: 9455/9900 (95.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 43.60727136855662.
Norm before scaling: 43.60414162659537. Distance: 2.221029373400664
Total norm for 4 adversaries is: 43.60414162659537. distance: 2.221029373400664
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1388, Accuracy: 9565/9900 (96.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 43.60727136855662.
Norm before scaling: 43.60390926649023. Distance: 2.0629749329264904
Total norm for 4 adversaries is: 43.60390926649023. distance: 2.0629749329264904
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2160, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 43.60727136855662.
Norm before scaling: 43.60956254438354. Distance: 2.2353515625
Total norm for 4 adversaries is: 43.60956254438354. distance: 2.2353515625
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1657, Accuracy: 9478/9900 (95.7374%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3794/4175 (90.8743%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3850/4175 (92.2156%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8091, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4917/5455 (90.1375%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4990/5455 (91.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8514, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3248/3704 (87.6890%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3359/3704 (90.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9320, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4425/4989 (88.6951%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4408/4989 (88.3544%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9309, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4442/4928 (90.1380%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4483/4928 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0027, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3335/3804 (87.6709%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3430/3804 (90.1682%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9764, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3862/4336 (89.0683%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3937/4336 (90.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0998, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3629/4046 (89.6935%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3627/4046 (89.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9332, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4282/4793 (89.3386%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9378, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3417/3756 (90.9744%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3503/3756 (93.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8482, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5588/6391 (87.4355%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5601/6391 (87.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2137, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3286/3672 (89.4880%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3376/3672 (91.9390%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9266, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4058/4558 (89.0303%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4049/4558 (88.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1815, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4145/4576 (90.5813%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4145/4576 (90.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9525, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4060/4456 (91.1131%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9124, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4017/4356 (92.2176%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3998/4356 (91.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1140, Accuracy: 5383/10000 (53.8300%)
time spent on training: 256.75730204582214
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.4196, Accuracy: 6611/10000 (66.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 10.6404, Accuracy: 42/9900 (0.4242%)
Done in 280.63086915016174 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 43.639938288993804.
Norm before scaling: 43.633972819173536. Distance: 2.0683020853063905
Total norm for 4 adversaries is: 43.633972819173536. distance: 2.0683020853063905
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2581, Accuracy: 9243/9900 (93.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 43.639938288993804.
Norm before scaling: 43.637410931590566. Distance: 2.2545097508358154
Total norm for 4 adversaries is: 43.637410931590566. distance: 2.2545097508358154
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1782, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 43.639938288993804.
Norm before scaling: 43.64254381746526. Distance: 2.104657358294978
Total norm for 4 adversaries is: 43.64254381746526. distance: 2.104657358294978
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1711, Accuracy: 9468/9900 (95.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 43.639938288993804.
Norm before scaling: 43.63989912795901. Distance: 2.249676469218631
Total norm for 4 adversaries is: 43.63989912795901. distance: 2.249676469218631
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1833, Accuracy: 9431/9900 (95.2626%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4531/5116 (88.5653%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4540/5116 (88.7412%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0329, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5076/5582 (90.9351%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4928/5582 (88.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2761, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4341/4928 (88.0885%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4388/4928 (89.0422%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0986, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3646/4126 (88.3665%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3770/4126 (91.3718%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8411, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3703/4158 (89.0572%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3721/4158 (89.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9885, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4497/5063 (88.8209%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4403/5063 (86.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1045, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5353/6124 (87.4102%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5423/6124 (88.5532%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0141, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3833/4354 (88.0340%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0140, Accuracy: 3235/4354 (74.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.7245, Accuracy: 4405/10000 (44.0500%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4479/5025 (89.1343%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4575/5025 (91.0448%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0268, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4284/4679 (91.5580%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4066/4679 (86.8989%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1926, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4236/4793 (88.3789%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4322/4793 (90.1732%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0392, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4053/4518 (89.7078%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4134/4518 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0460, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4596/5167 (88.9491%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4722/5167 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1542, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3995/4433 (90.1196%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4038/4433 (91.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9061, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4119/4503 (91.4724%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4142/4503 (91.9831%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8311, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4176/4707 (88.7189%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4254/4707 (90.3760%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9415, Accuracy: 5545/10000 (55.4500%)
time spent on training: 261.4473509788513
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.3649, Accuracy: 6683/10000 (66.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 10.7144, Accuracy: 23/9900 (0.2323%)
Done in 285.4174828529358 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 43.67539257971458.
Norm before scaling: 43.66791965540894. Distance: 2.0577407024953493
Total norm for 4 adversaries is: 43.66791965540894. distance: 2.0577407024953493
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2329, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 43.67539257971458.
Norm before scaling: 43.670775086774995. Distance: 2.2078063144043747
Total norm for 4 adversaries is: 43.670775086774995. distance: 2.2078063144043747
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.3926, Accuracy: 8981/9900 (90.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 43.67539257971458.
Norm before scaling: 43.668689787689274. Distance: 2.053012295537029
Total norm for 4 adversaries is: 43.668689787689274. distance: 2.053012295537029
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1175, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 43.67539257971458.
Norm before scaling: 43.67605497661519. Distance: 2.2338340477909426
Total norm for 4 adversaries is: 43.67605497661519. distance: 2.2338340477909426
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2487, Accuracy: 9265/9900 (93.5859%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3275/3704 (88.4179%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3401/3704 (91.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7874, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4749/5392 (88.0749%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4735/5392 (87.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0135, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4029/4362 (92.3659%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4111/4362 (94.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8892, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4134/4538 (91.0974%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4210/4538 (92.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9837, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3749/4184 (89.6033%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3826/4184 (91.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8434, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3423/3756 (91.1342%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9192, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4251/4679 (90.8527%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4186/4679 (89.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3247, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3164/3472 (91.1290%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0021, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5525/6391 (86.4497%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5589/6391 (87.4511%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0417, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4835/5265 (91.8329%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4775/5265 (90.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0003, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5149/5902 (87.2416%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5159/5902 (87.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2273, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5385/6124 (87.9327%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5407/6124 (88.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0146, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4700/5083 (92.4651%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4686/5083 (92.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9150, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4465 (90.1680%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4136/4465 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9188, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3415/3804 (89.7739%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3472/3804 (91.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0011, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4403/4918 (89.5283%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4488/4918 (91.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0495, Accuracy: 5430/10000 (54.3000%)
time spent on training: 260.8656482696533
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.4058, Accuracy: 6592/10000 (65.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 10.5196, Accuracy: 25/9900 (0.2525%)
Done in 284.48364520072937 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 43.7056192307551.
Norm before scaling: 43.70546282181153. Distance: 2.13222375366216
Total norm for 4 adversaries is: 43.70546282181153. distance: 2.13222375366216
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1275, Accuracy: 9541/9900 (96.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 43.7056192307551.
Norm before scaling: 43.70346297241501. Distance: 2.217131225646019
Total norm for 4 adversaries is: 43.70346297241501. distance: 2.217131225646019
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2551, Accuracy: 9269/9900 (93.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 43.7056192307551.
Norm before scaling: 43.70178425723171. Distance: 2.043972607542905
Total norm for 4 adversaries is: 43.70178425723171. distance: 2.043972607542905
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2848, Accuracy: 9209/9900 (93.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 43.7056192307551.
Norm before scaling: 43.70619179443429. Distance: 2.2409429518772037
Total norm for 4 adversaries is: 43.70619179443429. distance: 2.2409429518772037
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2103, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4063/4538 (89.5328%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4152/4538 (91.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8632, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4486/4989 (89.9178%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4536/4989 (90.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8492, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4287/4793 (89.4429%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0559, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3718/4158 (89.4180%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3761/4158 (90.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8793, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3500/3861 (90.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9191, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4712/5232 (90.0612%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4752/5232 (90.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0370, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4191/4663 (89.8778%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4282/4663 (91.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8922, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4732/5197 (91.0525%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4685/5197 (90.1482%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0175, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4586/5167 (88.7556%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4683/5167 (90.6329%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0731, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3901/4416 (88.3379%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3984/4416 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8150, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3884/4354 (89.2053%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3742/4354 (85.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3561, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4925/5455 (90.2841%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4911/5455 (90.0275%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2964, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3988/4456 (89.4973%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4111/4456 (92.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8280, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2983/3271 (91.1954%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3016/3271 (92.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8068, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2972/3297 (90.1426%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3068/3297 (93.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8391, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4956/5591 (88.6425%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4907/5591 (87.7661%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0622, Accuracy: 5411/10000 (54.1100%)
time spent on training: 259.70258235931396
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.3956, Accuracy: 6589/10000 (65.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 10.5059, Accuracy: 24/9900 (0.2424%)
Done in 283.61666560173035 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 43.73736145573227.
Norm before scaling: 43.730588606635656. Distance: 2.064652562319986
Total norm for 4 adversaries is: 43.730588606635656. distance: 2.064652562319986
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2079, Accuracy: 9397/9900 (94.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 43.73736145573227.
Norm before scaling: 43.73308266668667. Distance: 2.2376247861365663
Total norm for 4 adversaries is: 43.73308266668667. distance: 2.2376247861365663
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0455, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 43.73736145573227.
Norm before scaling: 43.73513419312469. Distance: 2.041771970355814
Total norm for 4 adversaries is: 43.73513419312469. distance: 2.041771970355814
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1473, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 43.73736145573227.
Norm before scaling: 43.735840342546865. Distance: 2.2476025630305623
Total norm for 4 adversaries is: 43.735840342546865. distance: 2.2476025630305623
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2149, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4626/5167 (89.5297%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4679/5167 (90.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2385, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3466/3775 (91.8146%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3560/3775 (94.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7649, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4619/5195 (88.9124%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4551/5195 (87.6035%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2976, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3735/4126 (90.5235%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3795/4126 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7832, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3449/3911 (88.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2041, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4088/4433 (92.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7992, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2997/3271 (91.6234%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2972/3271 (90.8591%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9036, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3262/3590 (90.8635%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3235/3590 (90.1114%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9523, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4432/4918 (90.1179%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9678, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4525/4986 (90.7541%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4535/4986 (90.9547%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8914, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3223/3616 (89.1316%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8316, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3923/4295 (91.3388%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3706/4295 (86.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1735, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3981/4356 (91.3912%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3984/4356 (91.4601%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9750, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4793 (89.1717%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4356/4793 (90.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1169, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3949/4315 (91.5180%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8067, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4369/4804 (90.9450%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4175/4804 (86.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2676, Accuracy: 5181/10000 (51.8100%)
time spent on training: 252.2443404197693
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.4466, Accuracy: 6477/10000 (64.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 10.5736, Accuracy: 24/9900 (0.2424%)
Done in 276.2180144786835 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 43.76391519776881.
Norm before scaling: 43.757947101872965. Distance: 2.071819289711333
Total norm for 4 adversaries is: 43.757947101872965. distance: 2.071819289711333
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1622, Accuracy: 9505/9900 (96.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 43.76391519776881.
Norm before scaling: 43.763216474694104. Distance: 2.2700925779580006
Total norm for 4 adversaries is: 43.763216474694104. distance: 2.2700925779580006
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2094, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 43.76391519776881.
Norm before scaling: 43.75751749030174. Distance: 2.019511534485788
Total norm for 4 adversaries is: 43.75751749030174. distance: 2.019511534485788
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1803, Accuracy: 9458/9900 (95.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 43.76391519776881.
Norm before scaling: 43.76745884903032. Distance: 2.3106210653175077
Total norm for 4 adversaries is: 43.76745884903032. distance: 2.3106210653175077
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1220, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4108/4503 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0545, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4305/4934 (87.2517%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4136/4934 (83.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1026, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4316/4804 (89.8418%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0111, Accuracy: 3797/4804 (79.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2932, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4045/4456 (90.7765%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4080/4456 (91.5619%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9780, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4158/4651 (89.4001%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4651 (90.7332%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9832, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3734/4184 (89.2447%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8998, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4353/4928 (88.3320%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4397/4928 (89.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0729, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3422/3775 (90.6490%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3503/3775 (92.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0026, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4733/5083 (93.1143%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4666/5083 (91.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9239, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4924/5455 (90.2658%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4998/5455 (91.6224%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0334, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3178/3638 (87.3557%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3317/3638 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8676, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3516/3911 (89.9003%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3394/3911 (86.7809%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2190, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9350, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3982/4501 (88.4692%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4008/4501 (89.0469%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9577, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4840/5197 (93.1307%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4691/5197 (90.2636%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0813, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3459/3861 (89.5882%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3519/3861 (91.1422%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9017, Accuracy: 5728/10000 (57.2800%)
time spent on training: 256.0888509750366
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.4285, Accuracy: 6521/10000 (65.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 10.4925, Accuracy: 24/9900 (0.2424%)
Done in 279.98946499824524 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 43.79319575163047.
Norm before scaling: 43.7903733913952. Distance: 2.0592291356296712
Total norm for 4 adversaries is: 43.7903733913952. distance: 2.0592291356296712
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2710, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 43.79319575163047.
Norm before scaling: 43.78955243369987. Distance: 2.2314073822337015
Total norm for 4 adversaries is: 43.78955243369987. distance: 2.2314073822337015
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1139, Accuracy: 9617/9900 (97.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 43.79319575163047.
Norm before scaling: 43.78994549176643. Distance: 2.0748991056984254
Total norm for 4 adversaries is: 43.78994549176643. distance: 2.0748991056984254
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1557, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 43.79319575163047.
Norm before scaling: 43.79239157171383. Distance: 2.2311859848285316
Total norm for 4 adversaries is: 43.79239157171383. distance: 2.2311859848285316
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1540, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2987/3271 (91.3176%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3025/3271 (92.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8405, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4034/4511 (89.4258%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4105/4511 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9002, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3221/3638 (88.5377%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3327/3638 (91.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.7845, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5107/5582 (91.4905%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5102/5582 (91.4009%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1407, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4053/4456 (90.9560%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4121/4456 (92.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0325, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5164/5902 (87.4958%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5104/5902 (86.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1073, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3863/4416 (87.4774%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4023/4416 (91.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8543, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4372/4934 (88.6096%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4131/4934 (83.7252%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2584, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4123/4596 (89.7084%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4202/4596 (91.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9869, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3837 (88.0636%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9841, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5522/6391 (86.4028%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5572/6391 (87.1851%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0701, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3906/4368 (89.4231%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9141, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3465/3804 (91.0883%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9625, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5688/6263 (90.8191%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5714/6263 (91.2342%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1062, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4274/4793 (89.1717%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0125, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4898/5424 (90.3024%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4979/5424 (91.7957%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0906, Accuracy: 5379/10000 (53.7900%)
time spent on training: 261.0421953201294
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.4601, Accuracy: 6476/10000 (64.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 10.3593, Accuracy: 23/9900 (0.2323%)
Done in 285.1783380508423 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 43.82467817328711.
Norm before scaling: 43.817825494365735. Distance: 2.0105636094966086
Total norm for 4 adversaries is: 43.817825494365735. distance: 2.0105636094966086
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1899, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 43.82467817328711.
Norm before scaling: 43.82299713763311. Distance: 2.259245210035286
Total norm for 4 adversaries is: 43.82299713763311. distance: 2.259245210035286
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0664, Accuracy: 9728/9900 (98.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 43.82467817328711.
Norm before scaling: 43.82169488258997. Distance: 2.0758768412123083
Total norm for 4 adversaries is: 43.82169488258997. distance: 2.0758768412123083
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2066, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4559/5066 (89.9921%), train_poison_data_count: 400
Global model norm: 43.82467817328711.
Norm before scaling: 43.824706027518744. Distance: 2.226071273423556
Total norm for 4 adversaries is: 43.824706027518744. distance: 2.226071273423556
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2185, Accuracy: 9376/9900 (94.7071%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4535/5055 (89.7132%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/5055 (91.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9026, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3734/4184 (89.2447%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3802/4184 (90.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8775, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3469/3861 (89.8472%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3509/3861 (90.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9257, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4385/4804 (91.2781%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4253/4804 (88.5304%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1592, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3123/3472 (89.9482%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3138/3472 (90.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0184, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3636/3969 (91.6100%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3681/3969 (92.7438%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9374, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4539/4989 (90.9802%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4564/4989 (91.4813%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7677, Accuracy: 5936/10000 (59.3600%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5216/5582 (93.4432%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5169/5582 (92.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0498, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4309/4793 (89.9019%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4358/4793 (90.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9235, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4206/4662 (90.2188%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4263/4662 (91.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9441, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4342/4934 (88.0016%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4163/4934 (84.3737%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2962, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4544/4986 (91.1352%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4593/4986 (92.1179%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8758, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4042/4433 (91.1798%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4032/4433 (90.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9237, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4214/4716 (89.3554%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4255/4716 (90.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9990, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4148/4596 (90.2524%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4261/4596 (92.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9741, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3877/4354 (89.0446%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3795/4354 (87.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3445, Accuracy: 5016/10000 (50.1600%)
time spent on training: 257.5849258899689
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.4521, Accuracy: 6453/10000 (64.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 10.1446, Accuracy: 26/9900 (0.2626%)
Done in 281.35446214675903 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 43.855286258471736.
Norm before scaling: 43.84972033699659. Distance: 2.0489932449177344
Total norm for 4 adversaries is: 43.84972033699659. distance: 2.0489932449177344
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.3293, Accuracy: 9095/9900 (91.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 43.855286258471736.
Norm before scaling: 43.85285064583174. Distance: 2.2547939938927946
Total norm for 4 adversaries is: 43.85285064583174. distance: 2.2547939938927946
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1399, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 43.855286258471736.
Norm before scaling: 43.848924153439185. Distance: 2.0122871855054543
Total norm for 4 adversaries is: 43.848924153439185. distance: 2.0122871855054543
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0980, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 43.855286258471736.
Norm before scaling: 43.855341928036545. Distance: 2.19763766381588
Total norm for 4 adversaries is: 43.855341928036545. distance: 2.19763766381588
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1716, Accuracy: 9479/9900 (95.7475%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4573/5116 (89.3862%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4606/5116 (90.0313%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9578, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4205/4662 (90.1973%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4245/4662 (91.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9275, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5130/5902 (86.9197%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5117/5902 (86.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2576, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4588/5063 (90.6182%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4481/5063 (88.5048%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9995, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3923/4354 (90.1011%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3734/4354 (85.7602%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3212, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4584/5195 (88.2387%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4576/5195 (88.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0426, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4058/4356 (93.1589%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3891/4356 (89.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1401, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3874/4295 (90.1979%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3700/4295 (86.1467%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0573, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5642/6263 (90.0846%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5636/6263 (89.9888%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9920, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4032/4511 (89.3815%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4110/4511 (91.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0107, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4229/4663 (90.6927%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4326/4663 (92.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9825, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3913/4336 (90.2445%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3969/4336 (91.5360%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1982, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4459/4928 (90.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0837, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3678/4046 (90.9046%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3624/4046 (89.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9131, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3267/3672 (88.9706%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3328/3672 (90.6318%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9103, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4051/4356 (92.9982%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3882/4356 (89.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2925, Accuracy: 5023/10000 (50.2300%)
time spent on training: 261.02699732780457
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.4370, Accuracy: 6519/10000 (65.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 10.0371, Accuracy: 33/9900 (0.3333%)
Done in 285.15221977233887 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 43.88656976638041.
Norm before scaling: 43.88329165106934. Distance: 2.102780014242945
Total norm for 4 adversaries is: 43.88329165106934. distance: 2.102780014242945
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1568, Accuracy: 9530/9900 (96.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 43.88656976638041.
Norm before scaling: 43.88320680902605. Distance: 2.190027139573917
Total norm for 4 adversaries is: 43.88320680902605. distance: 2.190027139573917
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0420, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4292/4717 (90.9900%), train_poison_data_count: 370
Global model norm: 43.88656976638041.
Norm before scaling: 43.88056966962997. Distance: 1.9730666536266128
Total norm for 4 adversaries is: 43.88056966962997. distance: 1.9730666536266128
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2020, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 43.88656976638041.
Norm before scaling: 43.8861261155469. Distance: 2.2146461035324814
Total norm for 4 adversaries is: 43.8861261155469. distance: 2.2146461035324814
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.4157, Accuracy: 8876/9900 (89.6566%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4529/5037 (89.9146%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4608/5037 (91.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0540, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4206/4647 (90.5100%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4239/4647 (91.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9229, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4263/4663 (91.4218%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4359/4663 (93.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9488, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3889/4336 (89.6910%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3956/4336 (91.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9775, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3441/3756 (91.6134%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3535/3756 (94.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8928, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4132/4625 (89.3405%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4104/4625 (88.7351%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0541, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4044/4362 (92.7098%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4055/4362 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9533, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4320/4874 (88.6336%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4216/4874 (86.4998%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2217, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4256/4767 (89.2805%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4297/4767 (90.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2308, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3456/3775 (91.5497%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3534/3775 (93.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8526, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4187/4662 (89.8112%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4235/4662 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1024, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5424/6124 (88.5696%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5433/6124 (88.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0033, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4014/4511 (88.9825%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4129/4511 (91.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9189, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3538/3911 (90.4628%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3424/3911 (87.5479%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0732, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4914/5591 (87.8913%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4977/5591 (89.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9381, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3723/4126 (90.2327%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3798/4126 (92.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8539, Accuracy: 5641/10000 (56.4100%)
time spent on training: 260.0241403579712
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.4470, Accuracy: 6505/10000 (65.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 10.2829, Accuracy: 16/9900 (0.1616%)
Done in 283.98963713645935 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 43.91707773516898.
Norm before scaling: 43.91464693949289. Distance: 2.1255316349781115
Total norm for 4 adversaries is: 43.91464693949289. distance: 2.1255316349781115
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1703, Accuracy: 9476/9900 (95.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 43.91707773516898.
Norm before scaling: 43.91467334680118. Distance: 2.2333463421722657
Total norm for 4 adversaries is: 43.91467334680118. distance: 2.2333463421722657
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1176, Accuracy: 9613/9900 (97.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 43.91707773516898.
Norm before scaling: 43.91006850610618. Distance: 2.009440671046379
Total norm for 4 adversaries is: 43.91006850610618. distance: 2.009440671046379
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.3753, Accuracy: 9019/9900 (91.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 43.91707773516898.
Norm before scaling: 43.91298046723343. Distance: 2.1626157917046935
Total norm for 4 adversaries is: 43.91298046723343. distance: 2.1626157917046935
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.4354, Accuracy: 8855/9900 (89.4444%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4503/5025 (89.6119%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4548/5025 (90.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1853, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4558/5116 (89.0930%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4584/5116 (89.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0054, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4625/5167 (89.5104%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4709/5167 (91.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1807, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4108/4558 (90.1272%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4055/4558 (88.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0720, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4182/4651 (89.9161%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4230/4651 (90.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0644, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3846/4336 (88.6993%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3938/4336 (90.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0243, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4672/5055 (92.4233%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4677/5055 (92.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8895, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3458/3775 (91.6026%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3547/3775 (93.9603%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7920, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4880/5265 (92.6876%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4754/5265 (90.2944%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0274, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3647/4025 (90.6087%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3733/4025 (92.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8359, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4549/4989 (91.1806%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4514/4989 (90.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0341, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4299/4793 (89.6933%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0159, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3442/3804 (90.4837%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3510/3804 (92.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9994, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3391/3797 (89.3073%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3520/3797 (92.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8423, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4057/4433 (91.5182%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4077/4433 (91.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8995, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4260/4707 (90.5035%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4293/4707 (91.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8865, Accuracy: 5732/10000 (57.3200%)
time spent on training: 257.68358993530273
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.4783, Accuracy: 6427/10000 (64.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 10.0454, Accuracy: 22/9900 (0.2222%)
Done in 281.38236832618713 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 43.94520763876378.
Norm before scaling: 43.94016983798111. Distance: 2.069310244391286
Total norm for 4 adversaries is: 43.94016983798111. distance: 2.069310244391286
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2100, Accuracy: 9405/9900 (95.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 43.94520763876378.
Norm before scaling: 43.94175332809189. Distance: 2.180603491167837
Total norm for 4 adversaries is: 43.94175332809189. distance: 2.180603491167837
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1847, Accuracy: 9458/9900 (95.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 43.94520763876378.
Norm before scaling: 43.9386543567243. Distance: 2.0296252281497544
Total norm for 4 adversaries is: 43.9386543567243. distance: 2.0296252281497544
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1168, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 43.94520763876378.
Norm before scaling: 43.94528541665832. Distance: 2.265712657416598
Total norm for 4 adversaries is: 43.94528541665832. distance: 2.265712657416598
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1409, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4883/5392 (90.5601%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4802/5392 (89.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0484, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4248/4663 (91.1002%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4348/4663 (93.2447%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8944, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3439/3797 (90.5715%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3514/3797 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9038, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5190/5582 (92.9774%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5213/5582 (93.3895%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0472, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4626/5167 (89.5297%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4679/5167 (90.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1677, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3438/3781 (90.9283%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3432/3781 (90.7696%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2605, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3654/3969 (92.0635%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3642/3969 (91.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8634, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3501/3837 (91.2432%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3595/3837 (93.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8167, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5160/5902 (87.4280%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5098/5902 (86.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0126, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4841/5455 (88.7443%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9962, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4514/5037 (89.6168%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4570/5037 (90.7286%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0897, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4585/5017 (91.3893%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4577/5017 (91.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9383, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4512/4986 (90.4934%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4579/4986 (91.8371%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8899, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4865/5197 (93.6117%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4744/5197 (91.2834%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0592, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3894/4361 (89.2914%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3918/4361 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0426, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5687/6263 (90.8031%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5699/6263 (90.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0955, Accuracy: 5339/10000 (53.3900%)
time spent on training: 264.64405941963196
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.4988, Accuracy: 6388/10000 (63.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 9.8173, Accuracy: 39/9900 (0.3939%)
Done in 288.5759930610657 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 43.97332509957031.
Norm before scaling: 43.96718830515476. Distance: 2.107157127572199
Total norm for 4 adversaries is: 43.96718830515476. distance: 2.107157127572199
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1173, Accuracy: 9591/9900 (96.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 43.97332509957031.
Norm before scaling: 43.96829746124615. Distance: 2.219074494179448
Total norm for 4 adversaries is: 43.96829746124615. distance: 2.219074494179448
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.3286, Accuracy: 9075/9900 (91.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 43.97332509957031.
Norm before scaling: 43.964696419399964. Distance: 1.9772798947649828
Total norm for 4 adversaries is: 43.964696419399964. distance: 1.9772798947649828
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2344, Accuracy: 9356/9900 (94.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 43.97332509957031.
Norm before scaling: 43.971752462784984. Distance: 2.1923874886851578
Total norm for 4 adversaries is: 43.971752462784984. distance: 2.1923874886851578
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1473, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4564/5017 (90.9707%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4630/5017 (92.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7456, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4364/4928 (88.5552%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4405/4928 (89.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0687, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3756/4184 (89.7706%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9957, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4300/4793 (89.7142%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9176, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5117/5740 (89.1463%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5187/5740 (90.3659%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0162, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3426/3756 (91.2141%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9047, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3866/4235 (91.2869%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3865/4235 (91.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8588, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3808/4223 (90.1729%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3895/4223 (92.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8599, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4607/5063 (90.9935%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4572/5063 (90.3022%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1027, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4487/4989 (89.9379%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4532/4989 (90.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9559, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4517/4928 (91.6599%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4504/4928 (91.3961%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8039, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5174/5902 (87.6652%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5044/5902 (85.4626%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2329, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4086/4456 (91.6966%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8835, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5399/6124 (88.1613%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5447/6124 (88.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0344, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3561/3828 (93.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8620, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3241/3616 (89.6294%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3291/3616 (91.0122%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8433, Accuracy: 5698/10000 (56.9800%)
time spent on training: 261.83227038383484
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.4696, Accuracy: 6473/10000 (64.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 10.1207, Accuracy: 35/9900 (0.3535%)
Done in 285.76147270202637 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4439/4885 (90.8700%), train_poison_data_count: 385
Global model norm: 44.00331658088044.
Norm before scaling: 44.0005409901046. Distance: 2.1324016468760885
Total norm for 4 adversaries is: 44.0005409901046. distance: 2.1324016468760885
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1422, Accuracy: 9551/9900 (96.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 44.00331658088044.
Norm before scaling: 43.99577172510445. Distance: 2.16034034096342
Total norm for 4 adversaries is: 43.99577172510445. distance: 2.16034034096342
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2420, Accuracy: 9292/9900 (93.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4288/4717 (90.9052%), train_poison_data_count: 370
Global model norm: 44.00331658088044.
Norm before scaling: 43.9954027028322. Distance: 2.029572131348486
Total norm for 4 adversaries is: 43.9954027028322. distance: 2.029572131348486
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.3700, Accuracy: 9029/9900 (91.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 44.00331658088044.
Norm before scaling: 44.001690918769675. Distance: 2.2399985231667148
Total norm for 4 adversaries is: 44.001690918769675. distance: 2.2399985231667148
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2301, Accuracy: 9331/9900 (94.2525%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3826/4223 (90.5991%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3928/4223 (93.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9880, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4013/4362 (91.9991%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4086/4362 (93.6726%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8694, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5566/6391 (87.0912%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5660/6391 (88.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2079, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4285/4793 (89.4012%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4378/4793 (91.3415%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9753, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3399/3756 (90.4952%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3477/3756 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8145, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4261/4618 (92.2694%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4233/4618 (91.6631%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9125, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3658/4025 (90.8820%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3744/4025 (93.0186%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9366, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3240/3638 (89.0599%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9415, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3950/4315 (91.5411%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4003/4315 (92.7694%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9783, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3995/4295 (93.0151%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3735/4295 (86.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1514, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4487/4928 (91.0511%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4492/4928 (91.1526%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8620, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4527/4986 (90.7942%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4522/4986 (90.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8689, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3770/4126 (91.3718%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3827/4126 (92.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9029, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4433/4918 (90.1383%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4483/4918 (91.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0424, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4638/5195 (89.2782%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4615/5195 (88.8354%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9889, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5130/5740 (89.3728%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0232, Accuracy: 5530/10000 (55.3000%)
time spent on training: 260.8020992279053
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.4559, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 9.9342, Accuracy: 44/9900 (0.4444%)
Done in 284.5332236289978 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 44.03149258050637.
Norm before scaling: 44.026066774855806. Distance: 2.1057482022627987
Total norm for 4 adversaries is: 44.026066774855806. distance: 2.1057482022627987
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1166, Accuracy: 9621/9900 (97.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4825/5305 (90.9519%), train_poison_data_count: 415
Global model norm: 44.03149258050637.
Norm before scaling: 44.02563284787909. Distance: 2.1945308501968754
Total norm for 4 adversaries is: 44.02563284787909. distance: 2.1945308501968754
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1511, Accuracy: 9524/9900 (96.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 44.03149258050637.
Norm before scaling: 44.02560096170253. Distance: 2.0298603879904316
Total norm for 4 adversaries is: 44.02560096170253. distance: 2.0298603879904316
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.3105, Accuracy: 9139/9900 (92.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 44.03149258050637.
Norm before scaling: 44.028559346019236. Distance: 2.1836118748548983
Total norm for 4 adversaries is: 44.028559346019236. distance: 2.1836118748548983
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1158, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2960/3297 (89.7786%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3010/3297 (91.2951%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7809, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3473/3828 (90.7262%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3542/3828 (92.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9419, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4577/5063 (90.4009%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4440/5063 (87.6950%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1296, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4028/4501 (89.4912%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4087/4501 (90.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0186, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4278/4793 (89.2552%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4328/4793 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9730, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3844/4223 (91.0253%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7590, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3428/3756 (91.2673%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3537/3756 (94.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7927, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3223/3638 (88.5926%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9042, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3265/3646 (89.5502%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3332/3646 (91.3878%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8835, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4374/4874 (89.7415%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4183/4874 (85.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2212, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5628/6263 (89.8611%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5666/6263 (90.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0282, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4512/5037 (89.5771%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4587/5037 (91.0661%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0166, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4044/4362 (92.7098%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4107/4362 (94.1541%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9928, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4070/4356 (93.4343%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3799/4356 (87.2130%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1574, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4575/5116 (89.4253%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4550/5116 (88.9367%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0232, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3914/4346 (90.0598%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4044/4346 (93.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8199, Accuracy: 5760/10000 (57.6000%)
time spent on training: 255.63915848731995
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.4529, Accuracy: 6491/10000 (64.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 9.9571, Accuracy: 49/9900 (0.4949%)
Done in 279.3104341030121 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 44.06592268399911.
Norm before scaling: 44.06158576179198. Distance: 2.170355944820014
Total norm for 4 adversaries is: 44.06158576179198. distance: 2.170355944820014
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0821, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4819/5305 (90.8388%), train_poison_data_count: 415
Global model norm: 44.06592268399911.
Norm before scaling: 44.06015757293161. Distance: 2.17073149732054
Total norm for 4 adversaries is: 44.06015757293161. distance: 2.17073149732054
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1980, Accuracy: 9399/9900 (94.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.06592268399911.
Norm before scaling: 44.05633129470085. Distance: 1.9781673384680918
Total norm for 4 adversaries is: 44.05633129470085. distance: 1.9781673384680918
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2442, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 44.06592268399911.
Norm before scaling: 44.0622852942464. Distance: 2.1867318030673406
Total norm for 4 adversaries is: 44.0622852942464. distance: 2.1867318030673406
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2338, Accuracy: 9310/9900 (94.0404%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4109/4518 (90.9473%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0295, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4096/4558 (89.8640%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4123/4558 (90.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0790, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3427/3804 (90.0894%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3473/3804 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9151, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3442/3775 (91.1788%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3576/3775 (94.7285%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7544, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4641/5083 (91.3043%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4632/5083 (91.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0382, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4480/4928 (90.9091%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4501/4928 (91.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9122, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4535/5244 (86.4798%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4585/5244 (87.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0280, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4489/4989 (89.9780%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4533/4989 (90.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9225, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4560/4986 (91.4561%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4557/4986 (91.3959%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8274, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3775/4175 (90.4192%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3851/4175 (92.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8363, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4722/5232 (90.2523%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4779/5232 (91.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9495, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4579/5063 (90.4405%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4421/5063 (87.3198%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2377, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4031/4441 (90.7678%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4071/4441 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0030, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3266/3646 (89.5776%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3315/3646 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8926, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4638/5167 (89.7620%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4705/5167 (91.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2381, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4153/4538 (91.5161%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4213/4538 (92.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8577, Accuracy: 5714/10000 (57.1400%)
time spent on training: 257.4693171977997
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.4681, Accuracy: 6440/10000 (64.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 9.9670, Accuracy: 43/9900 (0.4343%)
Done in 281.1715099811554 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 44.09668997108797.
Norm before scaling: 44.088128351331015. Distance: 2.051082567149754
Total norm for 4 adversaries is: 44.088128351331015. distance: 2.051082567149754
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2765, Accuracy: 9231/9900 (93.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.09668997108797.
Norm before scaling: 44.09129295289278. Distance: 2.1307197336233483
Total norm for 4 adversaries is: 44.09129295289278. distance: 2.1307197336233483
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0985, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 44.09668997108797.
Norm before scaling: 44.089375668918244. Distance: 1.9985651591360487
Total norm for 4 adversaries is: 44.089375668918244. distance: 1.9985651591360487
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.3055, Accuracy: 9153/9900 (92.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4602/5066 (90.8409%), train_poison_data_count: 400
Global model norm: 44.09668997108797.
Norm before scaling: 44.09464142436981. Distance: 2.1431292065979353
Total norm for 4 adversaries is: 44.09464142436981. distance: 2.1431292065979353
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.3127, Accuracy: 9167/9900 (92.5960%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4097/4356 (94.0542%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3795/4356 (87.1212%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2220, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4457/4928 (90.4424%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4508/4928 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9816, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4497/5037 (89.2793%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4593/5037 (91.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9625, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4346/4804 (90.4663%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4138/4804 (86.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2453, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3452/3775 (91.4437%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3531/3775 (93.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8296, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4673/5167 (90.4393%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4725/5167 (91.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1327, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3892/4235 (91.9008%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3869/4235 (91.3577%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8957, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4490/4956 (90.5973%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4490/4956 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0307, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5149/5740 (89.7038%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5154/5740 (89.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1477, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4333/4679 (92.6053%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4377/4679 (93.5456%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8594, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3320/3704 (89.6328%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8286, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3214/3472 (92.5691%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3191/3472 (91.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9982, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4152/4651 (89.2711%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4224/4651 (90.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9435, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4151/4634 (89.5770%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4244/4634 (91.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9529, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5229/5902 (88.5971%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5194/5902 (88.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0782, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3508/3837 (91.4256%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3583/3837 (93.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8335, Accuracy: 5735/10000 (57.3500%)
time spent on training: 260.3100755214691
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.4760, Accuracy: 6407/10000 (64.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 9.8948, Accuracy: 60/9900 (0.6061%)
Done in 284.0924491882324 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 44.127661260044704.
Norm before scaling: 44.121534865269446. Distance: 2.05080171120745
Total norm for 4 adversaries is: 44.121534865269446. distance: 2.05080171120745
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2795, Accuracy: 9234/9900 (93.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 44.127661260044704.
Norm before scaling: 44.11907106502385. Distance: 2.142191626880769
Total norm for 4 adversaries is: 44.11907106502385. distance: 2.142191626880769
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2345, Accuracy: 9330/9900 (94.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.127661260044704.
Norm before scaling: 44.117597699306025. Distance: 2.041175887099197
Total norm for 4 adversaries is: 44.117597699306025. distance: 2.041175887099197
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1451, Accuracy: 9554/9900 (96.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4592/5066 (90.6435%), train_poison_data_count: 400
Global model norm: 44.127661260044704.
Norm before scaling: 44.12345628496537. Distance: 2.1908170346533717
Total norm for 4 adversaries is: 44.12345628496537. distance: 2.1908170346533717
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1751, Accuracy: 9467/9900 (95.6263%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3619/3969 (91.1817%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3621/3969 (91.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0496, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4226/4707 (89.7812%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4283/4707 (90.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9426, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3513/3861 (90.9868%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3504/3861 (90.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9514, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4159/4596 (90.4917%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4275/4596 (93.0157%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9145, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4120/4503 (91.4946%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4115/4503 (91.3835%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8896, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4491/4928 (91.1323%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4547/4928 (92.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9313, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4626/5025 (92.0597%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4691/5025 (93.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1812, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4151/4576 (90.7124%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4210/4576 (92.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9330, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4577/4918 (93.0663%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4570/4918 (92.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9913, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3965/4315 (91.8888%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3988/4315 (92.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8528, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3260/3590 (90.8078%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3242/3590 (90.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1399, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4100/4456 (92.0108%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4100/4456 (92.0108%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8815, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3904/4354 (89.6647%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3839/4354 (88.1718%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3524, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4064/4501 (90.2910%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4047/4501 (89.9134%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9489, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3526/3911 (90.1560%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3470/3911 (88.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2374, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4082/4558 (89.5568%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4072/4558 (89.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0265, Accuracy: 5432/10000 (54.3200%)
time spent on training: 255.2750928401947
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.4787, Accuracy: 6409/10000 (64.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 9.5811, Accuracy: 71/9900 (0.7172%)
Done in 279.33529257774353 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 44.15541511064922.
Norm before scaling: 44.14891515070755. Distance: 2.0699380787972697
Total norm for 4 adversaries is: 44.14891515070755. distance: 2.0699380787972697
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1982, Accuracy: 9434/9900 (95.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.15541511064922.
Norm before scaling: 44.15060866077825. Distance: 2.1844670659693377
Total norm for 4 adversaries is: 44.15060866077825. distance: 2.1844670659693377
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2776, Accuracy: 9199/9900 (92.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 44.15541511064922.
Norm before scaling: 44.14479653960858. Distance: 1.9896576020391175
Total norm for 4 adversaries is: 44.14479653960858. distance: 1.9896576020391175
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1693, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4583/5066 (90.4659%), train_poison_data_count: 400
Global model norm: 44.15541511064922.
Norm before scaling: 44.15242237258549. Distance: 2.210270649661955
Total norm for 4 adversaries is: 44.15242237258549. distance: 2.210270649661955
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1512, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4742/5116 (92.6896%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4689/5116 (91.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9195, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4896/5392 (90.8012%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4926/5392 (91.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0224, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4767 (90.5391%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4293/4767 (90.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1399, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4313/4618 (93.3954%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4253/4618 (92.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0226, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3653/4046 (90.2867%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3721/4046 (91.9674%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8811, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4218/4625 (91.2000%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4131/4625 (89.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1394, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3274/3638 (89.9945%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3353/3638 (92.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7935, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3939/4416 (89.1984%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3984/4416 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8328, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4357/4874 (89.3927%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4272/4874 (87.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1884, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3277/3646 (89.8793%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3312/3646 (90.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9645, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4483/5063 (88.5443%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4433/5063 (87.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9413, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3762/4126 (91.1779%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3828/4126 (92.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8031, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4340/4934 (87.9611%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4183/4934 (84.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1278, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4011/4511 (88.9160%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4511 (91.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0217, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4142/4518 (91.6777%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9096, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2956/3297 (89.6573%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3062/3297 (92.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7096, Accuracy: 5967/10000 (59.6700%)
time spent on training: 256.3359293937683
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.4602, Accuracy: 6456/10000 (64.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 9.4779, Accuracy: 61/9900 (0.6162%)
Done in 280.1338152885437 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 44.18783564891969.
Norm before scaling: 44.18212512616457. Distance: 2.1009000847438366
Total norm for 4 adversaries is: 44.18212512616457. distance: 2.1009000847438366
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1399, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4840/5305 (91.2347%), train_poison_data_count: 415
Global model norm: 44.18783564891969.
Norm before scaling: 44.18148551270515. Distance: 2.163625294283301
Total norm for 4 adversaries is: 44.18148551270515. distance: 2.163625294283301
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1511, Accuracy: 9530/9900 (96.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 44.18783564891969.
Norm before scaling: 44.177014867214886. Distance: 1.9648774828584206
Total norm for 4 adversaries is: 44.177014867214886. distance: 1.9648774828584206
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1857, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 44.18783564891969.
Norm before scaling: 44.18319849554664. Distance: 2.1546138139480724
Total norm for 4 adversaries is: 44.18319849554664. distance: 2.1546138139480724
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1419, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5478/6124 (89.4513%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5405/6124 (88.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1666, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4603/5025 (91.6020%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4668/5025 (92.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8907, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3184/3472 (91.7051%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3206/3472 (92.3387%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9387, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4480/5037 (88.9418%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4535/5037 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9803, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5210/5582 (93.3357%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5164/5582 (92.5116%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1276, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4682/5116 (91.5168%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4720/5116 (92.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9097, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4083/4518 (90.3718%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4180/4518 (92.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9197, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4514/4928 (91.5990%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4498/4928 (91.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9161, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4099/4558 (89.9298%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4029/4558 (88.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1421, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3028/3297 (91.8411%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3065/3297 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8024, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3450/3756 (91.8530%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3543/3756 (94.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8050, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4182/4651 (89.9161%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4267/4651 (91.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1492, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4070/4441 (91.6460%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4095/4441 (92.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0473, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3320/3638 (91.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8731, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4161/4596 (90.5352%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4267/4596 (92.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9633, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2977/3271 (91.0119%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3021/3271 (92.3571%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8164, Accuracy: 5864/10000 (58.6400%)
time spent on training: 255.98597812652588
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.4350, Accuracy: 6494/10000 (64.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 9.4582, Accuracy: 78/9900 (0.7879%)
Done in 279.9940493106842 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 44.218865945077674.
Norm before scaling: 44.21318151775412. Distance: 2.0825031024960126
Total norm for 4 adversaries is: 44.21318151775412. distance: 2.0825031024960126
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1338, Accuracy: 9581/9900 (96.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4833/5305 (91.1027%), train_poison_data_count: 415
Global model norm: 44.218865945077674.
Norm before scaling: 44.21069935547276. Distance: 2.183257976231299
Total norm for 4 adversaries is: 44.21069935547276. distance: 2.183257976231299
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0905, Accuracy: 9664/9900 (97.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4345/4717 (92.1136%), train_poison_data_count: 370
Global model norm: 44.218865945077674.
Norm before scaling: 44.207206421683956. Distance: 1.9206731496399387
Total norm for 4 adversaries is: 44.207206421683956. distance: 1.9206731496399387
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3278, Accuracy: 9116/9900 (92.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 44.218865945077674.
Norm before scaling: 44.21079875508358. Distance: 2.1009214196305397
Total norm for 4 adversaries is: 44.21079875508358. distance: 2.1009214196305397
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1410, Accuracy: 9539/9900 (96.3535%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4532/4989 (90.8398%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4523/4989 (90.6595%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9100, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4090/4465 (91.6013%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4190/4465 (93.8410%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8015, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3980/4315 (92.2364%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3987/4315 (92.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9344, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4322/4767 (90.6650%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4326/4767 (90.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0309, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5646/6391 (88.3430%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5620/6391 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0477, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3314/3672 (90.2505%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3325/3672 (90.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8445, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3648/3969 (91.9123%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3695/3969 (93.0965%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8881, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3295/3590 (91.7827%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3196/3590 (89.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2181, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5258/5902 (89.0884%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5099/5902 (86.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2067, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3665/4013 (91.3282%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7595, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4320/4804 (89.9251%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4350/4804 (90.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9959, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3810/4175 (91.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0311, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3236/3616 (89.4912%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3301/3616 (91.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8546, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3994/4361 (91.5845%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3969/4361 (91.0112%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9702, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4883/5424 (90.0258%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4983/5424 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1664, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3505/3837 (91.3474%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3603/3837 (93.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7878, Accuracy: 5825/10000 (58.2500%)
time spent on training: 258.57916927337646
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.4488, Accuracy: 6509/10000 (65.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.9254, Accuracy: 43/9900 (0.4343%)
Done in 282.39638805389404 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 44.247833026477835.
Norm before scaling: 44.24211231341837. Distance: 2.0839794555720403
Total norm for 4 adversaries is: 44.24211231341837. distance: 2.0839794555720403
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1907, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 44.247833026477835.
Norm before scaling: 44.23929789808632. Distance: 2.1133235567550672
Total norm for 4 adversaries is: 44.23929789808632. distance: 2.1133235567550672
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1824, Accuracy: 9459/9900 (95.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4265/4717 (90.4176%), train_poison_data_count: 370
Global model norm: 44.247833026477835.
Norm before scaling: 44.23842456516521. Distance: 2.019963644285971
Total norm for 4 adversaries is: 44.23842456516521. distance: 2.019963644285971
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2217, Accuracy: 9359/9900 (94.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 44.247833026477835.
Norm before scaling: 44.24615151431958. Distance: 2.180257415097503
Total norm for 4 adversaries is: 44.24615151431958. distance: 2.180257415097503
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2411, Accuracy: 9313/9900 (94.0707%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3955/4416 (89.5607%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4015/4416 (90.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9603, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5167/5740 (90.0174%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5183/5740 (90.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0978, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4495/5037 (89.2396%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4605/5037 (91.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9495, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4769/5116 (93.2174%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4699/5116 (91.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9427, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4516/4918 (91.8259%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4539/4918 (92.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0078, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3485/3837 (90.8262%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3551/3837 (92.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9262, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4203/4651 (90.3677%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4225/4651 (90.8407%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9968, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3465/3861 (89.7436%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3483/3861 (90.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9586, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3826/4223 (90.5991%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3915/4223 (92.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8794, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4254/4662 (91.2484%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4280/4662 (91.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9987, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5706/6263 (91.1065%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9198, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3423/3781 (90.5316%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3124/3781 (82.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4509, Accuracy: 4829/10000 (48.2900%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3404/3804 (89.4848%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3531/3804 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8933, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3445/3828 (89.9948%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3558/3828 (92.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8925, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3956/4315 (91.6802%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3977/4315 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8146, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4540/4956 (91.6061%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4536/4956 (91.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0855, Accuracy: 5459/10000 (54.5900%)
time spent on training: 258.2554142475128
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.4340, Accuracy: 6509/10000 (65.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 9.4858, Accuracy: 80/9900 (0.8081%)
Done in 281.93147683143616 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 44.27233116338719.
Norm before scaling: 44.26503347425101. Distance: 2.068223237338405
Total norm for 4 adversaries is: 44.26503347425101. distance: 2.068223237338405
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1220, Accuracy: 9579/9900 (96.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 44.27233116338719.
Norm before scaling: 44.26726992399054. Distance: 2.197367619160561
Total norm for 4 adversaries is: 44.26726992399054. distance: 2.197367619160561
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2662, Accuracy: 9245/9900 (93.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 44.27233116338719.
Norm before scaling: 44.26456879696503. Distance: 2.032549633062932
Total norm for 4 adversaries is: 44.26456879696503. distance: 2.032549633062932
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2594, Accuracy: 9256/9900 (93.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 44.27233116338719.
Norm before scaling: 44.26644815904239. Distance: 2.1522734088792257
Total norm for 4 adversaries is: 44.26644815904239. distance: 2.1522734088792257
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1069, Accuracy: 9613/9900 (97.1010%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4249/4662 (91.1411%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4305/4662 (92.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9096, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3221/3616 (89.0763%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3322/3616 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8853, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3478/3828 (90.8568%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3556/3828 (92.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8713, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2986/3297 (90.5672%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3043/3297 (92.2960%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8418, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3976/4361 (91.1717%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3844/4361 (88.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1776, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4147/4576 (90.6250%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4199/4576 (91.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9354, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3969/4295 (92.4098%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3908/4295 (90.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0030, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4723/5083 (92.9176%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4691/5083 (92.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9606, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4796/5116 (93.7451%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4742/5116 (92.6896%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8539, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3697/4046 (91.3742%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3751/4046 (92.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8091, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5193/5902 (87.9871%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5146/5902 (87.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0900, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4881/5197 (93.9196%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4840/5197 (93.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8801, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4097/4465 (91.7581%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4176/4465 (93.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8722, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3273/3704 (88.3639%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3361/3704 (90.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8676, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3589/3861 (92.9552%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3617/3861 (93.6804%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8851, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3733/4126 (90.4750%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3807/4126 (92.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9351, Accuracy: 5572/10000 (55.7200%)
time spent on training: 254.53249740600586
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.4397, Accuracy: 6505/10000 (65.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.5886, Accuracy: 58/9900 (0.5859%)
Done in 278.38824224472046 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4503/4885 (92.1801%), train_poison_data_count: 385
Global model norm: 44.297850518358956.
Norm before scaling: 44.291082072713856. Distance: 2.060840864135623
Total norm for 4 adversaries is: 44.291082072713856. distance: 2.060840864135623
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.5042, Accuracy: 8747/9900 (88.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 44.297850518358956.
Norm before scaling: 44.28892813416732. Distance: 2.1486301405111328
Total norm for 4 adversaries is: 44.28892813416732. distance: 2.1486301405111328
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1734, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 44.297850518358956.
Norm before scaling: 44.28422162753061. Distance: 2.0026962464142213
Total norm for 4 adversaries is: 44.28422162753061. distance: 2.0026962464142213
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1439, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4631/5066 (91.4133%), train_poison_data_count: 400
Global model norm: 44.297850518358956.
Norm before scaling: 44.29124330382291. Distance: 2.1435898345637896
Total norm for 4 adversaries is: 44.29124330382291. distance: 2.1435898345637896
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1801, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4049/4511 (89.7584%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4110/4511 (91.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9718, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5144/5740 (89.6167%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5265/5740 (91.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0580, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4264/4662 (91.4629%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4281/4662 (91.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8719, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3902/4235 (92.1370%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3917/4235 (92.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8895, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4810/5265 (91.3580%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4775/5265 (90.6933%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9094, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4058/4433 (91.5407%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4433 (90.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8607, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4171/4596 (90.7528%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4210/4596 (91.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8746, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4677/5055 (92.5223%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4649/5055 (91.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9565, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4496/5037 (89.2595%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0179, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4195/4538 (92.4416%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4265/4538 (93.9841%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8819, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3462/3756 (92.1725%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3520/3756 (93.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8999, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3693/4025 (91.7516%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3776/4025 (93.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8653, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4582/5244 (87.3760%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4653/5244 (88.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9561, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4279/4663 (91.7650%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4352/4663 (93.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9373, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3522/3837 (91.7905%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3541/3837 (92.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0008, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4008/4481 (89.4443%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3955/4481 (88.2615%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0072, Accuracy: 5574/10000 (55.7400%)
time spent on training: 258.6856200695038
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.4349, Accuracy: 6511/10000 (65.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.6288, Accuracy: 81/9900 (0.8182%)
Done in 282.38764810562134 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 44.32513153005019.
Norm before scaling: 44.317175958774015. Distance: 2.04982120385497
Total norm for 4 adversaries is: 44.317175958774015. distance: 2.04982120385497
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1913, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 44.32513153005019.
Norm before scaling: 44.318547663390184. Distance: 2.1677220659555765
Total norm for 4 adversaries is: 44.318547663390184. distance: 2.1677220659555765
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.4268, Accuracy: 8900/9900 (89.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 44.32513153005019.
Norm before scaling: 44.3199151941032. Distance: 2.0599414098611026
Total norm for 4 adversaries is: 44.3199151941032. distance: 2.0599414098611026
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.3882, Accuracy: 8991/9900 (90.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 44.32513153005019.
Norm before scaling: 44.3221392350052. Distance: 2.1918955645916753
Total norm for 4 adversaries is: 44.3221392350052. distance: 2.1918955645916753
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1243, Accuracy: 9570/9900 (96.6667%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4052/4362 (92.8932%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3995/4362 (91.5864%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0185, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4975/5591 (88.9823%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4978/5591 (89.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1222, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3967/4315 (91.9351%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3947/4315 (91.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9333, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3453/3781 (91.3250%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3243/3781 (85.7710%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1711, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3745/4158 (90.0673%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3801/4158 (91.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8815, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4033/4511 (89.4037%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4118/4511 (91.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8723, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4334/4793 (90.4235%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4397/4793 (91.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9881, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4913/5424 (90.5789%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4958/5424 (91.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1919, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4293/4618 (92.9623%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4281/4618 (92.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9877, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3977/4368 (91.0485%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3980/4368 (91.1172%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0488, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4378/4934 (88.7313%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4098/4934 (83.0563%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1177, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4736/5232 (90.5199%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4700/5232 (89.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1952, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5272/5902 (89.3257%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5074/5902 (85.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1366, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5023/5392 (93.1565%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4970/5392 (92.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9926, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4586/5017 (91.4092%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4603/5017 (91.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0961, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4659/5195 (89.6824%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4680/5195 (90.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0424, Accuracy: 5496/10000 (54.9600%)
time spent on training: 261.9503004550934
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.4965, Accuracy: 6422/10000 (64.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 9.8035, Accuracy: 66/9900 (0.6667%)
Done in 285.67574095726013 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4499/4885 (92.0983%), train_poison_data_count: 385
Global model norm: 44.361160914207936.
Norm before scaling: 44.354922284447476. Distance: 2.0766653800376633
Total norm for 4 adversaries is: 44.354922284447476. distance: 2.0766653800376633
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1258, Accuracy: 9590/9900 (96.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 44.361160914207936.
Norm before scaling: 44.35104024155254. Distance: 2.1757845373488407
Total norm for 4 adversaries is: 44.35104024155254. distance: 2.1757845373488407
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2104, Accuracy: 9389/9900 (94.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 44.361160914207936.
Norm before scaling: 44.3527384191037. Distance: 2.0458584656372683
Total norm for 4 adversaries is: 44.3527384191037. distance: 2.0458584656372683
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2612, Accuracy: 9241/9900 (93.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 44.361160914207936.
Norm before scaling: 44.3558401088043. Distance: 2.229087281521874
Total norm for 4 adversaries is: 44.3558401088043. distance: 2.229087281521874
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1103, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4869/5265 (92.4786%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9110, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3729/4126 (90.3781%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3855/4126 (93.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8198, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4090/4501 (90.8687%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4108/4501 (91.2686%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8350, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5477/6124 (89.4350%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5426/6124 (88.6022%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0517, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2977/3271 (91.0119%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3007/3271 (91.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0174, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4249/4663 (91.1216%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4320/4663 (92.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0045, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3690/4025 (91.6770%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8638, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4181/4651 (89.8946%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4215/4651 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0446, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4387/4804 (91.3197%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3815/4804 (79.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.4387, Accuracy: 4689/10000 (46.8900%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3278/3616 (90.6527%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3339/3616 (92.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8647, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3551/3911 (90.7952%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3346/3911 (85.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2066, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4847/5197 (93.2653%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4820/5197 (92.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0215, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4184/4538 (92.1992%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4241/4538 (93.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9258, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5652/6391 (88.4369%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5587/6391 (87.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1828, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3339/3704 (90.1458%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3472/3704 (93.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7825, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3913/4235 (92.3967%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3736/4235 (88.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9563, Accuracy: 5564/10000 (55.6400%)
time spent on training: 258.1541254520416
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.5237, Accuracy: 6372/10000 (63.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 9.8026, Accuracy: 69/9900 (0.6970%)
Done in 281.73336601257324 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 44.39020838637658.
Norm before scaling: 44.37855949632379. Distance: 2.000633735387406
Total norm for 4 adversaries is: 44.37855949632379. distance: 2.000633735387406
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2456, Accuracy: 9324/9900 (94.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 44.39020838637658.
Norm before scaling: 44.38343477274559. Distance: 2.2314040699826547
Total norm for 4 adversaries is: 44.38343477274559. distance: 2.2314040699826547
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1579, Accuracy: 9500/9900 (95.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 44.39020838637658.
Norm before scaling: 44.379574478124226. Distance: 2.0253387120803086
Total norm for 4 adversaries is: 44.379574478124226. distance: 2.0253387120803086
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0769, Accuracy: 9710/9900 (98.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 44.39020838637658.
Norm before scaling: 44.383393517363984. Distance: 2.176696475274215
Total norm for 4 adversaries is: 44.383393517363984. distance: 2.176696475274215
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1567, Accuracy: 9516/9900 (96.1212%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4773/5116 (93.2955%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4782/5116 (93.4715%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7629, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5224/5582 (93.5865%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5171/5582 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9986, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3979/4235 (93.9551%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3941/4235 (93.0579%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9762, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4204/4625 (90.8973%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4131/4625 (89.3189%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2698, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4036/4481 (90.0692%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4034/4481 (90.0245%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0188, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4754/5232 (90.8639%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4734/5232 (90.4817%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0049, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4201/4662 (90.1115%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4276/4662 (91.7203%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9285, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4085/4441 (91.9838%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4123/4441 (92.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9274, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4125/4518 (91.3015%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4155/4518 (91.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1299, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4504/4928 (91.3961%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4525/4928 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9584, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4255/4634 (91.8213%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4246/4634 (91.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9892, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4386/4934 (88.8934%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4470/4934 (90.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0471, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3544/3861 (91.7897%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3582/3861 (92.7739%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8516, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3270/3616 (90.4314%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3334/3616 (92.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7685, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3994/4416 (90.4438%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3978/4416 (90.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9885, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3493/3797 (91.9937%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3501/3797 (92.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9583, Accuracy: 5694/10000 (56.9400%)
time spent on training: 258.5011131763458
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.5388, Accuracy: 6354/10000 (63.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 9.8403, Accuracy: 69/9900 (0.6970%)
Done in 282.27147936820984 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4493/4885 (91.9754%), train_poison_data_count: 385
Global model norm: 44.42165653525246.
Norm before scaling: 44.412217557327345. Distance: 2.0700598220658146
Total norm for 4 adversaries is: 44.412217557327345. distance: 2.0700598220658146
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3138, Accuracy: 9125/9900 (92.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 44.42165653525246.
Norm before scaling: 44.4137416160352. Distance: 2.134988980767359
Total norm for 4 adversaries is: 44.4137416160352. distance: 2.134988980767359
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1081, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 44.42165653525246.
Norm before scaling: 44.41231375734944. Distance: 2.0318697644121952
Total norm for 4 adversaries is: 44.41231375734944. distance: 2.0318697644121952
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1406, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 44.42165653525246.
Norm before scaling: 44.41575895506782. Distance: 2.174755354528592
Total norm for 4 adversaries is: 44.41575895506782. distance: 2.174755354528592
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1620, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5755/6263 (91.8889%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5775/6263 (92.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0114, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3966/4295 (92.3399%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3869/4295 (90.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0524, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4523/4989 (90.6595%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4539/4989 (90.9802%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8995, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3850/4223 (91.1674%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3894/4223 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8099, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5434/6124 (88.7329%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5422/6124 (88.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0235, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4045/4481 (90.2700%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3947/4481 (88.0830%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1073, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4281/4618 (92.7025%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4143/4618 (89.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1615, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4054/4441 (91.2857%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4120/4441 (92.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0093, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3665/4013 (91.3282%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3739/4013 (93.1722%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8480, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4070/4511 (90.2239%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4164/4511 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9621, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3936/4416 (89.1304%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4021/4416 (91.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8470, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4565/4956 (92.1106%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4531/4956 (91.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9638, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4224/4538 (93.0807%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4234/4538 (93.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8775, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4848/5265 (92.0798%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4831/5265 (91.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9336, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4862/5197 (93.5540%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4852/5197 (93.3616%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9602, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4265/4716 (90.4368%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4294/4716 (91.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1112, Accuracy: 5384/10000 (53.8400%)
time spent on training: 259.70591378211975
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.5739, Accuracy: 6313/10000 (63.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 10.1948, Accuracy: 48/9900 (0.4848%)
Done in 283.3052761554718 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4514/4885 (92.4053%), train_poison_data_count: 385
Global model norm: 44.454010590915054.
Norm before scaling: 44.44313238962306. Distance: 2.0110794977591944
Total norm for 4 adversaries is: 44.44313238962306. distance: 2.0110794977591944
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1374, Accuracy: 9566/9900 (96.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 44.454010590915054.
Norm before scaling: 44.44580206598889. Distance: 2.1779384363474397
Total norm for 4 adversaries is: 44.44580206598889. distance: 2.1779384363474397
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1205, Accuracy: 9580/9900 (96.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 44.454010590915054.
Norm before scaling: 44.44137998400604. Distance: 1.9485651728474114
Total norm for 4 adversaries is: 44.44137998400604. distance: 1.9485651728474114
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.3228, Accuracy: 9154/9900 (92.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 44.454010590915054.
Norm before scaling: 44.447993717465046. Distance: 2.161322997731922
Total norm for 4 adversaries is: 44.447993717465046. distance: 2.161322997731922
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2255, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3268/3616 (90.3761%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3368/3616 (93.1416%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7893, Accuracy: 5986/10000 (59.8600%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3989/4315 (92.4450%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4037/4315 (93.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8439, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4955/5455 (90.8341%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4919/5455 (90.1742%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9596, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4379/4804 (91.1532%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4186/4804 (87.1357%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3268, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4061/4362 (93.0995%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3977/4362 (91.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9342, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5837/6263 (93.1981%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5785/6263 (92.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9727, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4171/4538 (91.9127%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4268/4538 (94.0502%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9006, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4216/4634 (90.9797%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4209/4634 (90.8287%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8965, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4808/5116 (93.9797%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4775/5116 (93.3346%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8276, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4307/4716 (91.3274%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4301/4716 (91.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0232, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3652/4046 (90.2620%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3641/4046 (89.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9196, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4149/4518 (91.8327%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9558, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4580/5063 (90.4602%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4610/5063 (91.0527%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8938, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5249/5740 (91.4460%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2575, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5166/5582 (92.5475%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5079/5582 (90.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0217, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4054/4433 (91.4505%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9818, Accuracy: 5644/10000 (56.4400%)
time spent on training: 257.11783361434937
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.6752, Accuracy: 6153/10000 (61.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 10.0935, Accuracy: 54/9900 (0.5455%)
Done in 280.69013714790344 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 44.486568867134636.
Norm before scaling: 44.47249687745928. Distance: 2.0204037344055767
Total norm for 4 adversaries is: 44.47249687745928. distance: 2.0204037344055767
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1969, Accuracy: 9420/9900 (95.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4846/5305 (91.3478%), train_poison_data_count: 415
Global model norm: 44.486568867134636.
Norm before scaling: 44.4767374678185. Distance: 2.1375238829946004
Total norm for 4 adversaries is: 44.4767374678185. distance: 2.1375238829946004
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1619, Accuracy: 9471/9900 (95.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 44.486568867134636.
Norm before scaling: 44.478071317504316. Distance: 2.039933760259469
Total norm for 4 adversaries is: 44.478071317504316. distance: 2.039933760259469
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0928, Accuracy: 9645/9900 (97.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4593/5066 (90.6632%), train_poison_data_count: 400
Global model norm: 44.486568867134636.
Norm before scaling: 44.47790253009423. Distance: 2.1575325731137016
Total norm for 4 adversaries is: 44.47790253009423. distance: 2.1575325731137016
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.3032, Accuracy: 9152/9900 (92.4444%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4822/5197 (92.7843%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4647/5197 (89.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9361, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3706/4025 (92.0745%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3765/4025 (93.5404%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7608, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3963/4481 (88.4401%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3958/4481 (88.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1144, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4181/4651 (89.8946%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4232/4651 (90.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8704, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5219/5902 (88.4277%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5140/5902 (87.0891%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0237, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3743/4126 (90.7174%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8717, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3961/4368 (90.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0339, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5685/6391 (88.9532%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5621/6391 (87.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2342, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3812/4175 (91.3054%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3819/4175 (91.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9284, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4268/4596 (92.8634%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4293/4596 (93.4073%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8888, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4200/4634 (90.6344%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4263/4634 (91.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8505, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3824/4223 (90.5517%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3902/4223 (92.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9086, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3537/3911 (90.4372%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3506/3911 (89.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0476, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4062/4433 (91.6309%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9946, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3937/4336 (90.7980%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3994/4336 (92.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0008, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3275/3638 (90.0220%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3327/3638 (91.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9405, Accuracy: 5578/10000 (55.7800%)
time spent on training: 255.22925996780396
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.6677, Accuracy: 6192/10000 (61.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 10.4866, Accuracy: 30/9900 (0.3030%)
Done in 279.07171964645386 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 44.51795442966312.
Norm before scaling: 44.50905285593946. Distance: 2.033798028136149
Total norm for 4 adversaries is: 44.50905285593946. distance: 2.033798028136149
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2515, Accuracy: 9299/9900 (93.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 44.51795442966312.
Norm before scaling: 44.511260590281395. Distance: 2.1736455054062076
Total norm for 4 adversaries is: 44.511260590281395. distance: 2.1736455054062076
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2240, Accuracy: 9350/9900 (94.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 44.51795442966312.
Norm before scaling: 44.50709459992376. Distance: 2.0093618864162512
Total norm for 4 adversaries is: 44.50709459992376. distance: 2.0093618864162512
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1643, Accuracy: 9504/9900 (96.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4629/5066 (91.3739%), train_poison_data_count: 400
Global model norm: 44.51795442966312.
Norm before scaling: 44.50823966904892. Distance: 2.1171613740892656
Total norm for 4 adversaries is: 44.50823966904892. distance: 2.1171613740892656
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1609, Accuracy: 9498/9900 (95.9394%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3470/3756 (92.3855%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3521/3756 (93.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7835, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4945/5424 (91.1689%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4989/5424 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2424, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4071/4433 (91.8340%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8118, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4118/4501 (91.4908%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4135/4501 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0310, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3692/4025 (91.7267%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3742/4025 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8139, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3947/4235 (93.1995%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3914/4235 (92.4203%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9472, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5512/6124 (90.0065%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5475/6124 (89.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9844, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4178/4634 (90.1597%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4281/4634 (92.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8360, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4286/4716 (90.8821%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4308/4716 (91.3486%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9818, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4767 (91.4621%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4391/4767 (92.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9134, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3421/3804 (89.9317%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3539/3804 (93.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9113, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3209/3472 (92.4251%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3232/3472 (93.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8755, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4988/5392 (92.5074%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4917/5392 (91.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0400, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5263/5740 (91.6899%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5269/5740 (91.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0059, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4163/4596 (90.5788%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4271/4596 (92.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0046, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3266/3616 (90.3208%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3358/3616 (92.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8862, Accuracy: 5697/10000 (56.9700%)
time spent on training: 259.37250900268555
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.6128, Accuracy: 6236/10000 (62.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 10.4473, Accuracy: 25/9900 (0.2525%)
Done in 282.9815230369568 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 44.5441675343487.
Norm before scaling: 44.53468873784303. Distance: 2.0556337911592406
Total norm for 4 adversaries is: 44.53468873784303. distance: 2.0556337911592406
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1252, Accuracy: 9558/9900 (96.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.5441675343487.
Norm before scaling: 44.53696235291536. Distance: 2.1790636051623222
Total norm for 4 adversaries is: 44.53696235291536. distance: 2.1790636051623222
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1864, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 44.5441675343487.
Norm before scaling: 44.53456813295782. Distance: 2.035138911724369
Total norm for 4 adversaries is: 44.53456813295782. distance: 2.035138911724369
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1120, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 44.5441675343487.
Norm before scaling: 44.536586851254945. Distance: 2.1421938528110007
Total norm for 4 adversaries is: 44.536586851254945. distance: 2.1421938528110007
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.2833, Accuracy: 9200/9900 (92.9293%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4555/5063 (89.9664%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4512/5063 (89.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1499, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4400/4804 (91.5903%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4459/4804 (92.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0900, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4108/4558 (90.1272%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4080/4558 (89.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2130, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3454/3756 (91.9595%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3514/3756 (93.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9257, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4955/5424 (91.3532%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4975/5424 (91.7220%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2939, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4109/4511 (91.0885%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4167/4511 (92.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9182, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4718/5167 (91.3102%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4701/5167 (90.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1887, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4099/4356 (94.1001%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4150/4356 (95.2709%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8638, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4569/5244 (87.1281%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4592/5244 (87.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0275, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4340/4793 (90.5487%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4413/4793 (92.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9665, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3469/3828 (90.6217%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8754, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3709/4046 (91.6708%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3687/4046 (91.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9390, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3682/4013 (91.7518%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7696, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2983/3271 (91.1954%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2931/3271 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0345, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4051/4362 (92.8702%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4033/4362 (92.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9436, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3976/4346 (91.4864%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4084/4346 (93.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7701, Accuracy: 5890/10000 (58.9000%)
time spent on training: 256.17098450660706
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.6417, Accuracy: 6187/10000 (61.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 10.3069, Accuracy: 31/9900 (0.3131%)
Done in 279.98747754096985 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 44.571523729159885.
Norm before scaling: 44.5614837059778. Distance: 1.9745365057686108
Total norm for 4 adversaries is: 44.5614837059778. distance: 1.9745365057686108
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.4194, Accuracy: 8904/9900 (89.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4849/5305 (91.4043%), train_poison_data_count: 415
Global model norm: 44.571523729159885.
Norm before scaling: 44.56352585819554. Distance: 2.1503034776704295
Total norm for 4 adversaries is: 44.56352585819554. distance: 2.1503034776704295
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1932, Accuracy: 9455/9900 (95.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 44.571523729159885.
Norm before scaling: 44.56066188793233. Distance: 1.982830197230513
Total norm for 4 adversaries is: 44.56066188793233. distance: 1.982830197230513
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1679, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4615/5066 (91.0975%), train_poison_data_count: 400
Global model norm: 44.571523729159885.
Norm before scaling: 44.56556243859994. Distance: 2.1409827163191086
Total norm for 4 adversaries is: 44.56556243859994. distance: 2.1409827163191086
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2347, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3798/4126 (92.0504%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3833/4126 (92.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9106, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4965/5455 (91.0174%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4994/5455 (91.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1203, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4059/4558 (89.0522%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3948/4558 (86.6169%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2288, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3980/4235 (93.9787%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3985/4235 (94.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7885, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3451/3804 (90.7203%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3533/3804 (92.8759%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8942, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5687/6391 (88.9845%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5660/6391 (88.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0441, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3960/4336 (91.3284%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3982/4336 (91.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9846, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4286/4663 (91.9151%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4295/4663 (92.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9384, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4082/4511 (90.4899%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4142/4511 (91.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0437, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4093/4503 (90.8950%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4168/4503 (92.5605%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9164, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5063 (90.5590%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4438/5063 (87.6555%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2365, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3969/4315 (91.9815%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4024/4315 (93.2561%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8442, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3248/3638 (89.2798%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3311/3638 (91.0115%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8832, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4090/4441 (92.0964%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4137/4441 (93.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8872, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4363/4679 (93.2464%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4410/4679 (94.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8830, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4843/5265 (91.9848%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4795/5265 (91.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0215, Accuracy: 5465/10000 (54.6500%)
time spent on training: 258.80418968200684
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7143, Accuracy: 6093/10000 (60.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 10.6876, Accuracy: 13/9900 (0.1313%)
Done in 282.47199749946594 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 44.59407711644213.
Norm before scaling: 44.58313999787714. Distance: 2.0698929271556334
Total norm for 4 adversaries is: 44.58313999787714. distance: 2.0698929271556334
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1093, Accuracy: 9633/9900 (97.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 44.59407711644213.
Norm before scaling: 44.58849254002862. Distance: 2.224753732661211
Total norm for 4 adversaries is: 44.58849254002862. distance: 2.224753732661211
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.2451, Accuracy: 9287/9900 (93.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.59407711644213.
Norm before scaling: 44.58393265270853. Distance: 2.0566037601307845
Total norm for 4 adversaries is: 44.58393265270853. distance: 2.0566037601307845
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1921, Accuracy: 9427/9900 (95.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4616/5066 (91.1173%), train_poison_data_count: 400
Global model norm: 44.59407711644213.
Norm before scaling: 44.58775198362354. Distance: 2.1788003408161063
Total norm for 4 adversaries is: 44.58775198362354. distance: 2.1788003408161063
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1508, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3912/4336 (90.2214%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4050/4336 (93.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8259, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3509/3828 (91.6667%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3517/3828 (91.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8845, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3339/3672 (90.9314%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3437/3672 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8235, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4230/4651 (90.9482%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4245/4651 (91.2707%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0698, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3962/4361 (90.8507%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3847/4361 (88.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0771, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4616/5025 (91.8607%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4686/5025 (93.2537%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8473, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5464/6124 (89.2227%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5471/6124 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1294, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3339/3704 (90.1458%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3419/3704 (92.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9795, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4934 (89.5420%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4156/4934 (84.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2254, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4544/5017 (90.5721%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4614/5017 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8589, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5194/5582 (93.0491%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5151/5582 (92.2788%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0082, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4773/5167 (92.3747%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4804/5167 (92.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0301, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3547/3861 (91.8674%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3586/3861 (92.8775%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8550, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3305/3646 (90.6473%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3363/3646 (92.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8443, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4029/4558 (88.3940%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4064/4558 (89.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0115, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4777/5116 (93.3737%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4795/5116 (93.7256%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8227, Accuracy: 5739/10000 (57.3900%)
time spent on training: 256.83346152305603
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.6953, Accuracy: 6123/10000 (61.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 10.5315, Accuracy: 17/9900 (0.1717%)
Done in 280.5525794029236 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4530/4885 (92.7329%), train_poison_data_count: 385
Global model norm: 44.623459904271485.
Norm before scaling: 44.616799677661355. Distance: 2.0714938266228486
Total norm for 4 adversaries is: 44.616799677661355. distance: 2.0714938266228486
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1776, Accuracy: 9456/9900 (95.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 44.623459904271485.
Norm before scaling: 44.61380095162889. Distance: 2.164339564245669
Total norm for 4 adversaries is: 44.61380095162889. distance: 2.164339564245669
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1537, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 44.623459904271485.
Norm before scaling: 44.612389072869234. Distance: 2.028287869865723
Total norm for 4 adversaries is: 44.612389072869234. distance: 2.028287869865723
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2022, Accuracy: 9378/9900 (94.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4577/5066 (90.3474%), train_poison_data_count: 400
Global model norm: 44.623459904271485.
Norm before scaling: 44.61775588961193. Distance: 2.2012372959166786
Total norm for 4 adversaries is: 44.61775588961193. distance: 2.2012372959166786
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1768, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4055/4511 (89.8914%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4167/4511 (92.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9978, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4029/4346 (92.7059%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4067/4346 (93.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9026, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4389/4804 (91.3614%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4120/4804 (85.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2017, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4820/5232 (92.1254%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4779/5232 (91.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0636, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4311/4618 (93.3521%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4170/4618 (90.2988%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0044, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3309/3590 (92.1727%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3337/3590 (92.9526%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0321, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5666/6391 (88.6559%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5712/6391 (89.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1654, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3928/4354 (90.2159%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3700/4354 (84.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3954, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4652/5055 (92.0277%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4757/5055 (94.1048%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8258, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3455/3837 (90.0443%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3563/3837 (92.8590%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9142, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4122/4503 (91.5390%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4129/4503 (91.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0321, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4255/4576 (92.9851%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4294/4576 (93.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8101, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4340/4793 (90.5487%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9632, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4213/4634 (90.9150%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8679, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3690/4158 (88.7446%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3764/4158 (90.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8507, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5257/5740 (91.5854%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5241/5740 (91.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0927, Accuracy: 5422/10000 (54.2200%)
time spent on training: 259.13155126571655
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7655, Accuracy: 6003/10000 (60.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 10.5498, Accuracy: 14/9900 (0.1414%)
Done in 282.8758978843689 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4515/4885 (92.4258%), train_poison_data_count: 385
Global model norm: 44.65577162532437.
Norm before scaling: 44.642212355834666. Distance: 1.98651236220766
Total norm for 4 adversaries is: 44.642212355834666. distance: 1.98651236220766
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2227, Accuracy: 9397/9900 (94.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4833/5305 (91.1027%), train_poison_data_count: 415
Global model norm: 44.65577162532437.
Norm before scaling: 44.64523104737434. Distance: 2.187087646856092
Total norm for 4 adversaries is: 44.64523104737434. distance: 2.187087646856092
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1397, Accuracy: 9576/9900 (96.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 44.65577162532437.
Norm before scaling: 44.64403890734952. Distance: 1.9915871706729993
Total norm for 4 adversaries is: 44.64403890734952. distance: 1.9915871706729993
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.3561, Accuracy: 9066/9900 (91.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 44.65577162532437.
Norm before scaling: 44.64753457639067. Distance: 2.194457515511301
Total norm for 4 adversaries is: 44.64753457639067. distance: 2.194457515511301
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2405, Accuracy: 9291/9900 (93.8485%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3777/4184 (90.2725%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3852/4184 (92.0650%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8571, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5856/6263 (93.5015%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5766/6263 (92.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0626, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4071/4456 (91.3600%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4141/4456 (92.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9144, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4220/4538 (92.9925%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4194/4538 (92.4196%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9394, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3952/4235 (93.3176%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3847/4235 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1379, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3824/4223 (90.5517%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3933/4223 (93.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9734, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4959/5455 (90.9074%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4910/5455 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0672, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4542/5037 (90.1727%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4649/5037 (92.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8771, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9451, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4842/5265 (91.9658%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4769/5265 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8996, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4672/5055 (92.4233%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4700/5055 (92.9773%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9298, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4382/4804 (91.2157%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3981/4804 (82.8684%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2487, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4601/5063 (90.8750%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4400/5063 (86.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1419, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3979/4295 (92.6426%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3840/4295 (89.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2242, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2970/3271 (90.7979%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9379, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3962/4356 (90.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1213, Accuracy: 5292/10000 (52.9200%)
time spent on training: 260.64524149894714
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7645, Accuracy: 5998/10000 (59.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 10.4588, Accuracy: 21/9900 (0.2121%)
Done in 284.43300127983093 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.687509560750726.
Norm before scaling: 44.677602159981966. Distance: 2.053191710249105
Total norm for 4 adversaries is: 44.677602159981966. distance: 2.053191710249105
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1455, Accuracy: 9536/9900 (96.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4834/5305 (91.1216%), train_poison_data_count: 415
Global model norm: 44.687509560750726.
Norm before scaling: 44.678283850787764. Distance: 2.166607843725401
Total norm for 4 adversaries is: 44.678283850787764. distance: 2.166607843725401
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2152, Accuracy: 9358/9900 (94.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.687509560750726.
Norm before scaling: 44.67504196976204. Distance: 2.0042181831871178
Total norm for 4 adversaries is: 44.67504196976204. distance: 2.0042181831871178
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0870, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 44.687509560750726.
Norm before scaling: 44.67887946790757. Distance: 2.1714641813714093
Total norm for 4 adversaries is: 44.67887946790757. distance: 2.1714641813714093
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1729, Accuracy: 9466/9900 (95.6162%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4101/4503 (91.0726%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4099/4503 (91.0282%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0038, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4123/4456 (92.5269%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4088/4456 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0416, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4780/5265 (90.7882%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4685/5265 (88.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0108, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4310/4793 (89.9228%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4392/4793 (91.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0129, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4509/4928 (91.4976%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4606/4928 (93.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7340, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3247/3638 (89.2523%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3362/3638 (92.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9298, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4256/4663 (91.2717%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4287/4663 (91.9365%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9882, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4436/4928 (90.0162%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0128, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4132/4465 (92.5420%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4152/4465 (92.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8900, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3540/3911 (90.5139%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3493/3911 (89.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0225, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4094/4518 (90.6153%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4180/4518 (92.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0175, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3933/4235 (92.8689%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3953/4235 (93.3412%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9854, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4437/4934 (89.9270%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4284/4934 (86.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2967, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4249/4647 (91.4353%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4245/4647 (91.3493%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8828, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4202/4651 (90.3462%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4237/4651 (91.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9451, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4513/4989 (90.4590%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4533/4989 (90.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8322, Accuracy: 5853/10000 (58.5300%)
time spent on training: 259.5895764827728
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7174, Accuracy: 6068/10000 (60.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 10.3077, Accuracy: 17/9900 (0.1717%)
Done in 283.76267981529236 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4506/4885 (92.2416%), train_poison_data_count: 385
Global model norm: 44.715457819066884.
Norm before scaling: 44.70362334788633. Distance: 2.028611685221024
Total norm for 4 adversaries is: 44.70362334788633. distance: 2.028611685221024
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2151, Accuracy: 9340/9900 (94.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 44.715457819066884.
Norm before scaling: 44.70633071343895. Distance: 2.1871799779861547
Total norm for 4 adversaries is: 44.70633071343895. distance: 2.1871799779861547
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1453, Accuracy: 9527/9900 (96.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 44.715457819066884.
Norm before scaling: 44.70421316615121. Distance: 2.0371099601883746
Total norm for 4 adversaries is: 44.70421316615121. distance: 2.0371099601883746
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1456, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 44.715457819066884.
Norm before scaling: 44.70589110194259. Distance: 2.1535465043827835
Total norm for 4 adversaries is: 44.70589110194259. distance: 2.1535465043827835
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2633, Accuracy: 9263/9900 (93.5657%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4219/4538 (92.9705%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4279/4538 (94.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8024, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4055/4362 (92.9619%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3915/4362 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0444, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4599/5244 (87.7002%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4663/5244 (88.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0612, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3715/4046 (91.8191%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3728/4046 (92.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9450, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3699/4013 (92.1754%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3740/4013 (93.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8593, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4058/4465 (90.8847%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4194/4465 (93.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8645, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5232 (92.4885%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4784/5232 (91.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9958, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4504/4928 (91.3961%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4546/4928 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8495, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4550/5063 (89.8677%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4348/5063 (85.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1262, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5255/5902 (89.0376%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5091/5902 (86.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1641, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4113/4456 (92.3025%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8171, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4207/4596 (91.5361%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4280/4596 (93.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0051, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4074/4441 (91.7361%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4135/4441 (93.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0935, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5337/5740 (92.9791%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5343/5740 (93.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0666, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3191/3472 (91.9067%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3196/3472 (92.0507%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9601, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3574/3861 (92.5667%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3553/3861 (92.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9890, Accuracy: 5592/10000 (55.9200%)
time spent on training: 258.75673055648804
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7461, Accuracy: 5974/10000 (59.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 5.3412, Accuracy: 1145/9900 (11.5657%)
Done in 282.52565002441406 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4524/4885 (92.6100%), train_poison_data_count: 385
Global model norm: 44.72152468898855.
Norm before scaling: 44.71060919087046. Distance: 1.8774050864090923
Total norm for 4 adversaries is: 44.71060919087046. distance: 1.8774050864090923
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1536, Accuracy: 9547/9900 (96.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4902/5305 (92.4034%), train_poison_data_count: 415
Global model norm: 44.72152468898855.
Norm before scaling: 44.710939547658526. Distance: 1.953547012513261
Total norm for 4 adversaries is: 44.710939547658526. distance: 1.953547012513261
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1722, Accuracy: 9507/9900 (96.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4379/4717 (92.8344%), train_poison_data_count: 370
Global model norm: 44.72152468898855.
Norm before scaling: 44.70823109601156. Distance: 1.7967842410842736
Total norm for 4 adversaries is: 44.70823109601156. distance: 1.7967842410842736
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1435, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 44.72152468898855.
Norm before scaling: 44.7055334024422. Distance: 1.7861540361898562
Total norm for 4 adversaries is: 44.7055334024422. distance: 1.7861540361898562
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1076, Accuracy: 9637/9900 (97.3434%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3530/3797 (92.9681%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3491/3797 (91.9410%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1218, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3026/3297 (91.7804%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3077/3297 (93.3273%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.6861, Accuracy: 6035/10000 (60.3500%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3556/3911 (90.9230%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3390/3911 (86.6786%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1259, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2995/3271 (91.5622%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3009/3271 (91.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8471, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3681/4046 (90.9787%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3704/4046 (91.5472%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9079, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5360/5740 (93.3798%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5394/5740 (93.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1013, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3689/3969 (92.9453%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3644/3969 (91.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8884, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3325/3704 (89.7678%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9325, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4445/4767 (93.2452%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4424/4767 (92.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9684, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4518/4956 (91.1622%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4465/4956 (90.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9977, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3270/3590 (91.0864%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3290/3590 (91.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9892, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5272/5902 (89.3257%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5182/5902 (87.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1508, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4513/4928 (91.5787%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4515/4928 (91.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9611, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3939/4235 (93.0106%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3960/4235 (93.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9132, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4808/5265 (91.3200%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4854/5265 (92.1937%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9439, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4019/4356 (92.2635%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1292, Accuracy: 5373/10000 (53.7300%)
time spent on training: 253.87191820144653
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7049, Accuracy: 6079/10000 (60.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 5.3677, Accuracy: 1231/9900 (12.4343%)
Done in 277.5639226436615 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4568/4885 (93.5107%), train_poison_data_count: 385
Global model norm: 44.74983633000796.
Norm before scaling: 44.737942738885664. Distance: 1.8372342339178043
Total norm for 4 adversaries is: 44.737942738885664. distance: 1.8372342339178043
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0885, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4890/5305 (92.1772%), train_poison_data_count: 415
Global model norm: 44.74983633000796.
Norm before scaling: 44.739073714113424. Distance: 1.9749168813091436
Total norm for 4 adversaries is: 44.739073714113424. distance: 1.9749168813091436
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1395, Accuracy: 9595/9900 (96.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4355/4717 (92.3256%), train_poison_data_count: 370
Global model norm: 44.74983633000796.
Norm before scaling: 44.7363246715372. Distance: 1.8405126825593638
Total norm for 4 adversaries is: 44.7363246715372. distance: 1.8405126825593638
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0859, Accuracy: 9675/9900 (97.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4730/5066 (93.3675%), train_poison_data_count: 400
Global model norm: 44.74983633000796.
Norm before scaling: 44.73574892013447. Distance: 1.8488532739440435
Total norm for 4 adversaries is: 44.73574892013447. distance: 1.8488532739440435
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1083, Accuracy: 9624/9900 (97.2121%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3684/4025 (91.5280%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3742/4025 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8086, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5238/5902 (88.7496%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5132/5902 (86.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2890, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4327/4793 (90.2775%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9922, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4824/5265 (91.6239%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4766/5265 (90.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1084, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3972/4295 (92.4796%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3815/4295 (88.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1363, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3314/3704 (89.4708%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9014, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4769/5116 (93.2174%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4740/5116 (92.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9784, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5399/5740 (94.0592%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5354/5740 (93.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0797, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3476/3797 (91.5460%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3497/3797 (92.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8831, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4269/4716 (90.5216%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4276/4716 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8191, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4025/4433 (90.7963%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8285, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3964/4416 (89.7645%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4000/4416 (90.5797%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9683, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3873/4223 (91.7121%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3965/4223 (93.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8655, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4694/5083 (92.3470%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4651/5083 (91.5011%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0146, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4233/4576 (92.5044%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4276/4576 (93.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8151, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4952/5392 (91.8398%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4926/5392 (91.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0019, Accuracy: 5598/10000 (55.9800%)
time spent on training: 262.00493454933167
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7493, Accuracy: 5972/10000 (59.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 5.4499, Accuracy: 1210/9900 (12.2222%)
Done in 285.6310660839081 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 44.77903922055078.
Norm before scaling: 44.76599994389227. Distance: 1.8098806988931824
Total norm for 4 adversaries is: 44.76599994389227. distance: 1.8098806988931824
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1286, Accuracy: 9595/9900 (96.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4873/5305 (91.8567%), train_poison_data_count: 415
Global model norm: 44.77903922055078.
Norm before scaling: 44.76718747273219. Distance: 2.040378891035176
Total norm for 4 adversaries is: 44.76718747273219. distance: 2.040378891035176
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0591, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 44.77903922055078.
Norm before scaling: 44.767027955764355. Distance: 1.8592306129108522
Total norm for 4 adversaries is: 44.767027955764355. distance: 1.8592306129108522
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2022, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4745/5066 (93.6636%), train_poison_data_count: 400
Global model norm: 44.77903922055078.
Norm before scaling: 44.762467166107754. Distance: 1.8057162172615868
Total norm for 4 adversaries is: 44.762467166107754. distance: 1.8057162172615868
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2387, Accuracy: 9306/9900 (94.0000%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4850/5265 (92.1178%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4811/5265 (91.3770%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0869, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4065/4356 (93.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1432, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3497/3756 (93.1044%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3542/3756 (94.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7326, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3483/3837 (90.7740%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3579/3837 (93.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9200, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5425/5740 (94.5122%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5377/5740 (93.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9777, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3825/4223 (90.5754%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3956/4223 (93.6775%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8374, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4076/4465 (91.2878%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4153/4465 (93.0123%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9134, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5063/5591 (90.5563%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5041/5591 (90.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1336, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5247/5902 (88.9021%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5153/5902 (87.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1587, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4542/4918 (92.3546%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4574/4918 (93.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1171, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3550/3861 (91.9451%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3595/3861 (93.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9050, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3922/4295 (91.3155%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3857/4295 (89.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9773, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3744/4158 (90.0433%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3718/4158 (89.4180%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9511, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5776/6263 (92.2242%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5759/6263 (91.9527%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1876, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3917/4354 (89.9633%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0158, Accuracy: 3130/4354 (71.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.6594, Accuracy: 4319/10000 (43.1900%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3487/3797 (91.8357%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3516/3797 (92.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0328, Accuracy: 5540/10000 (55.4000%)
time spent on training: 260.7046892642975
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7013, Accuracy: 6069/10000 (60.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 5.7991, Accuracy: 1000/9900 (10.1010%)
Done in 284.65907192230225 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4563/4885 (93.4084%), train_poison_data_count: 385
Global model norm: 44.81185031563568.
Norm before scaling: 44.79692541198768. Distance: 1.8237991013692136
Total norm for 4 adversaries is: 44.79692541198768. distance: 1.8237991013692136
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1869, Accuracy: 9485/9900 (95.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4910/5305 (92.5542%), train_poison_data_count: 415
Global model norm: 44.81185031563568.
Norm before scaling: 44.79866118474203. Distance: 1.946528533428528
Total norm for 4 adversaries is: 44.79866118474203. distance: 1.946528533428528
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1532, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4372/4717 (92.6860%), train_poison_data_count: 370
Global model norm: 44.81185031563568.
Norm before scaling: 44.79865845987676. Distance: 1.8392577321308852
Total norm for 4 adversaries is: 44.79865845987676. distance: 1.8392577321308852
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1067, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4712/5066 (93.0122%), train_poison_data_count: 400
Global model norm: 44.81185031563568.
Norm before scaling: 44.79885873703286. Distance: 1.8507302904822518
Total norm for 4 adversaries is: 44.79885873703286. distance: 1.8507302904822518
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2488, Accuracy: 9338/9900 (94.3232%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3523/3797 (92.7838%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3514/3797 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9293, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4635/5037 (92.0191%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4649/5037 (92.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0328, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4410/4934 (89.3798%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4307/4934 (87.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1934, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5071/5455 (92.9606%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5106/5455 (93.6022%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0767, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5216/5902 (88.3768%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5135/5902 (87.0044%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1277, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5667/6391 (88.6716%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5613/6391 (87.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2150, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3577/3911 (91.4600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3383/3911 (86.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2670, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4687/5195 (90.2214%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4629/5195 (89.1049%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1837, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3942/4235 (93.0815%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3933/4235 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9792, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4767/5116 (93.1783%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4810/5116 (94.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9141, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4147/4538 (91.3839%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8049, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5250/5582 (94.0523%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5225/5582 (93.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9364, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4153/4558 (91.1145%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4135/4558 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1512, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3721/4046 (91.9674%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3772/4046 (93.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7989, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3510/3828 (91.6928%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8250, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4640/5055 (91.7903%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4683/5055 (92.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8076, Accuracy: 5853/10000 (58.5300%)
time spent on training: 261.42838287353516
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7790, Accuracy: 5970/10000 (59.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 5.8545, Accuracy: 947/9900 (9.5657%)
Done in 285.16642475128174 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4567/4885 (93.4903%), train_poison_data_count: 385
Global model norm: 44.84344512091483.
Norm before scaling: 44.8292155779681. Distance: 1.8235206983817753
Total norm for 4 adversaries is: 44.8292155779681. distance: 1.8235206983817753
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2347, Accuracy: 9304/9900 (93.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 44.84344512091483.
Norm before scaling: 44.82914069518565. Distance: 2.0152421927850397
Total norm for 4 adversaries is: 44.82914069518565. distance: 2.0152421927850397
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1266, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4379/4717 (92.8344%), train_poison_data_count: 370
Global model norm: 44.84344512091483.
Norm before scaling: 44.83234148216483. Distance: 1.844114881714382
Total norm for 4 adversaries is: 44.83234148216483. distance: 1.844114881714382
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2625, Accuracy: 9277/9900 (93.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4708/5066 (92.9333%), train_poison_data_count: 400
Global model norm: 44.84344512091483.
Norm before scaling: 44.83237007174615. Distance: 1.9026662564913213
Total norm for 4 adversaries is: 44.83237007174615. distance: 1.9026662564913213
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0804, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5260/5582 (94.2315%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5243/5582 (93.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9532, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4086/4501 (90.7798%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4133/4501 (91.8240%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8792, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3575/3911 (91.4088%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3320/3911 (84.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2122, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4283/4663 (91.8507%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4330/4663 (92.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9377, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4866/5265 (92.4217%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4902/5265 (93.1054%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7706, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3945/4416 (89.3342%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4008/4416 (90.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0240, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4077/4433 (91.9693%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9807, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5916/6263 (94.4595%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5849/6263 (93.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0840, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5020/5455 (92.0257%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4960/5455 (90.9258%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9579, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4189/4634 (90.3971%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4184/4634 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8566, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4325/4707 (91.8844%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4344/4707 (92.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7487, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3773/4126 (91.4445%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3830/4126 (92.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8323, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4757/5116 (92.9828%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4704/5116 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9902, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4639/5063 (91.6255%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4366/5063 (86.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3475, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4013/4361 (92.0202%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3900/4361 (89.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0208, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5504/6124 (89.8759%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5429/6124 (88.6512%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0374, Accuracy: 5422/10000 (54.2200%)
time spent on training: 264.19149899482727
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8426, Accuracy: 5864/10000 (58.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 6.1345, Accuracy: 755/9900 (7.6263%)
Done in 287.9347493648529 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4528/4885 (92.6919%), train_poison_data_count: 385
Global model norm: 44.86997409398976.
Norm before scaling: 44.85590128269426. Distance: 1.8779091836382285
Total norm for 4 adversaries is: 44.85590128269426. distance: 1.8779091836382285
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2736, Accuracy: 9242/9900 (93.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4871/5305 (91.8190%), train_poison_data_count: 415
Global model norm: 44.86997409398976.
Norm before scaling: 44.859516500995916. Distance: 2.035754681427829
Total norm for 4 adversaries is: 44.859516500995916. distance: 2.035754681427829
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2189, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4354/4717 (92.3044%), train_poison_data_count: 370
Global model norm: 44.86997409398976.
Norm before scaling: 44.857195284034425. Distance: 1.8592671595483397
Total norm for 4 adversaries is: 44.857195284034425. distance: 1.8592671595483397
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0317, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4726/5066 (93.2886%), train_poison_data_count: 400
Global model norm: 44.86997409398976.
Norm before scaling: 44.851922436937556. Distance: 1.8508422351996938
Total norm for 4 adversaries is: 44.851922436937556. distance: 1.8508422351996938
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1094, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4002/4356 (91.8733%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4099/4356 (94.1001%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9805, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4082/4362 (93.5809%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4141/4362 (94.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8744, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4422/4679 (94.5074%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4403/4679 (94.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8954, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3760/4158 (90.4281%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3770/4158 (90.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8900, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4151/4651 (89.2496%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4209/4651 (90.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0471, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3836/4175 (91.8802%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3821/4175 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8487, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4301/4618 (93.1356%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4266/4618 (92.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9307, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4226/4625 (91.3730%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4171/4625 (90.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0755, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5244/5582 (93.9448%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0029, Accuracy: 5273/5582 (94.4643%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9828, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4410/4874 (90.4801%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4257/4874 (87.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1797, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4441/4934 (90.0081%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4226/4934 (85.6506%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4583, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4941/5424 (91.0951%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4999/5424 (92.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1930, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4375/4804 (91.0699%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4422/4804 (92.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0146, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4498/4918 (91.4599%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4537/4918 (92.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1022, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3548/3861 (91.8933%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3521/3861 (91.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0010, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3871/4223 (91.6647%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3948/4223 (93.4880%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8355, Accuracy: 5839/10000 (58.3900%)
time spent on training: 260.14677453041077
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8149, Accuracy: 5930/10000 (59.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 6.6269, Accuracy: 561/9900 (5.6667%)
Done in 283.7576103210449 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4549/4885 (93.1218%), train_poison_data_count: 385
Global model norm: 44.8957451178561.
Norm before scaling: 44.87785343034608. Distance: 1.8361771447444044
Total norm for 4 adversaries is: 44.87785343034608. distance: 1.8361771447444044
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1677, Accuracy: 9475/9900 (95.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 44.8957451178561.
Norm before scaling: 44.88332313134245. Distance: 2.0669982869695276
Total norm for 4 adversaries is: 44.88332313134245. distance: 2.0669982869695276
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1355, Accuracy: 9571/9900 (96.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4361/4717 (92.4528%), train_poison_data_count: 370
Global model norm: 44.8957451178561.
Norm before scaling: 44.88532480457839. Distance: 1.8963111303304467
Total norm for 4 adversaries is: 44.88532480457839. distance: 1.8963111303304467
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1225, Accuracy: 9608/9900 (97.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4708/5066 (92.9333%), train_poison_data_count: 400
Global model norm: 44.8957451178561.
Norm before scaling: 44.88635280314887. Distance: 1.9372915955716588
Total norm for 4 adversaries is: 44.88635280314887. distance: 1.9372915955716588
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0869, Accuracy: 9694/9900 (97.9192%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4285/4647 (92.2100%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4256/4647 (91.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8909, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3452/3804 (90.7466%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3552/3804 (93.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7535, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5069/5591 (90.6636%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5057/5591 (90.4489%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1605, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4203/4634 (90.6992%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4222/4634 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9301, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4106/4433 (92.6235%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4121/4433 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7692, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3371/3704 (91.0097%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3448/3704 (93.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8676, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3481/3837 (90.7219%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3555/3837 (92.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0251, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5084/5455 (93.1989%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5052/5455 (92.6123%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9059, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5330/5740 (92.8571%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5317/5740 (92.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0423, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4573/4986 (91.7168%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4596/4986 (92.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8763, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4064/4456 (91.2029%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4074/4456 (91.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8737, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4056/4356 (93.1129%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3901/4356 (89.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1977, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3302/3590 (91.9777%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3333/3590 (92.8412%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9627, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4144/4503 (92.0275%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4173/4503 (92.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9449, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4608/5037 (91.4830%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8884, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4773/5167 (92.3747%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4745/5167 (91.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1447, Accuracy: 5365/10000 (53.6500%)
time spent on training: 256.63251852989197
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8045, Accuracy: 5934/10000 (59.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 6.9492, Accuracy: 419/9900 (4.2323%)
Done in 280.2151577472687 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4554/4885 (93.2242%), train_poison_data_count: 385
Global model norm: 44.9251316754296.
Norm before scaling: 44.90730877970687. Distance: 1.82284317595072
Total norm for 4 adversaries is: 44.90730877970687. distance: 1.82284317595072
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0850, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 44.9251316754296.
Norm before scaling: 44.91311191701497. Distance: 1.9704065165826647
Total norm for 4 adversaries is: 44.91311191701497. distance: 1.9704065165826647
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1740, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4350/4717 (92.2196%), train_poison_data_count: 370
Global model norm: 44.9251316754296.
Norm before scaling: 44.909978044190666. Distance: 1.8596567533499702
Total norm for 4 adversaries is: 44.909978044190666. distance: 1.8596567533499702
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1018, Accuracy: 9628/9900 (97.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4696/5066 (92.6964%), train_poison_data_count: 400
Global model norm: 44.9251316754296.
Norm before scaling: 44.91212258269267. Distance: 1.9220990926461867
Total norm for 4 adversaries is: 44.91212258269267. distance: 1.9220990926461867
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2447, Accuracy: 9311/9900 (94.0505%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3295/3638 (90.5717%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3362/3638 (92.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7287, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4270/4716 (90.5428%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4256/4716 (90.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0439, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4538/4956 (91.5658%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4477/4956 (90.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0907, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4934/5392 (91.5059%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4898/5392 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2113, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3822/4184 (91.3480%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7948, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4003/4481 (89.3327%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3916/4481 (87.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1546, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3313/3646 (90.8667%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8790, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4615/5025 (91.8408%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0790, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3305/3590 (92.0613%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3193/3590 (88.9415%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1517, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4217/4596 (91.7537%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4288/4596 (93.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9518, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3914/4336 (90.2675%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1011, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4432/4874 (90.9315%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4288/4874 (87.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1159, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4768/5167 (92.2779%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4745/5167 (91.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0534, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4269/4618 (92.4426%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4159/4618 (90.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9929, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4415/4928 (89.5901%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4516/4928 (91.6396%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9299, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4289/4647 (92.2961%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4318/4647 (92.9202%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8194, Accuracy: 5919/10000 (59.1900%)
time spent on training: 257.53785514831543
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8226, Accuracy: 5896/10000 (58.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 7.6366, Accuracy: 273/9900 (2.7576%)
Done in 281.37002396583557 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4538/4885 (92.8966%), train_poison_data_count: 385
Global model norm: 44.952738039262556.
Norm before scaling: 44.93919774696278. Distance: 1.9025735892501523
Total norm for 4 adversaries is: 44.93919774696278. distance: 1.9025735892501523
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1224, Accuracy: 9595/9900 (96.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4908/5305 (92.5165%), train_poison_data_count: 415
Global model norm: 44.952738039262556.
Norm before scaling: 44.93866262404234. Distance: 2.046167731941238
Total norm for 4 adversaries is: 44.93866262404234. distance: 2.046167731941238
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2052, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4346/4717 (92.1348%), train_poison_data_count: 370
Global model norm: 44.952738039262556.
Norm before scaling: 44.94097827506999. Distance: 1.9050264027285222
Total norm for 4 adversaries is: 44.94097827506999. distance: 1.9050264027285222
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1038, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4744/5066 (93.6439%), train_poison_data_count: 400
Global model norm: 44.952738039262556.
Norm before scaling: 44.937653478962524. Distance: 1.8711735782039776
Total norm for 4 adversaries is: 44.937653478962524. distance: 1.8711735782039776
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1543, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3964/4368 (90.7509%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3900/4368 (89.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0666, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4783/5195 (92.0693%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4648/5195 (89.4706%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9998, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3998/4315 (92.6535%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4018/4315 (93.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8101, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3325/3646 (91.1958%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3363/3646 (92.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7731, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3326/3590 (92.6462%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3350/3590 (93.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9102, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3791/4126 (91.8808%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3828/4126 (92.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8834, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4064/4361 (93.1896%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3990/4361 (91.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9565, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3467/3837 (90.3570%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3571/3837 (93.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8535, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3961/4235 (93.5301%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4012/4235 (94.7344%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8680, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5262/5902 (89.1562%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5116/5902 (86.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0607, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4105/4433 (92.6009%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4079/4433 (92.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8127, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3275/3638 (90.0220%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3337/3638 (91.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8240, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4809/5232 (91.9151%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4807/5232 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0715, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3959/4336 (91.3054%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4041/4336 (93.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9329, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4606/4989 (92.3231%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4609/4989 (92.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0409, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3992/4481 (89.0873%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3947/4481 (88.0830%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1604, Accuracy: 5298/10000 (52.9800%)
time spent on training: 252.8569691181183
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8438, Accuracy: 5877/10000 (58.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 7.7423, Accuracy: 234/9900 (2.3636%)
Done in 276.4692747592926 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4585/4885 (93.8588%), train_poison_data_count: 385
Global model norm: 44.97843314569981.
Norm before scaling: 44.96372914335023. Distance: 1.834979192735331
Total norm for 4 adversaries is: 44.96372914335023. distance: 1.834979192735331
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1478, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4882/5305 (92.0264%), train_poison_data_count: 415
Global model norm: 44.97843314569981.
Norm before scaling: 44.963473945612925. Distance: 2.062462430669607
Total norm for 4 adversaries is: 44.963473945612925. distance: 2.062462430669607
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0672, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4361/4717 (92.4528%), train_poison_data_count: 370
Global model norm: 44.97843314569981.
Norm before scaling: 44.96504040249978. Distance: 1.8407606039305235
Total norm for 4 adversaries is: 44.96504040249978. distance: 1.8407606039305235
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.3609, Accuracy: 9078/9900 (91.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4691/5066 (92.5977%), train_poison_data_count: 400
Global model norm: 44.97843314569981.
Norm before scaling: 44.96468476456343. Distance: 1.9499083008357319
Total norm for 4 adversaries is: 44.96468476456343. distance: 1.9499083008357319
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0823, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4764/5116 (93.1196%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4716/5116 (92.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0495, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4066/4362 (93.2141%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4061/4362 (93.0995%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9744, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4103/4441 (92.3891%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4102/4441 (92.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9890, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4251/4663 (91.1645%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4347/4663 (93.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9637, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4756/5083 (93.5668%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4740/5083 (93.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9319, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4425/4767 (92.8257%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4419/4767 (92.6998%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0553, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3461/3797 (91.1509%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3549/3797 (93.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8484, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4794/5195 (92.2810%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4720/5195 (90.8566%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0778, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4386/4618 (94.9762%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4286/4618 (92.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9910, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4066/4433 (91.7212%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4059/4433 (91.5633%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9528, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4660/5055 (92.1860%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4686/5055 (92.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9117, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3749/4158 (90.1635%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3830/4158 (92.1116%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9722, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3465/3781 (91.6424%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3486/3781 (92.1978%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9163, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3820/4175 (91.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8593, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4834/5265 (91.8139%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4857/5265 (92.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8603, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3508/3837 (91.4256%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9058, Accuracy: 5617/10000 (56.1700%)
time spent on training: 257.36319184303284
users count: 20 and corrupted count: 4.
Selected 16 users with smallest Krum scores.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
 max_rate for 10 = 0.5454545454545454.
Suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Performing suspicious analysis across clients.
