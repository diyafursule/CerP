current path: saved_models/model_cifar100_Nov.06_22.49.08_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4307/4885 (88.1679%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439917606485906. Distance: 2.293391901902169
Total norm for 4 adversaries is: 42.439917606485906. distance: 2.293391901902169
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4488, Accuracy: 8812/9900 (89.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43535697368852. Distance: 2.2516252158204106
Total norm for 4 adversaries is: 42.43535697368852. distance: 2.2516252158204106
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7208, Accuracy: 8324/9900 (84.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43868509022752. Distance: 2.1781486083055217
Total norm for 4 adversaries is: 42.43868509022752. distance: 2.1781486083055217
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4362, Accuracy: 8873/9900 (89.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44038788038465. Distance: 2.30392226106572
Total norm for 4 adversaries is: 42.44038788038465. distance: 2.30392226106572
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6049, Accuracy: 8497/9900 (85.8283%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3677/4356 (84.4123%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4165, Accuracy: 4705/10000 (47.0500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3940/4465 (88.2419%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4097/4465 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9909, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4042/4647 (86.9808%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4175/4647 (89.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9993, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4447/5055 (87.9723%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4514/5055 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2009, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4442/5116 (86.8256%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4470/5116 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0188, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3628/4126 (87.9302%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3769/4126 (91.3476%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9896, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3081/3472 (88.7385%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3229/3472 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0311, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4432/4986 (88.8889%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4441/4986 (89.0694%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1917, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8195, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4039/4618 (87.4621%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4082/4618 (88.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0613, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4424/5083 (87.0352%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4422/5083 (86.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1281, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3976/4511 (88.1401%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4019/4511 (89.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2144, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3337/3797 (87.8852%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3392/3797 (89.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9779, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5010/5582 (89.7528%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5063/5582 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1088, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3156/3616 (87.2788%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3199/3616 (88.4679%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0811, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4827/5455 (88.4876%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4855/5455 (89.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9526, Accuracy: 5399/10000 (53.9900%)
time spent on training: 230.89788365364075
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1471, Accuracy: 6999/10000 (69.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8615, Accuracy: 69/9900 (0.6970%)
Done in 254.9857017993927 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 42.46519858449166.
Norm before scaling: 42.47163575552512. Distance: 2.157133059808719
Total norm for 4 adversaries is: 42.47163575552512. distance: 2.157133059808719
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1951, Accuracy: 9397/9900 (94.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.46519858449166.
Norm before scaling: 42.468353336999655. Distance: 2.211492138635823
Total norm for 4 adversaries is: 42.468353336999655. distance: 2.211492138635823
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4193, Accuracy: 8860/9900 (89.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4171/4717 (88.4248%), train_poison_data_count: 370
Global model norm: 42.46519858449166.
Norm before scaling: 42.47343350508571. Distance: 2.213935787045084
Total norm for 4 adversaries is: 42.47343350508571. distance: 2.213935787045084
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1973, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 42.46519858449166.
Norm before scaling: 42.475821764508716. Distance: 2.3530775493483147
Total norm for 4 adversaries is: 42.475821764508716. distance: 2.3530775493483147
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1803, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3595/4025 (89.3168%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3725/4025 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9013, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3322/3797 (87.4901%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3393/3797 (89.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0599, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3935/4625 (85.0811%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4026/4625 (87.0486%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2717, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3866/4481 (86.2754%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3870/4481 (86.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1965, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3836/4315 (88.8992%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3979/4315 (92.2132%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9633, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3706/4235 (87.5089%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3818/4235 (90.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0279, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3365/3828 (87.9049%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3469/3828 (90.6217%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9926, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3810/4416 (86.2772%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3936/4416 (89.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9202, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3155/3638 (86.7235%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3269/3638 (89.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9512, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4540/5265 (86.2298%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4523/5265 (85.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9958, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3338/3781 (88.2835%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3348/3781 (88.5480%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2448, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3953/4441 (89.0115%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4015/4441 (90.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2226, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4016/4433 (90.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9411, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4394/5083 (86.4450%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4456/5083 (87.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0362, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4322/4928 (87.7029%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0018, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4161/4793 (86.8141%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9923, Accuracy: 5426/10000 (54.2600%)
time spent on training: 228.06659603118896
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1484, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.4564, Accuracy: 82/9900 (0.8283%)
Done in 252.01024103164673 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.50168597299259.
Norm before scaling: 42.50355281565442. Distance: 2.1136691994228007
Total norm for 4 adversaries is: 42.50355281565442. distance: 2.1136691994228007
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1979, Accuracy: 9375/9900 (94.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 42.50168597299259.
Norm before scaling: 42.50525157122132. Distance: 2.19889967451791
Total norm for 4 adversaries is: 42.50525157122132. distance: 2.19889967451791
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0780, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.50168597299259.
Norm before scaling: 42.50433112122222. Distance: 2.0884654981719097
Total norm for 4 adversaries is: 42.50433112122222. distance: 2.0884654981719097
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1814, Accuracy: 9413/9900 (95.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 42.50168597299259.
Norm before scaling: 42.508269818115245. Distance: 2.262526504614262
Total norm for 4 adversaries is: 42.508269818115245. distance: 2.262526504614262
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1582, Accuracy: 9482/9900 (95.7778%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3124/3616 (86.3938%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3281/3616 (90.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8170, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9553, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4281/4679 (91.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0164, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3101/3638 (85.2391%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3267/3638 (89.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0348, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3611/4046 (89.2486%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3653/4046 (90.2867%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0413, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3974/4518 (87.9593%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4081/4518 (90.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1469, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3357/3797 (88.4119%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3404/3797 (89.6497%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0822, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4435/5025 (88.2587%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4468/5025 (88.9154%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2638, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3888/4362 (89.1334%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3913/4362 (89.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1080, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3969/4558 (87.0777%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4001/4558 (87.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2615, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3201/3672 (87.1732%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3281/3672 (89.3519%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0852, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4305/4874 (88.3258%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4368/4874 (89.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0558, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3603/4025 (89.5155%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9096, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4098/4663 (87.8833%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0630, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3441/3911 (87.9826%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3428/3911 (87.6502%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9651, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4423/5017 (88.1603%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4561/5017 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8364, Accuracy: 5660/10000 (56.6000%)
time spent on training: 225.76481866836548
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.2004, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.5889, Accuracy: 51/9900 (0.5152%)
Done in 250.47278475761414 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.53241095265248.
Norm before scaling: 42.53622077859057. Distance: 2.116403244427602
Total norm for 4 adversaries is: 42.53622077859057. distance: 2.116403244427602
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5417, Accuracy: 8693/9900 (87.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 42.53241095265248.
Norm before scaling: 42.53200914320663. Distance: 2.16758996902175
Total norm for 4 adversaries is: 42.53200914320663. distance: 2.16758996902175
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0891, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 42.53241095265248.
Norm before scaling: 42.5344256827815. Distance: 2.089362828900772
Total norm for 4 adversaries is: 42.5344256827815. distance: 2.089362828900772
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1742, Accuracy: 9450/9900 (95.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4465/5066 (88.1366%), train_poison_data_count: 400
Global model norm: 42.53241095265248.
Norm before scaling: 42.539543873539. Distance: 2.2792402847181727
Total norm for 4 adversaries is: 42.539543873539. distance: 2.2792402847181727
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2746, Accuracy: 9192/9900 (92.8485%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5260/6124 (85.8916%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5318/6124 (86.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1558, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3870/4356 (88.8430%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3654/4356 (83.8843%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.5393, Accuracy: 4757/10000 (47.5700%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3511/4158 (84.4396%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3600/4158 (86.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1077, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4869/5455 (89.2576%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4871/5455 (89.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9590, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3897/4511 (86.3888%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4038/4511 (89.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0182, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4506/5232 (86.1239%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4520/5232 (86.3914%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2288, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4490/5244 (85.6217%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4519/5244 (86.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0631, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4370/4918 (88.8573%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4408/4918 (89.6299%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0689, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3588/4126 (86.9607%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3727/4126 (90.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.7995, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4341/4928 (88.0885%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4424/4928 (89.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0370, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3713/4223 (87.9233%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3843/4223 (91.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9615, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4513/5195 (86.8720%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4630/5195 (89.1242%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1745, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4135/4679 (88.3736%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4126/4679 (88.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9983, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3160/3646 (86.6703%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3293/3646 (90.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8717, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3148/3616 (87.0575%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3210/3616 (88.7721%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8962, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4041/4716 (85.6870%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4131/4716 (87.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0323, Accuracy: 5301/10000 (53.0100%)
time spent on training: 232.900470495224
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2373, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.5322, Accuracy: 50/9900 (0.5051%)
Done in 257.3690593242645 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 42.571364142130506.
Norm before scaling: 42.57622128771675. Distance: 2.139222514017076
Total norm for 4 adversaries is: 42.57622128771675. distance: 2.139222514017076
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1666, Accuracy: 9486/9900 (95.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 42.571364142130506.
Norm before scaling: 42.56717175627393. Distance: 2.1538156229517185
Total norm for 4 adversaries is: 42.56717175627393. distance: 2.1538156229517185
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1481, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4205/4717 (89.1456%), train_poison_data_count: 370
Global model norm: 42.571364142130506.
Norm before scaling: 42.57382862497878. Distance: 2.1086321617718076
Total norm for 4 adversaries is: 42.57382862497878. distance: 2.1086321617718076
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1960, Accuracy: 9416/9900 (95.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4475/5066 (88.3340%), train_poison_data_count: 400
Global model norm: 42.571364142130506.
Norm before scaling: 42.58139178981604. Distance: 2.309981547030112
Total norm for 4 adversaries is: 42.58139178981604. distance: 2.309981547030112
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2038, Accuracy: 9357/9900 (94.5152%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5252/6124 (85.7609%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5363/6124 (87.5735%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9953, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3904/4433 (88.0668%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3976/4433 (89.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0968, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3374/3781 (89.2357%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3214/3781 (85.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2579, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3529/3969 (88.9141%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3599/3969 (90.6778%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9226, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4446/5025 (88.4776%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4509/5025 (89.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1633, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4158/4679 (88.8651%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4195/4679 (89.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9641, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4134/4707 (87.8266%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9089, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4402/4986 (88.2872%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4425/4986 (88.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8947, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3881/4315 (89.9421%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3972/4315 (92.0510%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8931, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3800/4416 (86.0507%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3929/4416 (88.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9557, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4272/4804 (88.9259%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4053/4804 (84.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1431, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4151/4793 (86.6055%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4255/4793 (88.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0792, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4498/5232 (85.9709%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4544/5232 (86.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9307, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4073/4662 (87.3659%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4205/4662 (90.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1259, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4226/4956 (85.2704%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4330/4956 (87.3688%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0974, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3815/4368 (87.3397%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3869/4368 (88.5760%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9304, Accuracy: 5453/10000 (54.5300%)
time spent on training: 234.34367561340332
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2428, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.3383, Accuracy: 60/9900 (0.6061%)
Done in 258.7401638031006 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4365/4885 (89.3552%), train_poison_data_count: 385
Global model norm: 42.60984770089832.
Norm before scaling: 42.61386114997531. Distance: 2.160643593308412
Total norm for 4 adversaries is: 42.61386114997531. distance: 2.160643593308412
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2659, Accuracy: 9222/9900 (93.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 42.60984770089832.
Norm before scaling: 42.611543651266025. Distance: 2.198404218886768
Total norm for 4 adversaries is: 42.611543651266025. distance: 2.198404218886768
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2271, Accuracy: 9346/9900 (94.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 42.60984770089832.
Norm before scaling: 42.60938216217395. Distance: 2.0581686605252876
Total norm for 4 adversaries is: 42.60938216217395. distance: 2.0581686605252876
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2328, Accuracy: 9281/9900 (93.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.60984770089832.
Norm before scaling: 42.61975029530763. Distance: 2.2885589566544917
Total norm for 4 adversaries is: 42.61975029530763. distance: 2.2885589566544917
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1897, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5283/6124 (86.2671%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5350/6124 (87.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1276, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5063/5902 (85.7845%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5118/5902 (86.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0319, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4170/4707 (88.5915%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4244/4707 (90.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9117, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4066/4647 (87.4973%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8871, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2916/3297 (88.4440%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3012/3297 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8114, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5549/6263 (88.5997%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5649/6263 (90.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2892, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4130/4663 (88.5696%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4235/4663 (90.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0875, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4297/4956 (86.7030%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4385/4956 (88.4786%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0724, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3589/4046 (88.7049%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3706/4046 (91.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8898, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3685/4184 (88.0736%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3786/4184 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8024, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4819/5591 (86.1921%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4890/5591 (87.4620%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1813, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4181/4634 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9082, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3317/3828 (86.6510%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3500/3828 (91.4316%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8985, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3097/3638 (85.1292%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3255/3638 (89.4722%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8971, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3366/3781 (89.0241%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3400/3781 (89.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0816, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3375/3837 (87.9593%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3517/3837 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8815, Accuracy: 5636/10000 (56.3600%)
time spent on training: 230.23441362380981
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2351, Accuracy: 6820/10000 (68.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.0539, Accuracy: 96/9900 (0.9697%)
Done in 254.297504901886 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 42.65498939300287.
Norm before scaling: 42.657612157738036. Distance: 2.118414716720459
Total norm for 4 adversaries is: 42.657612157738036. distance: 2.118414716720459
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1976, Accuracy: 9423/9900 (95.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.65498939300287.
Norm before scaling: 42.656364468710876. Distance: 2.1658763789143216
Total norm for 4 adversaries is: 42.656364468710876. distance: 2.1658763789143216
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1435, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 42.65498939300287.
Norm before scaling: 42.6565175701315. Distance: 2.0816521791555163
Total norm for 4 adversaries is: 42.6565175701315. distance: 2.0816521791555163
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1305, Accuracy: 9571/9900 (96.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 42.65498939300287.
Norm before scaling: 42.659279024780325. Distance: 2.230791646429916
Total norm for 4 adversaries is: 42.659279024780325. distance: 2.230791646429916
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1831, Accuracy: 9442/9900 (95.3737%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3868/4501 (85.9365%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3950/4501 (87.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1020, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3654/4175 (87.5210%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3735/4175 (89.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8413, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3124/3616 (86.3938%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3217/3616 (88.9657%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0152, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4049/4634 (87.3759%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4145/4634 (89.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9762, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3956/4558 (86.7925%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3974/4558 (87.1874%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0386, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4546/5167 (87.9814%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4605/5167 (89.1233%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1589, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3936/4356 (90.3581%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3924/4356 (90.0826%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0835, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4106/4716 (87.0653%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4146/4716 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9856, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5309/6124 (86.6917%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5263/6124 (85.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0528, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4403/5055 (87.1019%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4525/5055 (89.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0995, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4464/5025 (88.8358%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4558/5025 (90.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2362, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4312/4918 (87.6779%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4384/4918 (89.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2428, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3689/4223 (87.3550%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3797/4223 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9595, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3964/4481 (88.4624%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3984/4481 (88.9087%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0754, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3167/3638 (87.0533%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3282/3638 (90.2144%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9597, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3569/4013 (88.9360%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3681/4013 (91.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9192, Accuracy: 5572/10000 (55.7200%)
time spent on training: 233.29293966293335
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2124, Accuracy: 6859/10000 (68.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.6883, Accuracy: 54/9900 (0.5455%)
Done in 257.89751172065735 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4421/4885 (90.5015%), train_poison_data_count: 385
Global model norm: 42.7003578045972.
Norm before scaling: 42.70232744864441. Distance: 2.090377368716026
Total norm for 4 adversaries is: 42.70232744864441. distance: 2.090377368716026
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2775, Accuracy: 9214/9900 (93.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.7003578045972.
Norm before scaling: 42.70038925100683. Distance: 2.1673131002872
Total norm for 4 adversaries is: 42.70038925100683. distance: 2.1673131002872
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2516, Accuracy: 9293/9900 (93.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.7003578045972.
Norm before scaling: 42.70181860881337. Distance: 2.059173907590532
Total norm for 4 adversaries is: 42.70181860881337. distance: 2.059173907590532
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2901, Accuracy: 9185/9900 (92.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 42.7003578045972.
Norm before scaling: 42.70687672185754. Distance: 2.261026701521925
Total norm for 4 adversaries is: 42.70687672185754. distance: 2.261026701521925
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1150, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3177/3646 (87.1366%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3294/3646 (90.3456%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7743, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3910/4501 (86.8696%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4062/4501 (90.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0663, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4036/4651 (86.7770%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4164/4651 (89.5291%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9607, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4550/5167 (88.0588%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4681/5167 (90.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0804, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4832/5455 (88.5793%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4902/5455 (89.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0466, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4845/5591 (86.6571%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4908/5591 (87.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0138, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4165/4679 (89.0147%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3973/4679 (84.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1582, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4463/5017 (88.9575%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4510/5017 (89.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9775, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4208/4793 (87.7947%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4287/4793 (89.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0981, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4002/4456 (89.8115%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4456 (91.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9951, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4786/5424 (88.2375%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4940/5424 (91.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2229, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3609/4175 (86.4431%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3648/4175 (87.3772%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9808, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4478/5116 (87.5293%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4571/5116 (89.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0336, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3261/3704 (88.0400%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3348/3704 (90.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8870, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5232 (85.1682%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4638/5232 (88.6468%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0507, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3088/3472 (88.9401%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3155/3472 (90.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0001, Accuracy: 5524/10000 (55.2400%)
time spent on training: 231.82598543167114
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2463, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.8543, Accuracy: 63/9900 (0.6364%)
Done in 255.4324243068695 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.73978056534027.
Norm before scaling: 42.742013999602165. Distance: 2.0952688373337454
Total norm for 4 adversaries is: 42.742013999602165. distance: 2.0952688373337454
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.4302, Accuracy: 8839/9900 (89.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 42.73978056534027.
Norm before scaling: 42.74006760530744. Distance: 2.2110265707130083
Total norm for 4 adversaries is: 42.74006760530744. distance: 2.2110265707130083
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2169, Accuracy: 9379/9900 (94.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 42.73978056534027.
Norm before scaling: 42.740051896702376. Distance: 2.052811378900295
Total norm for 4 adversaries is: 42.740051896702376. distance: 2.052811378900295
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2164, Accuracy: 9352/9900 (94.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 42.73978056534027.
Norm before scaling: 42.745870825803166. Distance: 2.2468781536223412
Total norm for 4 adversaries is: 42.745870825803166. distance: 2.2468781536223412
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3083, Accuracy: 9095/9900 (91.8687%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3305/3590 (92.0613%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9517, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3821/4368 (87.4771%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3922/4368 (89.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9248, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3239/3704 (87.4460%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3354/3704 (90.5508%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8821, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4321/4928 (87.6826%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4389/4928 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9946, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3975/4356 (91.2534%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3949/4356 (90.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9916, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3530/3911 (90.2582%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3473/3911 (88.8008%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1250, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4082/4651 (87.7661%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4173/4651 (89.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0552, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3711/4184 (88.6950%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3770/4184 (90.1052%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8316, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3907/4346 (89.8988%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4010/4346 (92.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9707, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4364/4793 (91.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9662, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3339/3804 (87.7760%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0483, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4450/4986 (89.2499%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4489/4986 (90.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9462, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5451/6124 (89.0105%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5405/6124 (88.2593%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9890, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4136/4707 (87.8691%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4246/4707 (90.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9057, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3785/4235 (89.3743%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3689/4235 (87.1074%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9753, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3629/4046 (89.6935%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3734/4046 (92.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9425, Accuracy: 5507/10000 (55.0700%)
time spent on training: 229.33444380760193
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2334, Accuracy: 6803/10000 (68.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.8472, Accuracy: 60/9900 (0.6061%)
Done in 252.90873336791992 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 42.78389640965614.
Norm before scaling: 42.785847942744894. Distance: 2.128172693824444
Total norm for 4 adversaries is: 42.785847942744894. distance: 2.128172693824444
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1263, Accuracy: 9573/9900 (96.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 42.78389640965614.
Norm before scaling: 42.78578374899337. Distance: 2.179157260949847
Total norm for 4 adversaries is: 42.78578374899337. distance: 2.179157260949847
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1281, Accuracy: 9585/9900 (96.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 42.78389640965614.
Norm before scaling: 42.78249832683848. Distance: 2.037426288418137
Total norm for 4 adversaries is: 42.78249832683848. distance: 2.037426288418137
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3701, Accuracy: 9031/9900 (91.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4474/5066 (88.3143%), train_poison_data_count: 400
Global model norm: 42.78389640965614.
Norm before scaling: 42.79096744093606. Distance: 2.2926825843577188
Total norm for 4 adversaries is: 42.79096744093606. distance: 2.2926825843577188
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3116, Accuracy: 9097/9900 (91.8889%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4423/4986 (88.7084%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4528/4986 (90.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8980, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4066/4634 (87.7428%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4155/4634 (89.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9256, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4121/4716 (87.3834%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4218/4716 (89.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9857, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5533/6124 (90.3494%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5543/6124 (90.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0792, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4350/4918 (88.4506%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4506/4918 (91.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0451, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3435/3797 (90.4662%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0976, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4987/5582 (89.3407%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1191, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4309/4956 (86.9451%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4338/4956 (87.5303%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0536, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3940/4433 (88.8789%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4012/4433 (90.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9489, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3839/4354 (88.1718%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3332/4354 (76.5273%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.5654, Accuracy: 4513/10000 (45.1300%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4289/4928 (87.0333%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4435/4928 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9711, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3508/3911 (89.6957%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3477/3911 (88.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0282, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3891/4481 (86.8333%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3944/4481 (88.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0329, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4568/5197 (87.8969%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4654/5197 (89.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0427, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4808/5455 (88.1393%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4869/5455 (89.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1142, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3788/4361 (86.8608%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3781/4361 (86.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2289, Accuracy: 5121/10000 (51.2100%)
time spent on training: 232.3727765083313
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.2862, Accuracy: 6704/10000 (67.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 10.2911, Accuracy: 48/9900 (0.4848%)
Done in 256.1599688529968 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.83027972507447.
Norm before scaling: 42.83302712733044. Distance: 2.108755628287736
Total norm for 4 adversaries is: 42.83302712733044. distance: 2.108755628287736
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2008, Accuracy: 9431/9900 (95.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.83027972507447.
Norm before scaling: 42.82907126827671. Distance: 2.156625023999449
Total norm for 4 adversaries is: 42.82907126827671. distance: 2.156625023999449
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2541, Accuracy: 9269/9900 (93.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.83027972507447.
Norm before scaling: 42.82861096267526. Distance: 2.0601179065108886
Total norm for 4 adversaries is: 42.82861096267526. distance: 2.0601179065108886
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1511, Accuracy: 9514/9900 (96.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4453/5066 (87.8997%), train_poison_data_count: 400
Global model norm: 42.83027972507447.
Norm before scaling: 42.83512888508172. Distance: 2.2721358830288443
Total norm for 4 adversaries is: 42.83512888508172. distance: 2.2721358830288443
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2668, Accuracy: 9220/9900 (93.1313%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4327/4928 (87.8044%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4381/4928 (88.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9490, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3715/4184 (88.7906%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3761/4184 (89.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9659, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4181/4707 (88.8252%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4257/4707 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0484, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3381/3828 (88.3229%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3502/3828 (91.4838%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9093, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3925/4503 (87.1641%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4040/4503 (89.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9061, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4128/4662 (88.5457%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4246/4662 (91.0768%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0107, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3724/4235 (87.9339%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3859/4235 (91.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9277, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4408/5244 (84.0580%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4539/5244 (86.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9780, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4187/4793 (87.3566%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9180, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4481 (88.8195%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3918/4481 (87.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2081, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3889/4346 (89.4846%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7791, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3809/4361 (87.3424%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3829/4361 (87.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1134, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4470/5055 (88.4273%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4573/5055 (90.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8589, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4491/5195 (86.4485%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4529/5195 (87.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1714, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3872/4315 (89.7335%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3999/4315 (92.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8993, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4171/4663 (89.4489%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4270/4663 (91.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1632, Accuracy: 5271/10000 (52.7100%)
time spent on training: 231.86477279663086
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.2923, Accuracy: 6695/10000 (66.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 10.3297, Accuracy: 41/9900 (0.4141%)
Done in 255.64543342590332 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.86873160491295.
Norm before scaling: 42.869511823034706. Distance: 2.0639718323862932
Total norm for 4 adversaries is: 42.869511823034706. distance: 2.0639718323862932
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2125, Accuracy: 9387/9900 (94.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4735/5305 (89.2554%), train_poison_data_count: 415
Global model norm: 42.86873160491295.
Norm before scaling: 42.871297159255484. Distance: 2.196984139956013
Total norm for 4 adversaries is: 42.871297159255484. distance: 2.196984139956013
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3761, Accuracy: 9018/9900 (91.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.86873160491295.
Norm before scaling: 42.8655137669877. Distance: 2.0052258643502796
Total norm for 4 adversaries is: 42.8655137669877. distance: 2.0052258643502796
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1976, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4470/5066 (88.2353%), train_poison_data_count: 400
Global model norm: 42.86873160491295.
Norm before scaling: 42.874803548201534. Distance: 2.2506593162083632
Total norm for 4 adversaries is: 42.874803548201534. distance: 2.2506593162083632
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2010, Accuracy: 9387/9900 (94.8182%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3896/4315 (90.2897%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3944/4315 (91.4021%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9382, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3194/3590 (88.9694%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3260/3590 (90.8078%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0821, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4250/4679 (90.8314%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4374/4679 (93.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8846, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5167 (88.3491%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4673/5167 (90.4393%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0455, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3305/3775 (87.5497%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3517/3775 (93.1656%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8716, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3382/3828 (88.3490%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3481/3828 (90.9352%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8812, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3746/4235 (88.4534%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3885/4235 (91.7355%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8707, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4099/4647 (88.2074%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4208/4647 (90.5530%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9674, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4323/4918 (87.9016%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4412/4918 (89.7113%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0840, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3944/4433 (88.9691%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4017/4433 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9386, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3970/4481 (88.5963%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3950/4481 (88.1500%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0259, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3771/4295 (87.7998%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3776/4295 (87.9162%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0900, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3964/4503 (88.0302%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4073/4503 (90.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9086, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3921/4354 (90.0551%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3822/4354 (87.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3096, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4422/4986 (88.6883%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4444/4986 (89.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9408, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5555/6263 (88.6955%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5700/6263 (91.0107%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9319, Accuracy: 5524/10000 (55.2400%)
time spent on training: 229.70112299919128
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3539, Accuracy: 6600/10000 (66.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 10.1604, Accuracy: 59/9900 (0.5960%)
Done in 253.5638816356659 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.902518558154746.
Norm before scaling: 42.90196514474891. Distance: 2.099231888304392
Total norm for 4 adversaries is: 42.90196514474891. distance: 2.099231888304392
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1901, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4688/5305 (88.3695%), train_poison_data_count: 415
Global model norm: 42.902518558154746.
Norm before scaling: 42.90739227130259. Distance: 2.336565628570058
Total norm for 4 adversaries is: 42.90739227130259. distance: 2.336565628570058
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1015, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.902518558154746.
Norm before scaling: 42.90244458042645. Distance: 2.06319704703674
Total norm for 4 adversaries is: 42.90244458042645. distance: 2.06319704703674
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1563, Accuracy: 9508/9900 (96.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 42.902518558154746.
Norm before scaling: 42.90678202055445. Distance: 2.2408120857991474
Total norm for 4 adversaries is: 42.90678202055445. distance: 2.2408120857991474
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1216, Accuracy: 9601/9900 (96.9798%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3716/4223 (87.9943%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9763, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4863/5455 (89.1476%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4896/5455 (89.7525%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1057, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4991/5582 (89.4124%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5101/5582 (91.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1428, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3953/4465 (88.5330%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4072/4465 (91.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8623, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4894/5591 (87.5335%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4990/5591 (89.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1028, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3513/3911 (89.8236%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3422/3911 (87.4968%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9409, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3914/4356 (89.8531%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3287/4356 (75.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3272, Accuracy: 4780/10000 (47.8000%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4411/5037 (87.5720%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4540/5037 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9771, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4240/4679 (90.6177%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4340/4679 (92.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9978, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3913/4362 (89.7066%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3913/4362 (89.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1084, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4069/4518 (90.0620%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4146/4518 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9525, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4481/5083 (88.1566%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4549/5083 (89.4944%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9902, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3554/4013 (88.5622%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8680, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4551/5197 (87.5698%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4664/5197 (89.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0246, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2918/3297 (88.5047%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3051/3297 (92.5387%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7973, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3963/4441 (89.2367%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4045/4441 (91.0831%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0871, Accuracy: 5368/10000 (53.6800%)
time spent on training: 234.15044689178467
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4120, Accuracy: 6559/10000 (65.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.9518, Accuracy: 58/9900 (0.5859%)
Done in 257.8186082839966 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 42.946549662687545.
Norm before scaling: 42.94762833145592. Distance: 2.1223535326777387
Total norm for 4 adversaries is: 42.94762833145592. distance: 2.1223535326777387
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2634, Accuracy: 9292/9900 (93.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 42.946549662687545.
Norm before scaling: 42.945691256061274. Distance: 2.1984819766970056
Total norm for 4 adversaries is: 42.945691256061274. distance: 2.1984819766970056
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2791, Accuracy: 9257/9900 (93.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.946549662687545.
Norm before scaling: 42.945959865277196. Distance: 2.065858476287539
Total norm for 4 adversaries is: 42.945959865277196. distance: 2.065858476287539
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3702, Accuracy: 8975/9900 (90.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4447/5066 (87.7813%), train_poison_data_count: 400
Global model norm: 42.946549662687545.
Norm before scaling: 42.95005701347715. Distance: 2.2957006034168663
Total norm for 4 adversaries is: 42.95005701347715. distance: 2.2957006034168663
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3642, Accuracy: 8989/9900 (90.7980%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3936/4501 (87.4472%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4084/4501 (90.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0003, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3938/4511 (87.2977%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4082/4511 (90.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9210, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3980/4354 (91.4102%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3512/4354 (80.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.8402, Accuracy: 4230/10000 (42.3000%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3884/4346 (89.3695%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4044/4346 (93.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8884, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4137/4707 (87.8904%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8828, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4886/5591 (87.3904%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4907/5591 (87.7661%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1007, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4063/4647 (87.4328%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4215/4647 (90.7037%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.7849, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4017/4538 (88.5192%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4162/4538 (91.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8933, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4312/4934 (87.3936%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4372/4934 (88.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0158, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4333/4804 (90.1957%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4362/4804 (90.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0795, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5562/6263 (88.8073%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1645, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3945/4481 (88.0384%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3997/4481 (89.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9869, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4317/5063 (85.2657%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4449/5063 (87.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9429, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3675/4223 (87.0234%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3908/4223 (92.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9813, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3964/4441 (89.2592%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4074/4441 (91.7361%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0457, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3335/3756 (88.7913%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3469/3756 (92.3589%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9948, Accuracy: 5509/10000 (55.0900%)
time spent on training: 232.85717630386353
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4508, Accuracy: 6469/10000 (64.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 10.4344, Accuracy: 50/9900 (0.5051%)
Done in 256.56678891181946 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4885 (89.2119%), train_poison_data_count: 385
Global model norm: 42.98900374932379.
Norm before scaling: 42.992433813804666. Distance: 2.1956306851403276
Total norm for 4 adversaries is: 42.992433813804666. distance: 2.1956306851403276
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1702, Accuracy: 9497/9900 (95.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 42.98900374932379.
Norm before scaling: 42.98881917683655. Distance: 2.279858726675544
Total norm for 4 adversaries is: 42.98881917683655. distance: 2.279858726675544
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0831, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.98900374932379.
Norm before scaling: 42.99269077367614. Distance: 2.1360008247102438
Total norm for 4 adversaries is: 42.99269077367614. distance: 2.1360008247102438
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2250, Accuracy: 9321/9900 (94.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4459/5066 (88.0182%), train_poison_data_count: 400
Global model norm: 42.98900374932379.
Norm before scaling: 42.99687289910236. Distance: 2.3219054434463224
Total norm for 4 adversaries is: 42.99687289910236. distance: 2.3219054434463224
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2644, Accuracy: 9234/9900 (93.2727%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4383/5244 (83.5812%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4556/5244 (86.8802%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9504, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4292/4928 (87.0942%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4446/4928 (90.2192%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8398, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3344/3804 (87.9075%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3469/3804 (91.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9346, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3542/4013 (88.2631%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3633/4013 (90.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9099, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3529/4158 (84.8725%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3626/4158 (87.2054%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8888, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4949/5582 (88.6600%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5051/5582 (90.4873%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9254, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4820/5455 (88.3593%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4956/5455 (90.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9468, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4025/4354 (92.4437%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3769/4354 (86.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3570, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3909/4433 (88.1796%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3984/4433 (89.8714%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9984, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3151/3646 (86.4235%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3339/3646 (91.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8253, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4014/4518 (88.8446%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4136/4518 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9251, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3735/4235 (88.1936%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3787/4235 (89.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2287, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3912/4362 (89.6836%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3984/4362 (91.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9436, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4729/5392 (87.7040%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4792/5392 (88.8724%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0536, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4813/5591 (86.0848%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4922/5591 (88.0343%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1491, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3317/3756 (88.3120%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3441/3756 (91.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0069, Accuracy: 5516/10000 (55.1600%)
time spent on training: 231.10910654067993
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.5721, Accuracy: 6256/10000 (62.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 11.3889, Accuracy: 13/9900 (0.1313%)
Done in 256.3756172657013 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 43.02343962797344.
Norm before scaling: 43.02767266811412. Distance: 2.2049802719583096
Total norm for 4 adversaries is: 43.02767266811412. distance: 2.2049802719583096
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2216, Accuracy: 9340/9900 (94.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4689/5305 (88.3883%), train_poison_data_count: 415
Global model norm: 43.02343962797344.
Norm before scaling: 43.02598744599739. Distance: 2.3114527831341154
Total norm for 4 adversaries is: 43.02598744599739. distance: 2.3114527831341154
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0480, Accuracy: 9765/9900 (98.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4160/4717 (88.1916%), train_poison_data_count: 370
Global model norm: 43.02343962797344.
Norm before scaling: 43.02680595016829. Distance: 2.198817160547365
Total norm for 4 adversaries is: 43.02680595016829. distance: 2.198817160547365
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1304, Accuracy: 9583/9900 (96.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4421/5066 (87.2681%), train_poison_data_count: 400
Global model norm: 43.02343962797344.
Norm before scaling: 43.03085284856669. Distance: 2.3914235096669705
Total norm for 4 adversaries is: 43.03085284856669. distance: 2.3914235096669705
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1478, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4071/4634 (87.8507%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4181/4634 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9700, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3962/4503 (87.9858%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4027/4503 (89.4293%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9496, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4282/4928 (86.8912%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4484/4928 (90.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7531, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3310/3804 (87.0137%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3438/3804 (90.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0654, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3145/3590 (87.6045%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3044/3590 (84.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2819, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4028/4647 (86.6796%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4238/4647 (91.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8732, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3951/4625 (85.4270%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4050/4625 (87.5676%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0396, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3973/4356 (91.2075%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4036/4356 (92.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9278, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3314/3797 (87.2794%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3448/3797 (90.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9252, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3975/4456 (89.2056%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4092/4456 (91.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9282, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/4025 (87.8509%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3725/4025 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9086, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3059/3472 (88.1048%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3137/3472 (90.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9746, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2851/3297 (86.4726%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3023/3297 (91.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8991, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3819/4416 (86.4810%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4000/4416 (90.5797%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9378, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3936/4356 (90.3581%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4086/4356 (93.8017%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9600, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3145/3638 (86.4486%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3328/3638 (91.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8562, Accuracy: 5591/10000 (55.9100%)
time spent on training: 225.02427625656128
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.5574, Accuracy: 6292/10000 (62.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 11.2442, Accuracy: 16/9900 (0.1616%)
Done in 248.93718910217285 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4331/4885 (88.6592%), train_poison_data_count: 385
Global model norm: 43.05181601633882.
Norm before scaling: 43.05491360968571. Distance: 2.2672247138935733
Total norm for 4 adversaries is: 43.05491360968571. distance: 2.2672247138935733
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1989, Accuracy: 9433/9900 (95.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4699/5305 (88.5768%), train_poison_data_count: 415
Global model norm: 43.05181601633882.
Norm before scaling: 43.05404176956343. Distance: 2.2613078058634315
Total norm for 4 adversaries is: 43.05404176956343. distance: 2.2613078058634315
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2031, Accuracy: 9436/9900 (95.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4179/4717 (88.5944%), train_poison_data_count: 370
Global model norm: 43.05181601633882.
Norm before scaling: 43.04976311772444. Distance: 2.1154071599919404
Total norm for 4 adversaries is: 43.04976311772444. distance: 2.1154071599919404
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1449, Accuracy: 9542/9900 (96.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4446/5066 (87.7615%), train_poison_data_count: 400
Global model norm: 43.05181601633882.
Norm before scaling: 43.061599965648774. Distance: 2.3454542957114906
Total norm for 4 adversaries is: 43.061599965648774. distance: 2.3454542957114906
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0789, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3586/4175 (85.8922%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3717/4175 (89.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9365, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4194/4956 (84.6247%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4431/4956 (89.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1676, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4395/5037 (87.2543%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4584/5037 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8772, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4116/4793 (85.8752%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4311/4793 (89.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9704, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3302/3804 (86.8034%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3423/3804 (89.9842%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9731, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4728/5392 (87.6855%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4871/5392 (90.3375%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9489, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3934/4465 (88.1075%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4068/4465 (91.1086%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0005, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4107/4596 (89.3603%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4214/4596 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9807, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5416/6124 (88.4389%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5494/6124 (89.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8867, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2815/3271 (86.0593%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2969/3271 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9357, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3256/3590 (90.6964%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3278/3590 (91.3092%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9538, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3812/4501 (84.6923%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4014/4501 (89.1802%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0775, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4504/5232 (86.0856%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4650/5232 (88.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1268, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3192/3672 (86.9281%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3291/3672 (89.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0065, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3706/4223 (87.7575%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3852/4223 (91.2148%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9374, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4112/4354 (94.4419%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0142, Accuracy: 3232/4354 (74.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.7981, Accuracy: 4224/10000 (42.2400%)
time spent on training: 229.61665177345276
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.5985, Accuracy: 6274/10000 (62.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.7945, Accuracy: 143/9900 (1.4444%)
Done in 253.41126561164856 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4357/4885 (89.1914%), train_poison_data_count: 385
Global model norm: 43.100967035265.
Norm before scaling: 43.104255087411325. Distance: 2.187500326974027
Total norm for 4 adversaries is: 43.104255087411325. distance: 2.187500326974027
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3737, Accuracy: 9014/9900 (91.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4687/5305 (88.3506%), train_poison_data_count: 415
Global model norm: 43.100967035265.
Norm before scaling: 43.10427207927742. Distance: 2.2563520413727405
Total norm for 4 adversaries is: 43.10427207927742. distance: 2.2563520413727405
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1645, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4141/4717 (87.7888%), train_poison_data_count: 370
Global model norm: 43.100967035265.
Norm before scaling: 43.10454678018318. Distance: 2.210012828910496
Total norm for 4 adversaries is: 43.10454678018318. distance: 2.210012828910496
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0885, Accuracy: 9678/9900 (97.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4438/5066 (87.6036%), train_poison_data_count: 400
Global model norm: 43.100967035265.
Norm before scaling: 43.10977284385105. Distance: 2.324626162427831
Total norm for 4 adversaries is: 43.10977284385105. distance: 2.324626162427831
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1919, Accuracy: 9449/9900 (95.4444%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4918/5582 (88.1046%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5041/5582 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0604, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3956/4647 (85.1302%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4173/4647 (89.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9868, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3891/4465 (87.1445%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4090/4465 (91.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9326, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4426/5083 (87.0746%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4489/5083 (88.3140%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1787, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3740/4416 (84.6920%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9312, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4197/4956 (84.6852%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4380/4956 (88.3777%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2106, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3859/4362 (88.4686%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3826/4362 (87.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0544, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3915/4356 (89.8760%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3926/4356 (90.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0647, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3296/3781 (87.1727%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3433/3781 (90.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1994, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3251/3590 (90.5571%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3295/3590 (91.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9481, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4073/4651 (87.5726%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4208/4651 (90.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0023, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4059/4662 (87.0656%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4237/4662 (90.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9380, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3043/3472 (87.6440%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3217/3472 (92.6555%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8733, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4809/5424 (88.6615%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1336, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2829/3271 (86.4873%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0065, Accuracy: 2848/3271 (87.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0598, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4327/5037 (85.9043%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4540/5037 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8859, Accuracy: 5596/10000 (55.9600%)
time spent on training: 230.10751032829285
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.5686, Accuracy: 6350/10000 (63.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.3693, Accuracy: 204/9900 (2.0606%)
Done in 253.785471200943 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4341/4885 (88.8639%), train_poison_data_count: 385
Global model norm: 43.13244670760488.
Norm before scaling: 43.13580593783139. Distance: 2.1889943059827166
Total norm for 4 adversaries is: 43.13580593783139. distance: 2.1889943059827166
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2489, Accuracy: 9257/9900 (93.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4693/5305 (88.4637%), train_poison_data_count: 415
Global model norm: 43.13244670760488.
Norm before scaling: 43.13385608794587. Distance: 2.3139817928893662
Total norm for 4 adversaries is: 43.13385608794587. distance: 2.3139817928893662
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1196, Accuracy: 9576/9900 (96.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 43.13244670760488.
Norm before scaling: 43.129332040115834. Distance: 2.0545918837661876
Total norm for 4 adversaries is: 43.129332040115834. distance: 2.0545918837661876
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3080, Accuracy: 9187/9900 (92.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4398/5066 (86.8141%), train_poison_data_count: 400
Global model norm: 43.13244670760488.
Norm before scaling: 43.14152904476512. Distance: 2.3668552077326863
Total norm for 4 adversaries is: 43.14152904476512. distance: 2.3668552077326863
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7482, Accuracy: 8129/9900 (82.1111%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4265/4989 (85.4881%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4443/4989 (89.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8665, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3550/4013 (88.4625%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3714/4013 (92.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9186, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4539/5195 (87.3725%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4447/5195 (85.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1175, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3438/3969 (86.6213%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3542/3969 (89.2416%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9278, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4077/4356 (93.5950%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4093/4356 (93.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9281, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3951/4441 (88.9664%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4050/4441 (91.1957%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9870, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4028/4518 (89.1545%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4161/4518 (92.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9212, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3440/3911 (87.9570%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3325/3911 (85.0166%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0900, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3846/4362 (88.1706%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3926/4362 (90.0046%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0640, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3325/3804 (87.4080%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0125, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3683/4223 (87.2129%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3837/4223 (90.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9504, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4064/4634 (87.6996%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4184/4634 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8973, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4142/4354 (95.1309%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3481/4354 (79.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.4319, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 4334/5244 (82.6468%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4566/5244 (87.0709%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8695, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4364/5037 (86.6389%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4563/5037 (90.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8927, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3171/3704 (85.6102%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8023, Accuracy: 5741/10000 (57.4100%)
time spent on training: 229.34786200523376
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5772, Accuracy: 6305/10000 (63.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 9.1577, Accuracy: 250/9900 (2.5253%)
Done in 252.861328125 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4354/4885 (89.1300%), train_poison_data_count: 385
Global model norm: 43.1754573477514.
Norm before scaling: 43.1768455336234. Distance: 2.1902843738371387
Total norm for 4 adversaries is: 43.1768455336234. distance: 2.1902843738371387
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2255, Accuracy: 9334/9900 (94.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4680/5305 (88.2187%), train_poison_data_count: 415
Global model norm: 43.1754573477514.
Norm before scaling: 43.17930655590057. Distance: 2.313039149763229
Total norm for 4 adversaries is: 43.17930655590057. distance: 2.313039149763229
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1563, Accuracy: 9540/9900 (96.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4158/4717 (88.1492%), train_poison_data_count: 370
Global model norm: 43.1754573477514.
Norm before scaling: 43.174865022679136. Distance: 2.1438460792831453
Total norm for 4 adversaries is: 43.174865022679136. distance: 2.1438460792831453
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1628, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4423/5066 (87.3075%), train_poison_data_count: 400
Global model norm: 43.1754573477514.
Norm before scaling: 43.18180842787345. Distance: 2.3220750684013245
Total norm for 4 adversaries is: 43.18180842787345. distance: 2.3220750684013245
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.3064, Accuracy: 9147/9900 (92.3939%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3786/4416 (85.7337%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3972/4416 (89.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8770, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4528/5197 (87.1272%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4648/5197 (89.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9086, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4276/4918 (86.9459%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0325, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5526/6263 (88.2325%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5665/6263 (90.4519%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1044, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3101/3646 (85.0521%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3268/3646 (89.6325%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8640, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4097/4707 (87.0406%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4277/4707 (90.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9073, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4321/5063 (85.3447%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4261/5063 (84.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3721, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3653/4295 (85.0524%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3884/4295 (90.4307%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0346, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4124/4793 (86.0421%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4304/4793 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0389, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4018/4538 (88.5412%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4177/4538 (92.0450%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8762, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4422/5083 (86.9959%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4518/5083 (88.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0090, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3125/3638 (85.8988%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3222/3638 (88.5651%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9322, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5406/6124 (88.2756%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5510/6124 (89.9739%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9614, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3997/4618 (86.5526%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4062/4618 (87.9602%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0102, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3471/3969 (87.4528%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3572/3969 (89.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8770, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3438/4158 (82.6840%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3652/4158 (87.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8672, Accuracy: 5535/10000 (55.3500%)
time spent on training: 236.05199575424194
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.5059, Accuracy: 6442/10000 (64.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.6163, Accuracy: 208/9900 (2.1010%)
Done in 264.255170583725 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4322/4885 (88.4749%), train_poison_data_count: 385
Global model norm: 43.21478849116281.
Norm before scaling: 43.21696206985025. Distance: 2.1443433557686604
Total norm for 4 adversaries is: 43.21696206985025. distance: 2.1443433557686604
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3013, Accuracy: 9155/9900 (92.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4678/5305 (88.1810%), train_poison_data_count: 415
Global model norm: 43.21478849116281.
Norm before scaling: 43.21514581862475. Distance: 2.290433089269293
Total norm for 4 adversaries is: 43.21514581862475. distance: 2.290433089269293
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1797, Accuracy: 9442/9900 (95.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4160/4717 (88.1916%), train_poison_data_count: 370
Global model norm: 43.21478849116281.
Norm before scaling: 43.21176450686636. Distance: 2.0933782902322324
Total norm for 4 adversaries is: 43.21176450686636. distance: 2.0933782902322324
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3034, Accuracy: 9090/9900 (91.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4426/5066 (87.3668%), train_poison_data_count: 400
Global model norm: 43.21478849116281.
Norm before scaling: 43.218824848543285. Distance: 2.324544829246683
Total norm for 4 adversaries is: 43.218824848543285. distance: 2.324544829246683
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3180, Accuracy: 9083/9900 (91.7475%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4048/4716 (85.8355%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4197/4716 (88.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0045, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3920/4481 (87.4805%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4007/4481 (89.4220%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1054, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3772/4361 (86.4939%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3755/4361 (86.1041%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1184, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4153/4793 (86.6472%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4340/4793 (90.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9579, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3721/4295 (86.6356%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3747/4295 (87.2410%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1705, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4377/5244 (83.4668%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4599/5244 (87.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9781, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4273/4989 (85.6484%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4456/4989 (89.3165%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8864, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4525/5197 (87.0695%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4595/5197 (88.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0315, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3705/4356 (85.0551%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3257, Accuracy: 4819/10000 (48.1900%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3999/4647 (86.0555%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4188/4647 (90.1227%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8651, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3552/4013 (88.5123%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3692/4013 (92.0010%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7277, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3983/4538 (87.7699%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4143/4538 (91.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8316, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4117/4707 (87.4655%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4224/4707 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8676, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5527/6263 (88.2484%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5711/6263 (91.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0142, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3736/4235 (88.2172%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3768/4235 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9949, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3349/3861 (86.7392%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0096, Accuracy: 5419/10000 (54.1900%)
time spent on training: 240.3611969947815
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.4988, Accuracy: 6447/10000 (64.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 9.2634, Accuracy: 292/9900 (2.9495%)
Done in 263.9986684322357 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4334/4885 (88.7206%), train_poison_data_count: 385
Global model norm: 43.245720976907066.
Norm before scaling: 43.247015172021555. Distance: 2.2229252603848013
Total norm for 4 adversaries is: 43.247015172021555. distance: 2.2229252603848013
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1589, Accuracy: 9479/9900 (95.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4676/5305 (88.1433%), train_poison_data_count: 415
Global model norm: 43.245720976907066.
Norm before scaling: 43.24990968198662. Distance: 2.2787491141028258
Total norm for 4 adversaries is: 43.24990968198662. distance: 2.2787491141028258
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2342, Accuracy: 9350/9900 (94.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4187/4717 (88.7640%), train_poison_data_count: 370
Global model norm: 43.245720976907066.
Norm before scaling: 43.24350508945679. Distance: 2.0998852925534583
Total norm for 4 adversaries is: 43.24350508945679. distance: 2.0998852925534583
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2022, Accuracy: 9396/9900 (94.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4424/5066 (87.3273%), train_poison_data_count: 400
Global model norm: 43.245720976907066.
Norm before scaling: 43.251162827576096. Distance: 2.353257490382223
Total norm for 4 adversaries is: 43.251162827576096. distance: 2.353257490382223
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1194, Accuracy: 9602/9900 (96.9899%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4468/5055 (88.3877%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4587/5055 (90.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8330, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3346/3828 (87.4086%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3521/3828 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9487, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3757/4361 (86.1500%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3857/4361 (88.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9579, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3550/4013 (88.4625%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9398, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3997/4518 (88.4683%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4152/4518 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8290, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3973/4558 (87.1654%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4042/4558 (88.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0742, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3608/4126 (87.4455%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3776/4126 (91.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8258, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4210/4679 (89.9765%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3997/4679 (85.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0620, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3751/4235 (88.5714%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3779/4235 (89.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0322, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4333/5037 (86.0234%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4604/5037 (91.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8991, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3161/3672 (86.0839%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3348/3672 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8089, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4302/4928 (87.2971%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4447/4928 (90.2394%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8549, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4015/4356 (92.1717%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3920/4356 (89.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9837, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3934/4456 (88.2855%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4113/4456 (92.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0597, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4144/4793 (86.4594%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9764, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4408/5025 (87.7214%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4555/5025 (90.6468%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9689, Accuracy: 5529/10000 (55.2900%)
time spent on training: 229.93346691131592
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.5163, Accuracy: 6406/10000 (64.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.3117, Accuracy: 228/9900 (2.3030%)
Done in 253.6431005001068 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4358/4885 (89.2119%), train_poison_data_count: 385
Global model norm: 43.28138537884965.
Norm before scaling: 43.284531407648245. Distance: 2.155798159817283
Total norm for 4 adversaries is: 43.284531407648245. distance: 2.155798159817283
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1277, Accuracy: 9577/9900 (96.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4692/5305 (88.4449%), train_poison_data_count: 415
Global model norm: 43.28138537884965.
Norm before scaling: 43.28302399342755. Distance: 2.295222408014569
Total norm for 4 adversaries is: 43.28302399342755. distance: 2.295222408014569
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1705, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 43.28138537884965.
Norm before scaling: 43.280592842483976. Distance: 2.089926573636241
Total norm for 4 adversaries is: 43.280592842483976. distance: 2.089926573636241
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2515, Accuracy: 9280/9900 (93.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4405/5066 (86.9522%), train_poison_data_count: 400
Global model norm: 43.28138537884965.
Norm before scaling: 43.28740366903806. Distance: 2.329118145577757
Total norm for 4 adversaries is: 43.28740366903806. distance: 2.329118145577757
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2057, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3870/4346 (89.0474%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4031/4346 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9269, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3663/4184 (87.5478%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3751/4184 (89.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0166, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3983/4356 (91.4371%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3678/4356 (84.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1102, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3161/3646 (86.6978%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3318/3646 (91.0038%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7802, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4453/5083 (87.6057%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4561/5083 (89.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0134, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3986/4356 (91.5060%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3955/4356 (90.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0038, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3975/4558 (87.2093%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4072/4558 (89.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0852, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3587/4175 (85.9162%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9135, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3048/3472 (87.7880%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3098/3472 (89.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1540, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3900/4501 (86.6474%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4019/4501 (89.2913%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0186, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4804/5424 (88.5693%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4954/5424 (91.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0805, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3923/4481 (87.5474%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4005/4481 (89.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0866, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4744/5455 (86.9661%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0881, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4489/5232 (85.7989%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4656/5232 (88.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1445, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5425/6391 (84.8850%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5500/6391 (86.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0201, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3374/3775 (89.3775%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3564/3775 (94.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8254, Accuracy: 5734/10000 (57.3400%)
time spent on training: 232.0930995941162
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.5319, Accuracy: 6372/10000 (63.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.4039, Accuracy: 205/9900 (2.0707%)
Done in 255.88863587379456 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4353/4885 (89.1095%), train_poison_data_count: 385
Global model norm: 43.3178320130694.
Norm before scaling: 43.31355546378134. Distance: 2.1977095905642328
Total norm for 4 adversaries is: 43.31355546378134. distance: 2.1977095905642328
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1533, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4719/5305 (88.9538%), train_poison_data_count: 415
Global model norm: 43.3178320130694.
Norm before scaling: 43.312955163102615. Distance: 2.2251029601545573
Total norm for 4 adversaries is: 43.312955163102615. distance: 2.2251029601545573
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0974, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4195/4717 (88.9336%), train_poison_data_count: 370
Global model norm: 43.3178320130694.
Norm before scaling: 43.31311158027815. Distance: 2.0568148547327176
Total norm for 4 adversaries is: 43.31311158027815. distance: 2.0568148547327176
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1438, Accuracy: 9546/9900 (96.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4411/5066 (87.0707%), train_poison_data_count: 400
Global model norm: 43.3178320130694.
Norm before scaling: 43.323122513687046. Distance: 2.327010534429045
Total norm for 4 adversaries is: 43.323122513687046. distance: 2.327010534429045
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1718, Accuracy: 9466/9900 (95.6162%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3555/4025 (88.3230%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3698/4025 (91.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7715, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3682/4223 (87.1892%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3821/4223 (90.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0360, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3152/3638 (86.6410%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3350/3638 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9221, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4429/5063 (87.4778%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4456/5063 (88.0111%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0263, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4231/4874 (86.8076%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4266/4874 (87.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2374, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4301/4804 (89.5296%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4184/4804 (87.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1566, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3484/4158 (83.7903%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3635/4158 (87.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8913, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3983/4518 (88.1585%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8860, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3710/4235 (87.6033%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3755/4235 (88.6659%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9943, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4258/4934 (86.2991%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4228/4934 (85.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1790, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 5449/6391 (85.2605%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5597/6391 (87.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0612, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3745/4295 (87.1944%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3803/4295 (88.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0106, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3332/3756 (88.7114%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3488/3756 (92.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8575, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3925/4481 (87.5921%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3956/4481 (88.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1204, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3590/4175 (85.9880%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3667/4175 (87.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9723, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3199/3590 (89.1086%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3223/3590 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0367, Accuracy: 5473/10000 (54.7300%)
time spent on training: 228.65987730026245
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5109, Accuracy: 6371/10000 (63.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.7662, Accuracy: 134/9900 (1.3535%)
Done in 252.24846935272217 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.35550376862492.
Norm before scaling: 43.354605593545365. Distance: 2.165000078936921
Total norm for 4 adversaries is: 43.354605593545365. distance: 2.165000078936921
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.3238, Accuracy: 9099/9900 (91.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4714/5305 (88.8596%), train_poison_data_count: 415
Global model norm: 43.35550376862492.
Norm before scaling: 43.356537069288926. Distance: 2.2334001455229586
Total norm for 4 adversaries is: 43.356537069288926. distance: 2.2334001455229586
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2769, Accuracy: 9270/9900 (93.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 43.35550376862492.
Norm before scaling: 43.357198706645015. Distance: 2.0857238660133244
Total norm for 4 adversaries is: 43.357198706645015. distance: 2.0857238660133244
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1243, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4433/5066 (87.5049%), train_poison_data_count: 400
Global model norm: 43.35550376862492.
Norm before scaling: 43.35995072815971. Distance: 2.3087894466481473
Total norm for 4 adversaries is: 43.35995072815971. distance: 2.3087894466481473
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1776, Accuracy: 9452/9900 (95.4747%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3370/3828 (88.0355%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7978, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3476/3911 (88.8775%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3395/3911 (86.8064%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1282, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3905/4362 (89.5232%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3945/4362 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9511, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4604/5197 (88.5896%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4600/5197 (88.5126%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0729, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4324/4679 (92.4129%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4358/4679 (93.1396%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9407, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4124/4793 (86.0421%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4288/4793 (89.4638%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9978, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4568/5116 (89.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0684, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3931/4625 (84.9946%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9907, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4104/4618 (88.8696%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4146/4618 (89.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0434, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2871/3271 (87.7713%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2975/3271 (90.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9266, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3663/4175 (87.7365%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9242, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3077/3616 (85.0940%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3287/3616 (90.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7945, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3893/4481 (86.8779%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4010/4481 (89.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0378, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3816/4368 (87.3626%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3927/4368 (89.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9719, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4962/5740 (86.4460%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5214/5740 (90.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0745, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4220/4647 (90.8113%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9487, Accuracy: 5545/10000 (55.4500%)
time spent on training: 231.38752818107605
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.4950, Accuracy: 6404/10000 (64.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.3001, Accuracy: 385/9900 (3.8889%)
Done in 255.07836413383484 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4394/4885 (89.9488%), train_poison_data_count: 385
Global model norm: 43.38853749029661.
Norm before scaling: 43.38621354060095. Distance: 2.0974540399874364
Total norm for 4 adversaries is: 43.38621354060095. distance: 2.0974540399874364
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3339, Accuracy: 9035/9900 (91.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 43.38853749029661.
Norm before scaling: 43.3815708954779. Distance: 2.152082756266435
Total norm for 4 adversaries is: 43.3815708954779. distance: 2.152082756266435
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2353, Accuracy: 9313/9900 (94.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 43.38853749029661.
Norm before scaling: 43.38758654287681. Distance: 2.044579186640996
Total norm for 4 adversaries is: 43.38758654287681. distance: 2.044579186640996
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2041, Accuracy: 9367/9900 (94.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4449/5066 (87.8208%), train_poison_data_count: 400
Global model norm: 43.38853749029661.
Norm before scaling: 43.3962005780388. Distance: 2.3054524849318234
Total norm for 4 adversaries is: 43.3962005780388. distance: 2.3054524849318234
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1298, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4818/5591 (86.1742%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4973/5591 (88.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1000, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4244/4956 (85.6336%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4368/4956 (88.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9993, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3933/4511 (87.1869%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4511 (90.6008%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9179, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3568/4013 (88.9110%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9020, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3221/3590 (89.7214%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3348/3590 (93.2591%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8566, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4165/4793 (86.8976%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9687, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3334/3804 (87.6446%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3420/3804 (89.9054%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9342, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3352/3837 (87.3599%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3538/3837 (92.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9036, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3794/4361 (86.9984%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3845/4361 (88.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1921, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4438/5063 (87.6555%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4399/5063 (86.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1929, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3790/4368 (86.7674%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3893/4368 (89.1255%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0523, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4326/4679 (92.4557%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4114/4679 (87.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0916, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4592/5265 (87.2175%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4677/5265 (88.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0392, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4096/4767 (85.9241%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4246/4767 (89.0707%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0976, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5189/5902 (87.9193%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4975/5902 (84.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2529, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3697/4223 (87.5444%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3865/4223 (91.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9773, Accuracy: 5461/10000 (54.6100%)
time spent on training: 230.53545308113098
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.5047, Accuracy: 6405/10000 (64.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.8896, Accuracy: 260/9900 (2.6263%)
Done in 254.3651626110077 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 43.43609906688718.
Norm before scaling: 43.43235974531979. Distance: 2.0704558700726303
Total norm for 4 adversaries is: 43.43235974531979. distance: 2.0704558700726303
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3774, Accuracy: 8951/9900 (90.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4724/5305 (89.0481%), train_poison_data_count: 415
Global model norm: 43.43609906688718.
Norm before scaling: 43.43348818029485. Distance: 2.215329717374673
Total norm for 4 adversaries is: 43.43348818029485. distance: 2.215329717374673
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2753, Accuracy: 9169/9900 (92.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 43.43609906688718.
Norm before scaling: 43.43136478704791. Distance: 2.04275143928183
Total norm for 4 adversaries is: 43.43136478704791. distance: 2.04275143928183
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1810, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 43.43609906688718.
Norm before scaling: 43.43962449840583. Distance: 2.2925346002494846
Total norm for 4 adversaries is: 43.43962449840583. distance: 2.2925346002494846
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1808, Accuracy: 9430/9900 (95.2525%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3346/3797 (88.1222%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3472/3797 (91.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9761, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3371/3861 (87.3090%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3450/3861 (89.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9138, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4133/4707 (87.8054%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4257/4707 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0025, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4029/4518 (89.1766%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4134/4518 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0630, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3564/4013 (88.8114%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3669/4013 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8304, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4591/5167 (88.8523%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4682/5167 (90.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1274, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3465/3969 (87.3016%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3617/3969 (91.1313%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0047, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3962/4441 (89.2141%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4107/4441 (92.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9502, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3984/4558 (87.4068%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4037/4558 (88.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0341, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3929/4465 (87.9955%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4127/4465 (92.4300%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8430, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3168/3638 (87.0808%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3327/3638 (91.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8144, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4039/4538 (89.0040%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4193/4538 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8317, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5026/5740 (87.5610%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5237/5740 (91.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1309, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3345/3837 (87.1775%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3509/3837 (91.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7990, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3806/4361 (87.2736%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3645/4361 (83.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0475, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4152/4793 (86.6263%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4313/4793 (89.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0822, Accuracy: 5383/10000 (53.8300%)
time spent on training: 229.52206468582153
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.4821, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.9927, Accuracy: 221/9900 (2.2323%)
Done in 253.4084758758545 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4382/4885 (89.7032%), train_poison_data_count: 385
Global model norm: 43.46988731887426.
Norm before scaling: 43.467472235892956. Distance: 2.0904746556072102
Total norm for 4 adversaries is: 43.467472235892956. distance: 2.0904746556072102
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2915, Accuracy: 9158/9900 (92.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4729/5305 (89.1423%), train_poison_data_count: 415
Global model norm: 43.46988731887426.
Norm before scaling: 43.46644157242171. Distance: 2.1888029305393832
Total norm for 4 adversaries is: 43.46644157242171. distance: 2.1888029305393832
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1536, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 43.46988731887426.
Norm before scaling: 43.46576615163291. Distance: 2.042351536485329
Total norm for 4 adversaries is: 43.46576615163291. distance: 2.042351536485329
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1693, Accuracy: 9444/9900 (95.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 43.46988731887426.
Norm before scaling: 43.47228682367294. Distance: 2.2443087973799027
Total norm for 4 adversaries is: 43.47228682367294. distance: 2.2443087973799027
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3572, Accuracy: 8988/9900 (90.7879%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4104/4767 (86.0919%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4213/4767 (88.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1076, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3952/4441 (88.9890%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4106/4441 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9927, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4090/4356 (93.8935%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4006/4356 (91.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0435, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0075, Accuracy: 5452/6391 (85.3075%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5620/6391 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0556, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3701/4184 (88.4560%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3776/4184 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8999, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3905/4346 (89.8527%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4034/4346 (92.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7251, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4391/5037 (87.1749%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9475, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4053/4634 (87.4622%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4219/4634 (91.0445%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8854, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4377/4934 (88.7110%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4356/4934 (88.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0648, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4804/5424 (88.5693%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4929/5424 (90.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0477, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3351/3781 (88.6273%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3411/3781 (90.2142%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0573, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3380/3861 (87.5421%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3473/3861 (89.9508%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8921, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4500/5055 (89.0208%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4681/5055 (92.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8564, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3959/4433 (89.3075%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4032/4433 (90.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8243, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4590/5167 (88.8330%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4704/5167 (91.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0643, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3244/3590 (90.3621%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3192/3590 (88.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0587, Accuracy: 5424/10000 (54.2400%)
time spent on training: 232.63565254211426
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.6289, Accuracy: 6197/10000 (61.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.7197, Accuracy: 916/9900 (9.2525%)
Done in 256.3883321285248 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 43.49860809554715.
Norm before scaling: 43.49940367542051. Distance: 2.1525549810921802
Total norm for 4 adversaries is: 43.49940367542051. distance: 2.1525549810921802
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2524, Accuracy: 9272/9900 (93.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 43.49860809554715.
Norm before scaling: 43.496385446091956. Distance: 2.159747286777534
Total norm for 4 adversaries is: 43.496385446091956. distance: 2.159747286777534
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2370, Accuracy: 9311/9900 (94.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 43.49860809554715.
Norm before scaling: 43.49586204052562. Distance: 2.0426683369140837
Total norm for 4 adversaries is: 43.49586204052562. distance: 2.0426683369140837
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1770, Accuracy: 9438/9900 (95.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 43.49860809554715.
Norm before scaling: 43.503462730353434. Distance: 2.2708663821367385
Total norm for 4 adversaries is: 43.503462730353434. distance: 2.2708663821367385
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1990, Accuracy: 9392/9900 (94.8687%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3800/4368 (86.9963%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3928/4368 (89.9267%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9269, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3350/3828 (87.5131%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3517/3828 (91.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7575, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4171/4356 (95.7530%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3763/4356 (86.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1399, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3366/3861 (87.1795%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3500/3861 (90.6501%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9855, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3071/3472 (88.4505%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3188/3472 (91.8203%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9746, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4065/4538 (89.5769%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8447, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4758/5392 (88.2418%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4877/5392 (90.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0292, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3758/4295 (87.4971%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3633/4295 (84.5867%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0036, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3711/4235 (87.6269%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3806/4235 (89.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9252, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3985/4456 (89.4300%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8839, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4554/5265 (86.4957%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4589/5265 (87.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0415, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3981/4441 (89.6420%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4093/4441 (92.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0342, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3584/4013 (89.3097%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3726/4013 (92.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7414, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3932/4465 (88.0627%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4102/4465 (91.8701%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7941, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5528/6263 (88.2644%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5698/6263 (90.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8958, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4391/4986 (88.0666%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4500/4986 (90.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9325, Accuracy: 5638/10000 (56.3800%)
time spent on training: 229.8906123638153
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Client 1 misclassified the most to class 2 with 1 misclassifications.
Client 1 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {1: 1})
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 2 with 1 misclassifications.
Client 3 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {1: 1, 3: 1})
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(1, 1), (3, 1)]
Top 3 clients: [(1, 1), (3, 1)]
Client 1 misclassification ratio: 0.5000
Client 3 misclassification ratio: 0.5000
Client 1 ranked 1 with score 1. Assigned small weight: 0.001
Client 3 ranked 2 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.5663, Accuracy: 6307/10000 (63.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 6.6058, Accuracy: 915/9900 (9.2424%)
Done in 253.62551879882812 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4370/4885 (89.4575%), train_poison_data_count: 385
Global model norm: 43.520955968342854.
Norm before scaling: 43.52175394450745. Distance: 2.1068720909150622
Total norm for 4 adversaries is: 43.52175394450745. distance: 2.1068720909150622
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1727, Accuracy: 9462/9900 (95.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 43.520955968342854.
Norm before scaling: 43.52167961694134. Distance: 2.185606872989577
Total norm for 4 adversaries is: 43.52167961694134. distance: 2.185606872989577
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1830, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 43.520955968342854.
Norm before scaling: 43.513654297835785. Distance: 1.959835274644646
Total norm for 4 adversaries is: 43.513654297835785. distance: 1.959835274644646
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2101, Accuracy: 9378/9900 (94.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 43.520955968342854.
Norm before scaling: 43.524316064324175. Distance: 2.238829860061605
Total norm for 4 adversaries is: 43.524316064324175. distance: 2.238829860061605
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2060, Accuracy: 9375/9900 (94.6970%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3558/4158 (85.5700%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3619/4158 (87.0370%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9763, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4525/5167 (87.5750%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4648/5167 (89.9555%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0779, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3390/3828 (88.5580%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3470/3828 (90.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8706, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4136/4663 (88.6983%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4269/4663 (91.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0167, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3945/4433 (88.9917%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4433 (92.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8146, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3682/4184 (88.0019%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3773/4184 (90.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9844, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4071/4716 (86.3232%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4250/4716 (90.1187%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9841, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3765/4223 (89.1546%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8979, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4305/4679 (92.0068%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4256/4679 (90.9596%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0087, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3227/3704 (87.1220%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3373/3704 (91.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8327, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3375/3837 (87.9593%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3533/3837 (92.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7673, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3402/3861 (88.1119%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3468/3861 (89.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8845, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4819/5424 (88.8459%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4930/5424 (90.8923%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1195, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4067/4576 (88.8767%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4191/4576 (91.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8547, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3573/4025 (88.7702%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3744/4025 (93.0186%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7821, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3383/3775 (89.6159%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3544/3775 (93.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7971, Accuracy: 5761/10000 (57.6100%)
time spent on training: 228.28427052497864
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.5466, Accuracy: 6315/10000 (63.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 6.6732, Accuracy: 800/9900 (8.0808%)
Done in 252.16063499450684 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 43.54823873223448.
Norm before scaling: 43.54499261494871. Distance: 2.0446534659240747
Total norm for 4 adversaries is: 43.54499261494871. distance: 2.0446534659240747
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1983, Accuracy: 9409/9900 (95.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4733/5305 (89.2177%), train_poison_data_count: 415
Global model norm: 43.54823873223448.
Norm before scaling: 43.54779864242925. Distance: 2.2024644443097117
Total norm for 4 adversaries is: 43.54779864242925. distance: 2.2024644443097117
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3397, Accuracy: 9049/9900 (91.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 43.54823873223448.
Norm before scaling: 43.544324019289526. Distance: 1.972259058481468
Total norm for 4 adversaries is: 43.544324019289526. distance: 1.972259058481468
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3745, Accuracy: 8972/9900 (90.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 43.54823873223448.
Norm before scaling: 43.54878393286373. Distance: 2.2318067395687344
Total norm for 4 adversaries is: 43.54878393286373. distance: 2.2318067395687344
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0760, Accuracy: 9670/9900 (97.6768%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4037/4576 (88.2212%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4187/4576 (91.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9503, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3258/3672 (88.7255%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3381/3672 (92.0752%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8454, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4094/4618 (88.6531%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4136/4618 (89.5626%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0087, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4072/4538 (89.7312%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4224/4538 (93.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8123, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4459/5025 (88.7363%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4598/5025 (91.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1190, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3246/3590 (90.4178%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3286/3590 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9251, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4130/4707 (87.7417%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4317/4707 (91.7145%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9970, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4394/4918 (89.3453%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4468/4918 (90.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9947, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3841/4336 (88.5839%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3946/4336 (91.0055%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9162, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5303/5902 (89.8509%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5233/5902 (88.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1846, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3981/4441 (89.6420%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0163, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4484/5232 (85.7034%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4654/5232 (88.9526%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0000, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4290/4804 (89.3006%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4316/4804 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0477, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3543/3969 (89.2668%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3628/3969 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9410, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4829/5392 (89.5586%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4919/5392 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8501, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3365/3828 (87.9049%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3518/3828 (91.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8407, Accuracy: 5694/10000 (56.9400%)
time spent on training: 232.2840178012848
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.5987, Accuracy: 6203/10000 (62.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 6.3921, Accuracy: 969/9900 (9.7879%)
Done in 256.0963668823242 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 43.57874405709451.
Norm before scaling: 43.57441467487329. Distance: 2.011092775599647
Total norm for 4 adversaries is: 43.57441467487329. distance: 2.011092775599647
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1582, Accuracy: 9498/9900 (95.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 43.57874405709451.
Norm before scaling: 43.5785801898959. Distance: 2.233788153136291
Total norm for 4 adversaries is: 43.5785801898959. distance: 2.233788153136291
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1953, Accuracy: 9419/9900 (95.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4201/4717 (89.0608%), train_poison_data_count: 370
Global model norm: 43.57874405709451.
Norm before scaling: 43.57370310794187. Distance: 2.0004596182082834
Total norm for 4 adversaries is: 43.57370310794187. distance: 2.0004596182082834
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2560, Accuracy: 9288/9900 (93.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 43.57874405709451.
Norm before scaling: 43.579234254437345. Distance: 2.2206549190499483
Total norm for 4 adversaries is: 43.579234254437345. distance: 2.2206549190499483
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1820, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4495/5232 (85.9136%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4594/5232 (87.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0366, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4264/4956 (86.0371%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4404/4956 (88.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1859, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4470/5063 (88.2876%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4494/5063 (88.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0065, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3601/4025 (89.4658%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3735/4025 (92.7950%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8744, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3973/4441 (89.4618%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4077/4441 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0350, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3972/4625 (85.8811%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4011/4625 (86.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2049, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4817/5591 (86.1563%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4873/5591 (87.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1200, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5037/5582 (90.2365%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5045/5582 (90.3798%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1175, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5306/5902 (89.9017%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5265/5902 (89.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1294, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4046/4538 (89.1582%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4198/4538 (92.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8842, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4449/5025 (88.5373%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4584/5025 (91.2239%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0134, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3688/4223 (87.3313%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3865/4223 (91.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8612, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3855/4361 (88.3972%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3815/4361 (87.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0461, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4114/4354 (94.4878%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3739/4354 (85.8751%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2629, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3250/3672 (88.5076%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3353/3672 (91.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9282, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3987/4356 (91.5289%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3979/4356 (91.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4903, Accuracy: 4825/10000 (48.2500%)
time spent on training: 234.1507556438446
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7109, Accuracy: 6074/10000 (60.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 6.0497, Accuracy: 1182/9900 (11.9394%)
Done in 257.7951853275299 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4369/4885 (89.4371%), train_poison_data_count: 385
Global model norm: 43.615304651058985.
Norm before scaling: 43.613299268077334. Distance: 2.0821319040441755
Total norm for 4 adversaries is: 43.613299268077334. distance: 2.0821319040441755
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1372, Accuracy: 9575/9900 (96.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 43.615304651058985.
Norm before scaling: 43.61274507759315. Distance: 2.155461485056509
Total norm for 4 adversaries is: 43.61274507759315. distance: 2.155461485056509
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1593, Accuracy: 9525/9900 (96.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.615304651058985.
Norm before scaling: 43.61219787755414. Distance: 2.0070649770454665
Total norm for 4 adversaries is: 43.61219787755414. distance: 2.0070649770454665
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3438, Accuracy: 9084/9900 (91.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4432/5066 (87.4852%), train_poison_data_count: 400
Global model norm: 43.615304651058985.
Norm before scaling: 43.619394898693. Distance: 2.3098189818891566
Total norm for 4 adversaries is: 43.619394898693. distance: 2.3098189818891566
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1754, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3383/3828 (88.3751%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3499/3828 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8205, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3755/4235 (88.6659%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3833/4235 (90.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9895, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3235/3704 (87.3380%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3328/3704 (89.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8707, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3605/4046 (89.1003%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3747/4046 (92.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8142, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4334/4928 (87.9464%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4454/4928 (90.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8077, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5035/5740 (87.7178%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5160/5740 (89.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0702, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4445/5083 (87.4484%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/5083 (89.1993%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8241, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4029/4576 (88.0463%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4122/4576 (90.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9811, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4065/4647 (87.4758%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4200/4647 (90.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9999, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4829/5424 (89.0302%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1100, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3921/4503 (87.0753%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4041/4503 (89.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0270, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5492/6391 (85.9333%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5588/6391 (87.4355%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0340, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3944/4511 (87.4307%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4084/4511 (90.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8834, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4041/4456 (90.6867%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4127/4456 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9182, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4387/4804 (91.3197%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4285/4804 (89.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1046, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3337/3804 (87.7234%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3461/3804 (90.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0383, Accuracy: 5436/10000 (54.3600%)
time spent on training: 234.55363655090332
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.6723, Accuracy: 6170/10000 (61.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 6.3379, Accuracy: 1015/9900 (10.2525%)
Done in 258.22949171066284 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 43.66088860020344.
Norm before scaling: 43.660565675643596. Distance: 2.084379149837452
Total norm for 4 adversaries is: 43.660565675643596. distance: 2.084379149837452
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1455, Accuracy: 9537/9900 (96.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 43.66088860020344.
Norm before scaling: 43.65818071294385. Distance: 2.2021966154998722
Total norm for 4 adversaries is: 43.65818071294385. distance: 2.2021966154998722
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1877, Accuracy: 9417/9900 (95.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 43.66088860020344.
Norm before scaling: 43.655100758853195. Distance: 1.9899877034099733
Total norm for 4 adversaries is: 43.655100758853195. distance: 1.9899877034099733
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1469, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 43.66088860020344.
Norm before scaling: 43.66340201795149. Distance: 2.244246438024345
Total norm for 4 adversaries is: 43.66340201795149. distance: 2.244246438024345
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1285, Accuracy: 9582/9900 (96.7879%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4368/4928 (88.6364%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4470/4928 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8154, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4388/5037 (87.1153%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4555/5037 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8910, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4848/5392 (89.9110%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4920/5392 (91.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9673, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3960/4501 (87.9804%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4049/4501 (89.9578%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0222, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3804 (87.5657%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3462/3804 (91.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9557, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3370/3837 (87.8290%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3529/3837 (91.9729%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8765, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4423/5063 (87.3593%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4412/5063 (87.1420%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0951, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4017/4481 (89.6452%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4048/4481 (90.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9287, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4039/4518 (89.3980%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4146/4518 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8590, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3137/3638 (86.2287%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3306/3638 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8966, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4138/4663 (88.7412%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4298/4663 (92.1724%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8876, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3963/4625 (85.6865%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4055/4625 (87.6757%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0572, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4548/5197 (87.5120%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4608/5197 (88.6665%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1910, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4469/5083 (87.9205%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4578/5083 (90.0649%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9737, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3383/3828 (88.3751%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8212, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3183/3704 (85.9341%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3367/3704 (90.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8418, Accuracy: 5709/10000 (57.0900%)
time spent on training: 231.033673286438
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.6443, Accuracy: 6180/10000 (61.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 6.9599, Accuracy: 777/9900 (7.8485%)
Done in 254.70094299316406 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 43.69618341814878.
Norm before scaling: 43.69161142804975. Distance: 2.0851443493683206
Total norm for 4 adversaries is: 43.69161142804975. distance: 2.0851443493683206
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2165, Accuracy: 9359/9900 (94.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 43.69618341814878.
Norm before scaling: 43.69589986530844. Distance: 2.1726841139832715
Total norm for 4 adversaries is: 43.69589986530844. distance: 2.1726841139832715
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1516, Accuracy: 9520/9900 (96.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 43.69618341814878.
Norm before scaling: 43.6925864908203. Distance: 2.015975566806779
Total norm for 4 adversaries is: 43.6925864908203. distance: 2.015975566806779
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1654, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 43.69618341814878.
Norm before scaling: 43.69583700851833. Distance: 2.227755364231025
Total norm for 4 adversaries is: 43.69583700851833. distance: 2.227755364231025
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2280, Accuracy: 9345/9900 (94.3939%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3415/3861 (88.4486%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3538/3861 (91.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8668, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3719/4184 (88.8862%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3830/4184 (91.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8780, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4388/5037 (87.1153%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4555/5037 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9584, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4559/5197 (87.7237%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4655/5197 (89.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0531, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4425/5025 (88.0597%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4555/5025 (90.6468%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0707, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4471/5116 (87.3925%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4586/5116 (89.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9274, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4037/4481 (90.0915%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4049/4481 (90.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0398, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4079/4576 (89.1390%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4152/4576 (90.7343%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9634, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4565/5232 (87.2515%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4668/5232 (89.2202%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0301, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4146/4354 (95.2228%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4099/4354 (94.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9308, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2895/3271 (88.5050%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2911/3271 (88.9942%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9160, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4782/5455 (87.6627%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4891/5455 (89.6609%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0454, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3654/4126 (88.5603%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3775/4126 (91.4930%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9438, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3341/3797 (87.9905%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8937, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3235/3704 (87.3380%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3378/3704 (91.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8743, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4421/4934 (89.6028%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4412/4934 (89.4203%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9772, Accuracy: 5467/10000 (54.6700%)
time spent on training: 230.73577284812927
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7604, Accuracy: 6049/10000 (60.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 7.1222, Accuracy: 664/9900 (6.7071%)
Done in 254.59018564224243 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 43.72212421083647.
Norm before scaling: 43.71721427788772. Distance: 2.0163571706102656
Total norm for 4 adversaries is: 43.71721427788772. distance: 2.0163571706102656
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.3215, Accuracy: 9118/9900 (92.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 43.72212421083647.
Norm before scaling: 43.7229743536293. Distance: 2.239673866985223
Total norm for 4 adversaries is: 43.7229743536293. distance: 2.239673866985223
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2310, Accuracy: 9357/9900 (94.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.72212421083647.
Norm before scaling: 43.7167605314848. Distance: 2.0306035113408467
Total norm for 4 adversaries is: 43.7167605314848. distance: 2.0306035113408467
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2750, Accuracy: 9204/9900 (92.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4489/5066 (88.6103%), train_poison_data_count: 400
Global model norm: 43.72212421083647.
Norm before scaling: 43.72174729494966. Distance: 2.222994116661671
Total norm for 4 adversaries is: 43.72174729494966. distance: 2.222994116661671
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1977, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4104/4618 (88.8696%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4128/4618 (89.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9742, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3885/4625 (84.0000%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4029/4625 (87.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0542, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5029/5740 (87.6132%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5112/5740 (89.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3539, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4028/4416 (91.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9522, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3669/4126 (88.9239%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3800/4126 (92.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8938, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3116/3616 (86.1726%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3304/3616 (91.3717%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8740, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3535/4158 (85.0168%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3721/4158 (89.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8987, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3897/4346 (89.6687%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4035/4346 (92.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8218, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4189/4874 (85.9458%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4314/4874 (88.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3342, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4637/5265 (88.0722%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4725/5265 (89.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0051, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3591/4025 (89.2174%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3715/4025 (92.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8652, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4079/4651 (87.7016%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4224/4651 (90.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0014, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3336/3837 (86.9429%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3505/3837 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0285, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3124/3638 (85.8714%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9351, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3079/3472 (88.6809%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3192/3472 (91.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9825, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4007/4456 (89.9237%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4125/4456 (92.5718%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8963, Accuracy: 5676/10000 (56.7600%)
time spent on training: 228.1413414478302
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7627, Accuracy: 6044/10000 (60.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 7.3155, Accuracy: 500/9900 (5.0505%)
Done in 251.6961750984192 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4352/4885 (89.0890%), train_poison_data_count: 385
Global model norm: 43.756486684297734.
Norm before scaling: 43.75530101813379. Distance: 2.1293208007364064
Total norm for 4 adversaries is: 43.75530101813379. distance: 2.1293208007364064
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1514, Accuracy: 9518/9900 (96.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 43.756486684297734.
Norm before scaling: 43.75306629879642. Distance: 2.16353206812995
Total norm for 4 adversaries is: 43.75306629879642. distance: 2.16353206812995
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1587, Accuracy: 9478/9900 (95.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 43.756486684297734.
Norm before scaling: 43.75164896446047. Distance: 2.0099070270348873
Total norm for 4 adversaries is: 43.75164896446047. distance: 2.0099070270348873
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2317, Accuracy: 9316/9900 (94.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 43.756486684297734.
Norm before scaling: 43.759548344207836. Distance: 2.2802954989229898
Total norm for 4 adversaries is: 43.759548344207836. distance: 2.2802954989229898
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2298, Accuracy: 9316/9900 (94.1010%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4831/5424 (89.0671%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4938/5424 (91.0398%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0879, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4378/4986 (87.8059%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4520/4986 (90.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8477, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4550/5167 (88.0588%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4712/5167 (91.1941%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1314, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4092/4716 (86.7684%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4217/4716 (89.4190%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9993, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3817/4368 (87.3855%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3890/4368 (89.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9298, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3980/4356 (91.3682%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3841/4356 (88.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3463, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4407/4804 (91.7361%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4268/4804 (88.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2181, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4040/4481 (90.1584%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4012/4481 (89.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0479, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3574/4025 (88.7950%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3737/4025 (92.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7732, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4450/5017 (88.6984%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4586/5017 (91.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0674, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3161/3616 (87.4170%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3344/3616 (92.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7658, Accuracy: 5951/10000 (59.5100%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3666/4184 (87.6195%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3782/4184 (90.3920%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8704, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4527/5195 (87.1415%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4651/5195 (89.5284%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1110, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3901/4361 (89.4520%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3976/4361 (91.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0738, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3403/3756 (90.6017%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3526/3756 (93.8765%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8638, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4862/5591 (86.9612%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4909/5591 (87.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1753, Accuracy: 5314/10000 (53.1400%)
time spent on training: 232.52047491073608
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7567, Accuracy: 6025/10000 (60.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 7.4813, Accuracy: 522/9900 (5.2727%)
Done in 256.1535291671753 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4421/4885 (90.5015%), train_poison_data_count: 385
Global model norm: 43.78672844470828.
Norm before scaling: 43.77986006671261. Distance: 2.053234558433844
Total norm for 4 adversaries is: 43.77986006671261. distance: 2.053234558433844
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4723, Accuracy: 8727/9900 (88.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4728/5305 (89.1235%), train_poison_data_count: 415
Global model norm: 43.78672844470828.
Norm before scaling: 43.78290057559572. Distance: 2.226279257443415
Total norm for 4 adversaries is: 43.78290057559572. distance: 2.226279257443415
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2393, Accuracy: 9316/9900 (94.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 43.78672844470828.
Norm before scaling: 43.783150108214436. Distance: 2.039170653299421
Total norm for 4 adversaries is: 43.783150108214436. distance: 2.039170653299421
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1375, Accuracy: 9554/9900 (96.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 43.78672844470828.
Norm before scaling: 43.78819203528218. Distance: 2.2456310027732638
Total norm for 4 adversaries is: 43.78819203528218. distance: 2.2456310027732638
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2282, Accuracy: 9344/9900 (94.3838%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3661/4175 (87.6886%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3773/4175 (90.3713%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0614, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4892/5455 (89.6792%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4982/5455 (91.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8935, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3203/3704 (86.4741%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3383/3704 (91.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8103, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4337/4989 (86.9312%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4442/4989 (89.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9397, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4300/4928 (87.2565%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4434/4928 (89.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9114, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3343/3804 (87.8812%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3475/3804 (91.3512%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9697, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3856/4336 (88.9299%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3954/4336 (91.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9033, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3595/4046 (88.8532%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3652/4046 (90.2620%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9185, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4205/4793 (87.7321%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4334/4793 (90.4235%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9993, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3345/3756 (89.0575%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3468/3756 (92.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9842, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5663/6391 (88.6090%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5629/6391 (88.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1449, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3232/3672 (88.0174%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3356/3672 (91.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8076, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4018/4558 (88.1527%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4125/4558 (90.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0361, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4038/4576 (88.2430%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4158/4576 (90.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9478, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3986/4456 (89.4524%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8738, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4133/4356 (94.8806%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4021/4356 (92.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9472, Accuracy: 5514/10000 (55.1400%)
time spent on training: 230.47411847114563
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7476, Accuracy: 6073/10000 (60.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 7.3758, Accuracy: 548/9900 (5.5354%)
Done in 254.34184432029724 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4407/4885 (90.2149%), train_poison_data_count: 385
Global model norm: 43.83028905085215.
Norm before scaling: 43.82665299444292. Distance: 2.082946232754202
Total norm for 4 adversaries is: 43.82665299444292. distance: 2.082946232754202
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2763, Accuracy: 9210/9900 (93.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 43.83028905085215.
Norm before scaling: 43.82641485077093. Distance: 2.1850188216527022
Total norm for 4 adversaries is: 43.82641485077093. distance: 2.1850188216527022
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1983, Accuracy: 9429/9900 (95.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 43.83028905085215.
Norm before scaling: 43.824584861482144. Distance: 2.0738574501790934
Total norm for 4 adversaries is: 43.824584861482144. distance: 2.0738574501790934
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1064, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 43.83028905085215.
Norm before scaling: 43.83047425744801. Distance: 2.2086446890473974
Total norm for 4 adversaries is: 43.83047425744801. distance: 2.2086446890473974
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2346, Accuracy: 9321/9900 (94.1515%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4483/5116 (87.6271%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4564/5116 (89.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0279, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5010/5582 (89.7528%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5106/5582 (91.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0907, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4280/4928 (86.8506%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0332, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3705/4126 (89.7964%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3862/4126 (93.6016%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7945, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3550/4158 (85.3776%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3687/4158 (88.6724%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8683, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4574/5063 (90.3417%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4527/5063 (89.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1308, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5472/6124 (89.3534%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5564/6124 (90.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0041, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4175/4354 (95.8888%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4095/4354 (94.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0450, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4429/5025 (88.1393%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9870, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4377/4679 (93.5456%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4303/4679 (91.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0945, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4224/4793 (88.1285%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8774, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4019/4518 (88.9553%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4147/4518 (91.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9026, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4574/5167 (88.5233%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4682/5167 (90.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0829, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3973/4433 (89.6233%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4050/4433 (91.3603%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8550, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4018/4503 (89.2294%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4066/4503 (90.2954%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0099, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4142/4707 (87.9966%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4293/4707 (91.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9512, Accuracy: 5493/10000 (54.9300%)
time spent on training: 236.40833282470703
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8093, Accuracy: 5991/10000 (59.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 7.3698, Accuracy: 631/9900 (6.3737%)
Done in 260.044638633728 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 43.85398913760583.
Norm before scaling: 43.85223963377968. Distance: 2.133909509257872
Total norm for 4 adversaries is: 43.85223963377968. distance: 2.133909509257872
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2722, Accuracy: 9214/9900 (93.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 43.85398913760583.
Norm before scaling: 43.84949067014633. Distance: 2.1867561165416736
Total norm for 4 adversaries is: 43.84949067014633. distance: 2.1867561165416736
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2829, Accuracy: 9186/9900 (92.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 43.85398913760583.
Norm before scaling: 43.84990685343228. Distance: 2.0809582205028807
Total norm for 4 adversaries is: 43.84990685343228. distance: 2.0809582205028807
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2758, Accuracy: 9207/9900 (93.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 43.85398913760583.
Norm before scaling: 43.852662750093494. Distance: 2.231263348194875
Total norm for 4 adversaries is: 43.852662750093494. distance: 2.231263348194875
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1765, Accuracy: 9492/9900 (95.8788%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3205/3704 (86.5281%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3381/3704 (91.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8350, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4720/5392 (87.5371%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4816/5392 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0113, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3911/4362 (89.6607%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4044/4362 (92.7098%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8814, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4043/4538 (89.0921%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4209/4538 (92.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9244, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3706/4184 (88.5755%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7905, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3342/3756 (88.9776%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3472/3756 (92.4388%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9088, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4345/4679 (92.8617%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4263/4679 (91.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0837, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3068/3472 (88.3641%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3164/3472 (91.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0650, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5715/6391 (89.4226%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5743/6391 (89.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9950, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4622/5265 (87.7873%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4578/5265 (86.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1733, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5299/5902 (89.7831%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5333/5902 (90.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0166, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5429/6124 (88.6512%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5485/6124 (89.5656%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0208, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4490/5083 (88.3337%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4553/5083 (89.5731%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0136, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3955/4465 (88.5778%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4064/4465 (91.0190%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9158, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3340/3804 (87.8023%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3427/3804 (90.0894%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8673, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4339/4918 (88.2269%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4487/4918 (91.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9863, Accuracy: 5458/10000 (54.5800%)
time spent on training: 234.63314819335938
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8925, Accuracy: 5855/10000 (58.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 7.3351, Accuracy: 586/9900 (5.9192%)
Done in 258.2606222629547 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.89048593783595.
Norm before scaling: 43.88668102607413. Distance: 2.1141246304400902
Total norm for 4 adversaries is: 43.88668102607413. distance: 2.1141246304400902
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3203, Accuracy: 9133/9900 (92.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 43.89048593783595.
Norm before scaling: 43.88715109516679. Distance: 2.1969020966639956
Total norm for 4 adversaries is: 43.88715109516679. distance: 2.1969020966639956
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3062, Accuracy: 9156/9900 (92.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 43.89048593783595.
Norm before scaling: 43.88826922745132. Distance: 2.0107573647132404
Total norm for 4 adversaries is: 43.88826922745132. distance: 2.0107573647132404
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1579, Accuracy: 9514/9900 (96.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4504/5066 (88.9064%), train_poison_data_count: 400
Global model norm: 43.89048593783595.
Norm before scaling: 43.894386464398124. Distance: 2.251926445120577
Total norm for 4 adversaries is: 43.894386464398124. distance: 2.251926445120577
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3205, Accuracy: 9117/9900 (92.0909%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4086/4538 (90.0397%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4250/4538 (93.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8343, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4295/4989 (86.0894%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4465/4989 (89.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8151, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4379/4793 (91.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9073, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3523/4158 (84.7282%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3657/4158 (87.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8971, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3419/3861 (88.5522%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8885, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4531/5232 (86.6017%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4650/5232 (88.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0617, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4146/4663 (88.9127%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4339/4663 (93.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8922, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4645/5197 (89.3785%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4640/5197 (89.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0161, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4629/5167 (89.5878%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4682/5167 (90.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9618, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3842/4416 (87.0018%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4000/4416 (90.5797%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8000, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4239/4354 (97.3588%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3998/4354 (91.8236%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1069, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4877/5455 (89.4042%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4877/5455 (89.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9327, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4020/4456 (90.2154%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4135/4456 (92.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8527, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2868/3271 (87.6796%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2936/3271 (89.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9233, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2947/3297 (89.3843%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3025/3297 (91.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7962, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4938/5591 (88.3205%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4959/5591 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1247, Accuracy: 5202/10000 (52.0200%)
time spent on training: 232.02920150756836
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9663, Accuracy: 5805/10000 (58.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 6.9019, Accuracy: 885/9900 (8.9394%)
Done in 255.6055028438568 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 43.91836187479703.
Norm before scaling: 43.91606040309314. Distance: 2.0967911227373452
Total norm for 4 adversaries is: 43.91606040309314. distance: 2.0967911227373452
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1842, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 43.91836187479703.
Norm before scaling: 43.91659408843228. Distance: 2.2004848379467856
Total norm for 4 adversaries is: 43.91659408843228. distance: 2.2004848379467856
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3877, Accuracy: 9004/9900 (90.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 43.91836187479703.
Norm before scaling: 43.91630917909726. Distance: 2.090157344498725
Total norm for 4 adversaries is: 43.91630917909726. distance: 2.090157344498725
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1579, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 43.91836187479703.
Norm before scaling: 43.92246697840127. Distance: 2.3136786472853252
Total norm for 4 adversaries is: 43.92246697840127. distance: 2.3136786472853252
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1760, Accuracy: 9469/9900 (95.6465%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4573/5167 (88.5040%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4715/5167 (91.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1275, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3352/3775 (88.7947%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3527/3775 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8748, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4572/5195 (88.0077%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4718/5195 (90.8181%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0530, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3639/4126 (88.1968%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3825/4126 (92.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7998, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3485/3911 (89.1076%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3353/3911 (85.7325%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3502, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3957/4433 (89.2624%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4079/4433 (92.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8831, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2841/3271 (86.8542%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0063, Accuracy: 2872/3271 (87.8019%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9131, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3228/3590 (89.9164%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3318/3590 (92.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8977, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4295/4918 (87.3322%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4507/4918 (91.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1525, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4375/4986 (87.7457%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4484/4986 (89.9318%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8504, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3127/3616 (86.4768%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3306/3616 (91.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9384, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3768/4295 (87.7299%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3899/4295 (90.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9978, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4054/4356 (93.0670%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3961/4356 (90.9320%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9797, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4202/4793 (87.6695%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4357/4793 (90.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9444, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3874/4315 (89.7798%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3944/4315 (91.4021%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8997, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4353/4804 (90.6120%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4486/4804 (93.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9391, Accuracy: 5679/10000 (56.7900%)
time spent on training: 228.6386399269104
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9452, Accuracy: 5779/10000 (57.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 6.2610, Accuracy: 1104/9900 (11.1515%)
Done in 252.58227014541626 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 43.948379754068434.
Norm before scaling: 43.9440076195158. Distance: 2.062061725636081
Total norm for 4 adversaries is: 43.9440076195158. distance: 2.062061725636081
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.2211, Accuracy: 9370/9900 (94.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4761/5305 (89.7455%), train_poison_data_count: 415
Global model norm: 43.948379754068434.
Norm before scaling: 43.942075575231705. Distance: 2.179796222996889
Total norm for 4 adversaries is: 43.942075575231705. distance: 2.179796222996889
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1723, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 43.948379754068434.
Norm before scaling: 43.943402041806145. Distance: 2.017157275315476
Total norm for 4 adversaries is: 43.943402041806145. distance: 2.017157275315476
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1101, Accuracy: 9616/9900 (97.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4492/5066 (88.6696%), train_poison_data_count: 400
Global model norm: 43.948379754068434.
Norm before scaling: 43.95232930092059. Distance: 2.274106271439677
Total norm for 4 adversaries is: 43.95232930092059. distance: 2.274106271439677
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1749, Accuracy: 9442/9900 (95.3737%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4013/4503 (89.1184%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4065/4503 (90.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9758, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4340/4934 (87.9611%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4292/4934 (86.9882%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1492, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4383/4804 (91.2365%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4255/4804 (88.5720%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1184, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4005/4456 (89.8788%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4101/4456 (92.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8805, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4073/4651 (87.5726%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4651 (90.7332%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0029, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3721/4184 (88.9340%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3815/4184 (91.1807%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9453, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4244/4928 (86.1201%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9012, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3379/3775 (89.5099%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3531/3775 (93.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8803, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4462/5083 (87.7828%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4564/5083 (89.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0008, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4884/5455 (89.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0868, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3176/3638 (87.3007%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7731, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3523/3911 (90.0793%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3636/3911 (92.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0163, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3393/3837 (88.4285%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8363, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4010/4501 (89.0913%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4066/4501 (90.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9598, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4627/5197 (89.0321%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4680/5197 (90.0520%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0209, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3405/3861 (88.1896%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3447/3861 (89.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8673, Accuracy: 5605/10000 (56.0500%)
time spent on training: 237.84787344932556
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9145, Accuracy: 5835/10000 (58.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 6.7942, Accuracy: 800/9900 (8.0808%)
Done in 261.62685894966125 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 43.98591249533054.
Norm before scaling: 43.98289434674789. Distance: 2.0921213448672544
Total norm for 4 adversaries is: 43.98289434674789. distance: 2.0921213448672544
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1629, Accuracy: 9478/9900 (95.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 43.98591249533054.
Norm before scaling: 43.98624690732533. Distance: 2.241146045152597
Total norm for 4 adversaries is: 43.98624690732533. distance: 2.241146045152597
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1518, Accuracy: 9539/9900 (96.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 43.98591249533054.
Norm before scaling: 43.97990513477789. Distance: 1.9785565356047703
Total norm for 4 adversaries is: 43.97990513477789. distance: 1.9785565356047703
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1547, Accuracy: 9489/9900 (95.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 43.98591249533054.
Norm before scaling: 43.98730285548319. Distance: 2.2661412144266615
Total norm for 4 adversaries is: 43.98730285548319. distance: 2.2661412144266615
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1257, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2879/3271 (88.0159%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2932/3271 (89.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9007, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3886/4511 (86.1450%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4031/4511 (89.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0129, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3316/3638 (91.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0287, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5034/5582 (90.1827%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5113/5582 (91.5980%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0132, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3983/4456 (89.3851%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4093/4456 (91.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0654, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5297/5902 (89.7492%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5231/5902 (88.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0620, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3981/4416 (90.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9426, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4451/4934 (90.2108%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4348/4934 (88.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0775, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4053/4596 (88.1854%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4263/4596 (92.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8936, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3386/3837 (88.2460%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9059, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5709/6391 (89.3287%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5788/6391 (90.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9531, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3858/4368 (88.3242%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3908/4368 (89.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0395, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3361/3804 (88.3544%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3497/3804 (91.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8449, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5543/6263 (88.5039%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5621/6263 (89.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1085, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4195/4793 (87.5235%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4374/4793 (91.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9776, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4846/5424 (89.3437%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4936/5424 (91.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1670, Accuracy: 5182/10000 (51.8200%)
time spent on training: 235.03752541542053
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9342, Accuracy: 5830/10000 (58.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 7.0815, Accuracy: 636/9900 (6.4242%)
Done in 259.09614181518555 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4398/4885 (90.0307%), train_poison_data_count: 385
Global model norm: 44.021260067047436.
Norm before scaling: 44.0168951715915. Distance: 2.098538857722636
Total norm for 4 adversaries is: 44.0168951715915. distance: 2.098538857722636
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2571, Accuracy: 9267/9900 (93.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 44.021260067047436.
Norm before scaling: 44.01625731707689. Distance: 2.1882696705041607
Total norm for 4 adversaries is: 44.01625731707689. distance: 2.1882696705041607
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1613, Accuracy: 9532/9900 (96.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 44.021260067047436.
Norm before scaling: 44.01333277444532. Distance: 2.041060130533007
Total norm for 4 adversaries is: 44.01333277444532. distance: 2.041060130533007
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1509, Accuracy: 9486/9900 (95.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 44.021260067047436.
Norm before scaling: 44.021343256531544. Distance: 2.285971680266345
Total norm for 4 adversaries is: 44.021343256531544. distance: 2.285971680266345
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2881, Accuracy: 9179/9900 (92.7172%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4485/5055 (88.7240%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4623/5055 (91.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9603, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3722/4184 (88.9579%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3743/4184 (89.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8614, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3448/3861 (89.3033%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3533/3861 (91.5048%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8793, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4314/4804 (89.8002%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4091/4804 (85.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2218, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3161/3472 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9221, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3495/3969 (88.0574%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3601/3969 (90.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8898, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4350/4989 (87.1918%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4413/4989 (88.4546%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9806, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5034/5582 (90.1827%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5099/5582 (91.3472%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0599, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4212/4793 (87.8782%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4335/4793 (90.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9976, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4104/4662 (88.0309%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4250/4662 (91.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9562, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4537/4934 (91.9538%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4471/4934 (90.6161%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1244, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4393/4986 (88.1067%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4564/4986 (91.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8729, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3966/4433 (89.4654%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4017/4433 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9665, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4120/4716 (87.3622%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4257/4716 (90.2672%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9279, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4097/4596 (89.1427%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4260/4596 (92.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0973, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4239/4354 (97.3588%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4086/4354 (93.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9625, Accuracy: 5593/10000 (55.9300%)
time spent on training: 231.58519101142883
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 47 with 1 misclassifications.
Client 3 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {3: 1})
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(3, 1)]
Top 3 clients: [(3, 1)]
Client 3 misclassification ratio: 1.0000
Client 3 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8426, Accuracy: 5952/10000 (59.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 6.5751, Accuracy: 783/9900 (7.9091%)
Done in 256.1297447681427 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 44.04223409171091.
Norm before scaling: 44.03884144325396. Distance: 2.0561663161296515
Total norm for 4 adversaries is: 44.03884144325396. distance: 2.0561663161296515
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1101, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 44.04223409171091.
Norm before scaling: 44.03745686823746. Distance: 2.1831281298623963
Total norm for 4 adversaries is: 44.03745686823746. distance: 2.1831281298623963
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1189, Accuracy: 9627/9900 (97.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4247/4717 (90.0360%), train_poison_data_count: 370
Global model norm: 44.04223409171091.
Norm before scaling: 44.03622748436437. Distance: 1.997382716434651
Total norm for 4 adversaries is: 44.03622748436437. distance: 1.997382716434651
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1973, Accuracy: 9382/9900 (94.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 44.04223409171091.
Norm before scaling: 44.041341606583835. Distance: 2.1839002145112167
Total norm for 4 adversaries is: 44.041341606583835. distance: 2.1839002145112167
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.4316, Accuracy: 8888/9900 (89.7778%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4502/5116 (87.9984%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4597/5116 (89.8554%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9077, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4136/4662 (88.7173%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4250/4662 (91.1626%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9047, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5263/5902 (89.1732%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5358/5902 (90.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1261, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4518/5063 (89.2356%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4555/5063 (89.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0009, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4251/4354 (97.6344%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3794/4354 (87.1383%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4333, Accuracy: 4779/10000 (47.7900%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4586/5195 (88.2772%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4608/5195 (88.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0856, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4067/4356 (93.3655%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3996/4356 (91.7355%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0721, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3787/4295 (88.1723%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3880/4295 (90.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8959, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5583/6263 (89.1426%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5670/6263 (90.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9130, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3964/4511 (87.8741%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0924, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4182/4663 (89.6848%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4337/4663 (93.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9731, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3903/4336 (90.0138%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4014/4336 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9580, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4275/4928 (86.7492%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1266, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3632/4046 (89.7677%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3734/4046 (92.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9346, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3229/3672 (87.9357%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3339/3672 (90.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0245, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4010/4356 (92.0569%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4038/4356 (92.6997%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9305, Accuracy: 5585/10000 (55.8500%)
time spent on training: 233.6234564781189
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9050, Accuracy: 5772/10000 (57.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 7.0392, Accuracy: 581/9900 (5.8687%)
Done in 257.16515946388245 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4436/4885 (90.8086%), train_poison_data_count: 385
Global model norm: 44.082764898912735.
Norm before scaling: 44.0805287806093. Distance: 2.057633177663901
Total norm for 4 adversaries is: 44.0805287806093. distance: 2.057633177663901
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1748, Accuracy: 9469/9900 (95.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4737/5305 (89.2931%), train_poison_data_count: 415
Global model norm: 44.082764898912735.
Norm before scaling: 44.08316503443378. Distance: 2.282040916142925
Total norm for 4 adversaries is: 44.08316503443378. distance: 2.282040916142925
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1206, Accuracy: 9618/9900 (97.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 44.082764898912735.
Norm before scaling: 44.079894616196626. Distance: 2.0678528191525736
Total norm for 4 adversaries is: 44.079894616196626. distance: 2.0678528191525736
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1973, Accuracy: 9400/9900 (94.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 44.082764898912735.
Norm before scaling: 44.08534287101199. Distance: 2.277850819272061
Total norm for 4 adversaries is: 44.08534287101199. distance: 2.277850819272061
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1974, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4384/5037 (87.0359%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8331, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4094/4647 (88.0998%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9206, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4171/4663 (89.4489%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4285/4663 (91.8936%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0355, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3852/4336 (88.8376%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3977/4336 (91.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9786, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3363/3756 (89.5367%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3493/3756 (92.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9643, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4059/4625 (87.7622%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4145/4625 (89.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9527, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3874/4362 (88.8125%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4036/4362 (92.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9326, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4255/4874 (87.3000%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4399/4874 (90.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0172, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4079/4767 (85.5674%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4235/4767 (88.8399%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0937, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3342/3775 (88.5298%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3531/3775 (93.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7992, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4142/4662 (88.8460%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4244/4662 (91.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9281, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5504/6124 (89.8759%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5543/6124 (90.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9230, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3939/4511 (87.3199%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4049/4511 (89.7584%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9730, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3573/3911 (91.3577%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3562/3911 (91.0765%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8246, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4851/5591 (86.7644%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4956/5591 (88.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9750, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3664/4126 (88.8027%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3771/4126 (91.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9422, Accuracy: 5536/10000 (55.3600%)
time spent on training: 231.06735754013062
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8658, Accuracy: 5845/10000 (58.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 7.2791, Accuracy: 518/9900 (5.2323%)
Done in 254.65645670890808 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 44.1171798908706.
Norm before scaling: 44.11493168152508. Distance: 2.1090011830586586
Total norm for 4 adversaries is: 44.11493168152508. distance: 2.1090011830586586
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1459, Accuracy: 9551/9900 (96.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4717/5305 (88.9161%), train_poison_data_count: 415
Global model norm: 44.1171798908706.
Norm before scaling: 44.11737911128037. Distance: 2.274887723562566
Total norm for 4 adversaries is: 44.11737911128037. distance: 2.274887723562566
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1464, Accuracy: 9535/9900 (96.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 44.1171798908706.
Norm before scaling: 44.11302511022113. Distance: 2.09783991572563
Total norm for 4 adversaries is: 44.11302511022113. distance: 2.09783991572563
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0340, Accuracy: 9806/9900 (99.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4514/5066 (89.1038%), train_poison_data_count: 400
Global model norm: 44.1171798908706.
Norm before scaling: 44.11639545176204. Distance: 2.218202657750926
Total norm for 4 adversaries is: 44.11639545176204. distance: 2.218202657750926
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1512, Accuracy: 9488/9900 (95.8384%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4520/5025 (89.9502%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4594/5025 (91.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1258, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4457/5116 (87.1188%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4605/5116 (90.0117%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9763, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4575/5167 (88.5427%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4698/5167 (90.9232%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9489, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3995/4558 (87.6481%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4037/4558 (88.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0623, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4080/4651 (87.7231%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4651 (90.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0440, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3874/4336 (89.3450%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3939/4336 (90.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0297, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4494/5055 (88.9021%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4601/5055 (91.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9797, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3388/3775 (89.7483%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3551/3775 (94.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7822, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4686/5265 (89.0028%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4728/5265 (89.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9423, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3586/4025 (89.0932%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9087, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4344/4989 (87.0716%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9727, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4199/4793 (87.6069%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4339/4793 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9931, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3339/3804 (87.7760%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3500/3804 (92.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8004, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3370/3797 (88.7543%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3414/3797 (89.9131%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1430, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3915/4433 (88.3149%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4070/4433 (91.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8723, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4150/4707 (88.1666%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8524, Accuracy: 5701/10000 (57.0100%)
time spent on training: 230.73288989067078
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8511, Accuracy: 5889/10000 (58.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 6.9381, Accuracy: 702/9900 (7.0909%)
Done in 254.4694848060608 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 44.147795324696.
Norm before scaling: 44.1448629049682. Distance: 2.035060067567338
Total norm for 4 adversaries is: 44.1448629049682. distance: 2.035060067567338
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1998, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 44.147795324696.
Norm before scaling: 44.14385635296193. Distance: 2.1979784000158045
Total norm for 4 adversaries is: 44.14385635296193. distance: 2.1979784000158045
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0703, Accuracy: 9742/9900 (98.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 44.147795324696.
Norm before scaling: 44.142076856654015. Distance: 1.9833354479781131
Total norm for 4 adversaries is: 44.142076856654015. distance: 1.9833354479781131
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.3398, Accuracy: 9104/9900 (91.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 44.147795324696.
Norm before scaling: 44.149376897853834. Distance: 2.2304988932535195
Total norm for 4 adversaries is: 44.149376897853834. distance: 2.2304988932535195
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1790, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4835/5392 (89.6699%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4851/5392 (89.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0541, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4167/4663 (89.3631%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4300/4663 (92.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0284, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3428/3797 (90.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0893, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4987/5582 (89.3407%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5113/5582 (91.5980%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9546, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4573/5167 (88.5040%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4694/5167 (90.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0444, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3351/3781 (88.6273%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3327/3781 (87.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1650, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3506/3969 (88.3346%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3660/3969 (92.2147%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8783, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3339/3837 (87.0211%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3536/3837 (92.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9239, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5253/5902 (89.0037%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5321/5902 (90.1559%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0725, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4839/5455 (88.7076%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4942/5455 (90.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8982, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4366/5037 (86.6786%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4509/5037 (89.5176%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9009, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4439/5017 (88.4792%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4587/5017 (91.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9563, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4401/4986 (88.2671%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4522/4986 (90.6939%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9271, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4615/5197 (88.8012%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4621/5197 (88.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1309, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3880/4361 (88.9704%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3837/4361 (87.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2246, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5613/6263 (89.6216%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5730/6263 (91.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0507, Accuracy: 5453/10000 (54.5300%)
time spent on training: 236.5557177066803
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8342, Accuracy: 5919/10000 (59.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 7.5716, Accuracy: 479/9900 (4.8384%)
Done in 260.3010342121124 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 44.178361910926625.
Norm before scaling: 44.172281237077854. Distance: 2.0447177147443854
Total norm for 4 adversaries is: 44.172281237077854. distance: 2.0447177147443854
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1239, Accuracy: 9602/9900 (96.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 44.178361910926625.
Norm before scaling: 44.1744090845452. Distance: 2.187467738322367
Total norm for 4 adversaries is: 44.1744090845452. distance: 2.187467738322367
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0910, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 44.178361910926625.
Norm before scaling: 44.17007452335164. Distance: 1.9533437377513718
Total norm for 4 adversaries is: 44.17007452335164. distance: 1.9533437377513718
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1327, Accuracy: 9556/9900 (96.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 44.178361910926625.
Norm before scaling: 44.17464811555167. Distance: 2.1676701520508237
Total norm for 4 adversaries is: 44.17464811555167. distance: 2.1676701520508237
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2576, Accuracy: 9284/9900 (93.7778%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4496/5017 (89.6153%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4564/5017 (90.9707%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7705, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4287/4928 (86.9927%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4409/4928 (89.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9653, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3713/4184 (88.7428%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3803/4184 (90.8939%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8497, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4206/4793 (87.7530%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0269, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5072/5740 (88.3624%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5184/5740 (90.3136%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9947, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3387/3756 (90.1757%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3514/3756 (93.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8506, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3776/4235 (89.1617%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3840/4235 (90.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8836, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3709/4223 (87.8286%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3890/4223 (92.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8209, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4511/5063 (89.0974%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4449/5063 (87.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1193, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4417/4989 (88.5348%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9588, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4354/4928 (88.3523%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8604, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5274/5902 (89.3595%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5120/5902 (86.7503%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1299, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3990/4456 (89.5422%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4124/4456 (92.5494%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8246, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5440/6124 (88.8308%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5543/6124 (90.5127%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8626, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3383/3828 (88.3751%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9758, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3177/3616 (87.8595%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3295/3616 (91.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7303, Accuracy: 5906/10000 (59.0600%)
time spent on training: 233.18016719818115
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8351, Accuracy: 5924/10000 (59.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 7.3040, Accuracy: 604/9900 (6.1010%)
Done in 256.71228671073914 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 44.220442215853346.
Norm before scaling: 44.21516521467422. Distance: 2.0343851396861727
Total norm for 4 adversaries is: 44.21516521467422. distance: 2.0343851396861727
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1975, Accuracy: 9446/9900 (95.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 44.220442215853346.
Norm before scaling: 44.213588755766736. Distance: 2.178152986672334
Total norm for 4 adversaries is: 44.213588755766736. distance: 2.178152986672334
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1978, Accuracy: 9390/9900 (94.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 44.220442215853346.
Norm before scaling: 44.212986870463894. Distance: 1.9815946309327628
Total norm for 4 adversaries is: 44.212986870463894. distance: 1.9815946309327628
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1680, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 44.220442215853346.
Norm before scaling: 44.218937720449595. Distance: 2.2018525256770314
Total norm for 4 adversaries is: 44.218937720449595. distance: 2.2018525256770314
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1338, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3700/4223 (87.6154%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3877/4223 (91.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9039, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3907/4362 (89.5690%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3948/4362 (90.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0959, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5709/6391 (89.3287%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5712/6391 (89.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1483, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4126/4793 (86.0839%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4355/4793 (90.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1134, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3340/3756 (88.9244%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3519/3756 (93.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0320, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4141/4618 (89.6709%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4150/4618 (89.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9399, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3588/4025 (89.1429%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3713/4025 (92.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8333, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3195/3638 (87.8230%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3368/3638 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7569, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3918/4315 (90.7995%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4009/4315 (92.9085%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8232, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3812/4295 (88.7544%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3583/4295 (83.4226%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0241, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4334/4928 (87.9464%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8247, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4398/4986 (88.2070%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4493/4986 (90.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9401, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3697/4126 (89.6025%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3738/4126 (90.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8488, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4370/4918 (88.8573%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4491/4918 (91.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0093, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4611/5195 (88.7584%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4624/5195 (89.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0982, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5090/5740 (88.6760%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0847, Accuracy: 5401/10000 (54.0100%)
time spent on training: 234.01510524749756
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Client 18 misclassified the most to class 95 with 1 misclassifications.
Client 18 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {18: 1})
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(18, 1)]
Top 3 clients: [(18, 1)]
Client 18 misclassification ratio: 1.0000
Client 18 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7860, Accuracy: 6004/10000 (60.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 6.5073, Accuracy: 902/9900 (9.1111%)
Done in 257.7254412174225 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 44.24032987116365.
Norm before scaling: 44.2311116223814. Distance: 1.9548204311235937
Total norm for 4 adversaries is: 44.2311116223814. distance: 1.9548204311235937
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0869, Accuracy: 9672/9900 (97.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4785/5305 (90.1979%), train_poison_data_count: 415
Global model norm: 44.24032987116365.
Norm before scaling: 44.234392937562596. Distance: 2.1445899496747844
Total norm for 4 adversaries is: 44.234392937562596. distance: 2.1445899496747844
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1740, Accuracy: 9464/9900 (95.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 44.24032987116365.
Norm before scaling: 44.23026986647196. Distance: 1.8970224891902068
Total norm for 4 adversaries is: 44.23026986647196. distance: 1.8970224891902068
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2519, Accuracy: 9319/9900 (94.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 44.24032987116365.
Norm before scaling: 44.2388633032901. Distance: 2.1359879884703585
Total norm for 4 adversaries is: 44.2388633032901. distance: 2.1359879884703585
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2032, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2934/3297 (88.9900%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3041/3297 (92.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7178, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3431/3828 (89.6290%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3526/3828 (92.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8961, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4542/5063 (89.7097%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4448/5063 (87.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8487, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3998/4501 (88.8247%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4106/4501 (91.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9562, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4232/4793 (88.2954%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4357/4793 (90.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9134, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3756/4223 (88.9415%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3907/4223 (92.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9098, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3441/3756 (91.6134%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3504/3756 (93.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8549, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3322/3638 (91.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8547, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3198/3646 (87.7126%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3329/3646 (91.3055%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9037, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4276/4874 (87.7308%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4266/4874 (87.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1086, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5673/6263 (90.5796%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5743/6263 (91.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0230, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4384/5037 (87.0359%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4532/5037 (89.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0442, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3971/4362 (91.0362%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4022/4362 (92.2054%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9111, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4064/4356 (93.2966%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4116/4356 (94.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7477, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4551/5116 (88.9562%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4568/5116 (89.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9009, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3927/4346 (90.3590%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4116/4346 (94.7078%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7430, Accuracy: 5967/10000 (59.6700%)
time spent on training: 229.2001552581787
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7861, Accuracy: 6021/10000 (60.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 6.8821, Accuracy: 763/9900 (7.7071%)
Done in 252.8662474155426 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.27447350230435.
Norm before scaling: 44.268669371132276. Distance: 2.008912019207294
Total norm for 4 adversaries is: 44.268669371132276. distance: 2.008912019207294
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1464, Accuracy: 9528/9900 (96.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 44.27447350230435.
Norm before scaling: 44.26838948524316. Distance: 2.0980894753110824
Total norm for 4 adversaries is: 44.26838948524316. distance: 2.0980894753110824
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2775, Accuracy: 9233/9900 (93.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 44.27447350230435.
Norm before scaling: 44.2646294672733. Distance: 1.8866446344259633
Total norm for 4 adversaries is: 44.2646294672733. distance: 1.8866446344259633
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1858, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 44.27447350230435.
Norm before scaling: 44.274024088446886. Distance: 2.1411126688104885
Total norm for 4 adversaries is: 44.274024088446886. distance: 2.1411126688104885
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1963, Accuracy: 9387/9900 (94.8182%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4080/4518 (90.3054%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9338, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4136/4558 (90.7416%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4147/4558 (90.9829%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0110, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3399/3804 (89.3533%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3507/3804 (92.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9520, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3406/3775 (90.2252%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3582/3775 (94.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.6961, Accuracy: 6020/10000 (60.2000%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4511/5083 (88.7468%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4612/5083 (90.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9832, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4404/4928 (89.3669%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4547/4928 (92.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8616, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4499/5244 (85.7933%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4571/5244 (87.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9881, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4359/4989 (87.3722%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4527/4989 (90.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8247, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4986 (88.8087%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4515/4986 (90.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9398, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3825/4175 (91.6168%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8520, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4626/5232 (88.4174%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4689/5232 (89.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0112, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5063 (90.5590%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4517/5063 (89.2159%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1519, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4020/4441 (90.5202%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4097/4441 (92.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0447, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3240/3646 (88.8645%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3359/3646 (92.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7666, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4575/5167 (88.5427%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4723/5167 (91.4070%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0375, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4071/4538 (89.7091%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4190/4538 (92.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7886, Accuracy: 5860/10000 (58.6000%)
time spent on training: 238.6125955581665
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8868, Accuracy: 5840/10000 (58.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 7.1747, Accuracy: 588/9900 (5.9394%)
Done in 262.7953898906708 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4459/4885 (91.2794%), train_poison_data_count: 385
Global model norm: 44.30793925974568.
Norm before scaling: 44.30052343881644. Distance: 1.9973248233299803
Total norm for 4 adversaries is: 44.30052343881644. distance: 1.9973248233299803
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1834, Accuracy: 9472/9900 (95.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 44.30793925974568.
Norm before scaling: 44.29746885624858. Distance: 2.082886368170665
Total norm for 4 adversaries is: 44.29746885624858. distance: 2.082886368170665
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1211, Accuracy: 9607/9900 (97.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 44.30793925974568.
Norm before scaling: 44.30093814037337. Distance: 1.979977518589818
Total norm for 4 adversaries is: 44.30093814037337. distance: 1.979977518589818
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1341, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 44.30793925974568.
Norm before scaling: 44.30343315650747. Distance: 2.13413172573973
Total norm for 4 adversaries is: 44.30343315650747. distance: 2.13413172573973
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0841, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4100/4356 (94.1230%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4036/4356 (92.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9628, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4348/4928 (88.2305%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4430/4928 (89.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9552, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4452/5037 (88.3859%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4581/5037 (90.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9300, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4347/4804 (90.4871%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4381/4804 (91.1948%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9961, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3422/3775 (90.6490%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7399, Accuracy: 5975/10000 (59.7500%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4570/5167 (88.4459%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4695/5167 (90.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1065, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3782/4235 (89.3034%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3880/4235 (91.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0449, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4342/4956 (87.6110%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4418/4956 (89.1445%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9691, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5092/5740 (88.7108%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5221/5740 (90.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2011, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4325/4679 (92.4343%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4371/4679 (93.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0293, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3272/3704 (88.3369%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3395/3704 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8568, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3119/3472 (89.8329%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3178/3472 (91.5323%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8787, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4134/4651 (88.8841%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4242/4651 (91.2062%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9295, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4086/4634 (88.1744%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4232/4634 (91.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8440, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5396/5902 (91.4266%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5351/5902 (90.6642%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9270, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3408/3837 (88.8194%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3550/3837 (92.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8412, Accuracy: 5738/10000 (57.3800%)
time spent on training: 232.83845710754395
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0012, Accuracy: 5693/10000 (56.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 6.9780, Accuracy: 625/9900 (6.3131%)
Done in 256.44158697128296 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 44.33557888070821.
Norm before scaling: 44.32776562905086. Distance: 1.9872599978659164
Total norm for 4 adversaries is: 44.32776562905086. distance: 1.9872599978659164
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2158, Accuracy: 9374/9900 (94.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 44.33557888070821.
Norm before scaling: 44.330045726364446. Distance: 2.152034342658407
Total norm for 4 adversaries is: 44.330045726364446. distance: 2.152034342658407
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0875, Accuracy: 9690/9900 (97.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 44.33557888070821.
Norm before scaling: 44.324912588481915. Distance: 1.9108596473985928
Total norm for 4 adversaries is: 44.324912588481915. distance: 1.9108596473985928
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1867, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 44.33557888070821.
Norm before scaling: 44.33521268680658. Distance: 2.2175346591997602
Total norm for 4 adversaries is: 44.33521268680658. distance: 2.2175346591997602
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1289, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3549/3969 (89.4180%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3645/3969 (91.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8423, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4174/4707 (88.6764%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8371, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3422/3861 (88.6299%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3501/3861 (90.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8276, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4110/4596 (89.4256%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4214/4596 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8978, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4038/4503 (89.6736%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4071/4503 (90.4064%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9625, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4391/4928 (89.1031%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4526/4928 (91.8425%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8709, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4452/5025 (88.5970%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0334, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4102/4576 (89.6416%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4198/4576 (91.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8779, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4379/4918 (89.0403%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8426, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3917/4315 (90.7764%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3964/4315 (91.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9183, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3268/3590 (91.0306%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3285/3590 (91.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8571, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4008/4456 (89.9461%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4122/4456 (92.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9824, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4203/4354 (96.5319%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3977/4354 (91.3413%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2010, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3997/4501 (88.8025%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4002/4501 (88.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9639, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3570/3911 (91.2810%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3691/3911 (94.3748%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8348, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4101/4558 (89.9737%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4168/4558 (91.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0783, Accuracy: 5392/10000 (53.9200%)
time spent on training: 230.30533242225647
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0300, Accuracy: 5697/10000 (56.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 6.9115, Accuracy: 666/9900 (6.7273%)
Done in 253.88228154182434 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 44.36283393964197.
Norm before scaling: 44.35696293856031. Distance: 1.9952160721601866
Total norm for 4 adversaries is: 44.35696293856031. distance: 1.9952160721601866
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2555, Accuracy: 9281/9900 (93.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 44.36283393964197.
Norm before scaling: 44.357791282489906. Distance: 2.188309546944465
Total norm for 4 adversaries is: 44.357791282489906. distance: 2.188309546944465
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0834, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4294/4717 (91.0324%), train_poison_data_count: 370
Global model norm: 44.36283393964197.
Norm before scaling: 44.356808826355085. Distance: 1.9627710410362793
Total norm for 4 adversaries is: 44.356808826355085. distance: 1.9627710410362793
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1432, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4545/5066 (89.7158%), train_poison_data_count: 400
Global model norm: 44.36283393964197.
Norm before scaling: 44.359632297157994. Distance: 2.176018802954273
Total norm for 4 adversaries is: 44.359632297157994. distance: 2.176018802954273
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1667, Accuracy: 9464/9900 (95.5960%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4487/5116 (87.7052%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4628/5116 (90.4613%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0150, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4825/5392 (89.4844%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4842/5392 (89.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9392, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4130/4767 (86.6373%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4273/4767 (89.6371%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0655, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4152/4618 (89.9091%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4174/4618 (90.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8855, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3736/4046 (92.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8339, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4063/4625 (87.8486%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4169/4625 (90.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9792, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3363/3638 (92.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7912, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3881/4416 (87.8850%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3967/4416 (89.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8823, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4289/4874 (87.9975%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4358/4874 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2863, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3232/3646 (88.6451%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3305/3646 (90.6473%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7813, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4692/5063 (92.6723%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4633/5063 (91.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9929, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3709/4126 (89.8934%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3851/4126 (93.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8837, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4520/4934 (91.6092%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4537/4934 (91.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0469, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4032/4511 (89.3815%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4142/4511 (91.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8054, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4081/4518 (90.3276%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4181/4518 (92.5409%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8298, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2952/3297 (89.5359%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.6831, Accuracy: 5944/10000 (59.4400%)
time spent on training: 229.15560030937195
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Client 16 misclassified the most to class 95 with 1 misclassifications.
Client 16 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {16: 1})
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(16, 1)]
Top 3 clients: [(16, 1)]
Client 16 misclassification ratio: 1.0000
Client 16 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9590, Accuracy: 5773/10000 (57.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 6.2986, Accuracy: 903/9900 (9.1212%)
Done in 252.92761850357056 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 44.381686886140045.
Norm before scaling: 44.37695858353747. Distance: 2.0103718517098317
Total norm for 4 adversaries is: 44.37695858353747. distance: 2.0103718517098317
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1101, Accuracy: 9618/9900 (97.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 44.381686886140045.
Norm before scaling: 44.37629839649765. Distance: 2.1217489618051864
Total norm for 4 adversaries is: 44.37629839649765. distance: 2.1217489618051864
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0993, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4290/4717 (90.9476%), train_poison_data_count: 370
Global model norm: 44.381686886140045.
Norm before scaling: 44.370394787445264. Distance: 1.8981392708581994
Total norm for 4 adversaries is: 44.370394787445264. distance: 1.8981392708581994
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2478, Accuracy: 9280/9900 (93.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 44.381686886140045.
Norm before scaling: 44.375524039599384. Distance: 2.1086511570909554
Total norm for 4 adversaries is: 44.375524039599384. distance: 2.1086511570909554
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1565, Accuracy: 9509/9900 (96.0505%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5520/6124 (90.1372%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5558/6124 (90.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0138, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1482, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3137/3472 (90.3514%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3114/3472 (89.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9502, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4444/5037 (88.2271%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4530/5037 (89.9345%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0095, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5063/5582 (90.7023%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5130/5582 (91.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9987, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4627/5116 (90.4418%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0174, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4061/4518 (89.8849%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4179/4518 (92.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9711, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4325/4928 (87.7638%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4462/4928 (90.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8843, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4125/4558 (90.5002%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4136/4558 (90.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9042, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2954/3297 (89.5966%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3064/3297 (92.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7747, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3436/3756 (91.4803%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3515/3756 (93.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9324, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4195/4651 (90.1957%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4207/4651 (90.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0376, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3954/4441 (89.0340%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4106/4441 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0806, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3194/3638 (87.7955%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3315/3638 (91.1215%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9226, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4108/4596 (89.3821%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4208/4596 (91.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9284, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2908/3271 (88.9025%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2915/3271 (89.1165%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8517, Accuracy: 5609/10000 (56.0900%)
time spent on training: 229.59441661834717
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9130, Accuracy: 5778/10000 (57.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 6.2454, Accuracy: 945/9900 (9.5455%)
Done in 253.28711080551147 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4460/4885 (91.2999%), train_poison_data_count: 385
Global model norm: 44.41803453544728.
Norm before scaling: 44.40994305324189. Distance: 1.9692459692735187
Total norm for 4 adversaries is: 44.40994305324189. distance: 1.9692459692735187
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2573, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 44.41803453544728.
Norm before scaling: 44.41173243118379. Distance: 2.1167410629694725
Total norm for 4 adversaries is: 44.41173243118379. distance: 2.1167410629694725
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0923, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4283/4717 (90.7992%), train_poison_data_count: 370
Global model norm: 44.41803453544728.
Norm before scaling: 44.40847384033958. Distance: 1.9275664127847323
Total norm for 4 adversaries is: 44.40847384033958. distance: 1.9275664127847323
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2871, Accuracy: 9197/9900 (92.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 44.41803453544728.
Norm before scaling: 44.4104543114393. Distance: 2.079095484777108
Total norm for 4 adversaries is: 44.4104543114393. distance: 2.079095484777108
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2367, Accuracy: 9290/9900 (93.8384%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4465/4989 (89.4969%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4530/4989 (90.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8846, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4044/4465 (90.5711%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4123/4465 (92.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8917, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3900/4315 (90.3824%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4004/4315 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8685, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4129/4767 (86.6163%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4243/4767 (89.0078%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1052, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5775/6391 (90.3614%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5750/6391 (89.9703%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0140, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3256/3672 (88.6710%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3329/3672 (90.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8578, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3578/3969 (90.1487%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3616/3969 (91.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9665, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3238/3590 (90.1950%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3171/3590 (88.3287%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0123, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5447/5902 (92.2907%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5307/5902 (89.9187%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1633, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3710/4013 (92.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8445, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4460/4804 (92.8393%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4126/4804 (85.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1839, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3680/4175 (88.1437%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3782/4175 (90.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8922, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3199/3616 (88.4679%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3316/3616 (91.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8302, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3945/4361 (90.4609%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3937/4361 (90.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9946, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4844/5424 (89.3068%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4974/5424 (91.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1569, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3435/3837 (89.5231%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3571/3837 (93.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0099, Accuracy: 5536/10000 (55.3600%)
time spent on training: 230.7772159576416
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0885, Accuracy: 5575/10000 (55.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 6.8924, Accuracy: 618/9900 (6.2424%)
Done in 254.53924107551575 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 44.45027176695605.
Norm before scaling: 44.440796291245725. Distance: 1.9551806199134099
Total norm for 4 adversaries is: 44.440796291245725. distance: 1.9551806199134099
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1668, Accuracy: 9483/9900 (95.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 44.45027176695605.
Norm before scaling: 44.44336310872595. Distance: 2.147392101841276
Total norm for 4 adversaries is: 44.44336310872595. distance: 2.147392101841276
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2886, Accuracy: 9167/9900 (92.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4323/4717 (91.6472%), train_poison_data_count: 370
Global model norm: 44.45027176695605.
Norm before scaling: 44.44081963910333. Distance: 1.8926411747149
Total norm for 4 adversaries is: 44.44081963910333. distance: 1.8926411747149
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3056, Accuracy: 9142/9900 (92.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 44.45027176695605.
Norm before scaling: 44.44394264785627. Distance: 2.1100943010057542
Total norm for 4 adversaries is: 44.44394264785627. distance: 2.1100943010057542
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1492, Accuracy: 9502/9900 (95.9798%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3835/4416 (86.8433%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3975/4416 (90.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9888, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5115/5740 (89.1115%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5239/5740 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0297, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4444/5037 (88.2271%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4627/5037 (91.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9001, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4550/5116 (88.9367%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4574/5116 (89.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9483, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4377/4918 (88.9996%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4469/4918 (90.8703%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9572, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3431/3837 (89.4188%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3549/3837 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8735, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4108/4651 (88.3251%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4234/4651 (91.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9826, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3465/3861 (89.7436%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3561/3861 (92.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8884, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3710/4223 (87.8522%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3917/4223 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9338, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4185/4662 (89.7683%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4319/4662 (92.6426%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8999, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5679/6263 (90.6754%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5757/6263 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0077, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3380/3781 (89.3943%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3307/3781 (87.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1340, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3392/3804 (89.1693%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3464/3804 (91.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9825, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3435/3828 (89.7335%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7483, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3909/4315 (90.5910%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9240, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4362/4956 (88.0145%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4426/4956 (89.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9038, Accuracy: 5598/10000 (55.9800%)
time spent on training: 232.30291295051575
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9380, Accuracy: 5765/10000 (57.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 7.5717, Accuracy: 393/9900 (3.9697%)
Done in 255.77521443367004 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 44.47654809085486.
Norm before scaling: 44.4685674517511. Distance: 2.0008477560040143
Total norm for 4 adversaries is: 44.4685674517511. distance: 2.0008477560040143
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1445, Accuracy: 9534/9900 (96.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 44.47654809085486.
Norm before scaling: 44.470200751546116. Distance: 2.1337673858309714
Total norm for 4 adversaries is: 44.470200751546116. distance: 2.1337673858309714
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0985, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 44.47654809085486.
Norm before scaling: 44.469008036847974. Distance: 1.920082869430152
Total norm for 4 adversaries is: 44.469008036847974. distance: 1.920082869430152
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1203, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 44.47654809085486.
Norm before scaling: 44.469014899509666. Distance: 2.0702481241833826
Total norm for 4 adversaries is: 44.469014899509666. distance: 2.0702481241833826
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1995, Accuracy: 9418/9900 (95.1313%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4163/4662 (89.2964%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4311/4662 (92.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9854, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3225/3616 (89.1869%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3303/3616 (91.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9129, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3424/3828 (89.4462%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3569/3828 (93.2341%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7591, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2954/3297 (89.5966%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3050/3297 (92.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7545, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3952/4361 (90.6214%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3956/4361 (90.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9433, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4103/4576 (89.6635%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4196/4576 (91.6958%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0034, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3802/4295 (88.5215%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3713/4295 (86.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9779, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4478/5083 (88.0976%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4588/5083 (90.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0014, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4558/5116 (89.0930%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4604/5116 (89.9922%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0374, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3674/4046 (90.8057%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3769/4046 (93.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8432, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5383/5902 (91.2064%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5210/5902 (88.2752%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9580, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4659/5197 (89.6479%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4653/5197 (89.5324%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9759, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4038/4465 (90.4367%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4154/4465 (93.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9147, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3259/3704 (87.9860%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3400/3704 (91.7927%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8262, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3456/3861 (89.5105%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0122, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3713/4126 (89.9903%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3851/4126 (93.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7436, Accuracy: 5869/10000 (58.6900%)
time spent on training: 228.54068422317505
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9580, Accuracy: 5756/10000 (57.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 7.2188, Accuracy: 459/9900 (4.6364%)
Done in 252.17568588256836 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 44.507191966228895.
Norm before scaling: 44.49739392825438. Distance: 1.9735394908316246
Total norm for 4 adversaries is: 44.49739392825438. distance: 1.9735394908316246
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2426, Accuracy: 9300/9900 (93.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 44.507191966228895.
Norm before scaling: 44.49746525435466. Distance: 2.1067994394391794
Total norm for 4 adversaries is: 44.49746525435466. distance: 2.1067994394391794
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1867, Accuracy: 9439/9900 (95.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4323/4717 (91.6472%), train_poison_data_count: 370
Global model norm: 44.507191966228895.
Norm before scaling: 44.49852415916454. Distance: 1.871857170822495
Total norm for 4 adversaries is: 44.49852415916454. distance: 1.871857170822495
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3106, Accuracy: 9175/9900 (92.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4563/5066 (90.0711%), train_poison_data_count: 400
Global model norm: 44.507191966228895.
Norm before scaling: 44.50382104820467. Distance: 2.1556846872739217
Total norm for 4 adversaries is: 44.50382104820467. distance: 2.1556846872739217
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2390, Accuracy: 9316/9900 (94.1010%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4020/4511 (89.1155%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4106/4511 (91.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8215, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5096/5740 (88.7805%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5178/5740 (90.2091%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0293, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4208/4662 (90.2617%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4254/4662 (91.2484%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9588, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3779/4235 (89.2326%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3884/4235 (91.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9225, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4735/5265 (89.9335%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4830/5265 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9073, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4006/4433 (90.3677%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4056/4433 (91.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8534, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4160/4596 (90.5135%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4256/4596 (92.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8617, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5055 (90.7023%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4656/5055 (92.1068%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7886, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4427/5037 (87.8896%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4599/5037 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0208, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4135/4538 (91.1194%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4252/4538 (93.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7468, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3401/3756 (90.5485%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3502/3756 (93.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8729, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3658/4025 (90.8820%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3748/4025 (93.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8977, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4518/5244 (86.1556%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4604/5244 (87.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9462, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4220/4663 (90.4997%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4310/4663 (92.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9583, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3419/3837 (89.1061%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3573/3837 (93.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8482, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4070/4481 (90.8279%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4065/4481 (90.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9872, Accuracy: 5664/10000 (56.6400%)
time spent on training: 232.1610231399536
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9477, Accuracy: 5723/10000 (57.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 7.1639, Accuracy: 461/9900 (4.6566%)
Done in 255.8947491645813 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4450/4885 (91.0952%), train_poison_data_count: 385
Global model norm: 44.543180967496305.
Norm before scaling: 44.53899877758115. Distance: 2.050182087882767
Total norm for 4 adversaries is: 44.53899877758115. distance: 2.050182087882767
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1833, Accuracy: 9470/9900 (95.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4825/5305 (90.9519%), train_poison_data_count: 415
Global model norm: 44.543180967496305.
Norm before scaling: 44.53262196351471. Distance: 2.0933942350206696
Total norm for 4 adversaries is: 44.53262196351471. distance: 2.0933942350206696
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1526, Accuracy: 9512/9900 (96.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 44.543180967496305.
Norm before scaling: 44.535141003253685. Distance: 1.9185932952808245
Total norm for 4 adversaries is: 44.535141003253685. distance: 1.9185932952808245
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1257, Accuracy: 9575/9900 (96.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 44.543180967496305.
Norm before scaling: 44.53541236029552. Distance: 2.1449921326392953
Total norm for 4 adversaries is: 44.53541236029552. distance: 2.1449921326392953
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1039, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3978/4362 (91.1967%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3971/4362 (91.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0082, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5031/5591 (89.9839%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5032/5591 (90.0018%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9885, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3942/4315 (91.3557%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3998/4315 (92.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8610, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3455/3781 (91.3779%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3496/3781 (92.4623%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0129, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3598/4158 (86.5320%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3711/4158 (89.2496%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9319, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4131/4511 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8560, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4260/4793 (88.8796%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8795, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4920/5424 (90.7080%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5012/5424 (92.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1240, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4192/4618 (90.7752%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4224/4618 (91.4682%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9528, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3885/4368 (88.9423%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3931/4368 (89.9954%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9673, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4520/4934 (91.6092%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4088/4934 (82.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3657, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4655/5232 (88.9717%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4648/5232 (88.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9307, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5405/5902 (91.5791%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5383/5902 (91.2064%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0873, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4814/5392 (89.2804%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4895/5392 (90.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0442, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4522/5017 (90.1335%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4537/5017 (90.4325%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8623, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4613/5195 (88.7969%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4584/5195 (88.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0372, Accuracy: 5480/10000 (54.8000%)
time spent on training: 236.2251513004303
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9468, Accuracy: 5781/10000 (57.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 6.9068, Accuracy: 626/9900 (6.3232%)
Done in 259.96418166160583 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 44.58297708434381.
Norm before scaling: 44.576702406761065. Distance: 2.007631167524472
Total norm for 4 adversaries is: 44.576702406761065. distance: 2.007631167524472
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2366, Accuracy: 9357/9900 (94.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 44.58297708434381.
Norm before scaling: 44.57324226238484. Distance: 2.1050787230062706
Total norm for 4 adversaries is: 44.57324226238484. distance: 2.1050787230062706
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2015, Accuracy: 9424/9900 (95.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 44.58297708434381.
Norm before scaling: 44.57221388910991. Distance: 1.9193801814226417
Total norm for 4 adversaries is: 44.57221388910991. distance: 1.9193801814226417
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.4909, Accuracy: 8777/9900 (88.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 44.58297708434381.
Norm before scaling: 44.574547207897275. Distance: 2.0852096373554314
Total norm for 4 adversaries is: 44.574547207897275. distance: 2.0852096373554314
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1443, Accuracy: 9521/9900 (96.1717%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4760/5265 (90.4084%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4809/5265 (91.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8857, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3721/4126 (90.1842%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3823/4126 (92.6563%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7113, Accuracy: 5928/10000 (59.2800%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4055/4501 (90.0911%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4072/4501 (90.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9584, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5609/6124 (91.5905%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5555/6124 (90.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9400, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2914/3271 (89.0859%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2931/3271 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9212, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4197/4663 (90.0064%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4347/4663 (93.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8902, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3623/4025 (90.0124%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7395, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4154/4651 (89.3141%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4276/4651 (91.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0146, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4513/4804 (93.9425%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4451/4804 (92.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9309, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3207/3616 (88.6892%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3331/3616 (92.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7725, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3595/3911 (91.9202%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3551/3911 (90.7952%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1301, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4639/5197 (89.2630%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4661/5197 (89.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0080, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4117/4538 (90.7228%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4261/4538 (93.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7440, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5710/6391 (89.3444%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5787/6391 (90.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8779, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3280/3704 (88.5529%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3388/3704 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8296, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3785/4235 (89.3743%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3763/4235 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0820, Accuracy: 5352/10000 (53.5200%)
time spent on training: 231.9671654701233
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9185, Accuracy: 5786/10000 (57.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 7.2425, Accuracy: 487/9900 (4.9192%)
Done in 255.69482922554016 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 44.60833514549859.
Norm before scaling: 44.60276603845607. Distance: 2.0584812893632156
Total norm for 4 adversaries is: 44.60276603845607. distance: 2.0584812893632156
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0936, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 44.60833514549859.
Norm before scaling: 44.59887682950239. Distance: 2.117241439976799
Total norm for 4 adversaries is: 44.59887682950239. distance: 2.117241439976799
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0883, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 44.60833514549859.
Norm before scaling: 44.597318040070384. Distance: 1.9438531142970032
Total norm for 4 adversaries is: 44.597318040070384. distance: 1.9438531142970032
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2021, Accuracy: 9406/9900 (95.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 44.60833514549859.
Norm before scaling: 44.600825581799775. Distance: 2.141965015079372
Total norm for 4 adversaries is: 44.600825581799775. distance: 2.141965015079372
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1387, Accuracy: 9550/9900 (96.4646%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4571/5116 (89.3471%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4656/5116 (91.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8681, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5068/5582 (90.7918%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5169/5582 (92.6012%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0535, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3826/4235 (90.3424%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3814/4235 (90.0590%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1222, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4119/4625 (89.0595%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4199/4625 (90.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0829, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4030/4481 (89.9353%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4064/4481 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8954, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4643/5232 (88.7424%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4716/5232 (90.1376%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8885, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4206/4662 (90.2188%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4327/4662 (92.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8673, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4052/4441 (91.2407%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4122/4441 (92.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9605, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4060/4518 (89.8628%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4160/4518 (92.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9933, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4511/4928 (91.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8169, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4256/4634 (91.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9063, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4608/4934 (93.3928%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4597/4934 (93.1698%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9305, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3450/3861 (89.3551%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3556/3861 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9248, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3179/3616 (87.9148%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8006, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3899/4416 (88.2926%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4013/4416 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8879, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3380/3797 (89.0176%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3474/3797 (91.4933%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9355, Accuracy: 5677/10000 (56.7700%)
time spent on training: 231.9666702747345
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9104, Accuracy: 5799/10000 (57.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 7.4065, Accuracy: 453/9900 (4.5758%)
Done in 255.787339925766 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 44.636709007448395.
Norm before scaling: 44.6328036112804. Distance: 2.0340996340539825
Total norm for 4 adversaries is: 44.6328036112804. distance: 2.0340996340539825
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2145, Accuracy: 9381/9900 (94.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 44.636709007448395.
Norm before scaling: 44.62811285536562. Distance: 2.1061933470218404
Total norm for 4 adversaries is: 44.62811285536562. distance: 2.1061933470218404
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0935, Accuracy: 9646/9900 (97.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 44.636709007448395.
Norm before scaling: 44.62594646230206. Distance: 1.9292283844052642
Total norm for 4 adversaries is: 44.62594646230206. distance: 1.9292283844052642
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2130, Accuracy: 9366/9900 (94.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 44.636709007448395.
Norm before scaling: 44.62880214019585. Distance: 2.105326518560924
Total norm for 4 adversaries is: 44.62880214019585. distance: 2.105326518560924
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3843, Accuracy: 8971/9900 (90.6162%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5628/6263 (89.8611%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5770/6263 (92.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0018, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3917/4295 (91.1991%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3918/4295 (91.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8767, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4378/4989 (87.7531%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4493/4989 (90.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8086, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3777/4223 (89.4388%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3915/4223 (92.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8292, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5567/6124 (90.9046%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5616/6124 (91.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8810, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4125/4481 (92.0553%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4070/4481 (90.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0261, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4212/4618 (91.2083%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4153/4618 (89.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0511, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4061/4441 (91.4434%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4081/4441 (91.8937%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0198, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3641/4013 (90.7301%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3738/4013 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7703, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3983/4511 (88.2953%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4105/4511 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8625, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3875/4416 (87.7491%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3992/4416 (90.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8688, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4324/4956 (87.2478%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4414/4956 (89.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1520, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4090/4538 (90.1278%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4202/4538 (92.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8769, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4691/5265 (89.0978%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4789/5265 (90.9592%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9455, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4672/5197 (89.8980%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4668/5197 (89.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0946, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4198/4716 (89.0161%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4274/4716 (90.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0280, Accuracy: 5476/10000 (54.7600%)
time spent on training: 235.45962500572205
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8716, Accuracy: 5885/10000 (58.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 7.5305, Accuracy: 516/9900 (5.2121%)
Done in 259.105384349823 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 44.668282854437805.
Norm before scaling: 44.65770696101206. Distance: 1.9869485821917803
Total norm for 4 adversaries is: 44.65770696101206. distance: 1.9869485821917803
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2252, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 44.668282854437805.
Norm before scaling: 44.66276085321249. Distance: 2.188468173894844
Total norm for 4 adversaries is: 44.66276085321249. distance: 2.188468173894844
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1554, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 44.668282854437805.
Norm before scaling: 44.65841765645224. Distance: 1.9234013892594863
Total norm for 4 adversaries is: 44.65841765645224. distance: 1.9234013892594863
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1225, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 44.668282854437805.
Norm before scaling: 44.65874019911304. Distance: 2.1083180357889457
Total norm for 4 adversaries is: 44.65874019911304. distance: 2.1083180357889457
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2745, Accuracy: 9211/9900 (93.0404%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3220/3616 (89.0487%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3337/3616 (92.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8339, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3927/4315 (91.0081%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3961/4315 (91.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9704, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4932/5455 (90.4125%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4903/5455 (89.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0050, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4553/4804 (94.7752%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4396/4804 (91.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0032, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3963/4362 (90.8528%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4001/4362 (91.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0045, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5691/6263 (90.8670%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5740/6263 (91.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0098, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4137/4538 (91.1635%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4218/4538 (92.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8306, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4146/4634 (89.4691%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4212/4634 (90.8934%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9715, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4538/5116 (88.7021%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4615/5116 (90.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8236, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4154/4716 (88.0831%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4249/4716 (90.0975%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9091, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3627/4046 (89.6441%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3734/4046 (92.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9829, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4063/4518 (89.9292%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4166/4518 (92.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8816, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4643/5063 (91.7045%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4461/5063 (88.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1885, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5162/5740 (89.9303%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5223/5740 (90.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0310, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5077/5582 (90.9531%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5155/5582 (92.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9705, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4052/4433 (91.4054%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4083/4433 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8576, Accuracy: 5661/10000 (56.6100%)
time spent on training: 233.24499535560608
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9024, Accuracy: 5900/10000 (59.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 7.4975, Accuracy: 591/9900 (5.9697%)
Done in 256.893785238266 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 44.70128311261392.
Norm before scaling: 44.689862809037855. Distance: 2.0029712302569553
Total norm for 4 adversaries is: 44.689862809037855. distance: 2.0029712302569553
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0918, Accuracy: 9665/9900 (97.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 44.70128311261392.
Norm before scaling: 44.69305991417669. Distance: 2.120452278044558
Total norm for 4 adversaries is: 44.69305991417669. distance: 2.120452278044558
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1381, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 44.70128311261392.
Norm before scaling: 44.68876336719402. Distance: 1.9487463124395084
Total norm for 4 adversaries is: 44.68876336719402. distance: 1.9487463124395084
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2045, Accuracy: 9379/9900 (94.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4583/5066 (90.4659%), train_poison_data_count: 400
Global model norm: 44.70128311261392.
Norm before scaling: 44.69239210547333. Distance: 2.1133295360414746
Total norm for 4 adversaries is: 44.69239210547333. distance: 2.1133295360414746
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2753, Accuracy: 9214/9900 (93.0707%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4639/5197 (89.2630%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4591/5197 (88.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0095, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3599/4025 (89.4161%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3732/4025 (92.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8153, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4103/4481 (91.5644%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4114/4481 (91.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9694, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4128/4651 (88.7551%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9440, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5359/5902 (90.7997%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5317/5902 (90.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9870, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3671/4126 (88.9724%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3817/4126 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7393, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3922/4368 (89.7894%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3914/4368 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0778, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5784/6391 (90.5023%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5765/6391 (90.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1309, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3728/4175 (89.2934%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3746/4175 (89.7246%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9210, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4167/4596 (90.6658%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4248/4596 (92.4282%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8902, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4137/4634 (89.2749%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4239/4634 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7892, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3760/4223 (89.0362%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0148, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3567/3911 (91.2043%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3407/3911 (87.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0367, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4011/4433 (90.4805%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4107/4433 (92.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8178, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3883/4336 (89.5526%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4008/4336 (92.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0895, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3222/3638 (88.5651%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3360/3638 (92.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9029, Accuracy: 5590/10000 (55.9000%)
time spent on training: 233.06432366371155
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8388, Accuracy: 5979/10000 (59.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 7.5852, Accuracy: 536/9900 (5.4141%)
Done in 256.7101945877075 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 44.72995552086362.
Norm before scaling: 44.72581126552513. Distance: 2.044410211626649
Total norm for 4 adversaries is: 44.72581126552513. distance: 2.044410211626649
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.3350, Accuracy: 9101/9900 (91.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 44.72995552086362.
Norm before scaling: 44.72381337075222. Distance: 2.180171133551177
Total norm for 4 adversaries is: 44.72381337075222. distance: 2.180171133551177
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1265, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 44.72995552086362.
Norm before scaling: 44.71754480599938. Distance: 1.9410331874213331
Total norm for 4 adversaries is: 44.71754480599938. distance: 1.9410331874213331
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1335, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4577/5066 (90.3474%), train_poison_data_count: 400
Global model norm: 44.72995552086362.
Norm before scaling: 44.72090097901651. Distance: 2.111426140330117
Total norm for 4 adversaries is: 44.72090097901651. distance: 2.111426140330117
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2554, Accuracy: 9287/9900 (93.8081%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3403/3756 (90.6017%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3509/3756 (93.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8702, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4895/5424 (90.2471%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5006/5424 (92.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0701, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4027/4433 (90.8414%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4013/4433 (90.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8986, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3984/4501 (88.5137%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4033/4501 (89.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9909, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3639/4025 (90.4099%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3758/4025 (93.3665%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8643, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3794/4235 (89.5868%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3849/4235 (90.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8687, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5605/6124 (91.5251%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5567/6124 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8604, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4183/4634 (90.2676%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4231/4634 (91.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8407, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4207/4716 (89.2070%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4278/4716 (90.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0194, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4157/4767 (87.2037%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4214/4767 (88.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0974, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3379/3804 (88.8275%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9012, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3133/3472 (90.2362%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3274/3472 (94.2972%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8959, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5392 (90.2448%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4883/5392 (90.5601%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0480, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5131/5740 (89.3902%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5218/5740 (90.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0387, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4151/4596 (90.3177%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4262/4596 (92.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9661, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3196/3616 (88.3850%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3349/3616 (92.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8166, Accuracy: 5880/10000 (58.8000%)
time spent on training: 231.64234471321106
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8112, Accuracy: 6009/10000 (60.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 7.8151, Accuracy: 420/9900 (4.2424%)
Done in 255.16594290733337 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 44.75999910110868.
Norm before scaling: 44.74922665401954. Distance: 2.039418273522786
Total norm for 4 adversaries is: 44.74922665401954. distance: 2.039418273522786
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0733, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 44.75999910110868.
Norm before scaling: 44.75161757289478. Distance: 2.149058193365
Total norm for 4 adversaries is: 44.75161757289478. distance: 2.149058193365
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0779, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 44.75999910110868.
Norm before scaling: 44.7502305008903. Distance: 1.9819041811726443
Total norm for 4 adversaries is: 44.7502305008903. distance: 1.9819041811726443
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0488, Accuracy: 9784/9900 (98.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 44.75999910110868.
Norm before scaling: 44.75146891138393. Distance: 2.0949925393857103
Total norm for 4 adversaries is: 44.75146891138393. distance: 2.0949925393857103
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1604, Accuracy: 9524/9900 (96.2020%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4756/5063 (93.9364%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4669/5063 (92.2181%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8932, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4563/4804 (94.9833%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4472/4804 (93.0891%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8470, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4122/4558 (90.4344%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4206/4558 (92.2773%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9903, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3437/3756 (91.5069%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3533/3756 (94.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8257, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4922/5424 (90.7448%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4999/5424 (92.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9970, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4183/4511 (92.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7831, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4613/5167 (89.2781%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4770/5167 (92.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9902, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4049/4356 (92.9522%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4136/4356 (94.9495%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0258, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4637/5244 (88.4249%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4716/5244 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9352, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4291/4793 (89.5264%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4418/4793 (92.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8697, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3449/3828 (90.0993%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3558/3828 (92.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7293, Accuracy: 5936/10000 (59.3600%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3662/4046 (90.5091%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3774/4046 (93.2773%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8541, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3650/4013 (90.9544%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3734/4013 (93.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7748, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2944/3271 (90.0031%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 2999/3271 (91.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7959, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3991/4362 (91.4947%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4042/4362 (92.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8278, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3978/4346 (91.5324%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4112/4346 (94.6157%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8181, Accuracy: 5788/10000 (57.8800%)
time spent on training: 230.6216197013855
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Client 11 misclassified the most to class 13 with 1 misclassifications.
Client 11 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {11: 1})
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(11, 1)]
Top 3 clients: [(11, 1)]
Client 11 misclassification ratio: 1.0000
Client 11 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7863, Accuracy: 6050/10000 (60.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 6.8586, Accuracy: 715/9900 (7.2222%)
Done in 254.60631227493286 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 44.77681606407425.
Norm before scaling: 44.767235191372805. Distance: 1.9859738254301287
Total norm for 4 adversaries is: 44.767235191372805. distance: 1.9859738254301287
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0550, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4831/5305 (91.0650%), train_poison_data_count: 415
Global model norm: 44.77681606407425.
Norm before scaling: 44.76434198641328. Distance: 2.0792881284820384
Total norm for 4 adversaries is: 44.76434198641328. distance: 2.0792881284820384
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1306, Accuracy: 9568/9900 (96.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 44.77681606407425.
Norm before scaling: 44.76467467359517. Distance: 1.9284403859884809
Total norm for 4 adversaries is: 44.76467467359517. distance: 1.9284403859884809
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0623, Accuracy: 9739/9900 (98.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 44.77681606407425.
Norm before scaling: 44.76938111423434. Distance: 2.0629541301722103
Total norm for 4 adversaries is: 44.76938111423434. distance: 2.0629541301722103
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.3169, Accuracy: 9103/9900 (91.9495%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3729/4126 (90.3781%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3832/4126 (92.8745%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7077, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4933/5455 (90.4308%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4934/5455 (90.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8998, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4157/4558 (91.2023%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4127/4558 (90.5441%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1231, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3868/4235 (91.3341%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3902/4235 (92.1370%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8385, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3393/3804 (89.1956%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3514/3804 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8565, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5733/6391 (89.7043%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5716/6391 (89.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0608, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3921/4336 (90.4290%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4010/4336 (92.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1063, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4178/4663 (89.5990%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4375/4663 (93.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9202, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4054/4511 (89.8692%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4166/4511 (92.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7775, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4043/4503 (89.7846%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4109/4503 (91.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9225, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4748/5063 (93.7784%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4675/5063 (92.3366%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0343, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3944/4315 (91.4021%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4028/4315 (93.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8077, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3237/3638 (88.9775%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3360/3638 (92.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7541, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4094/4441 (92.1864%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4182/4441 (94.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9329, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4367/4679 (93.3319%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4267/4679 (91.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9616, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4745/5265 (90.1235%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4696/5265 (89.1928%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0544, Accuracy: 5426/10000 (54.2600%)
time spent on training: 232.42707443237305
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8287, Accuracy: 5994/10000 (59.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 7.0165, Accuracy: 640/9900 (6.4646%)
Done in 256.0843482017517 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 44.81715647660433.
Norm before scaling: 44.8061103468496. Distance: 1.9553141418128233
Total norm for 4 adversaries is: 44.8061103468496. distance: 1.9553141418128233
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1374, Accuracy: 9587/9900 (96.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4847/5305 (91.3666%), train_poison_data_count: 415
Global model norm: 44.81715647660433.
Norm before scaling: 44.80429312707865. Distance: 2.0642245625382385
Total norm for 4 adversaries is: 44.80429312707865. distance: 2.0642245625382385
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0794, Accuracy: 9691/9900 (97.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4343/4717 (92.0712%), train_poison_data_count: 370
Global model norm: 44.81715647660433.
Norm before scaling: 44.80500558409322. Distance: 1.8409252834999363
Total norm for 4 adversaries is: 44.80500558409322. distance: 1.8409252834999363
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.3604, Accuracy: 9078/9900 (91.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 44.81715647660433.
Norm before scaling: 44.807163319782084. Distance: 2.0502857009166555
Total norm for 4 adversaries is: 44.807163319782084. distance: 2.0502857009166555
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0944, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3951/4336 (91.1208%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4025/4336 (92.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0183, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3538/3828 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7202, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3285/3672 (89.4608%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3305/3672 (90.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9169, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4154/4651 (89.3141%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4244/4651 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9505, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3992/4361 (91.5386%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3927/4361 (90.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0618, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4553/5025 (90.6070%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4651/5025 (92.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0399, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5605/6124 (91.5251%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5632/6124 (91.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1141, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3326/3704 (89.7948%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3404/3704 (91.9006%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7649, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4606/4934 (93.3522%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4350/4934 (88.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2771, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4565/5017 (90.9906%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5017 (91.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7938, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5068/5582 (90.7918%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5154/5582 (92.3325%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9840, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4632/5167 (89.6458%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4688/5167 (90.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2068, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3485/3861 (90.2616%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3527/3861 (91.3494%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9056, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3278/3646 (89.9067%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3355/3646 (92.0187%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7513, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4107/4558 (90.1053%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4125/4558 (90.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9203, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4606/5116 (90.0313%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4633/5116 (90.5590%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9008, Accuracy: 5585/10000 (55.8500%)
time spent on training: 231.84553289413452
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8871, Accuracy: 5904/10000 (59.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 7.1039, Accuracy: 562/9900 (5.6768%)
Done in 255.49071288108826 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 44.85017783853747.
Norm before scaling: 44.838873047087304. Distance: 2.028268357016934
Total norm for 4 adversaries is: 44.838873047087304. distance: 2.028268357016934
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0201, Accuracy: 9836/9900 (99.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 44.85017783853747.
Norm before scaling: 44.8403730762489. Distance: 2.1157309388721157
Total norm for 4 adversaries is: 44.8403730762489. distance: 2.1157309388721157
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1563, Accuracy: 9528/9900 (96.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4334/4717 (91.8804%), train_poison_data_count: 370
Global model norm: 44.85017783853747.
Norm before scaling: 44.836592961100145. Distance: 1.8902152381932589
Total norm for 4 adversaries is: 44.836592961100145. distance: 1.8902152381932589
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0905, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4571/5066 (90.2290%), train_poison_data_count: 400
Global model norm: 44.85017783853747.
Norm before scaling: 44.84376088850042. Distance: 2.128713616571509
Total norm for 4 adversaries is: 44.84376088850042. distance: 2.128713616571509
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1872, Accuracy: 9445/9900 (95.4040%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4040/4511 (89.5589%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9046, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3979/4346 (91.5555%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4118/4346 (94.7538%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.6865, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4528/4804 (94.2548%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4320/4804 (89.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0370, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4626/5232 (88.4174%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4708/5232 (89.9847%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9700, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4230/4618 (91.5981%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4248/4618 (91.9879%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8476, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3281/3590 (91.3928%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3223/3590 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1382, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5862/6391 (91.7227%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5863/6391 (91.7384%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9221, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4176/4354 (95.9118%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3986/4354 (91.5480%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0726, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4547/5055 (89.9505%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4662/5055 (92.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9073, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3488/3837 (90.9044%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3573/3837 (93.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9683, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4069/4503 (90.3620%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4107/4503 (91.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8717, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4176/4576 (91.2587%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4239/4576 (92.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8466, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4237/4793 (88.3997%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4406/4793 (91.9257%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0135, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4186/4634 (90.3323%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4274/4634 (92.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7910, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3587/4158 (86.2674%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3689/4158 (88.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0431, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5133/5740 (89.4251%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9332, Accuracy: 5624/10000 (56.2400%)
time spent on training: 231.90473794937134
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0415, Accuracy: 5703/10000 (57.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 6.9935, Accuracy: 567/9900 (5.7273%)
Done in 255.76198053359985 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 44.877841190088596.
Norm before scaling: 44.86802750933146. Distance: 2.009485994539339
Total norm for 4 adversaries is: 44.86802750933146. distance: 2.009485994539339
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1328, Accuracy: 9552/9900 (96.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 44.877841190088596.
Norm before scaling: 44.868612445812275. Distance: 2.1197108472809028
Total norm for 4 adversaries is: 44.868612445812275. distance: 2.1197108472809028
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1422, Accuracy: 9570/9900 (96.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 44.877841190088596.
Norm before scaling: 44.86545233781292. Distance: 1.925844017383228
Total norm for 4 adversaries is: 44.86545233781292. distance: 1.925844017383228
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2074, Accuracy: 9366/9900 (94.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4587/5066 (90.5448%), train_poison_data_count: 400
Global model norm: 44.877841190088596.
Norm before scaling: 44.871968201466686. Distance: 2.099477989166795
Total norm for 4 adversaries is: 44.871968201466686. distance: 2.099477989166795
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2963, Accuracy: 9169/9900 (92.6162%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3722/4184 (88.9579%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3761/4184 (89.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9439, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5662/6263 (90.4040%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9550, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4050/4456 (90.8887%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4179/4456 (93.7837%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8636, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4161/4538 (91.6924%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4224/4538 (93.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8868, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3825/4235 (90.3188%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3818/4235 (90.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1004, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3768/4223 (89.2257%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3924/4223 (92.9197%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8741, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4868/5455 (89.2392%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4837/5455 (88.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0085, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5037 (88.3065%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4616/5037 (91.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9069, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3438/3756 (91.5335%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3520/3756 (93.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9523, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4781/5265 (90.8072%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4773/5265 (90.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8839, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4548/5055 (89.9703%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4622/5055 (91.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0006, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4542/4804 (94.5462%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4282/4804 (89.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1695, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4766/5063 (94.1339%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4667/5063 (92.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8728, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3927/4295 (91.4319%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3983/4295 (92.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7878, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2912/3271 (89.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1009, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4025/4356 (92.4013%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4129/4356 (94.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9580, Accuracy: 5703/10000 (57.0300%)
time spent on training: 232.46564745903015
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2427, Accuracy: 5390/10000 (53.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 6.5617, Accuracy: 651/9900 (6.5758%)
Done in 256.0172724723816 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 44.909134062745245.
Norm before scaling: 44.89913147084181. Distance: 1.9884259783938434
Total norm for 4 adversaries is: 44.89913147084181. distance: 1.9884259783938434
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1937, Accuracy: 9427/9900 (95.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 44.909134062745245.
Norm before scaling: 44.90285059114775. Distance: 2.095180876578109
Total norm for 4 adversaries is: 44.90285059114775. distance: 2.095180876578109
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1645, Accuracy: 9491/9900 (95.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 44.909134062745245.
Norm before scaling: 44.897419973897165. Distance: 1.8997255829854516
Total norm for 4 adversaries is: 44.897419973897165. distance: 1.8997255829854516
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2453, Accuracy: 9342/9900 (94.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4601/5066 (90.8212%), train_poison_data_count: 400
Global model norm: 44.909134062745245.
Norm before scaling: 44.90263582576821. Distance: 2.0688587770935176
Total norm for 4 adversaries is: 44.90263582576821. distance: 2.0688587770935176
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3366, Accuracy: 9128/9900 (92.2020%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4040/4503 (89.7180%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4088/4503 (90.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0593, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4054/4456 (90.9785%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4153/4456 (93.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9943, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4759/5265 (90.3894%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4831/5265 (91.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9249, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4238/4793 (88.4206%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4357/4793 (90.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9364, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4403/4928 (89.3466%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4517/4928 (91.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9023, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3218/3638 (88.4552%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3329/3638 (91.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8346, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4197/4663 (90.0064%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4336/4663 (92.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8574, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4331/4928 (87.8856%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0243, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4018/4465 (89.9888%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4127/4465 (92.4300%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9554, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3659/3911 (93.5566%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3599/3911 (92.0225%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8951, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4067/4518 (90.0177%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4101/4518 (90.7703%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8997, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3836/4235 (90.5785%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3873/4235 (91.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1381, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4658/4934 (94.4062%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4330/4934 (87.7584%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1632, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4211/4647 (90.6176%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4308/4647 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8232, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4225/4651 (90.8407%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4287/4651 (92.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1698, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4452/4989 (89.2363%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4473/4989 (89.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9973, Accuracy: 5588/10000 (55.8800%)
time spent on training: 232.25892186164856
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2288, Accuracy: 5441/10000 (54.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 6.6123, Accuracy: 741/9900 (7.4848%)
Done in 255.87357759475708 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 44.942121795965946.
Norm before scaling: 44.932721516625556. Distance: 2.0304558008301377
Total norm for 4 adversaries is: 44.932721516625556. distance: 2.0304558008301377
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0772, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 44.942121795965946.
Norm before scaling: 44.93471012288969. Distance: 2.1589270296827148
Total norm for 4 adversaries is: 44.93471012288969. distance: 2.1589270296827148
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.2045, Accuracy: 9443/9900 (95.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 44.942121795965946.
Norm before scaling: 44.92870871934225. Distance: 1.9259860721017195
Total norm for 4 adversaries is: 44.92870871934225. distance: 1.9259860721017195
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1827, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 44.942121795965946.
Norm before scaling: 44.936277582469486. Distance: 2.1455567067425982
Total norm for 4 adversaries is: 44.936277582469486. distance: 2.1455567067425982
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0955, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4122/4538 (90.8330%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4222/4538 (93.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8630, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3984/4362 (91.3343%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3942/4362 (90.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9183, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4578/5244 (87.2998%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4686/5244 (89.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9566, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3651/4046 (90.2373%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3673/4046 (90.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1567, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3651/4013 (90.9793%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9200, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4067/4465 (91.0862%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4119/4465 (92.2508%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8121, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4632/5232 (88.5321%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4690/5232 (89.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8706, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4388/4928 (89.0422%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8726, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4709/5063 (93.0081%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4755/5063 (93.9167%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8008, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5364/5902 (90.8844%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5414/5902 (91.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9870, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4069/4456 (91.3151%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4154/4456 (93.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8128, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4145/4596 (90.1871%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4304/4596 (93.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8235, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3998/4441 (90.0248%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4119/4441 (92.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0640, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5135/5740 (89.4599%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5227/5740 (91.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0561, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3157/3472 (90.9274%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3184/3472 (91.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0892, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3431/3861 (88.8630%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3514/3861 (91.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9027, Accuracy: 5557/10000 (55.5700%)
time spent on training: 233.0442497730255
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1613, Accuracy: 5509/10000 (55.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 6.7241, Accuracy: 652/9900 (6.5859%)
Done in 256.83789253234863 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4497/4885 (92.0573%), train_poison_data_count: 385
Global model norm: 44.97699743037059.
Norm before scaling: 44.96829666640849. Distance: 1.9919159947304168
Total norm for 4 adversaries is: 44.96829666640849. distance: 1.9919159947304168
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1598, Accuracy: 9470/9900 (95.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 44.97699743037059.
Norm before scaling: 44.96888165590526. Distance: 2.0875742916204607
Total norm for 4 adversaries is: 44.96888165590526. distance: 2.0875742916204607
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2298, Accuracy: 9403/9900 (94.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 44.97699743037059.
Norm before scaling: 44.96495895894588. Distance: 1.9394768505047435
Total norm for 4 adversaries is: 44.96495895894588. distance: 1.9394768505047435
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1456, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 44.97699743037059.
Norm before scaling: 44.9661914556196. Distance: 2.0941728762701435
Total norm for 4 adversaries is: 44.9661914556196. distance: 2.0941728762701435
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1626, Accuracy: 9463/9900 (95.5859%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3452/3797 (90.9139%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3435/3797 (90.4662%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0157, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2942/3297 (89.2326%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3069/3297 (93.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7508, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3650/3911 (93.3265%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3511/3911 (89.7724%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0388, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2885/3271 (88.1993%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2942/3271 (89.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9131, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3678/4046 (90.9046%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3768/4046 (93.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8704, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5157/5740 (89.8432%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5265/5740 (91.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0397, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3566/3969 (89.8463%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3622/3969 (91.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8173, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3293/3704 (88.9039%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3356/3704 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9827, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4294/4767 (90.0776%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4351/4767 (91.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0242, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4483/4956 (90.4560%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4508/4956 (90.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9510, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3269/3590 (91.0585%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3068/3590 (85.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2705, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5379/5902 (91.1386%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5330/5902 (90.3084%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1295, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4408/4928 (89.4481%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4518/4928 (91.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8125, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3827/4235 (90.3660%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3937/4235 (92.9634%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9457, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4759/5265 (90.3894%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4734/5265 (89.9145%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0741, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4043/4356 (92.8145%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3838/4356 (88.1084%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1890, Accuracy: 5249/10000 (52.4900%)
time spent on training: 227.59947562217712
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2433, Accuracy: 5349/10000 (53.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 7.5138, Accuracy: 366/9900 (3.6970%)
Done in 251.25516724586487 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 45.00639331754017.
Norm before scaling: 44.99710684058962. Distance: 2.0170309205453534
Total norm for 4 adversaries is: 44.99710684058962. distance: 2.0170309205453534
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1954, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 45.00639331754017.
Norm before scaling: 44.99675009965998. Distance: 2.135383369992569
Total norm for 4 adversaries is: 44.99675009965998. distance: 2.135383369992569
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1550, Accuracy: 9516/9900 (96.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 45.00639331754017.
Norm before scaling: 44.99580601115786. Distance: 1.9700648443326032
Total norm for 4 adversaries is: 44.99580601115786. distance: 1.9700648443326032
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1141, Accuracy: 9603/9900 (97.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 45.00639331754017.
Norm before scaling: 44.99733200641248. Distance: 2.1108840630669325
Total norm for 4 adversaries is: 44.99733200641248. distance: 2.1108840630669325
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1369, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3677/4025 (91.3540%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3818/4025 (94.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8371, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5376/5902 (91.0878%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5382/5902 (91.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0086, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4278/4793 (89.2552%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4376/4793 (91.2998%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8679, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4734/5265 (89.9145%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4779/5265 (90.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8944, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3848/4295 (89.5925%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3871/4295 (90.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0414, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3318/3704 (89.5788%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3414/3704 (92.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7930, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4527/5116 (88.4871%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4557/5116 (89.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9753, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5111/5740 (89.0418%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5236/5740 (91.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1940, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3442/3797 (90.6505%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3496/3797 (92.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8982, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4188/4716 (88.8041%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4237/4716 (89.8431%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0247, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4024/4433 (90.7737%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8593, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3908/4416 (88.4964%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4033/4416 (91.3270%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9395, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3773/4223 (89.3441%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3846/4223 (91.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9072, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4479/5083 (88.1173%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4593/5083 (90.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9896, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4111/4576 (89.8383%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4230/4576 (92.4388%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9856, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4887/5392 (90.6343%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4801/5392 (89.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0585, Accuracy: 5474/10000 (54.7400%)
time spent on training: 234.25019311904907
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2056, Accuracy: 5377/10000 (53.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 7.9814, Accuracy: 248/9900 (2.5051%)
Done in 257.99519968032837 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 45.039485985649996.
Norm before scaling: 45.026958613181115. Distance: 1.9964618977904947
Total norm for 4 adversaries is: 45.026958613181115. distance: 1.9964618977904947
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1892, Accuracy: 9456/9900 (95.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 45.039485985649996.
Norm before scaling: 45.02982545673548. Distance: 2.1197716964293374
Total norm for 4 adversaries is: 45.02982545673548. distance: 2.1197716964293374
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1490, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 45.039485985649996.
Norm before scaling: 45.031022292970434. Distance: 1.9788111384110496
Total norm for 4 adversaries is: 45.031022292970434. distance: 1.9788111384110496
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1256, Accuracy: 9576/9900 (96.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 45.039485985649996.
Norm before scaling: 45.0305275683723. Distance: 2.114288259379501
Total norm for 4 adversaries is: 45.0305275683723. distance: 2.114288259379501
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2687, Accuracy: 9288/9900 (93.8182%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4726/5265 (89.7626%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4791/5265 (90.9972%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9153, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4006/4356 (91.9651%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3916/4356 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2621, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3453/3756 (91.9329%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3532/3756 (94.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7442, Accuracy: 6006/10000 (60.0600%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3438/3837 (89.6013%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3574/3837 (93.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8595, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5171/5740 (90.0871%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5243/5740 (91.3415%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9702, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3755/4223 (88.9178%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3894/4223 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8721, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4030/4465 (90.2576%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4123/4465 (92.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8513, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5054/5591 (90.3953%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5082/5591 (90.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1214, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5390/5902 (91.3250%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5224/5902 (88.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0428, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4435/4918 (90.1789%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4542/4918 (92.3546%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1136, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3478/3861 (90.0803%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3558/3861 (92.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9429, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3857/4295 (89.8021%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3894/4295 (90.6636%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8606, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3586/4158 (86.2434%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3709/4158 (89.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9096, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5655/6263 (90.2922%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9073, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4184/4354 (96.0955%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3585/4354 (82.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.4467, Accuracy: 4667/10000 (46.6700%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3432/3797 (90.3871%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3467/3797 (91.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9616, Accuracy: 5589/10000 (55.8900%)
time spent on training: 231.82128763198853
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1945, Accuracy: 5309/10000 (53.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 8.0915, Accuracy: 247/9900 (2.4949%)
Done in 255.64144372940063 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 45.078965817548294.
Norm before scaling: 45.06814366314845. Distance: 2.0191827174467263
Total norm for 4 adversaries is: 45.06814366314845. distance: 2.0191827174467263
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1968, Accuracy: 9429/9900 (95.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 45.078965817548294.
Norm before scaling: 45.06606072313801. Distance: 2.1271858193133233
Total norm for 4 adversaries is: 45.06606072313801. distance: 2.1271858193133233
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1853, Accuracy: 9446/9900 (95.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4326/4717 (91.7108%), train_poison_data_count: 370
Global model norm: 45.078965817548294.
Norm before scaling: 45.06845921068303. Distance: 1.9582993592365678
Total norm for 4 adversaries is: 45.06845921068303. distance: 1.9582993592365678
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2300, Accuracy: 9342/9900 (94.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4580/5066 (90.4066%), train_poison_data_count: 400
Global model norm: 45.078965817548294.
Norm before scaling: 45.07204925475918. Distance: 2.1639615803126766
Total norm for 4 adversaries is: 45.07204925475918. distance: 2.1639615803126766
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1990, Accuracy: 9398/9900 (94.9293%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3418/3797 (90.0184%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3483/3797 (91.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8854, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4465/5037 (88.6440%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4585/5037 (91.0264%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8945, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4688/4934 (95.0142%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4704/4934 (95.3385%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8216, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4817/5455 (88.3043%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4940/5455 (90.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0135, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5347/5902 (90.5964%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5248/5902 (88.9190%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2090, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5818/6391 (91.0343%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5851/6391 (91.5506%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0397, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3616/3911 (92.4572%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3557/3911 (90.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9397, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4630/5195 (89.1242%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4664/5195 (89.7786%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9977, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3791/4235 (89.5159%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3829/4235 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9640, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4547/5116 (88.8780%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4613/5116 (90.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9398, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4130/4538 (91.0093%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4255/4538 (93.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9318, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5037/5582 (90.2365%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5134/5582 (91.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2263, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4101/4558 (89.9737%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4148/4558 (91.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1209, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3652/4046 (90.2620%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3759/4046 (92.9066%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8550, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3434/3828 (89.7074%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3525/3828 (92.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8228, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4529/5055 (89.5945%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4652/5055 (92.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8953, Accuracy: 5698/10000 (56.9800%)
time spent on training: 235.49652433395386
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1555, Accuracy: 5376/10000 (53.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 7.8902, Accuracy: 310/9900 (3.1313%)
Done in 259.1671619415283 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 45.11633183712413.
Norm before scaling: 45.10663364115638. Distance: 1.9927387148157465
Total norm for 4 adversaries is: 45.10663364115638. distance: 1.9927387148157465
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1547, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 45.11633183712413.
Norm before scaling: 45.10711535299891. Distance: 2.173809918569872
Total norm for 4 adversaries is: 45.10711535299891. distance: 2.173809918569872
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2747, Accuracy: 9265/9900 (93.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 45.11633183712413.
Norm before scaling: 45.10179458735539. Distance: 1.9117746186754583
Total norm for 4 adversaries is: 45.10179458735539. distance: 1.9117746186754583
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1951, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.11633183712413.
Norm before scaling: 45.10663634741705. Distance: 2.1368460608567648
Total norm for 4 adversaries is: 45.10663634741705. distance: 2.1368460608567648
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1995, Accuracy: 9392/9900 (94.8687%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5063/5582 (90.7023%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5196/5582 (93.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0070, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3989/4501 (88.6248%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4100/4501 (91.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9383, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3611/3911 (92.3293%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3536/3911 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0857, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4221/4663 (90.5211%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4319/4663 (92.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8348, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4734/5265 (89.9145%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4750/5265 (90.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0160, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3899/4416 (88.2926%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4051/4416 (91.7346%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9667, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3999/4433 (90.2098%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4107/4433 (92.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7637, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5617/6263 (89.6855%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5675/6263 (90.6115%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0037, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4905/5455 (89.9175%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4951/5455 (90.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9701, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4173/4634 (90.0518%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4221/4634 (91.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8920, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4208/4707 (89.3988%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9420, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3720/4126 (90.1600%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3826/4126 (92.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9000, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4586/5116 (89.6403%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4638/5116 (90.6568%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2084, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4718/5063 (93.1859%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4702/5063 (92.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9469, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3996/4361 (91.6304%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3900/4361 (89.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1077, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5528/6124 (90.2678%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5650/6124 (92.2600%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7845, Accuracy: 5749/10000 (57.4900%)
time spent on training: 237.8563642501831
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1970, Accuracy: 5292/10000 (52.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 8.6329, Accuracy: 197/9900 (1.9899%)
Done in 261.61364126205444 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 45.1427950867266.
Norm before scaling: 45.13252512566464. Distance: 2.0667412816185977
Total norm for 4 adversaries is: 45.13252512566464. distance: 2.0667412816185977
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0457, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 45.1427950867266.
Norm before scaling: 45.12919009718793. Distance: 2.1417579715527424
Total norm for 4 adversaries is: 45.12919009718793. distance: 2.1417579715527424
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1472, Accuracy: 9533/9900 (96.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 45.1427950867266.
Norm before scaling: 45.12625111882287. Distance: 1.9479901373024109
Total norm for 4 adversaries is: 45.12625111882287. distance: 1.9479901373024109
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1842, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 45.1427950867266.
Norm before scaling: 45.13414656912699. Distance: 2.128876572148357
Total norm for 4 adversaries is: 45.13414656912699. distance: 2.128876572148357
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2743, Accuracy: 9233/9900 (93.2626%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4014/4356 (92.1488%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3890/4356 (89.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1160, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3988/4362 (91.4260%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3968/4362 (90.9674%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0402, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4296/4679 (91.8145%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4277/4679 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0659, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3614/4158 (86.9168%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3719/4158 (89.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9483, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4170/4651 (89.6581%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4237/4651 (91.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9823, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3741/4175 (89.6048%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3839/4175 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8889, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4187/4618 (90.6670%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4215/4618 (91.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0818, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4090/4625 (88.4324%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4120/4625 (89.0811%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9971, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5081/5582 (91.0247%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5121/5582 (91.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0255, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4330/4874 (88.8387%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4428/4874 (90.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0288, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4668/4934 (94.6088%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4456/4934 (90.3121%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1795, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4941/5424 (91.0951%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5017/5424 (92.4963%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2346, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4566/4804 (95.0458%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4359/4804 (90.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8215, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4464/4918 (90.7686%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4504/4918 (91.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0677, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3480/3861 (90.1321%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3579/3861 (92.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8430, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3812/4223 (90.2676%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3914/4223 (92.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8028, Accuracy: 5909/10000 (59.0900%)
time spent on training: 233.72092509269714
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0758, Accuracy: 5534/10000 (55.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 8.4566, Accuracy: 252/9900 (2.5455%)
Done in 257.6057367324829 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 45.16924283233974.
Norm before scaling: 45.15826660721988. Distance: 2.022778613653688
Total norm for 4 adversaries is: 45.15826660721988. distance: 2.022778613653688
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1538, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 45.16924283233974.
Norm before scaling: 45.157362388980246. Distance: 2.152461829295634
Total norm for 4 adversaries is: 45.157362388980246. distance: 2.152461829295634
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1424, Accuracy: 9553/9900 (96.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 45.16924283233974.
Norm before scaling: 45.1567582151332. Distance: 1.9762431252328008
Total norm for 4 adversaries is: 45.1567582151332. distance: 1.9762431252328008
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1904, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 45.16924283233974.
Norm before scaling: 45.16218737998983. Distance: 2.1651294708302697
Total norm for 4 adversaries is: 45.16218737998983. distance: 2.1651294708302697
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.3110, Accuracy: 9148/9900 (92.4040%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4141/4647 (89.1113%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4259/4647 (91.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8977, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3400/3804 (89.3796%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3510/3804 (92.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8494, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5042/5591 (90.1806%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5080/5591 (90.8603%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0115, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4170/4634 (89.9871%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4267/4634 (92.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8031, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4031/4433 (90.9316%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4155/4433 (93.7289%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7870, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3385/3704 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8804, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3448/3837 (89.8619%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3591/3837 (93.5887%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8749, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4881/5455 (89.4775%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4929/5455 (90.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0581, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5163/5740 (89.9477%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5219/5740 (90.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9864, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4436/4986 (88.9691%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4547/4986 (91.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9395, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4079/4456 (91.5395%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9052, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4038/4356 (92.6997%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3933/4356 (90.2893%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1277, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3222/3590 (89.7493%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3259/3590 (90.7799%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0595, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4033/4503 (89.5625%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4104/4503 (91.1392%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8262, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4475/5037 (88.8426%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4603/5037 (91.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9858, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4647/5167 (89.9361%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4725/5167 (91.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0187, Accuracy: 5480/10000 (54.8000%)
time spent on training: 232.66993117332458
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1124, Accuracy: 5419/10000 (54.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 8.3784, Accuracy: 251/9900 (2.5354%)
Done in 256.3116936683655 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 45.19828682412573.
Norm before scaling: 45.18774042553605. Distance: 2.0610976798256
Total norm for 4 adversaries is: 45.18774042553605. distance: 2.0610976798256
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1495, Accuracy: 9516/9900 (96.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 45.19828682412573.
Norm before scaling: 45.18606552443048. Distance: 2.172062159096681
Total norm for 4 adversaries is: 45.18606552443048. distance: 2.172062159096681
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2534, Accuracy: 9265/9900 (93.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 45.19828682412573.
Norm before scaling: 45.18367192896539. Distance: 1.9785182760810225
Total norm for 4 adversaries is: 45.18367192896539. distance: 1.9785182760810225
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0901, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 45.19828682412573.
Norm before scaling: 45.191248061623476. Distance: 2.1827989472696885
Total norm for 4 adversaries is: 45.191248061623476. distance: 2.1827989472696885
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1368, Accuracy: 9561/9900 (96.5758%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3247/3638 (89.2523%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8594, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4193/4716 (88.9101%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4328/4716 (91.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9744, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4420/4956 (89.1848%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4467/4956 (90.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9781, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4990/5392 (92.5445%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4963/5392 (92.0438%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9652, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3730/4184 (89.1491%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3852/4184 (92.0650%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8101, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4081/4481 (91.0734%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4075/4481 (90.9395%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9443, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3275/3646 (89.8245%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3379/3646 (92.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7810, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4521/5025 (89.9701%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4566/5025 (90.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0025, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3236/3590 (90.1393%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3193/3590 (88.9415%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0900, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4167/4596 (90.6658%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4291/4596 (93.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9228, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3918/4336 (90.3598%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3991/4336 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9630, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4321/4874 (88.6541%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4250/4874 (87.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0014, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4665/5167 (90.2845%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4708/5167 (91.1167%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0326, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4179/4618 (90.4937%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4269/4618 (92.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9632, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4394/4928 (89.1640%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8788, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4185/4647 (90.0581%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4285/4647 (92.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8426, Accuracy: 5765/10000 (57.6500%)
time spent on training: 231.94335746765137
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Client 7 misclassified the most to class 95 with 1 misclassifications.
Client 7 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {7: 1})
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(7, 1)]
Top 3 clients: [(7, 1)]
Client 7 misclassification ratio: 1.0000
Client 7 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0622, Accuracy: 5487/10000 (54.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 7.5661, Accuracy: 433/9900 (4.3737%)
Done in 255.86438918113708 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 45.21596802732899.
Norm before scaling: 45.207780394564. Distance: 1.9729717342287374
Total norm for 4 adversaries is: 45.207780394564. distance: 1.9729717342287374
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.4240, Accuracy: 8926/9900 (90.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4855/5305 (91.5174%), train_poison_data_count: 415
Global model norm: 45.21596802732899.
Norm before scaling: 45.20546760910468. Distance: 2.098640310523483
Total norm for 4 adversaries is: 45.20546760910468. distance: 2.098640310523483
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2331, Accuracy: 9324/9900 (94.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 45.21596802732899.
Norm before scaling: 45.204122817797966. Distance: 1.92758008036029
Total norm for 4 adversaries is: 45.204122817797966. distance: 1.92758008036029
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1970, Accuracy: 9405/9900 (95.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 45.21596802732899.
Norm before scaling: 45.20745906892744. Distance: 2.070721049753818
Total norm for 4 adversaries is: 45.20745906892744. distance: 2.070721049753818
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2879, Accuracy: 9208/9900 (93.0101%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3905/4368 (89.4002%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3927/4368 (89.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9014, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4688/5195 (90.2406%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4593/5195 (88.4119%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1176, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3941/4315 (91.3326%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9111, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3283/3646 (90.0439%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3378/3646 (92.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8127, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3259/3590 (90.7799%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3312/3590 (92.2563%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9448, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3741/4126 (90.6689%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3830/4126 (92.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8157, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4046/4361 (92.7769%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4095/4361 (93.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8175, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3440/3837 (89.6534%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3566/3837 (92.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8823, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3857/4235 (91.0744%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3794/4235 (89.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0208, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5526/5902 (93.6293%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5505/5902 (93.2735%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0979, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4013/4433 (90.5256%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4108/4433 (92.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8149, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3250/3638 (89.3348%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3363/3638 (92.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8765, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4642/5232 (88.7232%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4721/5232 (90.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9168, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3891/4336 (89.7371%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3994/4336 (92.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9534, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4411/4989 (88.4145%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4530/4989 (90.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8315, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4100/4481 (91.4974%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4063/4481 (90.6717%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9213, Accuracy: 5672/10000 (56.7200%)
time spent on training: 229.20705389976501
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0377, Accuracy: 5511/10000 (55.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 7.6460, Accuracy: 394/9900 (3.9798%)
Done in 252.89918398857117 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 45.24816148932531.
Norm before scaling: 45.23525609029629. Distance: 1.9668311804589476
Total norm for 4 adversaries is: 45.23525609029629. distance: 1.9668311804589476
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1316, Accuracy: 9568/9900 (96.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4857/5305 (91.5551%), train_poison_data_count: 415
Global model norm: 45.24816148932531.
Norm before scaling: 45.233840670419255. Distance: 2.034931426708888
Total norm for 4 adversaries is: 45.233840670419255. distance: 2.034931426708888
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1002, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4337/4717 (91.9440%), train_poison_data_count: 370
Global model norm: 45.24816148932531.
Norm before scaling: 45.23239821889629. Distance: 1.858526276577921
Total norm for 4 adversaries is: 45.23239821889629. distance: 1.858526276577921
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0656, Accuracy: 9735/9900 (98.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 45.24816148932531.
Norm before scaling: 45.24224618477458. Distance: 2.1218630131648375
Total norm for 4 adversaries is: 45.24224618477458. distance: 2.1218630131648375
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1832, Accuracy: 9451/9900 (95.4646%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4562/5116 (89.1712%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4669/5116 (91.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9248, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1338, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4093/4441 (92.1639%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4152/4441 (93.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9802, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4246/4663 (91.0573%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4315/4663 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8872, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4579/5083 (90.0846%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4650/5083 (91.4814%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9198, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4259/4767 (89.3434%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4322/4767 (90.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9996, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3443/3797 (90.6769%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3490/3797 (91.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8226, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4751/5195 (91.4533%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4779/5195 (91.9923%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9920, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4176/4618 (90.4288%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4184/4618 (90.6020%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0598, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4040/4433 (91.1347%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4084/4433 (92.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9096, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4549/5055 (89.9901%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4608/5055 (91.1573%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8649, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3644/4158 (87.6383%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3732/4158 (89.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8204, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3456/3781 (91.4044%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3424/3781 (90.5581%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1100, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3721/4175 (89.1257%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3761/4175 (90.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8298, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4826/5265 (91.6619%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4677/5265 (88.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0066, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3492/3837 (91.0086%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3556/3837 (92.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7606, Accuracy: 5855/10000 (58.5500%)
time spent on training: 230.2745349407196
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1204, Accuracy: 5419/10000 (54.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 7.8237, Accuracy: 333/9900 (3.3636%)
Done in 253.83563995361328 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 45.278767077371654.
Norm before scaling: 45.26529060111207. Distance: 2.0004729665366012
Total norm for 4 adversaries is: 45.26529060111207. distance: 2.0004729665366012
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1453, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4834/5305 (91.1216%), train_poison_data_count: 415
Global model norm: 45.278767077371654.
Norm before scaling: 45.26659582148436. Distance: 2.1119995743360955
Total norm for 4 adversaries is: 45.26659582148436. distance: 2.1119995743360955
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1434, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4341/4717 (92.0288%), train_poison_data_count: 370
Global model norm: 45.278767077371654.
Norm before scaling: 45.263656325846846. Distance: 1.8865717165186149
Total norm for 4 adversaries is: 45.263656325846846. distance: 1.8865717165186149
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1562, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4617/5066 (91.1370%), train_poison_data_count: 400
Global model norm: 45.278767077371654.
Norm before scaling: 45.2714738842933. Distance: 2.1210224849187154
Total norm for 4 adversaries is: 45.2714738842933. distance: 2.1210224849187154
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0754, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3644/3911 (93.1731%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3536/3911 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0146, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4783/5195 (92.0693%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4766/5195 (91.7421%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0326, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3464/3775 (91.7616%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8062, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4320/4679 (92.3274%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4323/4679 (92.3915%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9553, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4034/4361 (92.5017%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4046/4361 (92.7769%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8861, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3279/3672 (89.2974%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3366/3672 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9788, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4112/4481 (91.7652%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4056/4481 (90.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9526, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3740/4126 (90.6447%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3851/4126 (93.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7738, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3641/3969 (91.7360%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3625/3969 (91.3328%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9163, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4601/5116 (89.9335%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4672/5116 (91.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9382, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4672/5063 (92.2773%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4462/5063 (88.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9427, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2994/3297 (90.8098%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3070/3297 (93.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.6980, Accuracy: 6058/10000 (60.5800%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4620/5037 (91.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9080, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4204/4596 (91.4708%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4295/4596 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0343, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4013/4501 (89.1580%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4026/4501 (89.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9897, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4086/4465 (91.5118%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4188/4465 (93.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7540, Accuracy: 5965/10000 (59.6500%)
time spent on training: 229.0797996520996
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1908, Accuracy: 5287/10000 (52.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 7.8140, Accuracy: 292/9900 (2.9495%)
Done in 252.76048755645752 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 45.309514987886374.
Norm before scaling: 45.298526940384605. Distance: 1.992621998994713
Total norm for 4 adversaries is: 45.298526940384605. distance: 1.992621998994713
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1930, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 45.309514987886374.
Norm before scaling: 45.29707711665842. Distance: 2.124190456795417
Total norm for 4 adversaries is: 45.29707711665842. distance: 2.124190456795417
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0887, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 45.309514987886374.
Norm before scaling: 45.29778586528126. Distance: 1.9097798918676676
Total norm for 4 adversaries is: 45.29778586528126. distance: 1.9097798918676676
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.2860, Accuracy: 9227/9900 (93.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 45.309514987886374.
Norm before scaling: 45.300251577322946. Distance: 2.092760905745844
Total norm for 4 adversaries is: 45.300251577322946. distance: 2.092760905745844
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1982, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4023/4361 (92.2495%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4104/4361 (94.1069%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8055, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3984/4346 (91.6705%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4075/4346 (93.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7143, Accuracy: 6039/10000 (60.3900%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4988/5455 (91.4390%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4986/5455 (91.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9726, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4035/4465 (90.3695%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4177/4465 (93.5498%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8001, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3940/4336 (90.8672%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4024/4336 (92.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0620, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4079/4441 (91.8487%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4169/4441 (93.8753%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9331, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3972/4362 (91.0591%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3953/4362 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0103, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3599/3969 (90.6778%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3650/3969 (91.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8223, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3860/4295 (89.8719%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3935/4295 (91.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0123, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4532/5017 (90.3329%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4599/5017 (91.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8917, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4749/5063 (93.7981%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4685/5063 (92.5341%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9901, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0064, Accuracy: 2870/3271 (87.7408%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9772, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5760/6263 (91.9687%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5752/6263 (91.8410%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0030, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4368/4874 (89.6184%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4336/4874 (88.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0610, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3652/3911 (93.3777%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3524/3911 (90.1048%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8943, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4557/4804 (94.8585%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4507/4804 (93.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8415, Accuracy: 5871/10000 (58.7100%)
time spent on training: 231.577481508255
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3458, Accuracy: 5087/10000 (50.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 7.7834, Accuracy: 294/9900 (2.9697%)
Done in 255.1701226234436 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 45.32922913167479.
Norm before scaling: 45.31700947388574. Distance: 1.9970578368154026
Total norm for 4 adversaries is: 45.31700947388574. distance: 1.9970578368154026
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0909, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 45.32922913167479.
Norm before scaling: 45.31683707692153. Distance: 2.156507283216808
Total norm for 4 adversaries is: 45.31683707692153. distance: 2.156507283216808
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.2078, Accuracy: 9387/9900 (94.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4314/4717 (91.4564%), train_poison_data_count: 370
Global model norm: 45.32922913167479.
Norm before scaling: 45.31638991923894. Distance: 1.9402939125481822
Total norm for 4 adversaries is: 45.31638991923894. distance: 1.9402939125481822
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1404, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4592/5066 (90.6435%), train_poison_data_count: 400
Global model norm: 45.32922913167479.
Norm before scaling: 45.31973002663961. Distance: 2.1045407884831797
Total norm for 4 adversaries is: 45.31973002663961. distance: 2.1045407884831797
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1371, Accuracy: 9549/9900 (96.4545%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5474/5902 (92.7482%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5475/5902 (92.7652%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9253, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4918 (90.8906%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4557/4918 (92.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0324, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3658/4025 (90.8820%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3755/4025 (93.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8068, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3177/3472 (91.5035%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3195/3472 (92.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8602, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4293/4793 (89.5681%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4421/4793 (92.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9470, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4693/4934 (95.1155%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4707/4934 (95.3993%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7941, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3668/3911 (93.7868%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3676/3911 (93.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8225, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4943/5392 (91.6728%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4923/5392 (91.3019%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1000, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3281/3638 (90.1869%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8302, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5543/6124 (90.5127%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5605/6124 (91.5251%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8378, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3759/4175 (90.0359%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3802/4175 (91.0659%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8123, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4104/4625 (88.7351%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4142/4625 (89.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0819, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4234/4354 (97.2439%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3931/4354 (90.2848%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3007, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4063/4511 (90.0687%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4156/4511 (92.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8918, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3351/3704 (90.4698%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3401/3704 (91.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7634, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3528/3861 (91.3753%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3589/3861 (92.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7618, Accuracy: 5900/10000 (59.0000%)
time spent on training: 231.5929253101349
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.5951, Accuracy: 4804/10000 (48.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 6.9370, Accuracy: 515/9900 (5.2020%)
Done in 255.209858417511 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 45.356909810723714.
Norm before scaling: 45.34376615265047. Distance: 1.9890864152811598
Total norm for 4 adversaries is: 45.34376615265047. distance: 1.9890864152811598
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0506, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 45.356909810723714.
Norm before scaling: 45.34422650076992. Distance: 2.1116799653358878
Total norm for 4 adversaries is: 45.34422650076992. distance: 2.1116799653358878
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0805, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 45.356909810723714.
Norm before scaling: 45.34446609531035. Distance: 1.9775958469856505
Total norm for 4 adversaries is: 45.34446609531035. distance: 1.9775958469856505
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.2139, Accuracy: 9349/9900 (94.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 45.356909810723714.
Norm before scaling: 45.344514552479225. Distance: 2.070715062571702
Total norm for 4 adversaries is: 45.344514552479225. distance: 2.070715062571702
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1145, Accuracy: 9629/9900 (97.2626%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4492/5083 (88.3730%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4489/5083 (88.3140%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1046, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3291/3646 (90.2633%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3348/3646 (91.8267%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8929, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4063/4503 (90.2287%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4087/4503 (90.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9781, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4031/4501 (89.5579%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4094/4501 (90.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8105, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3687/4013 (91.8764%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3723/4013 (92.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7738, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4046/4362 (92.7556%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4018/4362 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9952, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3959/4315 (91.7497%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4055/4315 (93.9745%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7967, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4173/4651 (89.7226%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4238/4651 (91.1202%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0252, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3928/4416 (88.9493%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4036/4416 (91.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9830, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3277/3704 (88.4719%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3408/3704 (92.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8240, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4228/4707 (89.8237%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4326/4707 (91.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8679, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4197/4662 (90.0257%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4306/4662 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8292, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4949/5424 (91.2426%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4969/5424 (91.6114%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1893, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3934/4336 (90.7288%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4045/4336 (93.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0580, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4106/4481 (91.6313%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4060/4481 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9201, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3466/3828 (90.5434%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3543/3828 (92.5549%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7968, Accuracy: 5849/10000 (58.4900%)
time spent on training: 229.67936992645264
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.6363, Accuracy: 4732/10000 (47.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 6.7473, Accuracy: 579/9900 (5.8485%)
Done in 253.6255714893341 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 45.389785921676534.
Norm before scaling: 45.37353378743356. Distance: 2.0048686610938096
Total norm for 4 adversaries is: 45.37353378743356. distance: 2.0048686610938096
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0696, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 45.389785921676534.
Norm before scaling: 45.377612162242244. Distance: 2.1499481993356633
Total norm for 4 adversaries is: 45.377612162242244. distance: 2.1499481993356633
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1270, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.389785921676534.
Norm before scaling: 45.37623750034262. Distance: 1.9808588189312533
Total norm for 4 adversaries is: 45.37623750034262. distance: 1.9808588189312533
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.2094, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 45.389785921676534.
Norm before scaling: 45.37998207841757. Distance: 2.151131678091901
Total norm for 4 adversaries is: 45.37998207841757. distance: 2.151131678091901
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1454, Accuracy: 9561/9900 (96.5758%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3759/4184 (89.8423%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3860/4184 (92.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9444, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4481/5037 (88.9617%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4625/5037 (91.8205%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8236, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3648/4158 (87.7345%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3772/4158 (90.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7919, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3007/3271 (91.9291%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3077/3271 (94.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.6614, Accuracy: 6105/10000 (61.0500%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4453/4918 (90.5449%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4552/4918 (92.5580%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0627, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5466/5902 (92.6127%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5355/5902 (90.7320%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0432, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4251/4354 (97.6344%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3852/4354 (88.4704%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1658, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3620/3969 (91.2069%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3683/3969 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8994, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4016/4356 (92.1947%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4001/4356 (91.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0170, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3867/4295 (90.0349%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3864/4295 (89.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0022, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3745/4126 (90.7659%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3832/4126 (92.8745%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8483, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4419/4928 (89.6713%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4526/4928 (91.8425%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8768, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4040/4511 (89.5589%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8731, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4172/4618 (90.3421%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4150/4618 (89.8657%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0188, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3297/3704 (89.0119%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3416/3704 (92.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8677, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3221/3616 (89.0763%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3312/3616 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9866, Accuracy: 5754/10000 (57.5400%)
time spent on training: 229.08004903793335
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.6691, Accuracy: 4721/10000 (47.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 8.0119, Accuracy: 224/9900 (2.2626%)
Done in 252.76212430000305 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4525/4885 (92.6305%), train_poison_data_count: 385
Global model norm: 45.419071873429445.
Norm before scaling: 45.40366368236433. Distance: 1.926367494439421
Total norm for 4 adversaries is: 45.40366368236433. distance: 1.926367494439421
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1795, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 45.419071873429445.
Norm before scaling: 45.408938323721024. Distance: 2.1529014128045008
Total norm for 4 adversaries is: 45.408938323721024. distance: 2.1529014128045008
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0992, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.419071873429445.
Norm before scaling: 45.40536550669838. Distance: 1.945305268913832
Total norm for 4 adversaries is: 45.40536550669838. distance: 1.945305268913832
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0996, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4578/5066 (90.3672%), train_poison_data_count: 400
Global model norm: 45.419071873429445.
Norm before scaling: 45.41159423126433. Distance: 2.1575825208881674
Total norm for 4 adversaries is: 45.41159423126433. distance: 2.1575825208881674
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2127, Accuracy: 9389/9900 (94.8384%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2983/3271 (91.1954%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8371, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4067/4456 (91.2702%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4153/4456 (93.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8674, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3660/4013 (91.2036%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6578, Accuracy: 6073/10000 (60.7300%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3421/3781 (90.4787%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3452/3781 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9751, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3446/3775 (91.2848%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3565/3775 (94.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7845, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4609/5232 (88.0925%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4718/5232 (90.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9948, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4431/4989 (88.8154%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4473/4989 (89.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0849, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3258/3646 (89.3582%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8149, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3949/4315 (91.5180%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4004/4315 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8744, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4918 (90.8906%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4535/4918 (92.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1458, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3912/4416 (88.5870%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4004/4416 (90.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9097, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5651/6263 (90.2283%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5747/6263 (91.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9785, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5539/6124 (90.4474%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5589/6124 (91.2639%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9611, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4194/4651 (90.1742%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4299/4651 (92.4317%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9835, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4062/4356 (93.2507%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3969/4356 (91.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9859, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4024/4356 (92.3783%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3777/4356 (86.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1534, Accuracy: 5130/10000 (51.3000%)
time spent on training: 231.10467624664307
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.8974, Accuracy: 4363/10000 (43.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 7.9177, Accuracy: 212/9900 (2.1414%)
Done in 255.01940822601318 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.44559386731705.
Norm before scaling: 45.432158816057814. Distance: 2.030924140028088
Total norm for 4 adversaries is: 45.432158816057814. distance: 2.030924140028088
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1491, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 45.44559386731705.
Norm before scaling: 45.434179297501345. Distance: 2.194039841331032
Total norm for 4 adversaries is: 45.434179297501345. distance: 2.194039841331032
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0513, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4335/4717 (91.9016%), train_poison_data_count: 370
Global model norm: 45.44559386731705.
Norm before scaling: 45.42935901106519. Distance: 1.9054947279269363
Total norm for 4 adversaries is: 45.42935901106519. distance: 1.9054947279269363
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1830, Accuracy: 9437/9900 (95.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 45.44559386731705.
Norm before scaling: 45.435952518352686. Distance: 2.092884625050309
Total norm for 4 adversaries is: 45.435952518352686. distance: 2.092884625050309
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1392, Accuracy: 9563/9900 (96.5960%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4170/4716 (88.4224%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4296/4716 (91.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8909, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4147/4634 (89.4907%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4257/4634 (91.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8370, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3448/3828 (90.0731%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9640, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4989 (87.8533%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4515/4989 (90.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0856, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4515/5116 (88.2525%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4626/5116 (90.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0242, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4006/4362 (91.8386%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4019/4362 (92.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9712, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4509/5017 (89.8744%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5017 (91.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9560, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4259/4354 (97.8181%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3781/4354 (86.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3322, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3215/3638 (88.3727%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3333/3638 (91.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8496, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4745/5195 (91.3378%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4661/5195 (89.7209%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0214, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4125/4596 (89.7520%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4278/4596 (93.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8889, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4348/4928 (88.2305%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9521, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4724/5244 (90.0839%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4759/5244 (90.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8302, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5461/5902 (92.5280%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5364/5902 (90.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0664, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4497/5025 (89.4925%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4613/5025 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0461, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5565/6124 (90.8720%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5599/6124 (91.4272%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8342, Accuracy: 5852/10000 (58.5200%)
time spent on training: 234.5764639377594
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 3.3822, Accuracy: 3735/10000 (37.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 7.8745, Accuracy: 172/9900 (1.7374%)
Done in 258.806512594223 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4432/4885 (90.7267%), train_poison_data_count: 385
Global model norm: 45.48012100082848.
Norm before scaling: 45.47408688610471. Distance: 2.1342619836691332
Total norm for 4 adversaries is: 45.47408688610471. distance: 2.1342619836691332
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0619, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 45.48012100082848.
Norm before scaling: 45.46858354780529. Distance: 2.174335869428524
Total norm for 4 adversaries is: 45.46858354780529. distance: 2.174335869428524
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1985, Accuracy: 9421/9900 (95.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.48012100082848.
Norm before scaling: 45.468320444706336. Distance: 1.9819293232392707
Total norm for 4 adversaries is: 45.468320444706336. distance: 1.9819293232392707
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1322, Accuracy: 9576/9900 (96.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 45.48012100082848.
Norm before scaling: 45.471732612655906. Distance: 2.1594810051300137
Total norm for 4 adversaries is: 45.471732612655906. distance: 2.1594810051300137
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0502, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4594/5116 (89.7967%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4629/5116 (90.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0177, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4612/5197 (88.7435%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4698/5197 (90.3983%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0740, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4154/4356 (95.3627%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4004/4356 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0306, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4278/4679 (91.4298%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4119/4679 (88.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1672, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4168/4647 (89.6923%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4309/4647 (92.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8219, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3590/3911 (91.7924%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3529/3911 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1133, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3918/4315 (90.7995%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4034/4315 (93.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8077, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3222/3646 (88.3708%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3374/3646 (92.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7500, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4223/4634 (91.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9750, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4540/5055 (89.8121%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5055 (91.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9020, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4005/4362 (91.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9301, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4611/4934 (93.4536%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4522/4934 (91.6498%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9147, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4767 (89.0078%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4318/4767 (90.5811%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0748, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4109/4433 (92.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7691, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4293/4928 (87.1144%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9603, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3396/3837 (88.5066%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1047, Accuracy: 5435/10000 (54.3500%)
time spent on training: 231.92555260658264
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 3.1088, Accuracy: 3983/10000 (39.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 7.8457, Accuracy: 154/9900 (1.5556%)
Done in 255.64820528030396 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 45.506065551233114.
Norm before scaling: 45.49526718173551. Distance: 2.1019123452708843
Total norm for 4 adversaries is: 45.49526718173551. distance: 2.1019123452708843
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1469, Accuracy: 9549/9900 (96.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 45.506065551233114.
Norm before scaling: 45.49808707774839. Distance: 2.209593347446059
Total norm for 4 adversaries is: 45.49808707774839. distance: 2.209593347446059
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1736, Accuracy: 9454/9900 (95.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 45.506065551233114.
Norm before scaling: 45.49455614325603. Distance: 2.0433808999595096
Total norm for 4 adversaries is: 45.49455614325603. distance: 2.0433808999595096
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1033, Accuracy: 9628/9900 (97.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4577/5066 (90.3474%), train_poison_data_count: 400
Global model norm: 45.506065551233114.
Norm before scaling: 45.5015935933155. Distance: 2.181830333907069
Total norm for 4 adversaries is: 45.5015935933155. distance: 2.181830333907069
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1210, Accuracy: 9613/9900 (97.1010%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4434/4986 (88.9290%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4574/4986 (91.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8241, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4242/4767 (88.9868%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4285/4767 (89.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9450, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3906/4315 (90.5214%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4032/4315 (93.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8975, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3337/3672 (90.8769%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3372/3672 (91.8301%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9941, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4072/4558 (89.3374%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4074/4558 (89.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1043, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3430/3828 (89.6029%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3578/3828 (93.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7578, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4281/4679 (91.4939%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4175/4679 (89.2285%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1198, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4956 (88.4988%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4491/4956 (90.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0199, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4129/4356 (94.7888%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4083/4356 (93.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8722, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4117/4538 (90.7228%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4211/4538 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8236, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3645/4013 (90.8298%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3768/4013 (93.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8041, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4813/5265 (91.4150%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4895/5265 (92.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9256, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4220/4663 (90.4997%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9125, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5640/6263 (90.0527%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5744/6263 (91.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9464, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4689/5063 (92.6131%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4675/5063 (92.3366%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9500, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3886/4416 (87.9982%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4050/4416 (91.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8796, Accuracy: 5702/10000 (57.0200%)
time spent on training: 232.02455139160156
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.9727, Accuracy: 4120/10000 (41.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 8.1461, Accuracy: 133/9900 (1.3434%)
Done in 255.7966663837433 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.53290148000125.
Norm before scaling: 45.51841145349868. Distance: 2.0316448121411863
Total norm for 4 adversaries is: 45.51841145349868. distance: 2.0316448121411863
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0843, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 45.53290148000125.
Norm before scaling: 45.520521964514806. Distance: 2.1551677918220156
Total norm for 4 adversaries is: 45.520521964514806. distance: 2.1551677918220156
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0398, Accuracy: 9803/9900 (99.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 45.53290148000125.
Norm before scaling: 45.51808695710283. Distance: 1.9567856929628764
Total norm for 4 adversaries is: 45.51808695710283. distance: 1.9567856929628764
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1320, Accuracy: 9580/9900 (96.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4602/5066 (90.8409%), train_poison_data_count: 400
Global model norm: 45.53290148000125.
Norm before scaling: 45.52143639951402. Distance: 2.10936946161744
Total norm for 4 adversaries is: 45.52143639951402. distance: 2.10936946161744
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2679, Accuracy: 9257/9900 (93.5051%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5087/5740 (88.6237%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5206/5740 (90.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0377, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4144/4651 (89.0991%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4334/4651 (93.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9468, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4021/4503 (89.2960%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4083/4503 (90.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8328, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4226/4767 (88.6511%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4328/4767 (90.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0855, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4968/5591 (88.8571%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4976/5591 (89.0002%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0690, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3980/4465 (89.1377%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4183/4465 (93.6842%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8234, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4402/4956 (88.8216%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4487/4956 (90.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0398, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3271/3704 (88.3099%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3407/3704 (91.9816%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8338, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3665/4025 (91.0559%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3788/4025 (94.1118%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7623, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4654/5083 (91.5601%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4687/5083 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0644, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5518/6124 (90.1045%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5524/6124 (90.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9272, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3824/4295 (89.0338%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3769/4295 (87.7532%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9420, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4548/4804 (94.6711%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4405/4804 (91.6944%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0336, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4265/4793 (88.9839%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4401/4793 (91.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9424, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3994/4433 (90.0970%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4104/4433 (92.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8434, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3956/4361 (90.7131%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3978/4361 (91.2176%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8732, Accuracy: 5770/10000 (57.7000%)
time spent on training: 235.00717973709106
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 3.0666, Accuracy: 4046/10000 (40.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 8.6461, Accuracy: 88/9900 (0.8889%)
Done in 258.74655985832214 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.559188408459384.
Norm before scaling: 45.547461938756804. Distance: 2.0532632395104864
Total norm for 4 adversaries is: 45.547461938756804. distance: 2.0532632395104864
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0641, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 45.559188408459384.
Norm before scaling: 45.54717517053747. Distance: 2.214688949961273
Total norm for 4 adversaries is: 45.54717517053747. distance: 2.214688949961273
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1328, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 45.559188408459384.
Norm before scaling: 45.546676671952426. Distance: 2.0109062850414583
Total norm for 4 adversaries is: 45.546676671952426. distance: 2.0109062850414583
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2269, Accuracy: 9356/9900 (94.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 45.559188408459384.
Norm before scaling: 45.550742224331536. Distance: 2.1765272412863954
Total norm for 4 adversaries is: 45.550742224331536. distance: 2.1765272412863954
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0918, Accuracy: 9669/9900 (97.6667%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4130/4558 (90.6099%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4161/4558 (91.2900%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0148, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4160/4596 (90.5135%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4259/4596 (92.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9210, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4324/4874 (88.7156%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4289/4874 (87.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1307, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3644/4158 (87.6383%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3761/4158 (90.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8639, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4951/5455 (90.7608%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5003/5455 (91.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9278, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3933/4346 (90.4970%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4059/4346 (93.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8431, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4403/4679 (94.1013%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4467/4679 (95.4691%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8822, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3921/4416 (88.7908%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4011/4416 (90.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8026, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3445/3828 (89.9948%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3558/3828 (92.9467%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8076, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3791/4223 (89.7703%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3928/4223 (93.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0134, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4779/5265 (90.7692%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0351, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5472/6124 (89.3534%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5571/6124 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8184, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3992/4361 (91.5386%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3985/4361 (91.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9470, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4956 (89.1445%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4455/4956 (89.8910%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0402, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5102/5740 (88.8850%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5172/5740 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0865, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3599/4013 (89.6835%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3737/4013 (93.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8796, Accuracy: 5728/10000 (57.2800%)
time spent on training: 230.74876499176025
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 3.0919, Accuracy: 3964/10000 (39.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 8.6359, Accuracy: 77/9900 (0.7778%)
Done in 254.5631606578827 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.58898139473369.
Norm before scaling: 45.57329583175601. Distance: 2.0006352846166697
Total norm for 4 adversaries is: 45.57329583175601. distance: 2.0006352846166697
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1449, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 45.58898139473369.
Norm before scaling: 45.57503953388987. Distance: 2.1581306548918637
Total norm for 4 adversaries is: 45.57503953388987. distance: 2.1581306548918637
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2664, Accuracy: 9252/9900 (93.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4323/4717 (91.6472%), train_poison_data_count: 370
Global model norm: 45.58898139473369.
Norm before scaling: 45.57018325135965. Distance: 1.9577553146303808
Total norm for 4 adversaries is: 45.57018325135965. distance: 1.9577553146303808
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0661, Accuracy: 9722/9900 (98.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 45.58898139473369.
Norm before scaling: 45.57749292499671. Distance: 2.152853571333469
Total norm for 4 adversaries is: 45.57749292499671. distance: 2.152853571333469
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1188, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3720/4184 (88.9101%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3874/4184 (92.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8346, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3252/3590 (90.5850%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3316/3590 (92.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9537, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3614/4158 (86.9168%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3714/4158 (89.3218%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9898, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3648/4025 (90.6335%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3781/4025 (93.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9102, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3633/4046 (89.7924%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3744/4046 (92.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8606, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4499/5025 (89.5323%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4645/5025 (92.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1166, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4684/5063 (92.5143%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4673/5063 (92.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9410, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4039/4356 (92.7227%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4027/4356 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0343, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4186/4651 (90.0022%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4311/4651 (92.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9723, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4143/4356 (95.1102%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3953/4356 (90.7484%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0421, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4097/4576 (89.5323%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4229/4576 (92.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0181, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4037/4456 (90.5969%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4143/4456 (92.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8202, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2947/3297 (89.3843%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3097/3297 (93.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7089, Accuracy: 6029/10000 (60.2900%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4617/4804 (96.1074%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4489/4804 (93.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0013, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3602/3969 (90.7533%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3642/3969 (91.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8181, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4718/5195 (90.8181%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4794/5195 (92.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0097, Accuracy: 5545/10000 (55.4500%)
time spent on training: 229.50927996635437
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 3.0112, Accuracy: 4079/10000 (40.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 8.2458, Accuracy: 128/9900 (1.2929%)
Done in 253.07888793945312 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 45.614805153795736.
Norm before scaling: 45.599736156034936. Distance: 2.012209578699704
Total norm for 4 adversaries is: 45.599736156034936. distance: 2.012209578699704
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1586, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 45.614805153795736.
Norm before scaling: 45.602418427165134. Distance: 2.1996136542854283
Total norm for 4 adversaries is: 45.602418427165134. distance: 2.1996136542854283
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1304, Accuracy: 9579/9900 (96.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 45.614805153795736.
Norm before scaling: 45.59746065263668. Distance: 1.9592805222118215
Total norm for 4 adversaries is: 45.59746065263668. distance: 1.9592805222118215
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1397, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4581/5066 (90.4264%), train_poison_data_count: 400
Global model norm: 45.614805153795736.
Norm before scaling: 45.603451675147355. Distance: 2.1940967818259063
Total norm for 4 adversaries is: 45.603451675147355. distance: 2.1940967818259063
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1202, Accuracy: 9589/9900 (96.8586%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3405/3837 (88.7412%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3589/3837 (93.5366%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8590, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5080/5582 (91.0068%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5157/5582 (92.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9649, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4930/5455 (90.3758%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4904/5455 (89.8992%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9999, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4334/4679 (92.6266%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4354/4679 (93.0541%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8777, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4093/4518 (90.5932%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4205/4518 (93.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0982, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4170/4618 (90.2988%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4294/4618 (92.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0347, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4190/4716 (88.8465%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4186/4716 (88.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0813, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4628/5244 (88.2532%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4731/5244 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9959, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4429/4874 (90.8699%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4332/4874 (88.8798%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2806, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4377/4928 (88.8190%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4481/4928 (90.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9073, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3697/4126 (89.6025%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8590, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3409/3828 (89.0543%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3545/3828 (92.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8949, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3130/3472 (90.1498%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3222/3472 (92.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8933, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3268/3638 (89.8296%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3329/3638 (91.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8687, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3240/3590 (90.2507%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3212/3590 (89.4708%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0841, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3777/4223 (89.4388%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9985, Accuracy: 5458/10000 (54.5800%)
time spent on training: 229.837557554245
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 3.0043, Accuracy: 4126/10000 (41.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 8.7214, Accuracy: 90/9900 (0.9091%)
Done in 253.52322602272034 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 45.64434521383782.
Norm before scaling: 45.631482309194986. Distance: 2.004946195303812
Total norm for 4 adversaries is: 45.631482309194986. distance: 2.004946195303812
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1911, Accuracy: 9443/9900 (95.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 45.64434521383782.
Norm before scaling: 45.632565725449844. Distance: 2.121429360606536
Total norm for 4 adversaries is: 45.632565725449844. distance: 2.121429360606536
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1421, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.64434521383782.
Norm before scaling: 45.62891410864798. Distance: 1.9844267230163997
Total norm for 4 adversaries is: 45.62891410864798. distance: 1.9844267230163997
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1585, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 45.64434521383782.
Norm before scaling: 45.63376146612149. Distance: 2.1660282832911792
Total norm for 4 adversaries is: 45.63376146612149. distance: 2.1660282832911792
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1174, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4013/4441 (90.3625%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4137/4441 (93.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9575, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4494/5017 (89.5754%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4654/5017 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8259, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4434/4918 (90.1586%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4511/4918 (91.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0393, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4656/5197 (89.5901%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4737/5197 (91.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0073, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4189/4356 (96.1662%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4011/4356 (92.0799%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9988, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4965/5455 (91.0174%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4977/5455 (91.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0014, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2956/3297 (89.6573%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3058/3297 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7493, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4713/5195 (90.7218%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4784/5195 (92.0885%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9866, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3475/3828 (90.7785%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3552/3828 (92.7900%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8013, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4082/4456 (91.6068%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4157/4456 (93.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8380, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3981/4361 (91.2864%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3976/4361 (91.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9133, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3832/4235 (90.4841%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3838/4235 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0179, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4482/5025 (89.1940%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4610/5025 (91.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0586, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3215/3646 (88.1788%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3394/3646 (93.0883%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7461, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3626/4158 (87.2054%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3723/4158 (89.5382%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0146, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4141/4538 (91.2517%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4260/4538 (93.8740%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7890, Accuracy: 5867/10000 (58.6700%)
time spent on training: 231.4029517173767
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 3.0348, Accuracy: 4136/10000 (41.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 8.7704, Accuracy: 99/9900 (1.0000%)
Done in 255.3824338912964 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 45.668512534451736.
Norm before scaling: 45.653589608492176. Distance: 2.0216314437368204
Total norm for 4 adversaries is: 45.653589608492176. distance: 2.0216314437368204
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1574, Accuracy: 9551/9900 (96.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4826/5305 (90.9708%), train_poison_data_count: 415
Global model norm: 45.668512534451736.
Norm before scaling: 45.65508693333772. Distance: 2.1688642971910728
Total norm for 4 adversaries is: 45.65508693333772. distance: 2.1688642971910728
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1644, Accuracy: 9475/9900 (95.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 45.668512534451736.
Norm before scaling: 45.654089613500126. Distance: 2.0224131933569627
Total norm for 4 adversaries is: 45.654089613500126. distance: 2.0224131933569627
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0923, Accuracy: 9647/9900 (97.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4581/5066 (90.4264%), train_poison_data_count: 400
Global model norm: 45.668512534451736.
Norm before scaling: 45.660316489848434. Distance: 2.20441696486129
Total norm for 4 adversaries is: 45.660316489848434. distance: 2.20441696486129
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1464, Accuracy: 9515/9900 (96.1111%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3904/4295 (90.8964%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3860/4295 (89.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9267, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5087/5582 (91.1322%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5140/5582 (92.0817%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0115, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3257/3672 (88.6983%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3395/3672 (92.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8504, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4109/4518 (90.9473%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4162/4518 (92.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0761, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3424/3797 (90.1765%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3483/3797 (91.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9809, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4018/4362 (92.1137%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3935/4362 (90.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9783, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4548/4804 (94.6711%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4329/4804 (90.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0559, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4596/5116 (89.8358%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4610/5116 (90.1095%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8903, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4517/5025 (89.8905%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4617/5025 (91.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0608, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2962/3297 (89.8392%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7410, Accuracy: 5998/10000 (59.9800%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3300/3704 (89.0929%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3396/3704 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8305, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4908/5424 (90.4867%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5012/5424 (92.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1169, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3469/3861 (89.8472%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3592/3861 (93.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7949, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4556/4874 (93.4756%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4588/4874 (94.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9265, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4158/4647 (89.4771%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4647 (92.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8433, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4018/4356 (92.2406%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3847/4356 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1726, Accuracy: 5252/10000 (52.5200%)
time spent on training: 228.90214800834656
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.9819, Accuracy: 4207/10000 (42.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 9.5240, Accuracy: 68/9900 (0.6869%)
Done in 252.70734977722168 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4482/4885 (91.7503%), train_poison_data_count: 385
Global model norm: 45.69593693474016.
Norm before scaling: 45.683251555206205. Distance: 2.0695489591054668
Total norm for 4 adversaries is: 45.683251555206205. distance: 2.0695489591054668
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2146, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 45.69593693474016.
Norm before scaling: 45.6850979404458. Distance: 2.168535697968622
Total norm for 4 adversaries is: 45.6850979404458. distance: 2.168535697968622
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1914, Accuracy: 9441/9900 (95.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4717 (91.4988%), train_poison_data_count: 370
Global model norm: 45.69593693474016.
Norm before scaling: 45.681578788664915. Distance: 1.976944113821836
Total norm for 4 adversaries is: 45.681578788664915. distance: 1.976944113821836
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1843, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4584/5066 (90.4856%), train_poison_data_count: 400
Global model norm: 45.69593693474016.
Norm before scaling: 45.68620680454332. Distance: 2.2014047386114965
Total norm for 4 adversaries is: 45.68620680454332. distance: 2.2014047386114965
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2071, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4061/4503 (90.1843%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4092/4503 (90.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8945, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3435/3861 (88.9666%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3519/3861 (91.1422%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8638, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3763/4184 (89.9379%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9456, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4074/4518 (90.1726%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4192/4518 (92.7844%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8899, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4616/5083 (90.8125%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4649/5083 (91.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8795, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4581/4804 (95.3580%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4161/4804 (86.6153%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1776, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4093/4356 (93.9624%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3919/4356 (89.9679%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1885, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4598/5244 (87.6812%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4699/5244 (89.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9332, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4388/4679 (93.7807%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4309/4679 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9540, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3896/4416 (88.2246%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4018/4416 (90.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9622, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4398/4918 (89.4266%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4526/4918 (92.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9914, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3222/3616 (89.1040%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3358/3616 (92.8650%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7537, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4117/4576 (89.9694%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4234/4576 (92.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8107, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4412/4928 (89.5292%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8392, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3656/4013 (91.1039%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3761/4013 (93.7204%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8100, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3891/4336 (89.7371%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3994/4336 (92.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9343, Accuracy: 5665/10000 (56.6500%)
time spent on training: 230.96556305885315
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.9682, Accuracy: 4268/10000 (42.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 9.5210, Accuracy: 66/9900 (0.6667%)
Done in 254.75387597084045 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 45.73043788570967.
Norm before scaling: 45.71821065129573. Distance: 2.094727359229161
Total norm for 4 adversaries is: 45.71821065129573. distance: 2.094727359229161
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0449, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 45.73043788570967.
Norm before scaling: 45.71839755503248. Distance: 2.2056450465591992
Total norm for 4 adversaries is: 45.71839755503248. distance: 2.2056450465591992
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0999, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 45.73043788570967.
Norm before scaling: 45.716814189194935. Distance: 2.078340218090818
Total norm for 4 adversaries is: 45.716814189194935. distance: 2.078340218090818
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0587, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 45.73043788570967.
Norm before scaling: 45.72388417429533. Distance: 2.2595348718412493
Total norm for 4 adversaries is: 45.72388417429533. distance: 2.2595348718412493
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0986, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5693/6263 (90.8989%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5796/6263 (92.5435%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8872, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3138/3472 (90.3802%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9582, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3595/4158 (86.4598%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8566, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3227/3638 (88.7026%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3367/3638 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9878, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4511/4874 (92.5523%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4405/4874 (90.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1067, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4171/4356 (95.7530%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3916/4356 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0294, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4083/4538 (89.9736%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4242/4538 (93.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8677, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4409/4928 (89.4683%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4521/4928 (91.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9201, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4201/4618 (90.9701%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4253/4618 (92.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9108, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4208/4707 (89.3988%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4306/4707 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9929, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4391/4679 (93.8448%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4356/4679 (93.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9184, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4137/4647 (89.0252%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4302/4647 (92.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9367, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4122/4576 (90.0787%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4230/4576 (92.4388%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9314, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3647/4046 (90.1384%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3718/4046 (91.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0907, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4135/4651 (88.9056%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4291/4651 (92.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0620, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4534/5055 (89.6934%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/5055 (91.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9267, Accuracy: 5703/10000 (57.0300%)
time spent on training: 232.05302572250366
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.8747, Accuracy: 4385/10000 (43.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 9.3632, Accuracy: 90/9900 (0.9091%)
Done in 255.7640118598938 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.75712088110576.
Norm before scaling: 45.74282997520622. Distance: 2.084151743037582
Total norm for 4 adversaries is: 45.74282997520622. distance: 2.084151743037582
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.2490, Accuracy: 9290/9900 (93.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 45.75712088110576.
Norm before scaling: 45.747446457937684. Distance: 2.2539300504118707
Total norm for 4 adversaries is: 45.747446457937684. distance: 2.2539300504118707
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0691, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 45.75712088110576.
Norm before scaling: 45.7444097720216. Distance: 2.0209126276668496
Total norm for 4 adversaries is: 45.7444097720216. distance: 2.0209126276668496
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1255, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4578/5066 (90.3672%), train_poison_data_count: 400
Global model norm: 45.75712088110576.
Norm before scaling: 45.74774531243999. Distance: 2.2528065026465764
Total norm for 4 adversaries is: 45.74774531243999. distance: 2.2528065026465764
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0615, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5129/5740 (89.3554%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9333, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3703/4175 (88.6946%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3760/4175 (90.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0282, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4409/4918 (89.6503%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4533/4918 (92.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9612, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3940/4235 (93.0342%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3937/4235 (92.9634%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9427, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4920/5455 (90.1925%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5038/5455 (92.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9756, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4152/4662 (89.0605%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4300/4662 (92.2351%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9026, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4043/4465 (90.5487%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4142/4465 (92.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0023, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4166/4651 (89.5721%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0310, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4173/4618 (90.3638%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4288/4618 (92.8540%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8487, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4461/5037 (88.5646%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4637/5037 (92.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9734, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4216/4354 (96.8305%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4014/4354 (92.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1323, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4032/4441 (90.7904%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4114/4441 (92.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9245, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4090/4538 (90.1278%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4233/4538 (93.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.7944, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4530/5116 (88.5457%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4606/5116 (90.0313%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9133, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5486/6124 (89.5820%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5557/6124 (90.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8153, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4062/4362 (93.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8580, Accuracy: 5691/10000 (56.9100%)
time spent on training: 234.238356590271
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.9249, Accuracy: 4326/10000 (43.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 9.2191, Accuracy: 85/9900 (0.8586%)
Done in 258.06474471092224 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 45.78175927617762.
Norm before scaling: 45.7693563902203. Distance: 2.115422375215296
Total norm for 4 adversaries is: 45.7693563902203. distance: 2.115422375215296
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1343, Accuracy: 9550/9900 (96.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 45.78175927617762.
Norm before scaling: 45.772362085207874. Distance: 2.2488580560936966
Total norm for 4 adversaries is: 45.772362085207874. distance: 2.2488580560936966
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0652, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 45.78175927617762.
Norm before scaling: 45.76803883613815. Distance: 1.997932855926996
Total norm for 4 adversaries is: 45.76803883613815. distance: 1.997932855926996
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1215, Accuracy: 9589/9900 (96.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.78175927617762.
Norm before scaling: 45.770889932733176. Distance: 2.1855119663208527
Total norm for 4 adversaries is: 45.770889932733176. distance: 2.1855119663208527
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.2193, Accuracy: 9320/9900 (94.1414%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4039/4361 (92.6164%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3990/4361 (91.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9883, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3375/3797 (88.8860%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3487/3797 (91.8357%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9403, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4390/4918 (89.2639%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4543/4918 (92.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1277, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3208/3638 (88.1803%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3356/3638 (92.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9017, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3264/3590 (90.9192%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3321/3590 (92.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9253, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4452/4986 (89.2900%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4546/4986 (91.1753%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7926, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4923/5392 (91.3019%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4963/5392 (92.0438%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0359, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3403/3804 (89.4585%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9055, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4451/5025 (88.5771%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4625/5025 (92.0398%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0842, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4262/4793 (88.9213%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0555, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4428/4956 (89.3462%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4472/4956 (90.2341%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1344, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4496/5116 (87.8812%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4604/5116 (89.9922%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9457, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4563/5055 (90.2671%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4642/5055 (91.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9242, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4638/5063 (91.6058%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4513/5063 (89.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0250, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4063/4433 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7883, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4166/4662 (89.3608%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4333/4662 (92.9429%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9823, Accuracy: 5591/10000 (55.9100%)
time spent on training: 233.66899490356445
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.8113, Accuracy: 4534/10000 (45.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 9.3445, Accuracy: 99/9900 (1.0000%)
Done in 257.4592459201813 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 45.81206833868942.
Norm before scaling: 45.800081451210325. Distance: 2.082943714584588
Total norm for 4 adversaries is: 45.800081451210325. distance: 2.082943714584588
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2411, Accuracy: 9293/9900 (93.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 45.81206833868942.
Norm before scaling: 45.797941176603395. Distance: 2.210862337054703
Total norm for 4 adversaries is: 45.797941176603395. distance: 2.210862337054703
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0544, Accuracy: 9765/9900 (98.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 45.81206833868942.
Norm before scaling: 45.79542762554194. Distance: 2.005542109729972
Total norm for 4 adversaries is: 45.79542762554194. distance: 2.005542109729972
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1029, Accuracy: 9651/9900 (97.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 45.81206833868942.
Norm before scaling: 45.801499361374624. Distance: 2.1812235571015384
Total norm for 4 adversaries is: 45.801499361374624. distance: 2.1812235571015384
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0723, Accuracy: 9717/9900 (98.1515%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4604/4804 (95.8368%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4414/4804 (91.8818%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9943, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4268/4793 (89.0465%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8985, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3401/3781 (89.9497%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3431/3781 (90.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9804, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3734/4175 (89.4371%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3783/4175 (90.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9715, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3969/4362 (90.9904%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4048/4362 (92.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9009, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4596/5083 (90.4190%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4675/5083 (91.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9813, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4568/4874 (93.7218%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4555/4874 (93.4551%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9649, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3254/3646 (89.2485%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3384/3646 (92.8140%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7734, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3407/3756 (90.7082%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3504/3756 (93.2907%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8495, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3795/4223 (89.8650%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3931/4223 (93.0855%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8884, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4186/4356 (96.0973%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0017, Accuracy: 4236/4356 (97.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.6514, Accuracy: 6167/10000 (61.6700%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4495/5025 (89.4527%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4676/5025 (93.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9378, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5748/6391 (89.9390%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5784/6391 (90.5023%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9769, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4096/4518 (90.6596%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4221/4518 (93.4263%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9423, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4646/5167 (89.9168%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4729/5167 (91.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1186, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4358/4679 (93.1396%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4405/4679 (94.1440%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8509, Accuracy: 5956/10000 (59.5600%)
time spent on training: 232.3761739730835
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.9337, Accuracy: 4381/10000 (43.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 9.0421, Accuracy: 136/9900 (1.3737%)
Done in 256.23303270339966 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 45.8341737612341.
Norm before scaling: 45.819350080472276. Distance: 2.0502853520600066
Total norm for 4 adversaries is: 45.819350080472276. distance: 2.0502853520600066
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.2155, Accuracy: 9423/9900 (95.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 45.8341737612341.
Norm before scaling: 45.82290127490838. Distance: 2.2168363458421614
Total norm for 4 adversaries is: 45.82290127490838. distance: 2.2168363458421614
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1187, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 45.8341737612341.
Norm before scaling: 45.815068567148295. Distance: 1.9718763566050268
Total norm for 4 adversaries is: 45.815068567148295. distance: 1.9718763566050268
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1082, Accuracy: 9650/9900 (97.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 45.8341737612341.
Norm before scaling: 45.82447031966791. Distance: 2.217831488672211
Total norm for 4 adversaries is: 45.82447031966791. distance: 2.217831488672211
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0519, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4413/4956 (89.0436%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4528/4956 (91.3640%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1446, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3395/3797 (89.4127%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3470/3797 (91.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9675, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4492/5017 (89.5356%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4664/5017 (92.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8127, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4012/4433 (90.5030%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4148/4433 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8210, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3501/3781 (92.5946%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3515/3781 (92.9648%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8846, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4770/5265 (90.5983%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4868/5265 (92.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9986, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4689/5197 (90.2251%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4688/5197 (90.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1074, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3264/3646 (89.5228%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3388/3646 (92.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7654, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4055/4356 (93.0900%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3670/4356 (84.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5514, Accuracy: 4713/10000 (47.1300%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3416/3804 (89.8002%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3535/3804 (92.9285%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8697, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3242/3590 (90.3064%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3208/3590 (89.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1261, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3724/4046 (92.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9251, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4713/5244 (89.8741%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4746/5244 (90.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8518, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4519/5025 (89.9303%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4624/5025 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9912, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3418/3756 (91.0011%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1106, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4908/5392 (91.0237%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4961/5392 (92.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8983, Accuracy: 5785/10000 (57.8500%)
time spent on training: 229.55445742607117
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.9043, Accuracy: 4453/10000 (44.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 8.9619, Accuracy: 170/9900 (1.7172%)
Done in 253.35063004493713 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4485/4885 (91.8117%), train_poison_data_count: 385
Global model norm: 45.86471700147075.
Norm before scaling: 45.849849947784726. Distance: 2.0094050759634956
Total norm for 4 adversaries is: 45.849849947784726. distance: 2.0094050759634956
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1456, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 45.86471700147075.
Norm before scaling: 45.856880788219776. Distance: 2.2541088099173523
Total norm for 4 adversaries is: 45.856880788219776. distance: 2.2541088099173523
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1823, Accuracy: 9470/9900 (95.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 45.86471700147075.
Norm before scaling: 45.851197098774044. Distance: 2.0229766203000263
Total norm for 4 adversaries is: 45.851197098774044. distance: 2.0229766203000263
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0929, Accuracy: 9681/9900 (97.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.86471700147075.
Norm before scaling: 45.852887637394225. Distance: 2.2380576562963017
Total norm for 4 adversaries is: 45.852887637394225. distance: 2.2380576562963017
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1438, Accuracy: 9522/9900 (96.1818%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4190/4663 (89.8563%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4348/4663 (93.2447%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9081, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4618 (90.3421%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4308/4618 (93.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9550, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4153/4662 (89.0819%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4334/4662 (92.9644%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8103, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4033/4511 (89.4037%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4144/4511 (91.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9199, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3978/4362 (91.1967%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4067/4362 (93.2370%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8811, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4117/4558 (90.3247%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4157/4558 (91.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0103, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3402/3828 (88.8715%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3533/3828 (92.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8230, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4179/4716 (88.6132%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9415, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4056/4465 (90.8399%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8878, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4454/4928 (90.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0900, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4927/5455 (90.3208%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9889, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4164/4647 (89.6062%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4208/4647 (90.5530%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0040, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4948/5591 (88.4994%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5053/5591 (90.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9938, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3225/3616 (89.1869%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3322/3616 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8094, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4442/4986 (89.0895%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4560/4986 (91.4561%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8764, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4627/5167 (89.5491%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4727/5167 (91.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2072, Accuracy: 5349/10000 (53.4900%)
time spent on training: 233.72761511802673
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.8233, Accuracy: 4595/10000 (45.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 8.7500, Accuracy: 224/9900 (2.2626%)
Done in 257.54594802856445 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4487/4885 (91.8526%), train_poison_data_count: 385
Global model norm: 45.89379830277997.
Norm before scaling: 45.880217793354305. Distance: 2.046451437419851
Total norm for 4 adversaries is: 45.880217793354305. distance: 2.046451437419851
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1744, Accuracy: 9450/9900 (95.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 45.89379830277997.
Norm before scaling: 45.88130863894223. Distance: 2.228716106574279
Total norm for 4 adversaries is: 45.88130863894223. distance: 2.228716106574279
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1006, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 45.89379830277997.
Norm before scaling: 45.87917481429483. Distance: 2.006886428234976
Total norm for 4 adversaries is: 45.87917481429483. distance: 2.006886428234976
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1517, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 45.89379830277997.
Norm before scaling: 45.88131662064364. Distance: 2.120678940145182
Total norm for 4 adversaries is: 45.88131662064364. distance: 2.120678940145182
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2232, Accuracy: 9352/9900 (94.4646%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3721/4175 (89.1257%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3734/4175 (89.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0101, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4596 (90.7746%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4286/4596 (93.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9069, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3212/3616 (88.8274%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3330/3616 (92.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8558, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4155/4356 (95.3857%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4142/4356 (95.0872%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8897, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4671/5244 (89.0732%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4773/5244 (91.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8365, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2964/3297 (89.8999%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3094/3297 (93.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7363, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3271/3646 (89.7148%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3377/3646 (92.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7667, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3418/3797 (90.0184%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3472/3797 (91.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9281, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4101/4456 (92.0332%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4148/4456 (93.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9250, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3555/3828 (92.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8051, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5080/5582 (91.0068%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5030/5582 (90.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0923, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3151/3472 (90.7546%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3261/3472 (93.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9261, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3972/4362 (91.0591%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4017/4362 (92.0908%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9996, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4897/5424 (90.2839%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5015/5424 (92.4594%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1019, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4404/4679 (94.1227%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4336/4679 (92.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9557, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3251/3590 (90.5571%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3241/3590 (90.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9866, Accuracy: 5536/10000 (55.3600%)
time spent on training: 226.530104637146
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.7807, Accuracy: 4693/10000 (46.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 8.9632, Accuracy: 209/9900 (2.1111%)
Done in 250.2245545387268 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 45.91863186064155.
Norm before scaling: 45.9016388511211. Distance: 1.9939025079162795
Total norm for 4 adversaries is: 45.9016388511211. distance: 1.9939025079162795
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1741, Accuracy: 9439/9900 (95.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 45.91863186064155.
Norm before scaling: 45.903665260793716. Distance: 2.1811494470717556
Total norm for 4 adversaries is: 45.903665260793716. distance: 2.1811494470717556
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1102, Accuracy: 9609/9900 (97.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.91863186064155.
Norm before scaling: 45.9065770708226. Distance: 2.0192266415284834
Total norm for 4 adversaries is: 45.9065770708226. distance: 2.0192266415284834
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.2056, Accuracy: 9402/9900 (94.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 45.91863186064155.
Norm before scaling: 45.908342681198754. Distance: 2.1815760371552244
Total norm for 4 adversaries is: 45.908342681198754. distance: 2.1815760371552244
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0634, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3421/3804 (89.9317%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3534/3804 (92.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8895, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2992/3297 (90.7492%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3074/3297 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7630, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4255/4354 (97.7262%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4007/4354 (92.0303%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0093, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4016/4433 (90.5933%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4131/4433 (93.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8172, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3434/3775 (90.9669%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3542/3775 (93.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8767, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4721/5195 (90.8758%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4843/5195 (93.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9863, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4950/5392 (91.8027%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4904/5392 (90.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9908, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4719/5244 (89.9886%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4761/5244 (90.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0726, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4072/4356 (93.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8800, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3901/4416 (88.3379%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9648, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4032/4481 (89.9799%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4090/4481 (91.2743%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0896, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4058/4441 (91.3758%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4120/4441 (92.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8897, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3939/4336 (90.8441%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9560, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3285/3646 (90.0987%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3384/3646 (92.8140%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7474, Accuracy: 5916/10000 (59.1600%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4190/4647 (90.1657%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4264/4647 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7915, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3237/3638 (88.9775%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8654, Accuracy: 5760/10000 (57.6000%)
time spent on training: 227.37921404838562
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.7120, Accuracy: 4847/10000 (48.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 8.9397, Accuracy: 251/9900 (2.5354%)
Done in 251.2120680809021 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 45.94366189540593.
Norm before scaling: 45.930970518097865. Distance: 2.0630120306510187
Total norm for 4 adversaries is: 45.930970518097865. distance: 2.0630120306510187
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2646, Accuracy: 9249/9900 (93.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 45.94366189540593.
Norm before scaling: 45.92943966275198. Distance: 2.206603530353207
Total norm for 4 adversaries is: 45.92943966275198. distance: 2.206603530353207
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0700, Accuracy: 9743/9900 (98.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 45.94366189540593.
Norm before scaling: 45.9296310224606. Distance: 1.9808975748641475
Total norm for 4 adversaries is: 45.9296310224606. distance: 1.9808975748641475
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0983, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4541/5066 (89.6368%), train_poison_data_count: 400
Global model norm: 45.94366189540593.
Norm before scaling: 45.93432440129195. Distance: 2.2296991039206744
Total norm for 4 adversaries is: 45.93432440129195. distance: 2.2296991039206744
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0467, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4172/4538 (91.9348%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4196/4538 (92.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8357, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5145/5740 (89.6341%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5289/5740 (92.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1204, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4587/4934 (92.9672%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4551/4934 (92.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0426, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3641/4013 (90.7301%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3751/4013 (93.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7682, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4019/4511 (89.0933%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4152/4511 (92.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8927, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4038/4501 (89.7134%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4062/4501 (90.2466%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0083, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4104/4518 (90.8367%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4202/4518 (93.0058%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8864, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3505/3804 (92.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8159, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3469/3781 (91.7482%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3314/3781 (87.6488%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1318, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4050/4441 (91.1957%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4099/4441 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9327, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4185/4662 (89.7683%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4298/4662 (92.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8988, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3104/3472 (89.4009%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3202/3472 (92.2235%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9837, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3618/3911 (92.5083%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3699/3911 (94.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9113, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4171/4634 (90.0086%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4221/4634 (91.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9068, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4173/4618 (90.3638%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4153/4618 (89.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9990, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4687/5195 (90.2214%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4688/5195 (90.2406%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1772, Accuracy: 5397/10000 (53.9700%)
time spent on training: 230.14524722099304
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 3.0117, Accuracy: 4519/10000 (45.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 9.7675, Accuracy: 159/9900 (1.6061%)
Done in 253.88631510734558 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 45.96889339712508.
Norm before scaling: 45.955358985990415. Distance: 2.082111750722996
Total norm for 4 adversaries is: 45.955358985990415. distance: 2.082111750722996
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2146, Accuracy: 9374/9900 (94.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 45.96889339712508.
Norm before scaling: 45.956142581983805. Distance: 2.211737066938899
Total norm for 4 adversaries is: 45.956142581983805. distance: 2.211737066938899
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1436, Accuracy: 9548/9900 (96.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 45.96889339712508.
Norm before scaling: 45.95581586392249. Distance: 2.0054908718528144
Total norm for 4 adversaries is: 45.95581586392249. distance: 2.0054908718528144
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1539, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4593/5066 (90.6632%), train_poison_data_count: 400
Global model norm: 45.96889339712508.
Norm before scaling: 45.95451693743636. Distance: 2.1277455936960417
Total norm for 4 adversaries is: 45.95451693743636. distance: 2.1277455936960417
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0410, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2971/3271 (90.8285%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2973/3271 (90.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8283, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4423/4928 (89.7524%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4496/4928 (91.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0171, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4554/4804 (94.7960%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4316/4804 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1145, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4120/4618 (89.2161%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4166/4618 (90.2122%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9655, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3426/3756 (91.2141%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3515/3756 (93.5836%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9140, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4184/4634 (90.2892%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4233/4634 (91.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9619, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3244/3638 (89.1699%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8114, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3278/3704 (88.4989%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8382, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4209/4707 (89.4200%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4289/4707 (91.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8996, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4051/4481 (90.4039%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4044/4481 (90.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0628, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4274/4354 (98.1626%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0016, Accuracy: 4268/4354 (98.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7251, Accuracy: 6155/10000 (61.5500%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3228/3646 (88.5354%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3370/3646 (92.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.6929, Accuracy: 6021/10000 (60.2100%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3824/4223 (90.5517%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3957/4223 (93.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8327, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4058/4511 (89.9579%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4194/4511 (92.9727%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8583, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4039/4456 (90.6418%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4112/4456 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9736, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3454/3861 (89.4587%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3579/3861 (92.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9594, Accuracy: 5629/10000 (56.2900%)
time spent on training: 226.57378554344177
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 3.0750, Accuracy: 4368/10000 (43.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 10.3141, Accuracy: 81/9900 (0.8182%)
Done in 250.25115132331848 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 45.998328137077436.
Norm before scaling: 45.985598756227475. Distance: 2.0688272006563375
Total norm for 4 adversaries is: 45.985598756227475. distance: 2.0688272006563375
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2161, Accuracy: 9380/9900 (94.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 45.998328137077436.
Norm before scaling: 45.98401928166866. Distance: 2.21036255171315
Total norm for 4 adversaries is: 45.98401928166866. distance: 2.21036255171315
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1354, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.998328137077436.
Norm before scaling: 45.98325474340496. Distance: 2.021935454088302
Total norm for 4 adversaries is: 45.98325474340496. distance: 2.021935454088302
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2497, Accuracy: 9290/9900 (93.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 45.998328137077436.
Norm before scaling: 45.98961754434364. Distance: 2.1890593284349795
Total norm for 4 adversaries is: 45.98961754434364. distance: 2.1890593284349795
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0788, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3382/3804 (88.9064%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3469/3804 (91.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9313, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4028/4501 (89.4912%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4119/4501 (91.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9149, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4224/4663 (90.5855%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4293/4663 (92.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9342, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4981/5591 (89.0896%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4993/5591 (89.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1098, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4644/5244 (88.5584%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4768/5244 (90.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8149, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4014/4433 (90.5482%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4147/4433 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7569, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4219/4707 (89.6325%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4312/4707 (91.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7508, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4043/4456 (90.7316%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4091/4456 (91.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8846, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4121/4356 (94.6051%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3943/4356 (90.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1076, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4122/4576 (90.0787%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4223/4576 (92.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9900, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4393/4679 (93.8876%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4395/4679 (93.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9367, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4174/4634 (90.0734%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4286/4634 (92.4903%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7024, Accuracy: 6014/10000 (60.1400%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3607/4013 (89.8829%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7862, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4573/5232 (87.4044%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4720/5232 (90.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0194, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3746/4126 (90.7901%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3877/4126 (93.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7614, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3394/3756 (90.3621%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3528/3756 (93.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8566, Accuracy: 5811/10000 (58.1100%)
time spent on training: 230.75909090042114
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 3.0929, Accuracy: 4383/10000 (43.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 10.1601, Accuracy: 79/9900 (0.7980%)
Done in 254.65255117416382 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 46.022935539827586.
Norm before scaling: 46.00993704234581. Distance: 2.1020958659690385
Total norm for 4 adversaries is: 46.00993704234581. distance: 2.1020958659690385
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1369, Accuracy: 9582/9900 (96.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 46.022935539827586.
Norm before scaling: 46.011494402893504. Distance: 2.2434544190617545
Total norm for 4 adversaries is: 46.011494402893504. distance: 2.2434544190617545
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1021, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4301/4717 (91.1808%), train_poison_data_count: 370
Global model norm: 46.022935539827586.
Norm before scaling: 46.00605800377679. Distance: 1.9971981688518752
Total norm for 4 adversaries is: 46.00605800377679. distance: 1.9971981688518752
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1744, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 46.022935539827586.
Norm before scaling: 46.01132991414995. Distance: 2.165827062738883
Total norm for 4 adversaries is: 46.01132991414995. distance: 2.165827062738883
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1156, Accuracy: 9614/9900 (97.1111%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4609/5055 (91.1771%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4596/5055 (90.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8833, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4067/4481 (90.7610%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4061/4481 (90.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1463, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4324/4767 (90.7069%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1423, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4764/5265 (90.4843%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4842/5265 (91.9658%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9257, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4098/4558 (89.9079%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4131/4558 (90.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0057, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4999/5591 (89.4116%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5027/5591 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0209, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4620/5232 (88.3028%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4733/5232 (90.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9662, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3404/3756 (90.6283%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3498/3756 (93.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8772, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4029/4433 (90.8865%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4130/4433 (93.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8599, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4279/4793 (89.2760%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4382/4793 (91.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9533, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3882/4235 (91.6647%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3918/4235 (92.5148%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8651, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4177/4707 (88.7402%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4345/4707 (92.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8010, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3656/4025 (90.8323%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3762/4025 (93.4658%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8632, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3420/3837 (89.1321%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3576/3837 (93.1978%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9383, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5721/6391 (89.5165%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5815/6391 (90.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0108, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4259/4354 (97.8181%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3891/4354 (89.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2112, Accuracy: 5294/10000 (52.9400%)
time spent on training: 235.53480625152588
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 3.0515, Accuracy: 4475/10000 (44.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 10.4679, Accuracy: 90/9900 (0.9091%)
Done in 260.8983633518219 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 46.05114821536077.
Norm before scaling: 46.0383618487751. Distance: 2.144768929295368
Total norm for 4 adversaries is: 46.0383618487751. distance: 2.144768929295368
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0864, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 46.05114821536077.
Norm before scaling: 46.036243258538974. Distance: 2.19545042208818
Total norm for 4 adversaries is: 46.036243258538974. distance: 2.19545042208818
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0815, Accuracy: 9694/9900 (97.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 46.05114821536077.
Norm before scaling: 46.03501289355066. Distance: 2.027306705202552
Total norm for 4 adversaries is: 46.03501289355066. distance: 2.027306705202552
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1077, Accuracy: 9639/9900 (97.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 46.05114821536077.
Norm before scaling: 46.03927130128283. Distance: 2.2271513578507336
Total norm for 4 adversaries is: 46.03927130128283. distance: 2.2271513578507336
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0963, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4923/5424 (90.7633%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5024/5424 (92.6254%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9945, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4145/4576 (90.5813%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4268/4576 (93.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8198, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4564/4934 (92.5010%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4349/4934 (88.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1597, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5046/5582 (90.3977%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5085/5582 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0940, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4415/4956 (89.0839%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4471/4956 (90.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9753, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5387/5902 (91.2741%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5364/5902 (90.8844%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9432, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2957/3297 (89.6876%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7211, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3136/3472 (90.3226%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9849, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4439/4928 (90.0771%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4541/4928 (92.1469%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9026, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4083/4481 (91.1181%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4065/4481 (90.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0697, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4536/5025 (90.2687%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4648/5025 (92.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8830, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4404/4986 (88.3273%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4595/4986 (92.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9215, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4373/4928 (88.7378%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4490/4928 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9566, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4603/4804 (95.8160%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4397/4804 (91.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0465, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3268/3646 (89.6325%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3373/3646 (92.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7381, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4205/4707 (89.3350%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4322/4707 (91.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8267, Accuracy: 5847/10000 (58.4700%)
time spent on training: 232.91379976272583
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.9988, Accuracy: 4557/10000 (45.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 10.6137, Accuracy: 77/9900 (0.7778%)
Done in 256.65356397628784 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 46.08334363462438.
Norm before scaling: 46.067023501599. Distance: 2.028899608273628
Total norm for 4 adversaries is: 46.067023501599. distance: 2.028899608273628
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1360, Accuracy: 9575/9900 (96.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4814/5305 (90.7446%), train_poison_data_count: 415
Global model norm: 46.08334363462438.
Norm before scaling: 46.0674024273808. Distance: 2.188512295418901
Total norm for 4 adversaries is: 46.0674024273808. distance: 2.188512295418901
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2028, Accuracy: 9404/9900 (94.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 46.08334363462438.
Norm before scaling: 46.065195074650724. Distance: 1.987009117397361
Total norm for 4 adversaries is: 46.065195074650724. distance: 1.987009117397361
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0768, Accuracy: 9708/9900 (98.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 46.08334363462438.
Norm before scaling: 46.07291902178003. Distance: 2.196735504626995
Total norm for 4 adversaries is: 46.07291902178003. distance: 2.196735504626995
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1460, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4556/5116 (89.0539%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4653/5116 (90.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9889, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4157/4651 (89.3786%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4262/4651 (91.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9537, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4975/5591 (88.9823%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5039/5591 (90.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1209, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4589/4804 (95.5246%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4505/4804 (93.7760%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0224, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4062/4456 (91.1580%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4140/4456 (92.9084%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9566, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4677/5063 (92.3761%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4583/5063 (90.5195%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0656, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3804/4223 (90.0781%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3926/4223 (92.9671%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8193, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4653/4934 (94.3048%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4512/4934 (91.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0811, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3433/3828 (89.6813%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3579/3828 (93.4953%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8600, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5430/5902 (92.0027%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5311/5902 (89.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9676, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3870/4416 (87.6359%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4019/4416 (91.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9033, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4101/4538 (90.3702%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4202/4538 (92.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8565, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4461/5025 (88.7761%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9428, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4071/4625 (88.0216%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4159/4625 (89.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0812, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4650/5197 (89.4747%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4715/5197 (90.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0688, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3408/3804 (89.5899%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3480/3804 (91.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0112, Accuracy: 5641/10000 (56.4100%)
time spent on training: 232.00430011749268
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 3.1432, Accuracy: 4349/10000 (43.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 10.5398, Accuracy: 60/9900 (0.6061%)
Done in 255.95347023010254 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 46.106002079277864.
Norm before scaling: 46.095272750270986. Distance: 2.152809715717723
Total norm for 4 adversaries is: 46.095272750270986. distance: 2.152809715717723
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1152, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 46.106002079277864.
Norm before scaling: 46.088230601749075. Distance: 2.189415338413059
Total norm for 4 adversaries is: 46.088230601749075. distance: 2.189415338413059
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.3032, Accuracy: 9188/9900 (92.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 46.106002079277864.
Norm before scaling: 46.088913941220724. Distance: 2.015793076242402
Total norm for 4 adversaries is: 46.088913941220724. distance: 2.015793076242402
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1122, Accuracy: 9631/9900 (97.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 46.106002079277864.
Norm before scaling: 46.09361228792987. Distance: 2.2558833661805973
Total norm for 4 adversaries is: 46.09361228792987. distance: 2.2558833661805973
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0422, Accuracy: 9800/9900 (98.9899%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4641/4804 (96.6070%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4499/4804 (93.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8862, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3603/3911 (92.1248%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3678/3911 (94.0424%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9074, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3622/4013 (90.2567%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8057, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4598/5232 (87.8823%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4713/5232 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0685, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5028/5591 (89.9302%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5009/5591 (89.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0615, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3474/3837 (90.5395%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3581/3837 (93.3281%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8146, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4926/5424 (90.8186%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5002/5424 (92.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1090, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4611/5167 (89.2394%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4773/5167 (92.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0622, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4081/4456 (91.5844%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4161/4456 (93.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8307, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4374/4928 (88.7581%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4513/4928 (91.5787%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9641, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3961/4433 (89.3526%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3993/4433 (90.0744%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8767, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2916/3297 (88.4440%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3073/3297 (93.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7409, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4198/4716 (89.0161%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4245/4716 (90.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0732, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4157/4596 (90.4482%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4229/4596 (92.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9772, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4245/4793 (88.5667%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4396/4793 (91.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8960, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3855/4416 (87.2962%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4009/4416 (90.7835%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9012, Accuracy: 5678/10000 (56.7800%)
time spent on training: 232.01329493522644
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 3.1304, Accuracy: 4331/10000 (43.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 10.4643, Accuracy: 65/9900 (0.6566%)
Done in 255.78559565544128 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 46.1363468428093.
Norm before scaling: 46.1190846689646. Distance: 2.0597224172585067
Total norm for 4 adversaries is: 46.1190846689646. distance: 2.0597224172585067
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2012, Accuracy: 9391/9900 (94.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 46.1363468428093.
Norm before scaling: 46.124068418776766. Distance: 2.2606648837687824
Total norm for 4 adversaries is: 46.124068418776766. distance: 2.2606648837687824
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1302, Accuracy: 9547/9900 (96.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 46.1363468428093.
Norm before scaling: 46.119915772466186. Distance: 2.0038271287910185
Total norm for 4 adversaries is: 46.119915772466186. distance: 2.0038271287910185
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1340, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 46.1363468428093.
Norm before scaling: 46.12344117877454. Distance: 2.2076073898858053
Total norm for 4 adversaries is: 46.12344117877454. distance: 2.2076073898858053
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0582, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2989/3271 (91.3788%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3004/3271 (91.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9357, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4596/5116 (89.8358%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4645/5116 (90.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9604, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4043/4501 (89.8245%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4118/4501 (91.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8319, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4129/4356 (94.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9476, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3870/4368 (88.5989%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3927/4368 (89.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0060, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3430/3837 (89.3928%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3560/3837 (92.7808%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8655, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5151/5740 (89.7387%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5272/5740 (91.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0561, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3266/3590 (90.9749%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3401/3590 (94.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8966, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2967/3297 (89.9909%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3024/3297 (91.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9328, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4169/4716 (88.4012%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4277/4716 (90.6913%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9854, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4540/5055 (89.8121%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4645/5055 (91.8892%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9585, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3590/3911 (91.7924%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3420/3911 (87.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3160, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3587/4158 (86.2674%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3784/4158 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8782, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4067/4456 (91.2702%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4105/4456 (92.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9617, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3968/4511 (87.9628%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4085/4511 (90.5564%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9642, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3254/3672 (88.6166%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3375/3672 (91.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9137, Accuracy: 5743/10000 (57.4300%)
time spent on training: 227.67599058151245
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 3.2139, Accuracy: 4264/10000 (42.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 10.5103, Accuracy: 69/9900 (0.6970%)
Done in 251.55156064033508 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 46.161935795699144.
Norm before scaling: 46.149849336157104. Distance: 2.120333428163631
Total norm for 4 adversaries is: 46.149849336157104. distance: 2.120333428163631
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1896, Accuracy: 9469/9900 (95.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 46.161935795699144.
Norm before scaling: 46.1473099838983. Distance: 2.2213567545176223
Total norm for 4 adversaries is: 46.1473099838983. distance: 2.2213567545176223
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1585, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4302/4717 (91.2020%), train_poison_data_count: 370
Global model norm: 46.161935795699144.
Norm before scaling: 46.14218324070448. Distance: 1.9618798533486244
Total norm for 4 adversaries is: 46.14218324070448. distance: 1.9618798533486244
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.2238, Accuracy: 9330/9900 (94.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4545/5066 (89.7158%), train_poison_data_count: 400
Global model norm: 46.161935795699144.
Norm before scaling: 46.15122211528504. Distance: 2.276802116356333
Total norm for 4 adversaries is: 46.15122211528504. distance: 2.276802116356333
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1135, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4709/5063 (93.0081%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4553/5063 (89.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0809, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4621/5083 (90.9109%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4615/5083 (90.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0529, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3403/3797 (89.6234%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3406/3797 (89.7024%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0058, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5461/6124 (89.1737%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5536/6124 (90.3984%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9526, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4617/5232 (88.2454%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4745/5232 (90.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9360, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3447/3861 (89.2774%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3580/3861 (92.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8896, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4461/5037 (88.5646%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5037 (90.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9586, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4557/5116 (89.0735%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4639/5116 (90.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9929, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3917/4368 (89.6749%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3976/4368 (91.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9417, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3237/3672 (88.1536%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3401/3672 (92.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9208, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5377/5902 (91.1047%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5308/5902 (89.9356%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0140, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3964/4361 (90.8966%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3884/4361 (89.0621%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9269, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3569/4158 (85.8345%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3731/4158 (89.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9594, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4519/5025 (89.9303%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4653/5025 (92.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0914, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4059/4456 (91.0907%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4158/4456 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9500, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8043, Accuracy: 5859/10000 (58.5900%)
time spent on training: 233.19483971595764
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 3.3231, Accuracy: 4165/10000 (41.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 10.3504, Accuracy: 54/9900 (0.5455%)
Done in 256.99641942977905 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 46.196294832486295.
Norm before scaling: 46.18304644885258. Distance: 2.103074108035173
Total norm for 4 adversaries is: 46.18304644885258. distance: 2.103074108035173
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1402, Accuracy: 9549/9900 (96.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 46.196294832486295.
Norm before scaling: 46.18217418973066. Distance: 2.1841793469300237
Total norm for 4 adversaries is: 46.18217418973066. distance: 2.1841793469300237
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1577, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4331/4717 (91.8168%), train_poison_data_count: 370
Global model norm: 46.196294832486295.
Norm before scaling: 46.17633755930222. Distance: 1.946557929363877
Total norm for 4 adversaries is: 46.17633755930222. distance: 1.946557929363877
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1204, Accuracy: 9601/9900 (96.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 46.196294832486295.
Norm before scaling: 46.183405920545475. Distance: 2.1862256288996713
Total norm for 4 adversaries is: 46.183405920545475. distance: 2.1862256288996713
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0485, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3661/4025 (90.9565%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7793, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4377/4928 (88.8190%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4473/4928 (90.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0950, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3792/4175 (90.8263%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3871/4175 (92.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8743, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3910/4416 (88.5417%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4058/4416 (91.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8607, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3423/3797 (90.1501%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8672, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4710/5195 (90.6641%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4774/5195 (91.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9034, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4645/5232 (88.7806%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4765/5232 (91.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0049, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5009/5455 (91.8240%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5035/5455 (92.3006%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9094, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4236/4716 (89.8219%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9630, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4348/4679 (92.9258%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4371/4679 (93.4174%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8670, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5714/6263 (91.2342%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5771/6263 (92.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0768, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4417/4918 (89.8129%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4536/4918 (92.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0404, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4067/4456 (91.2702%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8948, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5489/5902 (93.0024%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5486/5902 (92.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9360, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4046/4481 (90.2923%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4097/4481 (91.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0004, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5152/5591 (92.1481%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5136/5591 (91.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0899, Accuracy: 5504/10000 (55.0400%)
time spent on training: 237.13888883590698
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 3.3375, Accuracy: 4174/10000 (41.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 10.4115, Accuracy: 40/9900 (0.4040%)
Done in 260.9328122138977 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 46.22283830802691.
Norm before scaling: 46.207957030891876. Distance: 2.1016538238536344
Total norm for 4 adversaries is: 46.207957030891876. distance: 2.1016538238536344
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1016, Accuracy: 9647/9900 (97.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4804/5305 (90.5561%), train_poison_data_count: 415
Global model norm: 46.22283830802691.
Norm before scaling: 46.205862068065834. Distance: 2.220534882760877
Total norm for 4 adversaries is: 46.205862068065834. distance: 2.220534882760877
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2917, Accuracy: 9174/9900 (92.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4339/4717 (91.9864%), train_poison_data_count: 370
Global model norm: 46.22283830802691.
Norm before scaling: 46.20392288793642. Distance: 1.915352336153716
Total norm for 4 adversaries is: 46.20392288793642. distance: 1.915352336153716
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1605, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 46.22283830802691.
Norm before scaling: 46.21114816625692. Distance: 2.156395727568229
Total norm for 4 adversaries is: 46.21114816625692. distance: 2.156395727568229
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0786, Accuracy: 9727/9900 (98.2525%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4001/4501 (88.8914%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4121/4501 (91.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9461, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4565/5083 (89.8092%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4618/5083 (90.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0012, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3390/3804 (89.1167%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3515/3804 (92.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8477, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3452/3756 (91.9063%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3524/3756 (93.8232%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8769, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3790/4175 (90.7784%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9712, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4640/4934 (94.0413%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4512/4934 (91.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1432, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3959/4336 (91.3054%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9148, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4092/4356 (93.9394%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4182/4356 (96.0055%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8170, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4674/5244 (89.1304%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4736/5244 (90.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9546, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4602/5017 (91.7281%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4628/5017 (92.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9496, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3454/3828 (90.2299%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3545/3828 (92.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8238, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4129/4538 (90.9872%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4208/4538 (92.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9548, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3224/3638 (88.6201%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3328/3638 (91.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9500, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4230/4662 (90.7336%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4313/4662 (92.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0276, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3443/3797 (90.6769%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3518/3797 (92.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0393, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4181/4634 (90.2244%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8731, Accuracy: 5759/10000 (57.5900%)
time spent on training: 229.55819249153137
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 3.4438, Accuracy: 4103/10000 (41.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 10.4660, Accuracy: 52/9900 (0.5253%)
Done in 253.15048551559448 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 46.251317020944114.
Norm before scaling: 46.23450437207314. Distance: 2.081617475263881
Total norm for 4 adversaries is: 46.23450437207314. distance: 2.081617475263881
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0760, Accuracy: 9723/9900 (98.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4836/5305 (91.1593%), train_poison_data_count: 415
Global model norm: 46.251317020944114.
Norm before scaling: 46.23528587730642. Distance: 2.2251368191260883
Total norm for 4 adversaries is: 46.23528587730642. distance: 2.2251368191260883
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1801, Accuracy: 9500/9900 (95.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4321/4717 (91.6048%), train_poison_data_count: 370
Global model norm: 46.251317020944114.
Norm before scaling: 46.23315782868936. Distance: 1.9524205883058976
Total norm for 4 adversaries is: 46.23315782868936. distance: 1.9524205883058976
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.2372, Accuracy: 9331/9900 (94.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 46.251317020944114.
Norm before scaling: 46.23440932323836. Distance: 2.141145406240614
Total norm for 4 adversaries is: 46.23440932323836. distance: 2.141145406240614
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0711, Accuracy: 9713/9900 (98.1111%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3789/4175 (90.7545%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3807/4175 (91.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9121, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4465 (89.8768%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4187/4465 (93.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9302, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4485/4918 (91.1956%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4498/4918 (91.4599%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0054, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4455/5037 (88.4455%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4634/5037 (91.9992%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9631, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3483/3781 (92.1185%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3324/3781 (87.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3948, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4207/4634 (90.7855%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4283/4634 (92.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8678, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4104/4576 (89.6853%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4222/4576 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8809, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3476/3861 (90.0285%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3496/3861 (90.5465%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0099, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5581/6124 (91.1332%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5563/6124 (90.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9476, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3781/4223 (89.5335%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3909/4223 (92.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9441, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4598/5083 (90.4584%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4611/5083 (90.7141%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0485, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4107/4356 (94.2837%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3730/4356 (85.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4777, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4293/4793 (89.5681%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4404/4793 (91.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9765, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4488/5055 (88.7834%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4634/5055 (91.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8792, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3984/4362 (91.3343%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3985/4362 (91.3572%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0326, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3989/4433 (89.9842%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4087/4433 (92.1949%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8439, Accuracy: 5877/10000 (58.7700%)
time spent on training: 232.79688906669617
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 3.6716, Accuracy: 3961/10000 (39.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 10.4539, Accuracy: 58/9900 (0.5859%)
Done in 256.6600148677826 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 46.27980722346005.
Norm before scaling: 46.265326852298365. Distance: 2.054805621678922
Total norm for 4 adversaries is: 46.265326852298365. distance: 2.054805621678922
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2170, Accuracy: 9391/9900 (94.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 46.27980722346005.
Norm before scaling: 46.262540529568845. Distance: 2.192653906019099
Total norm for 4 adversaries is: 46.262540529568845. distance: 2.192653906019099
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0815, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 46.27980722346005.
Norm before scaling: 46.263382248916635. Distance: 1.9840949153730596
Total norm for 4 adversaries is: 46.263382248916635. distance: 1.9840949153730596
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2606, Accuracy: 9270/9900 (93.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4622/5066 (91.2357%), train_poison_data_count: 400
Global model norm: 46.27980722346005.
Norm before scaling: 46.26591786888054. Distance: 2.1822791876849603
Total norm for 4 adversaries is: 46.26591786888054. distance: 2.1822791876849603
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1286, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4573/5025 (91.0050%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4658/5025 (92.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9663, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4043/4441 (91.0381%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8895, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5111/5591 (91.4148%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5094/5591 (91.1107%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1442, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4171/4481 (93.0819%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4156/4481 (92.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9409, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4767 (88.9448%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4266/4767 (89.4902%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0351, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4583/5055 (90.6627%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4626/5055 (91.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9581, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4103/4518 (90.8145%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4256/4518 (94.2010%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8176, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4093/4625 (88.4973%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4168/4625 (90.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3293, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4291/4793 (89.5264%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4407/4793 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9417, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4622/5083 (90.9306%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4672/5083 (91.9142%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9688, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4680/5244 (89.2449%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4752/5244 (90.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9228, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5711/6263 (91.1863%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5771/6263 (92.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0593, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3780/4175 (90.5389%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3849/4175 (92.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9350, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4056/4416 (91.8478%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9264, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4810/5265 (91.3580%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4817/5265 (91.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9761, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3654/4025 (90.7826%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3765/4025 (93.5404%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8163, Accuracy: 5867/10000 (58.6700%)
time spent on training: 236.22395849227905
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 3.5472, Accuracy: 4077/10000 (40.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 10.4694, Accuracy: 60/9900 (0.6061%)
Done in 260.1242735385895 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4504/4885 (92.2006%), train_poison_data_count: 385
Global model norm: 46.30636873213284.
Norm before scaling: 46.29029600149744. Distance: 2.0588735430116345
Total norm for 4 adversaries is: 46.29029600149744. distance: 2.0588735430116345
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1393, Accuracy: 9571/9900 (96.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 46.30636873213284.
Norm before scaling: 46.29012986638593. Distance: 2.208041285750807
Total norm for 4 adversaries is: 46.29012986638593. distance: 2.208041285750807
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0950, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 46.30636873213284.
Norm before scaling: 46.28773007048547. Distance: 1.9745082508609315
Total norm for 4 adversaries is: 46.28773007048547. distance: 1.9745082508609315
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0863, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 46.30636873213284.
Norm before scaling: 46.296144632274725. Distance: 2.222359528538187
Total norm for 4 adversaries is: 46.296144632274725. distance: 2.222359528538187
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0926, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3858/4295 (89.8254%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3801/4295 (88.4983%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0001, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3833/4223 (90.7649%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3941/4223 (93.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8296, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4297/4793 (89.6516%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9926, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4198/4707 (89.1863%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4317/4707 (91.7145%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8531, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5013/5455 (91.8973%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5004/5455 (91.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9881, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4178/4651 (89.8301%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4306/4651 (92.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0406, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3432/3837 (89.4449%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3588/3837 (93.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8782, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4082/4441 (91.9162%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4139/4441 (93.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9778, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3285/3638 (90.2969%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3350/3638 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8519, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3861/4235 (91.1688%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3939/4235 (93.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8635, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4090/4362 (93.7643%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8800, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3443/3797 (90.6769%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3512/3797 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9710, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3653/4158 (87.8547%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3757/4158 (90.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8334, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3734/4126 (90.4993%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3849/4126 (93.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8066, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4683/5195 (90.1444%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4691/5195 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0224, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3661/4046 (90.4844%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3730/4046 (92.1898%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9256, Accuracy: 5671/10000 (56.7100%)
time spent on training: 226.56851243972778
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 3.6134, Accuracy: 3994/10000 (39.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 10.3641, Accuracy: 59/9900 (0.5960%)
Done in 250.32235503196716 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 46.3317531252191.
Norm before scaling: 46.3151251786336. Distance: 2.0811687923316775
Total norm for 4 adversaries is: 46.3151251786336. distance: 2.0811687923316775
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0995, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 46.3317531252191.
Norm before scaling: 46.31403137228636. Distance: 2.1511089569970756
Total norm for 4 adversaries is: 46.31403137228636. distance: 2.1511089569970756
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1441, Accuracy: 9539/9900 (96.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 46.3317531252191.
Norm before scaling: 46.30993793520458. Distance: 1.9905858801047465
Total norm for 4 adversaries is: 46.30993793520458. distance: 1.9905858801047465
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1066, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4609/5066 (90.9791%), train_poison_data_count: 400
Global model norm: 46.3317531252191.
Norm before scaling: 46.31563385567691. Distance: 2.1152693163521006
Total norm for 4 adversaries is: 46.31563385567691. distance: 2.1152693163521006
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0943, Accuracy: 9681/9900 (97.7879%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3960/4361 (90.8049%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3917/4361 (89.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8791, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2970/3297 (90.0819%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3085/3297 (93.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8060, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4202/4716 (89.1009%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4314/4716 (91.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9827, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4648/5167 (89.9555%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4815/5167 (93.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0176, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3900/4368 (89.2857%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3998/4368 (91.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9021, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4337/4679 (92.6907%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4382/4679 (93.6525%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9237, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4129/4356 (94.7888%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4169/4356 (95.7071%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9317, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5496/5902 (93.1210%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5380/5902 (91.1555%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0478, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3490/3861 (90.3911%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3564/3861 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8263, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4172/4356 (95.7759%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4045/4356 (92.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8168, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5703/6263 (91.0586%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5799/6263 (92.5914%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0220, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3880/4235 (91.6175%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3930/4235 (92.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0237, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4601/5232 (87.9396%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4763/5232 (91.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0069, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4537/5017 (90.4325%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4628/5017 (92.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8763, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4616/4804 (96.0866%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4563/4804 (94.9833%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8447, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4288/4793 (89.4638%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9970, Accuracy: 5648/10000 (56.4800%)
time spent on training: 234.23535776138306
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 3.5298, Accuracy: 4112/10000 (41.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 10.2482, Accuracy: 55/9900 (0.5556%)
Done in 257.8677468299866 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4459/4885 (91.2794%), train_poison_data_count: 385
Global model norm: 46.364335553614104.
Norm before scaling: 46.350400420499334. Distance: 2.127525287661675
Total norm for 4 adversaries is: 46.350400420499334. distance: 2.127525287661675
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1614, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 46.364335553614104.
Norm before scaling: 46.35008438250814. Distance: 2.167321020742406
Total norm for 4 adversaries is: 46.35008438250814. distance: 2.167321020742406
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.2066, Accuracy: 9437/9900 (95.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 46.364335553614104.
Norm before scaling: 46.34681853040859. Distance: 1.9640782952716715
Total norm for 4 adversaries is: 46.34681853040859. distance: 1.9640782952716715
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1342, Accuracy: 9575/9900 (96.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4640/5066 (91.5910%), train_poison_data_count: 400
Global model norm: 46.364335553614104.
Norm before scaling: 46.34684486884598. Distance: 2.086953133773818
Total norm for 4 adversaries is: 46.34684486884598. distance: 2.086953133773818
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.2497, Accuracy: 9280/9900 (93.7374%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3463/3837 (90.2528%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3579/3837 (93.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9038, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3493/3861 (90.4688%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3497/3861 (90.5724%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9577, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3775/4175 (90.4192%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3800/4175 (91.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9375, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4053/4441 (91.2632%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4105/4441 (92.4341%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0979, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3982/4336 (91.8358%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4042/4336 (93.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0221, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3665/4046 (90.5833%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3760/4046 (92.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9348, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4452/4956 (89.8305%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4510/4956 (91.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0010, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4230/4618 (91.5981%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4265/4618 (92.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9307, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3240/3616 (89.6018%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8965, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4166/4576 (91.0402%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4222/4576 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8392, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3835/4223 (90.8122%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3932/4223 (93.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8707, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4074/4503 (90.4730%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4149/4503 (92.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8993, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3290/3590 (91.6435%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3323/3590 (92.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8973, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4243/4707 (90.1423%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4330/4707 (91.9907%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9797, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3690/4013 (91.9512%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3780/4013 (94.1939%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7746, Accuracy: 6013/10000 (60.1300%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3316/3704 (89.5248%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3385/3704 (91.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9135, Accuracy: 5717/10000 (57.1700%)
time spent on training: 225.72000288963318
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 3.3694, Accuracy: 4222/10000 (42.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 10.0789, Accuracy: 75/9900 (0.7576%)
Done in 249.14726877212524 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 46.389567182281134.
Norm before scaling: 46.373947090473116. Distance: 2.0529715331157643
Total norm for 4 adversaries is: 46.373947090473116. distance: 2.0529715331157643
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1156, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 46.389567182281134.
Norm before scaling: 46.37157795662662. Distance: 2.1822408398617235
Total norm for 4 adversaries is: 46.37157795662662. distance: 2.1822408398617235
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1213, Accuracy: 9601/9900 (96.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 46.389567182281134.
Norm before scaling: 46.369358758134936. Distance: 1.976664664903799
Total norm for 4 adversaries is: 46.369358758134936. distance: 1.976664664903799
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0730, Accuracy: 9717/9900 (98.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4631/5066 (91.4133%), train_poison_data_count: 400
Global model norm: 46.389567182281134.
Norm before scaling: 46.37495525183151. Distance: 2.093008564865442
Total norm for 4 adversaries is: 46.37495525183151. distance: 2.093008564865442
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1359, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4192/4596 (91.2097%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4320/4596 (93.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9009, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4136/4356 (94.9495%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3995/4356 (91.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1228, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3972/4295 (92.4796%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4035/4295 (93.9464%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7578, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4206/4634 (90.7639%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4263/4634 (91.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8168, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4259/4767 (89.3434%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4344/4767 (91.1265%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9774, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3822/4223 (90.5044%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3925/4223 (92.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8152, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3709/4046 (91.6708%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3741/4046 (92.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9115, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4588/5083 (90.2617%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4631/5083 (91.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0160, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3985/4362 (91.3572%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4107/4362 (94.1541%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8262, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4250/4663 (91.1430%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4360/4663 (93.5020%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9669, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3000/3297 (90.9918%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3097/3297 (93.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7711, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4059/4433 (91.5633%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4081/4433 (92.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9153, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4813/5265 (91.4150%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4850/5265 (92.1178%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8898, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4554/4986 (91.3357%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4599/4986 (92.2383%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9691, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4202/4647 (90.4239%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4286/4647 (92.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9347, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4583/5017 (91.3494%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/5017 (91.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9420, Accuracy: 5719/10000 (57.1900%)
time spent on training: 231.83198428153992
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 3.3442, Accuracy: 4222/10000 (42.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 9.9564, Accuracy: 100/9900 (1.0101%)
Done in 255.56244134902954 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4517/4885 (92.4667%), train_poison_data_count: 385
Global model norm: 46.417241438223954.
Norm before scaling: 46.39906036477867. Distance: 1.9663010761201587
Total norm for 4 adversaries is: 46.39906036477867. distance: 1.9663010761201587
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1806, Accuracy: 9471/9900 (95.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 46.417241438223954.
Norm before scaling: 46.39931029760841. Distance: 2.174284003783238
Total norm for 4 adversaries is: 46.39931029760841. distance: 2.174284003783238
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0749, Accuracy: 9728/9900 (98.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4293/4717 (91.0112%), train_poison_data_count: 370
Global model norm: 46.417241438223954.
Norm before scaling: 46.397834358977626. Distance: 1.9754595789190714
Total norm for 4 adversaries is: 46.397834358977626. distance: 1.9754595789190714
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0590, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4591/5066 (90.6238%), train_poison_data_count: 400
Global model norm: 46.417241438223954.
Norm before scaling: 46.40028896899512. Distance: 2.128805455612767
Total norm for 4 adversaries is: 46.40028896899512. distance: 2.128805455612767
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.2013, Accuracy: 9418/9900 (95.1313%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3798/4184 (90.7744%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3853/4184 (92.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8525, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5812/6391 (90.9404%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5828/6391 (91.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0506, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4666/4934 (94.5683%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4620/4934 (93.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9353, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4237/4618 (91.7497%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4333/4618 (93.8285%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8960, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3908/4235 (92.2786%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3968/4235 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9473, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4063/4465 (90.9966%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4194/4465 (93.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8078, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4093/4503 (90.8950%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4110/4503 (91.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8219, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4521/5025 (89.9701%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4574/5025 (91.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2185, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5082/5582 (91.0426%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5131/5582 (91.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1356, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3400/3804 (89.3796%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3536/3804 (92.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8169, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3677/4158 (88.4319%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3787/4158 (91.0774%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9107, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4186/4538 (92.2433%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4240/4538 (93.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9294, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3909/4368 (89.4918%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3989/4368 (91.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9272, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4659/5083 (91.6585%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4708/5083 (92.6225%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8478, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4564/5116 (89.2103%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4673/5116 (91.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9123, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4151/4356 (95.2938%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4021/4356 (92.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1657, Accuracy: 5410/10000 (54.1000%)
time spent on training: 234.27264785766602
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 3.2843, Accuracy: 4236/10000 (42.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 9.9687, Accuracy: 92/9900 (0.9293%)
Done in 258.07705545425415 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4509/4885 (92.3030%), train_poison_data_count: 385
Global model norm: 46.451458934132255.
Norm before scaling: 46.431340544567796. Distance: 1.9898697478831748
Total norm for 4 adversaries is: 46.431340544567796. distance: 1.9898697478831748
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1032, Accuracy: 9651/9900 (97.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 46.451458934132255.
Norm before scaling: 46.430919894673906. Distance: 2.0890577888292987
Total norm for 4 adversaries is: 46.430919894673906. distance: 2.0890577888292987
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1565, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 46.451458934132255.
Norm before scaling: 46.43034938216597. Distance: 1.946960792671823
Total norm for 4 adversaries is: 46.43034938216597. distance: 1.946960792671823
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1022, Accuracy: 9653/9900 (97.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 46.451458934132255.
Norm before scaling: 46.43477132797415. Distance: 2.129699335324265
Total norm for 4 adversaries is: 46.43477132797415. distance: 2.129699335324265
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0634, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5698/6263 (90.9788%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5771/6263 (92.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9625, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4044/4433 (91.2249%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4130/4433 (93.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9531, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3341/3672 (90.9858%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3396/3672 (92.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9021, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5063/5455 (92.8139%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4989/5455 (91.4574%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9898, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4576/5025 (91.0647%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4586/5025 (91.2637%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0775, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4236/4618 (91.7280%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4241/4618 (91.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9480, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4269/4707 (90.6947%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4323/4707 (91.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8457, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4032/4362 (92.4347%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0657, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4432/4989 (88.8354%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4989 (90.9401%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9759, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4672/5083 (91.9142%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4691/5083 (92.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1089, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4202/4647 (90.4239%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4328/4647 (93.1354%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8578, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3958/4368 (90.6136%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3973/4368 (90.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9317, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4259/4354 (97.8181%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4228/4354 (97.1061%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7731, Accuracy: 6078/10000 (60.7800%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4276/4767 (89.7000%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4349/4767 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0132, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4253/4662 (91.2269%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4307/4662 (92.3852%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9853, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4655/4804 (96.8984%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0017, Accuracy: 4670/4804 (97.2107%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6738, Accuracy: 6270/10000 (62.7000%)
time spent on training: 234.63722395896912
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 3.2887, Accuracy: 4251/10000 (42.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 10.0751, Accuracy: 97/9900 (0.9798%)
Done in 258.45420002937317 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 46.481079189883815.
Norm before scaling: 46.46411848556502. Distance: 2.0113536910882424
Total norm for 4 adversaries is: 46.46411848556502. distance: 2.0113536910882424
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1374, Accuracy: 9551/9900 (96.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4849/5305 (91.4043%), train_poison_data_count: 415
Global model norm: 46.481079189883815.
Norm before scaling: 46.463708641294716. Distance: 2.155082939658388
Total norm for 4 adversaries is: 46.463708641294716. distance: 2.155082939658388
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.2979, Accuracy: 9270/9900 (93.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4343/4717 (92.0712%), train_poison_data_count: 370
Global model norm: 46.481079189883815.
Norm before scaling: 46.45974399950994. Distance: 1.9061030972268238
Total norm for 4 adversaries is: 46.45974399950994. distance: 1.9061030972268238
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0490, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4637/5066 (91.5318%), train_poison_data_count: 400
Global model norm: 46.481079189883815.
Norm before scaling: 46.46550299684703. Distance: 2.0950471646045883
Total norm for 4 adversaries is: 46.46550299684703. distance: 2.0950471646045883
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0698, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3911/4235 (92.3495%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3948/4235 (93.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9240, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3467/3775 (91.8411%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3557/3775 (94.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8175, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4540/4874 (93.1473%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4503/4874 (92.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0208, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4769/5265 (90.5793%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4752/5265 (90.2564%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9699, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4679/5083 (92.0519%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4736/5083 (93.1733%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8730, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4081/4511 (90.4677%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4192/4511 (92.9284%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8506, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4200/4538 (92.5518%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4260/4538 (93.8740%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8773, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4274/4716 (90.6277%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4328/4716 (91.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8877, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4254/4663 (91.2288%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4342/4663 (93.1160%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9201, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4082/4441 (91.9162%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4145/4441 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9872, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4321/4793 (90.1523%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4473/4793 (93.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9639, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4271/4662 (91.6130%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4309/4662 (92.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9190, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3322/3704 (89.6868%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3464/3704 (93.5205%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8153, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4511/4989 (90.4189%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4501/4989 (90.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8573, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4022/4346 (92.5449%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4104/4346 (94.4317%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7519, Accuracy: 6014/10000 (60.1400%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4100/4362 (93.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9471, Accuracy: 5670/10000 (56.7000%)
time spent on training: 232.45459294319153
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 3.3075, Accuracy: 4163/10000 (41.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 9.9374, Accuracy: 91/9900 (0.9192%)
Done in 256.8060507774353 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4529/4885 (92.7124%), train_poison_data_count: 385
Global model norm: 46.51205583384404.
Norm before scaling: 46.49276447402865. Distance: 1.9564264699297598
Total norm for 4 adversaries is: 46.49276447402865. distance: 1.9564264699297598
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1285, Accuracy: 9607/9900 (97.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4847/5305 (91.3666%), train_poison_data_count: 415
Global model norm: 46.51205583384404.
Norm before scaling: 46.49409824778839. Distance: 2.151316541299853
Total norm for 4 adversaries is: 46.49409824778839. distance: 2.151316541299853
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.3338, Accuracy: 9158/9900 (92.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4362/4717 (92.4740%), train_poison_data_count: 370
Global model norm: 46.51205583384404.
Norm before scaling: 46.48934847343394. Distance: 1.8910518195981616
Total norm for 4 adversaries is: 46.48934847343394. distance: 1.8910518195981616
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1603, Accuracy: 9514/9900 (96.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4658/5066 (91.9463%), train_poison_data_count: 400
Global model norm: 46.51205583384404.
Norm before scaling: 46.49275397172123. Distance: 2.0441052282685006
Total norm for 4 adversaries is: 46.49275397172123. distance: 2.0441052282685006
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2339, Accuracy: 9365/9900 (94.5960%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3595/3969 (90.5770%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3633/3969 (91.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9300, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4165/4558 (91.3778%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4172/4558 (91.5314%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0197, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4426/4918 (89.9959%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4546/4918 (92.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9840, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5602/5902 (94.9170%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5538/5902 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8994, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4942/5265 (93.8651%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4883/5265 (92.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9899, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4095/4511 (90.7781%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4193/4511 (92.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8736, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4224/4625 (91.3297%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4200/4625 (90.8108%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8711, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3947/4416 (89.3795%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4040/4416 (91.4855%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8851, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3039/3297 (92.1747%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3097/3297 (93.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7491, Accuracy: 6047/10000 (60.4700%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4609/5025 (91.7214%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4687/5025 (93.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1430, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4117/4441 (92.7043%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4201/4441 (94.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9679, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4149/4481 (92.5909%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4119/4481 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0334, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3475/3797 (91.5196%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3526/3797 (92.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7875, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3319/3646 (91.0313%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3400/3646 (93.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7987, Accuracy: 5981/10000 (59.8100%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3717/4025 (92.3478%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3746/4025 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8214, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4434/4928 (89.9756%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9736, Accuracy: 5660/10000 (56.6000%)
time spent on training: 233.18772339820862
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 3.3921, Accuracy: 4126/10000 (41.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 9.9760, Accuracy: 116/9900 (1.1717%)
Done in 259.0511054992676 sec.
Saving all the graphs.
This run has a label: Nov.06_22.49.08. Visdom environment: cifar100_CerP
