current path: saved_models/model_cifar100_Oct.24_00.49.35_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4309/4885 (88.2088%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43986583289422. Distance: 2.292793644160361
Total norm for 4 adversaries is: 42.43986583289422. distance: 2.292793644160361
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4406, Accuracy: 8831/9900 (89.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43529081142251. Distance: 2.2500133514008165
Total norm for 4 adversaries is: 42.43529081142251. distance: 2.2500133514008165
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7386, Accuracy: 8281/9900 (83.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4717 (88.5520%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43869084301199. Distance: 2.1779974397936748
Total norm for 4 adversaries is: 42.43869084301199. distance: 2.1779974397936748
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4309, Accuracy: 8878/9900 (89.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440474168607615. Distance: 2.30618237652144
Total norm for 4 adversaries is: 42.440474168607615. distance: 2.30618237652144
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5903, Accuracy: 8525/9900 (86.1111%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3689/4356 (84.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.5341, Accuracy: 4481/10000 (44.8100%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3939/4465 (88.2195%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4107/4465 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9863, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4042/4647 (86.9808%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9767, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4444/5055 (87.9130%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4526/5055 (89.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0897, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4439/5116 (86.7670%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4467/5116 (87.3143%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0668, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3634/4126 (88.0756%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3760/4126 (91.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9414, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3079/3472 (88.6809%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3212/3472 (92.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0857, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4464/4986 (89.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0241, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3682/4013 (91.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8465, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4034/4618 (87.3538%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4109/4618 (88.9779%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0454, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4437/5083 (87.2910%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4421/5083 (86.9762%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0998, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3970/4511 (88.0071%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4046/4511 (89.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0762, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3797 (87.7272%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3390/3797 (89.2810%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9950, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4992/5582 (89.4303%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0549, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3151/3616 (87.1405%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3222/3616 (89.1040%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0016, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4833/5455 (88.5976%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4854/5455 (88.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0031, Accuracy: 5243/10000 (52.4300%)
time spent on training: 232.0371437072754
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1042, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0666, Accuracy: 114/9900 (1.1515%)
Done in 256.33122086524963 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.454715074197.
Norm before scaling: 42.460657916512844. Distance: 2.1119116330589236
Total norm for 4 adversaries is: 42.460657916512844. distance: 2.1119116330589236
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2542, Accuracy: 9239/9900 (93.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.454715074197.
Norm before scaling: 42.45805892381475. Distance: 2.165160303502274
Total norm for 4 adversaries is: 42.45805892381475. distance: 2.165160303502274
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5498, Accuracy: 8571/9900 (86.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4186/4717 (88.7428%), train_poison_data_count: 370
Global model norm: 42.454715074197.
Norm before scaling: 42.461859609352665. Distance: 2.162892931040795
Total norm for 4 adversaries is: 42.461859609352665. distance: 2.162892931040795
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2352, Accuracy: 9323/9900 (94.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 42.454715074197.
Norm before scaling: 42.464589165654395. Distance: 2.2908714879997154
Total norm for 4 adversaries is: 42.464589165654395. distance: 2.2908714879997154
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2803, Accuracy: 9143/9900 (92.3535%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3594/4025 (89.2919%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3719/4025 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9248, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3345/3797 (88.0959%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3400/3797 (89.5444%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0183, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3931/4625 (84.9946%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3999/4625 (86.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1747, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3870/4481 (86.3647%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3860/4481 (86.1415%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0955, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3860/4315 (89.4554%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3970/4315 (92.0046%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0274, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3700/4235 (87.3672%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3826/4235 (90.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0128, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3373/3828 (88.1139%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3476/3828 (90.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8560, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3814/4416 (86.3678%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3974/4416 (89.9909%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9116, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3638 (86.6410%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3286/3638 (90.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9291, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4561/5265 (86.6287%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4530/5265 (86.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0909, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3355/3781 (88.7331%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3311/3781 (87.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2364, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3989/4441 (89.8221%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4012/4441 (90.3400%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2066, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3967/4433 (89.4879%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4025/4433 (90.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9400, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4438/5083 (87.3106%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4410/5083 (86.7598%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0335, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4314/4928 (87.5406%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4403/4928 (89.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9361, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4171/4793 (87.0227%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4375/4793 (91.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9915, Accuracy: 5469/10000 (54.6900%)
time spent on training: 229.87326550483704
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0953, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0906, Accuracy: 225/9900 (2.2727%)
Done in 254.16511487960815 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 42.477264426561916.
Norm before scaling: 42.47774290823519. Distance: 2.017701845908645
Total norm for 4 adversaries is: 42.47774290823519. distance: 2.017701845908645
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2314, Accuracy: 9272/9900 (93.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 42.477264426561916.
Norm before scaling: 42.47865531330485. Distance: 2.0968703746034003
Total norm for 4 adversaries is: 42.47865531330485. distance: 2.0968703746034003
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0878, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 42.477264426561916.
Norm before scaling: 42.478866528692826. Distance: 1.9885284330135182
Total norm for 4 adversaries is: 42.478866528692826. distance: 1.9885284330135182
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2092, Accuracy: 9359/9900 (94.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.477264426561916.
Norm before scaling: 42.483600638860494. Distance: 2.1643601636298233
Total norm for 4 adversaries is: 42.483600638860494. distance: 2.1643601636298233
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1527, Accuracy: 9508/9900 (96.0404%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3163/3616 (87.4723%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3295/3616 (91.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8144, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3409/3837 (88.8455%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3499/3837 (91.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9397, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4169/4679 (89.1002%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4283/4679 (91.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0036, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3099/3638 (85.1842%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3253/3638 (89.4173%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9558, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3638/4046 (89.9160%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3635/4046 (89.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9870, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3989/4518 (88.2913%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4096/4518 (90.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1866, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3391/3797 (89.3073%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3429/3797 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1177, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4434/5025 (88.2388%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4472/5025 (88.9950%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.4257, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3911/4362 (89.6607%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3966/4362 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0624, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3991/4558 (87.5603%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4023/4558 (88.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1590, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3213/3672 (87.5000%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3262/3672 (88.8344%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0984, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4333/4874 (88.9003%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4358/4874 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2808, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3612/4025 (89.7391%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3698/4025 (91.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9311, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4083/4663 (87.5617%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4259/4663 (91.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0382, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3460/3911 (88.4684%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3435/3911 (87.8292%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0393, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4444/5017 (88.5788%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4535/5017 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9082, Accuracy: 5562/10000 (55.6200%)
time spent on training: 228.36058402061462
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0902, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0942, Accuracy: 422/9900 (4.2626%)
Done in 253.20540118217468 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 42.49760879072713.
Norm before scaling: 42.499819048328014. Distance: 1.9702502997893923
Total norm for 4 adversaries is: 42.499819048328014. distance: 1.9702502997893923
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5336, Accuracy: 8678/9900 (87.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4829/5305 (91.0273%), train_poison_data_count: 415
Global model norm: 42.49760879072713.
Norm before scaling: 42.4956569472105. Distance: 2.0186127985104174
Total norm for 4 adversaries is: 42.4956569472105. distance: 2.0186127985104174
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0761, Accuracy: 9690/9900 (97.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.49760879072713.
Norm before scaling: 42.49909954239104. Distance: 1.955106782655539
Total norm for 4 adversaries is: 42.49909954239104. distance: 1.955106782655539
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1398, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.49760879072713.
Norm before scaling: 42.50352840362565. Distance: 2.119099109436369
Total norm for 4 adversaries is: 42.50352840362565. distance: 2.119099109436369
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3385, Accuracy: 9035/9900 (91.2626%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5263/6124 (85.9406%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5331/6124 (87.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1089, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4356 (89.0266%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3670/4356 (84.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4193, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3543/4158 (85.2092%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3607/4158 (86.7484%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2102, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4895/5455 (89.7342%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4905/5455 (89.9175%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9865, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3933/4511 (87.1869%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4078/4511 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0883, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4544/5232 (86.8502%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4550/5232 (86.9648%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1453, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4489/5244 (85.6026%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4555/5244 (86.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1152, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4384/4918 (89.1419%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4392/4918 (89.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1280, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3625/4126 (87.8575%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3725/4126 (90.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8566, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0971, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3734/4223 (88.4206%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8932, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4525/5195 (87.1030%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4580/5195 (88.1617%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2068, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4149/4679 (88.6728%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4165/4679 (89.0147%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9633, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3213/3646 (88.1240%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3282/3646 (90.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8363, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3196/3616 (88.3850%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3224/3616 (89.1593%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9129, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4079/4716 (86.4928%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4075/4716 (86.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0710, Accuracy: 5298/10000 (52.9800%)
time spent on training: 233.65739631652832
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0869, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4265, Accuracy: 686/9900 (6.9293%)
Done in 258.0643889904022 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 42.52249088947298.
Norm before scaling: 42.52531845807786. Distance: 1.9551572678864453
Total norm for 4 adversaries is: 42.52531845807786. distance: 1.9551572678864453
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1797, Accuracy: 9473/9900 (95.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4871/5305 (91.8190%), train_poison_data_count: 415
Global model norm: 42.52249088947298.
Norm before scaling: 42.51748118191725. Distance: 1.9823148952238374
Total norm for 4 adversaries is: 42.51748118191725. distance: 1.9823148952238374
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1400, Accuracy: 9554/9900 (96.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 42.52249088947298.
Norm before scaling: 42.52317268083074. Distance: 1.9199321199378554
Total norm for 4 adversaries is: 42.52317268083074. distance: 1.9199321199378554
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1879, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 42.52249088947298.
Norm before scaling: 42.5297302378179. Distance: 2.078606915346577
Total norm for 4 adversaries is: 42.5297302378179. distance: 2.078606915346577
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2769, Accuracy: 9211/9900 (93.0404%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5283/6124 (86.2671%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5338/6124 (87.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0695, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3967/4433 (89.4879%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4023/4433 (90.7512%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9645, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3382/3781 (89.4472%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3200/3781 (84.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3260, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3569/3969 (89.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0503, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4466/5025 (88.8756%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4508/5025 (89.7114%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2488, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4192/4679 (89.5918%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4226/4679 (90.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0867, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4160/4707 (88.3790%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4223/4707 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0194, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4425/4986 (88.7485%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4457/4986 (89.3903%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9283, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3906/4315 (90.5214%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3942/4315 (91.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8593, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3861/4416 (87.4321%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3926/4416 (88.9040%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9310, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4246/4804 (88.3847%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4133/4804 (86.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1549, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4259/4793 (88.8588%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0733, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4562/5232 (87.1942%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4549/5232 (86.9457%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9819, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4126/4662 (88.5028%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4210/4662 (90.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0813, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4247/4956 (85.6941%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4302/4956 (86.8039%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2558, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3834/4368 (87.7747%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3838/4368 (87.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9933, Accuracy: 5353/10000 (53.5300%)
time spent on training: 236.10951781272888
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0859, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7504, Accuracy: 1053/9900 (10.6364%)
Done in 260.49431467056274 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 42.54681761839686.
Norm before scaling: 42.54714325796812. Distance: 1.9212379330099139
Total norm for 4 adversaries is: 42.54714325796812. distance: 1.9212379330099139
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2891, Accuracy: 9187/9900 (92.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5305 (91.4609%), train_poison_data_count: 415
Global model norm: 42.54681761839686.
Norm before scaling: 42.54359838650082. Distance: 1.9535545792230367
Total norm for 4 adversaries is: 42.54359838650082. distance: 1.9535545792230367
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2117, Accuracy: 9368/9900 (94.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 42.54681761839686.
Norm before scaling: 42.546836267426364. Distance: 1.8650972166112116
Total norm for 4 adversaries is: 42.546836267426364. distance: 1.8650972166112116
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2344, Accuracy: 9311/9900 (94.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4601/5066 (90.8212%), train_poison_data_count: 400
Global model norm: 42.54681761839686.
Norm before scaling: 42.55136630490333. Distance: 2.0181007262347554
Total norm for 4 adversaries is: 42.55136630490333. distance: 2.0181007262347554
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1154, Accuracy: 9598/9900 (96.9495%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5364/6124 (87.5898%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5330/6124 (87.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0604, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5159/5902 (87.4110%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5143/5902 (87.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2903, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4173/4707 (88.6552%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4222/4707 (89.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9031, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4095/4647 (88.1214%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4161/4647 (89.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9587, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2981/3297 (90.4155%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3026/3297 (91.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8204, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5556/6263 (88.7115%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5629/6263 (89.8771%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2268, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4178/4663 (89.5990%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4246/4663 (91.0573%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1548, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4336/4956 (87.4899%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4363/4956 (88.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2775, Accuracy: 4959/10000 (49.5900%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3627/4046 (89.6441%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3727/4046 (92.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8942, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3720/4184 (88.9101%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3778/4184 (90.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8316, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4883/5591 (87.3368%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4893/5591 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1191, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4096/4634 (88.3902%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4190/4634 (90.4186%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9127, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3397/3828 (88.7409%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3502/3828 (91.4838%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0036, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3141/3638 (86.3386%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3262/3638 (89.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9068, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3391/3781 (89.6853%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3373/3781 (89.2092%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2185, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3427/3837 (89.3146%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3523/3837 (91.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8964, Accuracy: 5672/10000 (56.7200%)
time spent on training: 231.54706859588623
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0839, Accuracy: 7078/10000 (70.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.1803, Accuracy: 1420/9900 (14.3434%)
Done in 255.81530833244324 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 42.57028597562947.
Norm before scaling: 42.568452169619555. Distance: 1.8526946521789949
Total norm for 4 adversaries is: 42.568452169619555. distance: 1.8526946521789949
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2879, Accuracy: 9198/9900 (92.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 42.57028597562947.
Norm before scaling: 42.567768235815755. Distance: 1.9394944907825855
Total norm for 4 adversaries is: 42.567768235815755. distance: 1.9394944907825855
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1500, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.57028597562947.
Norm before scaling: 42.572091028869046. Distance: 1.8814465011423436
Total norm for 4 adversaries is: 42.572091028869046. distance: 1.8814465011423436
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1530, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4623/5066 (91.2554%), train_poison_data_count: 400
Global model norm: 42.57028597562947.
Norm before scaling: 42.5721182689592. Distance: 1.9504722585771073
Total norm for 4 adversaries is: 42.5721182689592. distance: 1.9504722585771073
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2251, Accuracy: 9355/9900 (94.4949%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3913/4501 (86.9362%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3931/4501 (87.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1266, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9222, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3165/3616 (87.5277%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3207/3616 (88.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8811, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4066/4634 (87.7428%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4128/4634 (89.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9889, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4018/4558 (88.1527%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3999/4558 (87.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1408, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4568/5167 (88.4072%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4650/5167 (89.9942%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1033, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3902/4356 (89.5776%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3861/4356 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2428, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4155/4716 (88.1043%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4193/4716 (88.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0255, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5391/6124 (88.0307%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5326/6124 (86.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9576, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5055 (88.2888%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4556/5055 (90.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0824, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4524/5025 (90.0299%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4571/5025 (90.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1352, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4384/4918 (89.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2081, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3758/4223 (88.9889%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3818/4223 (90.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8895, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3925/4481 (87.5921%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3850/4481 (85.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0899, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3206/3638 (88.1253%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3296/3638 (90.5992%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9532, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3586/4013 (89.3596%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8465, Accuracy: 5617/10000 (56.1700%)
time spent on training: 234.45564794540405
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0859, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6185, Accuracy: 1965/9900 (19.8485%)
Done in 258.6461093425751 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4507/4885 (92.2620%), train_poison_data_count: 385
Global model norm: 42.593583776271394.
Norm before scaling: 42.59123508028456. Distance: 1.836168185411619
Total norm for 4 adversaries is: 42.59123508028456. distance: 1.836168185411619
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2460, Accuracy: 9288/9900 (93.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4859/5305 (91.5928%), train_poison_data_count: 415
Global model norm: 42.593583776271394.
Norm before scaling: 42.59049705571802. Distance: 1.921883621816757
Total norm for 4 adversaries is: 42.59049705571802. distance: 1.921883621816757
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2392, Accuracy: 9331/9900 (94.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4330/4717 (91.7956%), train_poison_data_count: 370
Global model norm: 42.593583776271394.
Norm before scaling: 42.59260791526433. Distance: 1.783138478706512
Total norm for 4 adversaries is: 42.59260791526433. distance: 1.783138478706512
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4528, Accuracy: 8824/9900 (89.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 42.593583776271394.
Norm before scaling: 42.59454671852079. Distance: 1.951310375288831
Total norm for 4 adversaries is: 42.59454671852079. distance: 1.951310375288831
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1284, Accuracy: 9573/9900 (96.6970%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3218/3646 (88.2611%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3320/3646 (91.0587%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7901, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3954/4501 (87.8471%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4026/4501 (89.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9722, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4119/4651 (88.5616%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4185/4651 (89.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9858, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4580/5167 (88.6394%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4644/5167 (89.8781%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1177, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4905/5455 (89.9175%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4900/5455 (89.8258%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9874, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4905/5591 (87.7303%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4874/5591 (87.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1100, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4233/4679 (90.4680%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4194/4679 (89.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1098, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5017 (89.2366%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4501/5017 (89.7150%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9121, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4270/4793 (89.0883%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4300/4793 (89.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0543, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4034/4456 (90.5296%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8844, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4831/5424 (89.0671%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4892/5424 (90.1917%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1824, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3682/4175 (88.1916%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3696/4175 (88.5269%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0199, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4558/5116 (89.0930%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4558/5116 (89.0930%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0280, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3369/3704 (90.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9086, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4521/5232 (86.4106%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4657/5232 (89.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0578, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3111/3472 (89.6025%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3178/3472 (91.5323%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0933, Accuracy: 5433/10000 (54.3300%)
time spent on training: 236.41424775123596
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0884, Accuracy: 7063/10000 (70.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1427, Accuracy: 2529/9900 (25.5455%)
Done in 260.4664714336395 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4885 (92.4053%), train_poison_data_count: 385
Global model norm: 42.61715527611064.
Norm before scaling: 42.615077141836636. Distance: 1.804399145299751
Total norm for 4 adversaries is: 42.615077141836636. distance: 1.804399145299751
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1992, Accuracy: 9408/9900 (95.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 42.61715527611064.
Norm before scaling: 42.610980729278424. Distance: 1.879975076368169
Total norm for 4 adversaries is: 42.610980729278424. distance: 1.879975076368169
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2044, Accuracy: 9421/9900 (95.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4328/4717 (91.7532%), train_poison_data_count: 370
Global model norm: 42.61715527611064.
Norm before scaling: 42.61425932309806. Distance: 1.7860847579306551
Total norm for 4 adversaries is: 42.61425932309806. distance: 1.7860847579306551
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1541, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4643/5066 (91.6502%), train_poison_data_count: 400
Global model norm: 42.61715527611064.
Norm before scaling: 42.61852727614482. Distance: 1.921800751531182
Total norm for 4 adversaries is: 42.61852727614482. distance: 1.921800751531182
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3611, Accuracy: 8997/9900 (90.8788%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3243/3590 (90.3343%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3341/3590 (93.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9415, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3871/4368 (88.6218%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3854/4368 (88.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8683, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3300/3704 (89.0929%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3377/3704 (91.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9714, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4354/4928 (88.3523%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4364/4928 (88.5552%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1835, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3928/4356 (90.1745%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3886/4356 (89.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1570, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3361/3911 (85.9371%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2039, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4151/4651 (89.2496%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4172/4651 (89.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1321, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3766/4184 (90.0096%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3764/4184 (89.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0021, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3934/4346 (90.5200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3989/4346 (91.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8618, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4240/4793 (88.4623%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9277, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3434/3804 (90.2734%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3471/3804 (91.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9449, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4498/4986 (90.2126%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4505/4986 (90.3530%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8346, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5382/6124 (87.8837%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5287/6124 (86.3325%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0886, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4184/4707 (88.8889%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4246/4707 (90.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9924, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3819/4235 (90.1771%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3737/4235 (88.2409%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0459, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3656/4046 (90.3609%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3708/4046 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9494, Accuracy: 5468/10000 (54.6800%)
time spent on training: 231.39333748817444
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0915, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7210, Accuracy: 3070/9900 (31.0101%)
Done in 255.5025351047516 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4555/4885 (93.2446%), train_poison_data_count: 385
Global model norm: 42.63936822534136.
Norm before scaling: 42.63371514414604. Distance: 1.7722107934068396
Total norm for 4 adversaries is: 42.63371514414604. distance: 1.7722107934068396
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0644, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4897/5305 (92.3091%), train_poison_data_count: 415
Global model norm: 42.63936822534136.
Norm before scaling: 42.63486042245462. Distance: 1.8430846355334918
Total norm for 4 adversaries is: 42.63486042245462. distance: 1.8430846355334918
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1006, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4351/4717 (92.2408%), train_poison_data_count: 370
Global model norm: 42.63936822534136.
Norm before scaling: 42.63633349144541. Distance: 1.7466175906491632
Total norm for 4 adversaries is: 42.63633349144541. distance: 1.7466175906491632
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3312, Accuracy: 9140/9900 (92.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.63936822534136.
Norm before scaling: 42.64069943196142. Distance: 1.9376211436145743
Total norm for 4 adversaries is: 42.64069943196142. distance: 1.9376211436145743
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1699, Accuracy: 9476/9900 (95.7172%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4460/4986 (89.4505%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4500/4986 (90.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0334, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4085/4634 (88.1528%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4133/4634 (89.1886%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9083, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4159/4716 (88.1891%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4224/4716 (89.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0601, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5374/6124 (87.7531%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5396/6124 (88.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1265, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4405/4918 (89.5689%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4483/4918 (91.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0289, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3403/3797 (89.6234%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3426/3797 (90.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0628, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5011/5582 (89.7707%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5054/5582 (90.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1819, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4350/4956 (87.7724%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4338/4956 (87.5303%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0767, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4017/4433 (90.6158%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4013/4433 (90.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9025, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3883/4354 (89.1824%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0118, Accuracy: 3387/4354 (77.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3532, Accuracy: 4746/10000 (47.4600%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9219, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3500/3911 (89.4912%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3506/3911 (89.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9112, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3853/4481 (85.9853%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3830/4481 (85.4720%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1062, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4609/5197 (88.6858%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4613/5197 (88.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9760, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4848/5455 (88.8726%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4909/5455 (89.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0532, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3848/4361 (88.2366%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3747/4361 (85.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0985, Accuracy: 5183/10000 (51.8300%)
time spent on training: 235.95070052146912
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0954, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3362, Accuracy: 3593/9900 (36.2929%)
Done in 260.0709025859833 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4534/4885 (92.8147%), train_poison_data_count: 385
Global model norm: 42.66501884457351.
Norm before scaling: 42.66440369644744. Distance: 1.7708002049956322
Total norm for 4 adversaries is: 42.66440369644744. distance: 1.7708002049956322
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1627, Accuracy: 9508/9900 (96.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4907/5305 (92.4976%), train_poison_data_count: 415
Global model norm: 42.66501884457351.
Norm before scaling: 42.65819020312805. Distance: 1.8296123876880366
Total norm for 4 adversaries is: 42.65819020312805. distance: 1.8296123876880366
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1397, Accuracy: 9526/9900 (96.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4362/4717 (92.4740%), train_poison_data_count: 370
Global model norm: 42.66501884457351.
Norm before scaling: 42.659017195041834. Distance: 1.7079155418812322
Total norm for 4 adversaries is: 42.659017195041834. distance: 1.7079155418812322
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0622, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 42.66501884457351.
Norm before scaling: 42.66779405375983. Distance: 1.9102824350815264
Total norm for 4 adversaries is: 42.66779405375983. distance: 1.9102824350815264
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1710, Accuracy: 9474/9900 (95.6970%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4341/4928 (88.0885%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4384/4928 (88.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9344, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3782/4184 (90.3920%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3813/4184 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8901, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4260/4707 (90.5035%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4243/4707 (90.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0711, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3438/3828 (89.8119%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3535/3828 (92.3459%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9595, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4015/4503 (89.1628%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4006/4503 (88.9629%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9079, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4198/4662 (90.0472%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4244/4662 (91.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9762, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3788/4235 (89.4451%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3813/4235 (90.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0141, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4457/5244 (84.9924%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4455/5244 (84.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0923, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4793 (88.9839%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1229, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3991/4481 (89.0649%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3864/4481 (86.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2391, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3971/4346 (91.3714%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4042/4346 (93.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7206, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3837/4361 (87.9844%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3687/4361 (84.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1270, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4567/5055 (90.3462%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4554/5055 (90.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9356, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4575/5195 (88.0654%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4527/5195 (87.1415%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1520, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3946/4315 (91.4484%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3993/4315 (92.5377%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0015, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4229/4663 (90.6927%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4275/4663 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0902, Accuracy: 5354/10000 (53.5400%)
time spent on training: 234.9908962249756
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.0995, Accuracy: 7044/10000 (70.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9347, Accuracy: 4142/9900 (41.8384%)
Done in 259.10378336906433 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4548/4885 (93.1013%), train_poison_data_count: 385
Global model norm: 42.688439377017666.
Norm before scaling: 42.684590230715145. Distance: 1.6975440180019483
Total norm for 4 adversaries is: 42.684590230715145. distance: 1.6975440180019483
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1779, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4925/5305 (92.8369%), train_poison_data_count: 415
Global model norm: 42.688439377017666.
Norm before scaling: 42.68344914665036. Distance: 1.8133823614761901
Total norm for 4 adversaries is: 42.68344914665036. distance: 1.8133823614761901
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2356, Accuracy: 9325/9900 (94.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4378/4717 (92.8132%), train_poison_data_count: 370
Global model norm: 42.688439377017666.
Norm before scaling: 42.68270842663118. Distance: 1.670843501389054
Total norm for 4 adversaries is: 42.68270842663118. distance: 1.670843501389054
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1689, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4675/5066 (92.2819%), train_poison_data_count: 400
Global model norm: 42.688439377017666.
Norm before scaling: 42.68850228737315. Distance: 1.8402290345780277
Total norm for 4 adversaries is: 42.68850228737315. distance: 1.8402290345780277
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1576, Accuracy: 9493/9900 (95.8889%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4315 (92.1900%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3956/4315 (91.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8789, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3279/3590 (91.3370%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3213/3590 (89.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1251, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4208/4679 (89.9337%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4227/4679 (90.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0634, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4633/5167 (89.6652%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4660/5167 (90.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0587, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3390/3775 (89.8013%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3523/3775 (93.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8598, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3436/3828 (89.7597%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3499/3828 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8840, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3811/4235 (89.9882%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3851/4235 (90.9327%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9395, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4160/4647 (89.5201%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4228/4647 (90.9834%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9105, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4423/4918 (89.9349%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4465/4918 (90.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0049, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4011/4433 (90.4805%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4017/4433 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9744, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3989/4481 (89.0203%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3899/4481 (87.0118%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1075, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3834/4295 (89.2666%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3704/4295 (86.2398%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2468, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4021/4503 (89.2960%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4027/4503 (89.4293%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9567, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3865/4354 (88.7689%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3578/4354 (82.1773%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5062, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4491/4986 (90.0722%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4435/4986 (88.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0657, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5611/6263 (89.5897%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5710/6263 (91.1704%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0648, Accuracy: 5316/10000 (53.1600%)
time spent on training: 232.98567128181458
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1108, Accuracy: 7025/10000 (70.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6276, Accuracy: 4650/9900 (46.9697%)
Done in 257.1635105609894 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4532/4885 (92.7738%), train_poison_data_count: 385
Global model norm: 42.71148409998695.
Norm before scaling: 42.70670665093189. Distance: 1.7331586817024842
Total norm for 4 adversaries is: 42.70670665093189. distance: 1.7331586817024842
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1610, Accuracy: 9507/9900 (96.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4898/5305 (92.3280%), train_poison_data_count: 415
Global model norm: 42.71148409998695.
Norm before scaling: 42.707162553820375. Distance: 1.8754034244137923
Total norm for 4 adversaries is: 42.707162553820375. distance: 1.8754034244137923
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0713, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4377/4717 (92.7920%), train_poison_data_count: 370
Global model norm: 42.71148409998695.
Norm before scaling: 42.70375245376936. Distance: 1.6535614793143292
Total norm for 4 adversaries is: 42.70375245376936. distance: 1.6535614793143292
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1673, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 42.71148409998695.
Norm before scaling: 42.70986500048174. Distance: 1.8262583666224024
Total norm for 4 adversaries is: 42.70986500048174. distance: 1.8262583666224024
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0557, Accuracy: 9763/9900 (98.6162%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3761/4223 (89.0599%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3817/4223 (90.3860%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9605, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4946/5455 (90.6691%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4885/5455 (89.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0587, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5094/5582 (91.2576%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5082/5582 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2807, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4023/4465 (90.1008%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4094/4465 (91.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8158, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4965/5591 (88.8034%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4924/5591 (88.0701%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1802, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3544/3911 (90.6162%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3396/3911 (86.8320%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0060, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3929/4356 (90.1974%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0141, Accuracy: 3279/4356 (75.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.5522, Accuracy: 4530/10000 (45.3000%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4473/5037 (88.8029%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4530/5037 (89.9345%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9607, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4249/4679 (90.8100%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4258/4679 (91.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1455, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3997/4362 (91.6323%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3948/4362 (90.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2343, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4129/4518 (91.3900%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4180/4518 (92.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9512, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4519/5083 (88.9042%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4492/5083 (88.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2157, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3723/4013 (92.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7782, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4623/5197 (88.9552%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4683/5197 (90.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1566, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2983/3297 (90.4762%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3046/3297 (92.3870%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7746, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4037/4441 (90.9029%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4048/4441 (91.1506%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0640, Accuracy: 5469/10000 (54.6900%)
time spent on training: 234.49416995048523
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1125, Accuracy: 7030/10000 (70.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3779, Accuracy: 5043/9900 (50.9394%)
Done in 258.72659134864807 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4550/4885 (93.1423%), train_poison_data_count: 385
Global model norm: 42.73441356259686.
Norm before scaling: 42.7293629944803. Distance: 1.7225167354219215
Total norm for 4 adversaries is: 42.7293629944803. distance: 1.7225167354219215
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0864, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4927/5305 (92.8746%), train_poison_data_count: 415
Global model norm: 42.73441356259686.
Norm before scaling: 42.72604752043828. Distance: 1.7446453735360188
Total norm for 4 adversaries is: 42.72604752043828. distance: 1.7446453735360188
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2816, Accuracy: 9261/9900 (93.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4400/4717 (93.2796%), train_poison_data_count: 370
Global model norm: 42.73441356259686.
Norm before scaling: 42.72764886509744. Distance: 1.6573882600107275
Total norm for 4 adversaries is: 42.72764886509744. distance: 1.6573882600107275
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2943, Accuracy: 9150/9900 (92.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4669/5066 (92.1634%), train_poison_data_count: 400
Global model norm: 42.73441356259686.
Norm before scaling: 42.73316525938533. Distance: 1.8289093552033056
Total norm for 4 adversaries is: 42.73316525938533. distance: 1.8289093552033056
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1638, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4039/4501 (89.7356%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4043/4501 (89.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9769, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4027/4511 (89.2707%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4078/4511 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9425, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3912/4354 (89.8484%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3421/4354 (78.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.6384, Accuracy: 4503/10000 (45.0300%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8594, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4254/4707 (90.3760%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9883, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4954/5591 (88.6067%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4938/5591 (88.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0864, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4140/4647 (89.0897%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4190/4647 (90.1657%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8308, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4113/4538 (90.6346%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4178/4538 (92.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8827, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4382/4934 (88.8123%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4368/4934 (88.5286%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1492, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4326/4804 (90.0500%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4221/4804 (87.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0563, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5692/6263 (90.8830%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5649/6263 (90.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3086, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3971/4481 (88.6186%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9582, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4450/5063 (87.8926%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4455/5063 (87.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9818, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3763/4223 (89.1073%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3892/4223 (92.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9243, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4058/4441 (91.3758%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4086/4441 (92.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0412, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3486/3756 (92.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8896, Accuracy: 5659/10000 (56.5900%)
time spent on training: 236.4416537284851
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1142, Accuracy: 7022/10000 (70.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1845, Accuracy: 5364/9900 (54.1818%)
Done in 260.67033863067627 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4578/4885 (93.7155%), train_poison_data_count: 385
Global model norm: 42.758057309047025.
Norm before scaling: 42.750908022154924. Distance: 1.6731514737040785
Total norm for 4 adversaries is: 42.750908022154924. distance: 1.6731514737040785
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1185, Accuracy: 9614/9900 (97.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4934/5305 (93.0066%), train_poison_data_count: 415
Global model norm: 42.758057309047025.
Norm before scaling: 42.754544200642435. Distance: 1.8456083727538797
Total norm for 4 adversaries is: 42.754544200642435. distance: 1.8456083727538797
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0659, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.758057309047025.
Norm before scaling: 42.751636139195014. Distance: 1.6251591824546452
Total norm for 4 adversaries is: 42.751636139195014. distance: 1.6251591824546452
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2094, Accuracy: 9387/9900 (94.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4709/5066 (92.9530%), train_poison_data_count: 400
Global model norm: 42.758057309047025.
Norm before scaling: 42.75247131700035. Distance: 1.757185624983369
Total norm for 4 adversaries is: 42.75247131700035. distance: 1.757185624983369
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2096, Accuracy: 9370/9900 (94.6465%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4481/5244 (85.4500%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4560/5244 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9073, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4429/4928 (89.8742%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4430/4928 (89.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9490, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3431/3804 (90.1945%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3486/3804 (91.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9469, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3647/4013 (90.8796%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3678/4013 (91.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9248, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3649/4158 (87.7585%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3605/4158 (86.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9374, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5111/5582 (91.5622%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5056/5582 (90.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0680, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4919/5455 (90.1742%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4958/5455 (90.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9766, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3914/4354 (89.8944%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3469/4354 (79.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.8754, Accuracy: 4256/10000 (42.5600%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4057/4433 (91.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0404, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3244/3646 (88.9742%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3337/3646 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8568, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4083/4518 (90.3718%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4104/4518 (90.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0471, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3873/4235 (91.4522%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3809/4235 (89.9410%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3044, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4003/4362 (91.7698%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3907/4362 (89.5690%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1413, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4863/5392 (90.1892%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4741/5392 (87.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1520, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4929/5591 (88.1595%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4910/5591 (87.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1908, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3477/3756 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9677, Accuracy: 5627/10000 (56.2700%)
time spent on training: 234.966472864151
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1222, Accuracy: 6993/10000 (69.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9327, Accuracy: 5824/9900 (58.8283%)
Done in 259.83846735954285 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4552/4885 (93.1832%), train_poison_data_count: 385
Global model norm: 42.78128566698659.
Norm before scaling: 42.77329837306141. Distance: 1.6807431474483845
Total norm for 4 adversaries is: 42.77329837306141. distance: 1.6807431474483845
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0914, Accuracy: 9660/9900 (97.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4940/5305 (93.1197%), train_poison_data_count: 415
Global model norm: 42.78128566698659.
Norm before scaling: 42.77300299436842. Distance: 1.7831034470574962
Total norm for 4 adversaries is: 42.77300299436842. distance: 1.7831034470574962
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0218, Accuracy: 9844/9900 (99.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4400/4717 (93.2796%), train_poison_data_count: 370
Global model norm: 42.78128566698659.
Norm before scaling: 42.773516695132166. Distance: 1.6333277861183064
Total norm for 4 adversaries is: 42.773516695132166. distance: 1.6333277861183064
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1166, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4696/5066 (92.6964%), train_poison_data_count: 400
Global model norm: 42.78128566698659.
Norm before scaling: 42.776573087124746. Distance: 1.8003894437594439
Total norm for 4 adversaries is: 42.776573087124746. distance: 1.8003894437594439
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1295, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4212/4634 (90.8934%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4177/4634 (90.1381%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2092, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4089/4503 (90.8061%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4054/4503 (90.0289%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9506, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4396/4928 (89.2045%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4508/4928 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8331, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3415/3804 (89.7739%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3476/3804 (91.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9202, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3282/3590 (91.4206%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3091/3590 (86.1003%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3472, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4181/4647 (89.9720%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4253/4647 (91.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8422, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4043/4625 (87.4162%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4063/4625 (87.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1118, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3954/4356 (90.7713%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3907/4356 (89.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2131, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3453/3797 (90.9402%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3506/3797 (92.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9410, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4056/4456 (91.0233%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4080/4456 (91.5619%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8927, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3638/4025 (90.3851%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8554, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3172/3472 (91.3594%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3156/3472 (90.8986%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9316, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2950/3297 (89.4753%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3022/3297 (91.6591%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8942, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3924/4416 (88.8587%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3994/4416 (90.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0645, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3967/4356 (91.0698%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4032/4356 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0580, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3231/3638 (88.8125%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8757, Accuracy: 5570/10000 (55.7000%)
time spent on training: 227.48189663887024
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1289, Accuracy: 6996/10000 (69.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7292, Accuracy: 6210/9900 (62.7273%)
Done in 251.7321994304657 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4561/4885 (93.3675%), train_poison_data_count: 385
Global model norm: 42.80136003561613.
Norm before scaling: 42.79543170257048. Distance: 1.6969881697935285
Total norm for 4 adversaries is: 42.79543170257048. distance: 1.6969881697935285
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1568, Accuracy: 9527/9900 (96.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4938/5305 (93.0820%), train_poison_data_count: 415
Global model norm: 42.80136003561613.
Norm before scaling: 42.79118709920741. Distance: 1.73889039756918
Total norm for 4 adversaries is: 42.79118709920741. distance: 1.73889039756918
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0990, Accuracy: 9655/9900 (97.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.80136003561613.
Norm before scaling: 42.79233814716792. Distance: 1.6245887676160191
Total norm for 4 adversaries is: 42.79233814716792. distance: 1.6245887676160191
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1134, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4722/5066 (93.2096%), train_poison_data_count: 400
Global model norm: 42.80136003561613.
Norm before scaling: 42.79434777131058. Distance: 1.7544581982733374
Total norm for 4 adversaries is: 42.79434777131058. distance: 1.7544581982733374
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0816, Accuracy: 9693/9900 (97.9091%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3737/4175 (89.5090%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3715/4175 (88.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9658, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4371/4956 (88.1961%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4414/4956 (89.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1162, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4465/5037 (88.6440%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4587/5037 (91.0661%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9135, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4294/4793 (89.5890%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4349/4793 (90.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0775, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3413/3804 (89.7213%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3415/3804 (89.7739%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0656, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5392 (90.2448%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4874/5392 (90.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1175, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4087/4465 (91.5342%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4086/4465 (91.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9188, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4168/4596 (90.6876%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4222/4596 (91.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9734, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5412/6124 (88.3736%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5389/6124 (87.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9827, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2919/3271 (89.2388%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2983/3271 (91.1954%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8865, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3257/3590 (90.7242%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3277/3590 (91.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9977, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3978/4501 (88.3804%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4031/4501 (89.5579%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0042, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4657/5232 (89.0099%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4584/5232 (87.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0749, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3274/3672 (89.1612%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3296/3672 (89.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0443, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3836/4223 (90.8359%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3873/4223 (91.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0697, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3919/4354 (90.0092%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0185, Accuracy: 2966/4354 (68.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.8142, Accuracy: 4149/10000 (41.4900%)
time spent on training: 233.08066129684448
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1366, Accuracy: 6983/10000 (69.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5496, Accuracy: 6544/9900 (66.1010%)
Done in 257.2079248428345 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 42.82426988076168.
Norm before scaling: 42.81160468954358. Distance: 1.5749599330589228
Total norm for 4 adversaries is: 42.81160468954358. distance: 1.5749599330589228
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2901, Accuracy: 9206/9900 (92.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4972/5305 (93.7229%), train_poison_data_count: 415
Global model norm: 42.82426988076168.
Norm before scaling: 42.811222608680545. Distance: 1.699938812276671
Total norm for 4 adversaries is: 42.811222608680545. distance: 1.699938812276671
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0599, Accuracy: 9748/9900 (98.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4405/4717 (93.3856%), train_poison_data_count: 370
Global model norm: 42.82426988076168.
Norm before scaling: 42.8164944532551. Distance: 1.6504760720067915
Total norm for 4 adversaries is: 42.8164944532551. distance: 1.6504760720067915
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0778, Accuracy: 9704/9900 (98.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.82426988076168.
Norm before scaling: 42.81605396973269. Distance: 1.682148394866242
Total norm for 4 adversaries is: 42.81605396973269. distance: 1.682148394866242
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1869, Accuracy: 9434/9900 (95.2929%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5106/5582 (91.4726%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5008/5582 (89.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0264, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4172/4647 (89.7784%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4198/4647 (90.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0481, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4049/4465 (90.6831%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4130/4465 (92.4972%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9102, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4539/5083 (89.2977%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4467/5083 (87.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3300, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3866/4416 (87.5453%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3942/4416 (89.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8660, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4421/4956 (89.2050%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4398/4956 (88.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2110, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4023/4362 (92.2283%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3897/4362 (89.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0263, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3947/4356 (90.6107%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3813/4356 (87.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3325, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3424/3781 (90.5581%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3480/3781 (92.0391%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0935, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3282/3590 (91.4206%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3322/3590 (92.5348%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0324, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4217/4651 (90.6687%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4255/4651 (91.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9609, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4222/4662 (90.5620%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4229/4662 (90.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9313, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3159/3472 (90.9850%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8758, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4902/5424 (90.3761%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4954/5424 (91.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1873, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2920/3271 (89.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9942, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4494/5037 (89.2198%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4535/5037 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9905, Accuracy: 5531/10000 (55.3100%)
time spent on training: 231.74904537200928
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1369, Accuracy: 6994/10000 (69.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4676, Accuracy: 6688/9900 (67.5556%)
Done in 255.9576132297516 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.8461973908931.
Norm before scaling: 42.83822789905355. Distance: 1.5987396670582465
Total norm for 4 adversaries is: 42.83822789905355. distance: 1.5987396670582465
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1732, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4969/5305 (93.6664%), train_poison_data_count: 415
Global model norm: 42.8461973908931.
Norm before scaling: 42.83667628284129. Distance: 1.7285987273676207
Total norm for 4 adversaries is: 42.83667628284129. distance: 1.7285987273676207
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0994, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4423/4717 (93.7672%), train_poison_data_count: 370
Global model norm: 42.8461973908931.
Norm before scaling: 42.83423404760861. Distance: 1.579377989439707
Total norm for 4 adversaries is: 42.83423404760861. distance: 1.579377989439707
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1975, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4697/5066 (92.7161%), train_poison_data_count: 400
Global model norm: 42.8461973908931.
Norm before scaling: 42.84099331257169. Distance: 1.7676419241334898
Total norm for 4 adversaries is: 42.84099331257169. distance: 1.7676419241334898
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2650, Accuracy: 9263/9900 (93.5657%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4397/4989 (88.1339%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4454/4989 (89.2764%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0872, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3646/4013 (90.8547%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3773/4013 (94.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7897, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4625/5195 (89.0279%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4456/5195 (85.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1479, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3610/3969 (90.9549%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3578/3969 (90.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8931, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3990/4356 (91.5978%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3809/4356 (87.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1244, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4067/4441 (91.5785%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4067/4441 (91.5785%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0430, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4103/4518 (90.8145%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4124/4518 (91.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0087, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3537/3911 (90.4372%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3264/3911 (83.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1692, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4019/4362 (92.1366%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3943/4362 (90.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9427, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3451/3804 (90.7203%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3514/3804 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9654, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3807/4223 (90.1492%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3879/4223 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9978, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4215/4634 (90.9581%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4199/4634 (90.6129%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8660, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3945/4354 (90.6063%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0158, Accuracy: 3148/4354 (72.3013%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 3.0654, Accuracy: 3914/10000 (39.1400%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4528/5244 (86.3463%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4511/5244 (86.0221%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0433, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4487/5037 (89.0808%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0548, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3326/3704 (89.7948%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3361/3704 (90.7397%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8989, Accuracy: 5635/10000 (56.3500%)
time spent on training: 230.803062915802
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1332, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.4101, Accuracy: 6799/9900 (68.6768%)
Done in 255.0607521533966 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4614/4885 (94.4524%), train_poison_data_count: 385
Global model norm: 42.86893377958493.
Norm before scaling: 42.85814172943106. Distance: 1.5842591975099969
Total norm for 4 adversaries is: 42.85814172943106. distance: 1.5842591975099969
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1380, Accuracy: 9552/9900 (96.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4962/5305 (93.5344%), train_poison_data_count: 415
Global model norm: 42.86893377958493.
Norm before scaling: 42.8568443360604. Distance: 1.6933249499771772
Total norm for 4 adversaries is: 42.8568443360604. distance: 1.6933249499771772
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0720, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4414/4717 (93.5764%), train_poison_data_count: 370
Global model norm: 42.86893377958493.
Norm before scaling: 42.856989600497926. Distance: 1.5468070275371237
Total norm for 4 adversaries is: 42.856989600497926. distance: 1.5468070275371237
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0980, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4737/5066 (93.5057%), train_poison_data_count: 400
Global model norm: 42.86893377958493.
Norm before scaling: 42.859534496604425. Distance: 1.6530771634368333
Total norm for 4 adversaries is: 42.859534496604425. distance: 1.6530771634368333
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1877, Accuracy: 9448/9900 (95.4343%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3943/4416 (89.2889%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3956/4416 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9767, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4648/5197 (89.4362%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4619/5197 (88.8782%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8919, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4425/4918 (89.9756%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4490/4918 (91.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0875, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5685/6263 (90.7712%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5691/6263 (90.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1422, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3272/3646 (89.7422%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3324/3646 (91.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8922, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4309/4707 (91.5445%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4331/4707 (92.0119%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9163, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4475/5063 (88.3863%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4326/5063 (85.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2151, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3844/4295 (89.4994%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3852/4295 (89.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1503, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4325/4793 (90.2358%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0160, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4141/4538 (91.2517%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4245/4538 (93.5434%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8878, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4562/5083 (89.7501%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4526/5083 (89.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9982, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3256/3638 (89.4997%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3291/3638 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8193, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5465/6124 (89.2391%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5413/6124 (88.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0477, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4177/4618 (90.4504%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4014/4618 (86.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0396, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3622/3969 (91.2572%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3600/3969 (90.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8370, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3612/4158 (86.8687%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3655/4158 (87.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9446, Accuracy: 5440/10000 (54.4000%)
time spent on training: 237.70851373672485
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1349, Accuracy: 6991/10000 (69.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3457, Accuracy: 6919/9900 (69.8889%)
Done in 262.56396555900574 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4598/4885 (94.1249%), train_poison_data_count: 385
Global model norm: 42.89247633754884.
Norm before scaling: 42.882539936964. Distance: 1.5567572536835543
Total norm for 4 adversaries is: 42.882539936964. distance: 1.5567572536835543
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2085, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4942/5305 (93.1574%), train_poison_data_count: 415
Global model norm: 42.89247633754884.
Norm before scaling: 42.88098280734057. Distance: 1.7381231000300739
Total norm for 4 adversaries is: 42.88098280734057. distance: 1.7381231000300739
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1770, Accuracy: 9449/9900 (95.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4441/4717 (94.1488%), train_poison_data_count: 370
Global model norm: 42.89247633754884.
Norm before scaling: 42.8811607272063. Distance: 1.5477244809326283
Total norm for 4 adversaries is: 42.8811607272063. distance: 1.5477244809326283
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0824, Accuracy: 9677/9900 (97.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4720/5066 (93.1702%), train_poison_data_count: 400
Global model norm: 42.89247633754884.
Norm before scaling: 42.88532241812168. Distance: 1.7234058781867456
Total norm for 4 adversaries is: 42.88532241812168. distance: 1.7234058781867456
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2958, Accuracy: 9188/9900 (92.8081%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4150/4716 (87.9983%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4195/4716 (88.9525%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1958, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4006/4481 (89.3997%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3925/4481 (87.5921%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0893, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3921/4361 (89.9106%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3765/4361 (86.3334%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1006, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4367/4793 (91.1120%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4396/4793 (91.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9507, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3903/4295 (90.8731%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3745/4295 (87.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1294, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4574/5244 (87.2235%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4562/5244 (86.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0708, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4432/4989 (88.8354%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4489/4989 (89.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9402, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4642/5197 (89.3208%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4640/5197 (89.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0218, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3941/4356 (90.4729%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3657/4356 (83.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3346, Accuracy: 4777/10000 (47.7700%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4174/4647 (89.8214%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4208/4647 (90.5530%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9258, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3667/4013 (91.3780%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3705/4013 (92.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8442, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4148/4538 (91.4059%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4172/4538 (91.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7812, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4293/4707 (91.2046%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4317/4707 (91.7145%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8594, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5665/6263 (90.4519%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5672/6263 (90.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1160, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3860/4235 (91.1452%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3753/4235 (88.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0137, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3477/3861 (90.0544%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3482/3861 (90.1839%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0044, Accuracy: 5448/10000 (54.4800%)
time spent on training: 233.45693159103394
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1379, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.2886, Accuracy: 7016/9900 (70.8687%)
Done in 257.50666213035583 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4595/4885 (94.0635%), train_poison_data_count: 385
Global model norm: 42.91643121648601.
Norm before scaling: 42.90851886526657. Distance: 1.629134054743748
Total norm for 4 adversaries is: 42.90851886526657. distance: 1.629134054743748
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1151, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4980/5305 (93.8737%), train_poison_data_count: 415
Global model norm: 42.91643121648601.
Norm before scaling: 42.90479046588941. Distance: 1.7038865093082882
Total norm for 4 adversaries is: 42.90479046588941. distance: 1.7038865093082882
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1185, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4419/4717 (93.6824%), train_poison_data_count: 370
Global model norm: 42.91643121648601.
Norm before scaling: 42.90517882630473. Distance: 1.544271725358968
Total norm for 4 adversaries is: 42.90517882630473. distance: 1.544271725358968
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1410, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4730/5066 (93.3675%), train_poison_data_count: 400
Global model norm: 42.91643121648601.
Norm before scaling: 42.910406412846115. Distance: 1.7152360541262277
Total norm for 4 adversaries is: 42.910406412846115. distance: 1.7152360541262277
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0968, Accuracy: 9639/9900 (97.3636%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4601/5055 (91.0188%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4640/5055 (91.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9466, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3474/3828 (90.7524%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3564/3828 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9115, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3926/4361 (90.0252%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3889/4361 (89.1768%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9485, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3664/4013 (91.3033%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8321, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4106/4518 (90.8809%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8841, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4120/4558 (90.3905%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4056/4558 (88.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1778, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3723/4126 (90.2327%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3803/4126 (92.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9679, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4269/4679 (91.2374%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3900/4679 (83.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2947, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3914/4235 (92.4203%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3837/4235 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9253, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4491/5037 (89.1602%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4613/5037 (91.5823%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9106, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3304/3672 (89.9782%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3354/3672 (91.3399%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8475, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4446/4928 (90.2192%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0967, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3966/4356 (91.0468%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3766/4356 (86.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1050, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4076/4456 (91.4722%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4116/4456 (92.3698%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9780, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4310/4793 (89.9228%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4382/4793 (91.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0018, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4540/5025 (90.3483%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4552/5025 (90.5871%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9147, Accuracy: 5516/10000 (55.1600%)
time spent on training: 234.00971913337708
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1370, Accuracy: 6993/10000 (69.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.1863, Accuracy: 7223/9900 (72.9596%)
Done in 258.23514699935913 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4639/4885 (94.9642%), train_poison_data_count: 385
Global model norm: 42.93816382993033.
Norm before scaling: 42.92706642931197. Distance: 1.541647043189175
Total norm for 4 adversaries is: 42.92706642931197. distance: 1.541647043189175
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0963, Accuracy: 9647/9900 (97.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4992/5305 (94.0999%), train_poison_data_count: 415
Global model norm: 42.93816382993033.
Norm before scaling: 42.9260924620737. Distance: 1.6919624524155112
Total norm for 4 adversaries is: 42.9260924620737. distance: 1.6919624524155112
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0818, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4455/4717 (94.4456%), train_poison_data_count: 370
Global model norm: 42.93816382993033.
Norm before scaling: 42.92384158900287. Distance: 1.4921454778216643
Total norm for 4 adversaries is: 42.92384158900287. distance: 1.4921454778216643
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1686, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.93816382993033.
Norm before scaling: 42.93093222149095. Distance: 1.6805431936490698
Total norm for 4 adversaries is: 42.93093222149095. distance: 1.6805431936490698
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1260, Accuracy: 9562/9900 (96.5859%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3985/4346 (91.6935%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4040/4346 (92.9590%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9053, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3810/4184 (91.0612%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3806/4184 (90.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9169, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3949/4356 (90.6566%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3541/4356 (81.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4891, Accuracy: 4734/10000 (47.3400%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3313/3646 (90.8667%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3360/3646 (92.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7585, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4580/5083 (90.1043%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4588/5083 (90.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0140, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3962/4356 (90.9550%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3917/4356 (89.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1828, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4092/4558 (89.7762%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4073/4558 (89.3594%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0371, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3768/4175 (90.2515%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3704/4175 (88.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9933, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3195/3472 (92.0219%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3174/3472 (91.4171%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1255, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4103/4501 (91.1575%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4075/4501 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9780, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4917/5424 (90.6527%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4958/5424 (91.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2757, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4021/4481 (89.7344%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4000/4481 (89.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1202, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4933/5455 (90.4308%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4917/5455 (90.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2147, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4686/5232 (89.5642%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4621/5232 (88.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0749, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5598/6391 (87.5919%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5566/6391 (87.0912%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0117, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3485/3775 (92.3179%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3575/3775 (94.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8212, Accuracy: 5791/10000 (57.9100%)
time spent on training: 234.8967342376709
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1430, Accuracy: 6983/10000 (69.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.0883, Accuracy: 7412/9900 (74.8687%)
Done in 259.0557870864868 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4597/4885 (94.1044%), train_poison_data_count: 385
Global model norm: 42.96135447719991.
Norm before scaling: 42.9513800118445. Distance: 1.6371628334093478
Total norm for 4 adversaries is: 42.9513800118445. distance: 1.6371628334093478
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0906, Accuracy: 9647/9900 (97.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4999/5305 (94.2319%), train_poison_data_count: 415
Global model norm: 42.96135447719991.
Norm before scaling: 42.94726451471473. Distance: 1.6507004667086747
Total norm for 4 adversaries is: 42.94726451471473. distance: 1.6507004667086747
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0385, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4442/4717 (94.1700%), train_poison_data_count: 370
Global model norm: 42.96135447719991.
Norm before scaling: 42.94790545542137. Distance: 1.5145967279162866
Total norm for 4 adversaries is: 42.94790545542137. distance: 1.5145967279162866
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1557, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4744/5066 (93.6439%), train_poison_data_count: 400
Global model norm: 42.96135447719991.
Norm before scaling: 42.95448200611972. Distance: 1.6958349451280788
Total norm for 4 adversaries is: 42.95448200611972. distance: 1.6958349451280788
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1532, Accuracy: 9507/9900 (96.0303%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3681/4025 (91.4534%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3740/4025 (92.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8479, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3867/4223 (91.5700%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3884/4223 (91.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9427, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3266/3638 (89.7746%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3382/3638 (92.9632%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8534, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4501/5063 (88.8999%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4388/5063 (86.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1174, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4383/4874 (89.9261%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4256/4874 (87.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.4281, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4339/4804 (90.3206%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4134/4804 (86.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3872, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3672/4158 (88.3117%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3665/4158 (88.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9880, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4104/4518 (90.8367%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4158/4518 (92.0319%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0043, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3890/4235 (91.8536%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3778/4235 (89.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0359, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4374/4934 (88.6502%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4093/4934 (82.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3095, Accuracy: 4869/10000 (48.6900%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5626/6391 (88.0300%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5624/6391 (87.9987%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0241, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3885/4295 (90.4540%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3854/4295 (89.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0078, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3475/3756 (92.5186%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3544/3756 (94.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8468, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4032/4481 (89.9799%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0864, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3753/4175 (89.8922%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3713/4175 (88.9341%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9346, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3292/3590 (91.6992%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3188/3590 (88.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2203, Accuracy: 5186/10000 (51.8600%)
time spent on training: 232.73727822303772
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1497, Accuracy: 6967/10000 (69.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 1.0081, Accuracy: 7572/9900 (76.4848%)
Done in 256.95203256607056 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4633/4885 (94.8414%), train_poison_data_count: 385
Global model norm: 42.98445877627241.
Norm before scaling: 42.970795405862575. Distance: 1.5430209766675356
Total norm for 4 adversaries is: 42.970795405862575. distance: 1.5430209766675356
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1986, Accuracy: 9422/9900 (95.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5046/5305 (95.1178%), train_poison_data_count: 415
Global model norm: 42.98445877627241.
Norm before scaling: 42.966708758333326. Distance: 1.5413004294109545
Total norm for 4 adversaries is: 42.966708758333326. distance: 1.5413004294109545
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2648, Accuracy: 9298/9900 (93.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4451/4717 (94.3608%), train_poison_data_count: 370
Global model norm: 42.98445877627241.
Norm before scaling: 42.969801123507075. Distance: 1.4643034485331197
Total norm for 4 adversaries is: 42.969801123507075. distance: 1.4643034485331197
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1109, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4756/5066 (93.8808%), train_poison_data_count: 400
Global model norm: 42.98445877627241.
Norm before scaling: 42.976284850721015. Distance: 1.6593557784122053
Total norm for 4 adversaries is: 42.976284850721015. distance: 1.6593557784122053
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0814, Accuracy: 9689/9900 (97.8687%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3505/3828 (91.5622%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3551/3828 (92.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7866, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3575/3911 (91.4088%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3374/3911 (86.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0920, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4040/4362 (92.6181%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3928/4362 (90.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9597, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4782/5197 (92.0146%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4581/5197 (88.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2625, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4297/4679 (91.8359%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4181/4679 (89.3567%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2217, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4349/4793 (90.7365%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1100, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4585/5116 (89.6208%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4575/5116 (89.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1716, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4094/4625 (88.5189%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4083/4625 (88.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9383, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4254/4618 (92.1178%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4173/4618 (90.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0216, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2956/3271 (90.3699%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2997/3271 (91.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8399, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3824/4175 (91.5928%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3795/4175 (90.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9778, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3234/3616 (89.4358%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8491, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3972/4481 (88.6409%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3928/4481 (87.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0779, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3960/4368 (90.6593%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8860, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5128/5740 (89.3380%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5167/5740 (90.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0931, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4194/4647 (90.2518%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4218/4647 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9315, Accuracy: 5597/10000 (55.9700%)
time spent on training: 231.68109941482544
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1637, Accuracy: 6949/10000 (69.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.8826, Accuracy: 7844/9900 (79.2323%)
Done in 255.72099590301514 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4657/4885 (95.3327%), train_poison_data_count: 385
Global model norm: 43.006906353987205.
Norm before scaling: 42.9933864031907. Distance: 1.5173596552597655
Total norm for 4 adversaries is: 42.9933864031907. distance: 1.5173596552597655
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2365, Accuracy: 9307/9900 (94.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5010/5305 (94.4392%), train_poison_data_count: 415
Global model norm: 43.006906353987205.
Norm before scaling: 42.98940696646239. Distance: 1.62155211069863
Total norm for 4 adversaries is: 42.98940696646239. distance: 1.62155211069863
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1080, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4457/4717 (94.4880%), train_poison_data_count: 370
Global model norm: 43.006906353987205.
Norm before scaling: 42.99240116133533. Distance: 1.4863811388223418
Total norm for 4 adversaries is: 42.99240116133533. distance: 1.4863811388223418
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0519, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4766/5066 (94.0782%), train_poison_data_count: 400
Global model norm: 43.006906353987205.
Norm before scaling: 42.99678488843308. Distance: 1.6505607201316996
Total norm for 4 adversaries is: 42.99678488843308. distance: 1.6505607201316996
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0619, Accuracy: 9733/9900 (98.3131%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4997/5591 (89.3758%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4999/5591 (89.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9988, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4414/4956 (89.0638%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4327/4956 (87.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0652, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4033/4511 (89.4037%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4127/4511 (91.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9159, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3690/4013 (91.9512%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3725/4013 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8507, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3317/3590 (92.3955%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3358/3590 (93.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8926, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4348/4793 (90.7156%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0745, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3476/3804 (91.3775%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3486/3804 (91.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0900, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3492/3837 (91.0086%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3552/3837 (92.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9503, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3793/4361 (86.9755%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1697, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4514/5063 (89.1566%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4384/5063 (86.5890%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2722, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3915/4368 (89.6291%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3950/4368 (90.4304%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0211, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4325/4679 (92.4343%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4124/4679 (88.1385%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0785, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4739/5265 (90.0095%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4663/5265 (88.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1458, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4244/4767 (89.0287%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4201/4767 (88.1267%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1348, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5212/5902 (88.3090%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4948/5902 (83.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2880, Accuracy: 5062/10000 (50.6200%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3815/4223 (90.3386%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9294, Accuracy: 5575/10000 (55.7500%)
time spent on training: 235.5954089164734
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1637, Accuracy: 6952/10000 (69.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.8661, Accuracy: 7881/9900 (79.6061%)
Done in 259.6230285167694 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4675/4885 (95.7011%), train_poison_data_count: 385
Global model norm: 43.03005427941107.
Norm before scaling: 43.01382720770947. Distance: 1.4353009694518937
Total norm for 4 adversaries is: 43.01382720770947. distance: 1.4353009694518937
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1773, Accuracy: 9456/9900 (95.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4999/5305 (94.2319%), train_poison_data_count: 415
Global model norm: 43.03005427941107.
Norm before scaling: 43.01744825640158. Distance: 1.6596145284589128
Total norm for 4 adversaries is: 43.01744825640158. distance: 1.6596145284589128
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1450, Accuracy: 9535/9900 (96.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4458/4717 (94.5092%), train_poison_data_count: 370
Global model norm: 43.03005427941107.
Norm before scaling: 43.01408545873738. Distance: 1.4484093557378523
Total norm for 4 adversaries is: 43.01408545873738. distance: 1.4484093557378523
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1680, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4763/5066 (94.0189%), train_poison_data_count: 400
Global model norm: 43.03005427941107.
Norm before scaling: 43.01770222917683. Distance: 1.648987953882305
Total norm for 4 adversaries is: 43.01770222917683. distance: 1.648987953882305
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0411, Accuracy: 9792/9900 (98.9091%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3496/3797 (92.0727%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3451/3797 (90.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8696, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3486/3861 (90.2875%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3437/3861 (89.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0161, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4304/4707 (91.4383%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4239/4707 (90.0574%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0713, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4127/4518 (91.3457%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4160/4518 (92.0761%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0018, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3692/4013 (92.0010%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3727/4013 (92.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9183, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4709/5167 (91.1361%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4680/5167 (90.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1451, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3601/3969 (90.7281%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3612/3969 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9494, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4077/4441 (91.8036%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4079/4441 (91.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0269, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4105/4558 (90.0614%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4094/4558 (89.8201%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1589, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4073/4465 (91.2206%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4125/4465 (92.3852%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8612, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3308/3638 (90.9291%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3356/3638 (92.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9593, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4134/4538 (91.0974%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4209/4538 (92.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8730, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5128/5740 (89.3380%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5170/5740 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1299, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3497/3837 (91.1389%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3550/3837 (92.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8595, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3948/4361 (90.5297%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3663/4361 (83.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0728, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4374/4793 (91.2581%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4367/4793 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0407, Accuracy: 5372/10000 (53.7200%)
time spent on training: 231.88337230682373
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1648, Accuracy: 6948/10000 (69.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.7901, Accuracy: 8030/9900 (81.1111%)
Done in 256.04634523391724 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4654/4885 (95.2712%), train_poison_data_count: 385
Global model norm: 43.05069459007021.
Norm before scaling: 43.03392783969992. Distance: 1.4816956280315494
Total norm for 4 adversaries is: 43.03392783969992. distance: 1.4816956280315494
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1035, Accuracy: 9635/9900 (97.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4994/5305 (94.1376%), train_poison_data_count: 415
Global model norm: 43.05069459007021.
Norm before scaling: 43.035710609856466. Distance: 1.6484947013873958
Total norm for 4 adversaries is: 43.035710609856466. distance: 1.6484947013873958
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0845, Accuracy: 9692/9900 (97.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4467/4717 (94.7000%), train_poison_data_count: 370
Global model norm: 43.05069459007021.
Norm before scaling: 43.03586094350196. Distance: 1.4586723841764917
Total norm for 4 adversaries is: 43.03586094350196. distance: 1.4586723841764917
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1815, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4768/5066 (94.1176%), train_poison_data_count: 400
Global model norm: 43.05069459007021.
Norm before scaling: 43.03775566971328. Distance: 1.6266172137846888
Total norm for 4 adversaries is: 43.03775566971328. distance: 1.6266172137846888
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1441, Accuracy: 9530/9900 (96.2626%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4223/4767 (88.5882%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4280/4767 (89.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1682, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4114/4441 (92.6368%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4127/4441 (92.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2106, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4003/4356 (91.8962%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3889/4356 (89.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.6089, Accuracy: 4730/10000 (47.3000%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5592/6391 (87.4980%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5522/6391 (86.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1808, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3804/4184 (90.9178%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3798/4184 (90.7744%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0083, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4010/4346 (92.2688%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4041/4346 (92.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7833, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4485/5037 (89.0411%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4632/5037 (91.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9642, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4196/4634 (90.5481%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4216/4634 (90.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0027, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4417/4934 (89.5217%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4282/4934 (86.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2895, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4930/5424 (90.8923%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4900/5424 (90.3392%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1689, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3463/3781 (91.5895%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3227/3781 (85.3478%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1863, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3535/3861 (91.5566%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3481/3861 (90.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9636, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4632/5055 (91.6320%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4634/5055 (91.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8756, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4083/4433 (92.1047%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4066/4433 (91.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7876, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4694/5167 (90.8458%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1111, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3328/3590 (92.7019%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3152/3590 (87.7994%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1736, Accuracy: 5341/10000 (53.4100%)
time spent on training: 235.81892228126526
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Max_rate for client 6 = 0.5185185185185185, misclassification from class 11 to 2.
Max_rate for client 6 = 0.574468085106383, misclassification from class 35 to 2.
All misclassifications by client 6 point to class 2. Flagging as suspicious.
Suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1610, Accuracy: 6944/10000 (69.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.7481, Accuracy: 8122/9900 (82.0404%)
Done in 260.14598631858826 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4646/4885 (95.1075%), train_poison_data_count: 385
Global model norm: 43.07325926909293.
Norm before scaling: 43.05616250762267. Distance: 1.4721131474297242
Total norm for 4 adversaries is: 43.05616250762267. distance: 1.4721131474297242
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1496, Accuracy: 9553/9900 (96.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5017/5305 (94.5712%), train_poison_data_count: 415
Global model norm: 43.07325926909293.
Norm before scaling: 43.05466977975502. Distance: 1.570813986189445
Total norm for 4 adversaries is: 43.05466977975502. distance: 1.570813986189445
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1461, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4486/4717 (95.1028%), train_poison_data_count: 370
Global model norm: 43.07325926909293.
Norm before scaling: 43.057804023250974. Distance: 1.452336004851129
Total norm for 4 adversaries is: 43.057804023250974. distance: 1.452336004851129
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0728, Accuracy: 9705/9900 (98.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4781/5066 (94.3743%), train_poison_data_count: 400
Global model norm: 43.07325926909293.
Norm before scaling: 43.06221794401459. Distance: 1.593183828280139
Total norm for 4 adversaries is: 43.06221794401459. distance: 1.593183828280139
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2388, Accuracy: 9310/9900 (94.0404%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3931/4368 (89.9954%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3929/4368 (89.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9799, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3505/3828 (91.5622%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3534/3828 (92.3197%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8253, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4042/4356 (92.7916%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3737/4356 (85.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1231, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3513/3861 (90.9868%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3499/3861 (90.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9261, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3204/3472 (92.2811%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3242/3472 (93.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9126, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4185/4538 (92.2212%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4191/4538 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8748, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4930/5392 (91.4318%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4912/5392 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9543, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3917/4295 (91.1991%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3705/4295 (86.2631%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0278, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3877/4235 (91.5466%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3842/4235 (90.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0796, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4118/4456 (92.4147%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8950, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4721/5265 (89.6676%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4650/5265 (88.3191%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9489, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4123/4441 (92.8395%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4156/4441 (93.5825%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9584, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3707/4013 (92.3748%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3752/4013 (93.4961%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7240, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4087/4465 (91.5342%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4133/4465 (92.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9028, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5689/6263 (90.8351%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5643/6263 (90.1006%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9724, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4517/4986 (90.5937%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4529/4986 (90.8343%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8767, Accuracy: 5669/10000 (56.6900%)
time spent on training: 232.54259729385376
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1591, Accuracy: 6948/10000 (69.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.7266, Accuracy: 8173/9900 (82.5556%)
Done in 256.6216802597046 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4628/4885 (94.7390%), train_poison_data_count: 385
Global model norm: 43.094666358549375.
Norm before scaling: 43.07917203796473. Distance: 1.5007621894988297
Total norm for 4 adversaries is: 43.07917203796473. distance: 1.5007621894988297
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2067, Accuracy: 9387/9900 (94.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5020/5305 (94.6277%), train_poison_data_count: 415
Global model norm: 43.094666358549375.
Norm before scaling: 43.079303801426796. Distance: 1.5862178460748382
Total norm for 4 adversaries is: 43.079303801426796. distance: 1.5862178460748382
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1186, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4469/4717 (94.7424%), train_poison_data_count: 370
Global model norm: 43.094666358549375.
Norm before scaling: 43.07799039922751. Distance: 1.442343802366854
Total norm for 4 adversaries is: 43.07799039922751. distance: 1.442343802366854
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0669, Accuracy: 9720/9900 (98.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4799/5066 (94.7296%), train_poison_data_count: 400
Global model norm: 43.094666358549375.
Norm before scaling: 43.08129578918211. Distance: 1.570286992563357
Total norm for 4 adversaries is: 43.08129578918211. distance: 1.570286992563357
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1129, Accuracy: 9619/9900 (97.1616%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3688/4158 (88.6965%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3686/4158 (88.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0749, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4687/5167 (90.7103%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4691/5167 (90.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1088, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3516/3828 (91.8495%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3506/3828 (91.5883%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9058, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4260/4663 (91.3575%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4267/4663 (91.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9698, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4081/4433 (92.0596%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8786, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3830/4184 (91.5392%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9649, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4240/4716 (89.9067%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4215/4716 (89.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1083, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3890/4223 (92.1146%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3903/4223 (92.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8551, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4303/4679 (91.9641%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4159/4679 (88.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1721, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3326/3704 (89.7948%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8728, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3527/3837 (91.9208%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3595/3837 (93.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0057, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3553/3861 (92.0228%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3495/3861 (90.5206%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0122, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4945/5424 (91.1689%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4920/5424 (90.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1383, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4203/4576 (91.8488%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4228/4576 (92.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7707, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3679/4025 (91.4037%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3759/4025 (93.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8080, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3486/3775 (92.3444%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3562/3775 (94.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7638, Accuracy: 5909/10000 (59.0900%)
time spent on training: 229.75640773773193
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1591, Accuracy: 6940/10000 (69.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.6828, Accuracy: 8272/9900 (83.5556%)
Done in 253.9450442790985 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.11458915322704.
Norm before scaling: 43.10048414343437. Distance: 1.505950093783669
Total norm for 4 adversaries is: 43.10048414343437. distance: 1.505950093783669
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0720, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5008/5305 (94.4015%), train_poison_data_count: 415
Global model norm: 43.11458915322704.
Norm before scaling: 43.099249275201274. Distance: 1.6291960314407548
Total norm for 4 adversaries is: 43.099249275201274. distance: 1.6291960314407548
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0873, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4484/4717 (95.0604%), train_poison_data_count: 370
Global model norm: 43.11458915322704.
Norm before scaling: 43.095418409508746. Distance: 1.3914004531902382
Total norm for 4 adversaries is: 43.095418409508746. distance: 1.3914004531902382
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2722, Accuracy: 9246/9900 (93.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4776/5066 (94.2756%), train_poison_data_count: 400
Global model norm: 43.11458915322704.
Norm before scaling: 43.10170056734276. Distance: 1.593034995265178
Total norm for 4 adversaries is: 43.10170056734276. distance: 1.593034995265178
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0453, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4163/4576 (90.9747%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4215/4576 (92.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9197, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3315/3672 (90.2778%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3342/3672 (91.0131%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9378, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4272/4618 (92.5076%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4081/4618 (88.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1340, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4215/4538 (92.8823%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4244/4538 (93.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8706, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4557/5025 (90.6866%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5025 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2096, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3312/3590 (92.2563%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3337/3590 (92.9526%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0137, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4302/4707 (91.3958%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1429, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4496/4918 (91.4193%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4464/4918 (90.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0274, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3948/4336 (91.0517%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3963/4336 (91.3976%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9871, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5237/5902 (88.7326%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5068/5902 (85.8692%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2052, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4120/4441 (92.7719%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9510, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4691/5232 (89.6598%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4649/5232 (88.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0158, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4337/4804 (90.2789%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4197/4804 (87.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2431, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3635/3969 (91.5848%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3649/3969 (91.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9580, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4946/5392 (91.7285%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4880/5392 (90.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0805, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3534/3828 (92.3197%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3528/3828 (92.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8821, Accuracy: 5663/10000 (56.6300%)
time spent on training: 232.67795848846436
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1703, Accuracy: 6912/10000 (69.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.6024, Accuracy: 8442/9900 (85.2727%)
Done in 257.03274393081665 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4673/4885 (95.6602%), train_poison_data_count: 385
Global model norm: 43.13609883219549.
Norm before scaling: 43.11652147179924. Distance: 1.396223692138138
Total norm for 4 adversaries is: 43.11652147179924. distance: 1.396223692138138
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1018, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5029/5305 (94.7974%), train_poison_data_count: 415
Global model norm: 43.13609883219549.
Norm before scaling: 43.11976021156803. Distance: 1.583135751476142
Total norm for 4 adversaries is: 43.11976021156803. distance: 1.583135751476142
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0825, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4462/4717 (94.5940%), train_poison_data_count: 370
Global model norm: 43.13609883219549.
Norm before scaling: 43.11892931682891. Distance: 1.4405558902605888
Total norm for 4 adversaries is: 43.11892931682891. distance: 1.4405558902605888
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1171, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4798/5066 (94.7098%), train_poison_data_count: 400
Global model norm: 43.13609883219549.
Norm before scaling: 43.120496254862665. Distance: 1.5405367843411208
Total norm for 4 adversaries is: 43.120496254862665. distance: 1.5405367843411208
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0942, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4694/5232 (89.7171%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4630/5232 (88.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1848, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4472/4956 (90.2341%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4442/4956 (89.6287%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3315, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4512/5063 (89.1171%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4495/5063 (88.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1143, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3751/4025 (93.1925%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3768/4025 (93.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8330, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4099/4441 (92.2990%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4099/4441 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1538, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4120/4625 (89.0811%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4066/4625 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0209, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5003/5591 (89.4831%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4785/5591 (85.5840%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2617, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5166/5582 (92.5475%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5080/5582 (91.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1092, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5256/5902 (89.0546%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5137/5902 (87.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2276, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4212/4538 (92.8162%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4205/4538 (92.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8303, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4608/5025 (91.7015%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4646/5025 (92.4577%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9239, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3870/4223 (91.6410%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3894/4223 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8144, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3922/4361 (89.9335%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3592/4361 (82.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2175, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3958/4354 (90.9049%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3559/4354 (81.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5222, Accuracy: 4652/10000 (46.5200%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3325/3672 (90.5501%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3330/3672 (90.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2132, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4001/4356 (91.8503%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3919/4356 (89.9679%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2349, Accuracy: 5026/10000 (50.2600%)
time spent on training: 235.58822083473206
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1700, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.5944, Accuracy: 8469/9900 (85.5455%)
Done in 260.5526192188263 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4650/4885 (95.1894%), train_poison_data_count: 385
Global model norm: 43.15973748128138.
Norm before scaling: 43.142696210692776. Distance: 1.4528916694599205
Total norm for 4 adversaries is: 43.142696210692776. distance: 1.4528916694599205
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0605, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5038/5305 (94.9670%), train_poison_data_count: 415
Global model norm: 43.15973748128138.
Norm before scaling: 43.139678491518254. Distance: 1.5215704799277532
Total norm for 4 adversaries is: 43.139678491518254. distance: 1.5215704799277532
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1236, Accuracy: 9572/9900 (96.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4717 (94.9120%), train_poison_data_count: 370
Global model norm: 43.15973748128138.
Norm before scaling: 43.14084004835934. Distance: 1.3936687120758524
Total norm for 4 adversaries is: 43.14084004835934. distance: 1.3936687120758524
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1472, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.15973748128138.
Norm before scaling: 43.145988155856536. Distance: 1.5580467851442994
Total norm for 4 adversaries is: 43.145988155856536. distance: 1.5580467851442994
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0958, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3551/3828 (92.7638%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3565/3828 (93.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8233, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3920/4235 (92.5620%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3764/4235 (88.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0041, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3377/3704 (91.1717%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3316/3704 (89.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9914, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3714/4046 (91.7944%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3728/4046 (92.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8689, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4501/4928 (91.3352%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4452/4928 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9858, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5212/5740 (90.8014%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5147/5740 (89.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1364, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4590/5083 (90.3010%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4514/5083 (88.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9639, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4185/4576 (91.4554%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4156/4576 (90.8217%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8870, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4230/4647 (91.0265%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4268/4647 (91.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9826, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4992/5424 (92.0354%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4938/5424 (91.0398%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3083, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4083/4503 (90.6729%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4049/4503 (89.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0598, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5648/6391 (88.3743%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5557/6391 (86.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1556, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4099/4511 (90.8668%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4065/4511 (90.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0664, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4129/4456 (92.6616%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4101/4456 (92.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9460, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4356/4804 (90.6744%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4091/4804 (85.1582%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2356, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3460/3804 (90.9569%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3497/3804 (91.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9464, Accuracy: 5516/10000 (55.1600%)
time spent on training: 236.47386240959167
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1728, Accuracy: 6931/10000 (69.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.5582, Accuracy: 8541/9900 (86.2727%)
Done in 260.7395918369293 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4663/4885 (95.4555%), train_poison_data_count: 385
Global model norm: 43.18261267118254.
Norm before scaling: 43.16444357863455. Distance: 1.4450393831106627
Total norm for 4 adversaries is: 43.16444357863455. distance: 1.4450393831106627
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0923, Accuracy: 9657/9900 (97.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5056/5305 (95.3063%), train_poison_data_count: 415
Global model norm: 43.18261267118254.
Norm before scaling: 43.16479283884393. Distance: 1.5852540145363574
Total norm for 4 adversaries is: 43.16479283884393. distance: 1.5852540145363574
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1020, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4475/4717 (94.8696%), train_poison_data_count: 370
Global model norm: 43.18261267118254.
Norm before scaling: 43.16554790996157. Distance: 1.4254623265421185
Total norm for 4 adversaries is: 43.16554790996157. distance: 1.4254623265421185
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0824, Accuracy: 9682/9900 (97.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4831/5066 (95.3612%), train_poison_data_count: 400
Global model norm: 43.18261267118254.
Norm before scaling: 43.16523824756155. Distance: 1.4840934084776032
Total norm for 4 adversaries is: 43.16523824756155. distance: 1.4840934084776032
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0719, Accuracy: 9699/9900 (97.9697%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4517/4928 (91.6599%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4481/4928 (90.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9323, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4511/5037 (89.5573%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4604/5037 (91.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9949, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4972/5392 (92.2107%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4863/5392 (90.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0174, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4089/4501 (90.8465%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4064/4501 (90.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0191, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3449/3804 (90.6677%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3494/3804 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9390, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3532/3837 (92.0511%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3568/3837 (92.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9656, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4531/5063 (89.4924%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4244/5063 (83.8238%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3105, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4063/4481 (90.6717%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3935/4481 (87.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1726, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4169/4518 (92.2753%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4158/4518 (92.0319%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9759, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3277/3638 (90.0770%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3325/3638 (91.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9131, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4271/4663 (91.5934%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4275/4663 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0811, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4137/4625 (89.4486%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4067/4625 (87.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2590, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4674/5197 (89.9365%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4665/5197 (89.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1351, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4628/5083 (91.0486%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4590/5083 (90.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1743, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3557/3828 (92.9206%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3603/3828 (94.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7997, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3333/3704 (89.9838%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3407/3704 (91.9816%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9452, Accuracy: 5655/10000 (56.5500%)
time spent on training: 233.20306634902954
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1746, Accuracy: 6934/10000 (69.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.5340, Accuracy: 8590/9900 (86.7677%)
Done in 257.58549785614014 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4658/4885 (95.3531%), train_poison_data_count: 385
Global model norm: 43.20441199484507.
Norm before scaling: 43.186678888268744. Distance: 1.4886090575922966
Total norm for 4 adversaries is: 43.186678888268744. distance: 1.4886090575922966
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0940, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5066/5305 (95.4948%), train_poison_data_count: 415
Global model norm: 43.20441199484507.
Norm before scaling: 43.18323315798115. Distance: 1.5061965742964507
Total norm for 4 adversaries is: 43.18323315798115. distance: 1.5061965742964507
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0529, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4494/4717 (95.2724%), train_poison_data_count: 370
Global model norm: 43.20441199484507.
Norm before scaling: 43.185698056203314. Distance: 1.4188286141952984
Total norm for 4 adversaries is: 43.185698056203314. distance: 1.4188286141952984
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1235, Accuracy: 9579/9900 (96.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4797/5066 (94.6901%), train_poison_data_count: 400
Global model norm: 43.20441199484507.
Norm before scaling: 43.18768796314017. Distance: 1.528968824568999
Total norm for 4 adversaries is: 43.18768796314017. distance: 1.528968824568999
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0828, Accuracy: 9694/9900 (97.9192%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3553/3861 (92.0228%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3551/3861 (91.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8846, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3845/4184 (91.8977%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3838/4184 (91.7304%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9148, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4523/5037 (89.7955%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4578/5037 (90.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9976, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4671/5197 (89.8788%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4529/5197 (87.1464%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1984, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4525/5025 (90.0498%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4515/5025 (89.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0608, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4646/5116 (90.8131%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4563/5116 (89.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0790, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4051/4481 (90.4039%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0585, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4241/4576 (92.6792%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4200/4576 (91.7832%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0057, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4713/5232 (90.0803%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4728/5232 (90.3670%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0019, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3945/4354 (90.6063%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3758/4354 (86.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2543, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2970/3271 (90.7979%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0055, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0259, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4906/5455 (89.9358%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4849/5455 (88.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0476, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3764/4126 (91.2264%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3812/4126 (92.3897%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0548, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3480/3797 (91.6513%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3541/3797 (93.2578%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8828, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3362/3704 (90.7667%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3393/3704 (91.6037%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7987, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4482/4934 (90.8391%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4280/4934 (86.7450%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3676, Accuracy: 4938/10000 (49.3800%)
time spent on training: 233.69840264320374
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1762, Accuracy: 6944/10000 (69.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.5043, Accuracy: 8654/9900 (87.4141%)
Done in 257.97268986701965 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4684/4885 (95.8854%), train_poison_data_count: 385
Global model norm: 43.22663521704529.
Norm before scaling: 43.20621739610733. Distance: 1.3986188035787304
Total norm for 4 adversaries is: 43.20621739610733. distance: 1.3986188035787304
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1001, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5044/5305 (95.0801%), train_poison_data_count: 415
Global model norm: 43.22663521704529.
Norm before scaling: 43.207563628229494. Distance: 1.5489214066920525
Total norm for 4 adversaries is: 43.207563628229494. distance: 1.5489214066920525
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1874, Accuracy: 9423/9900 (95.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4717 (94.7848%), train_poison_data_count: 370
Global model norm: 43.22663521704529.
Norm before scaling: 43.207533963545494. Distance: 1.4445783245365498
Total norm for 4 adversaries is: 43.207533963545494. distance: 1.4445783245365498
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0889, Accuracy: 9667/9900 (97.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4826/5066 (95.2625%), train_poison_data_count: 400
Global model norm: 43.22663521704529.
Norm before scaling: 43.20849876163687. Distance: 1.5056608195337369
Total norm for 4 adversaries is: 43.20849876163687. distance: 1.5056608195337369
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0672, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4270/4618 (92.4643%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4121/4618 (89.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9971, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4113/4625 (88.9297%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4072/4625 (88.0432%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1698, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5225/5740 (91.0279%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5111/5740 (89.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2407, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4007/4416 (90.7382%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4020/4416 (91.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9955, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3815/4126 (92.4624%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3838/4126 (93.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8275, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3260/3616 (90.1549%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3315/3616 (91.6759%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8217, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3679/4158 (88.4800%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3727/4158 (89.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9610, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4028/4346 (92.6829%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4052/4346 (93.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9518, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4365/4874 (89.5568%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4305/4874 (88.3258%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4772, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4732/5265 (89.8765%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4681/5265 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0142, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3720/4025 (92.4224%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3751/4025 (93.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8840, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4230/4651 (90.9482%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4205/4651 (90.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1290, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3488/3837 (90.9044%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3516/3837 (91.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0330, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3288/3638 (90.3793%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9094, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3230/3472 (93.0300%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3261/3472 (93.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9191, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4143/4456 (92.9758%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4136/4456 (92.8187%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9822, Accuracy: 5575/10000 (55.7500%)
time spent on training: 230.89904141426086
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1765, Accuracy: 6922/10000 (69.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.4906, Accuracy: 8682/9900 (87.6970%)
Done in 255.2213578224182 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4647/4885 (95.1279%), train_poison_data_count: 385
Global model norm: 43.24706739064078.
Norm before scaling: 43.23232229948155. Distance: 1.5017896149009409
Total norm for 4 adversaries is: 43.23232229948155. distance: 1.5017896149009409
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1156, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.24706739064078.
Norm before scaling: 43.22694585158949. Distance: 1.5114565284274801
Total norm for 4 adversaries is: 43.22694585158949. distance: 1.5114565284274801
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0599, Accuracy: 9745/9900 (98.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4488/4717 (95.1452%), train_poison_data_count: 370
Global model norm: 43.24706739064078.
Norm before scaling: 43.22760806050703. Distance: 1.4047978851091718
Total norm for 4 adversaries is: 43.22760806050703. distance: 1.4047978851091718
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0985, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.24706739064078.
Norm before scaling: 43.231366504017515. Distance: 1.5525181649783975
Total norm for 4 adversaries is: 43.231366504017515. distance: 1.5525181649783975
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0656, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4964/5424 (91.5192%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4933/5424 (90.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1222, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4568/4986 (91.6165%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4519/4986 (90.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8889, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4698/5167 (90.9232%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4704/5167 (91.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1134, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4254/4716 (90.2036%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4228/4716 (89.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1060, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3927/4368 (89.9038%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3862/4368 (88.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0798, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4023/4356 (92.3554%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3751/4356 (86.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2986, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4401/4804 (91.6112%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4310/4804 (89.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1645, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4068/4481 (90.7833%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3960/4481 (88.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0505, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3720/4025 (92.4224%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3802/4025 (94.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8139, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4578/5017 (91.2498%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4587/5017 (91.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8592, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3299/3616 (91.2334%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8621, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3804/4184 (90.9178%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3819/4184 (91.2763%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7441, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4670/5195 (89.8941%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4591/5195 (88.3734%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1002, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3977/4361 (91.1947%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3964/4361 (90.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0512, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3521/3756 (93.7433%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3542/3756 (94.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8560, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5025/5591 (89.8766%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4922/5591 (88.0343%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2598, Accuracy: 5159/10000 (51.5900%)
time spent on training: 235.14302349090576
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1797, Accuracy: 6934/10000 (69.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.4617, Accuracy: 8758/9900 (88.4646%)
Done in 259.4250326156616 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4676/4885 (95.7216%), train_poison_data_count: 385
Global model norm: 43.26886668516695.
Norm before scaling: 43.24825711128788. Distance: 1.3930562657770384
Total norm for 4 adversaries is: 43.24825711128788. distance: 1.3930562657770384
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1628, Accuracy: 9468/9900 (95.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5012/5305 (94.4769%), train_poison_data_count: 415
Global model norm: 43.26886668516695.
Norm before scaling: 43.25364502116773. Distance: 1.6252634861880497
Total norm for 4 adversaries is: 43.25364502116773. distance: 1.6252634861880497
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1073, Accuracy: 9616/9900 (97.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4490/4717 (95.1876%), train_poison_data_count: 370
Global model norm: 43.26886668516695.
Norm before scaling: 43.248027072955885. Distance: 1.3794891162953167
Total norm for 4 adversaries is: 43.248027072955885. distance: 1.3794891162953167
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0699, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4801/5066 (94.7690%), train_poison_data_count: 400
Global model norm: 43.26886668516695.
Norm before scaling: 43.25265300750348. Distance: 1.570838877957354
Total norm for 4 adversaries is: 43.25265300750348. distance: 1.570838877957354
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0481, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3818/4175 (91.4491%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3775/4175 (90.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0927, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5008/5455 (91.8057%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5003/5455 (91.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9138, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3390/3704 (91.5227%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3445/3704 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7888, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4469/4989 (89.5771%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4424/4989 (88.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9300, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4508/4928 (91.4773%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4443/4928 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0168, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3481/3804 (91.5089%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3497/3804 (91.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1018, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3950/4336 (91.0978%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3933/4336 (90.7057%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9972, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3711/4046 (91.7202%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3700/4046 (91.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8460, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4366/4793 (91.0912%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4382/4793 (91.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9291, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3483/3756 (92.7316%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3518/3756 (93.6635%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0004, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5710/6391 (89.3444%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5533/6391 (86.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3092, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3332/3672 (90.7407%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3358/3672 (91.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9789, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4155/4558 (91.1584%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4129/4558 (90.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1733, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4204/4576 (91.8706%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4169/4576 (91.1058%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8882, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4132/4456 (92.7289%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4177/4456 (93.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8169, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4055/4356 (93.0900%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3604/4356 (82.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2802, Accuracy: 5054/10000 (50.5400%)
time spent on training: 233.18239736557007
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1823, Accuracy: 6926/10000 (69.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4395, Accuracy: 8797/9900 (88.8586%)
Done in 257.2961857318878 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4672/4885 (95.6397%), train_poison_data_count: 385
Global model norm: 43.290329316195866.
Norm before scaling: 43.26879333379312. Distance: 1.3916591270988732
Total norm for 4 adversaries is: 43.26879333379312. distance: 1.3916591270988732
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0664, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5038/5305 (94.9670%), train_poison_data_count: 415
Global model norm: 43.290329316195866.
Norm before scaling: 43.27253127436186. Distance: 1.5727136577772607
Total norm for 4 adversaries is: 43.27253127436186. distance: 1.5727136577772607
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1077, Accuracy: 9617/9900 (97.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4717 (94.9120%), train_poison_data_count: 370
Global model norm: 43.290329316195866.
Norm before scaling: 43.27260320891918. Distance: 1.4544882173818265
Total norm for 4 adversaries is: 43.27260320891918. distance: 1.4544882173818265
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0511, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4830/5066 (95.3415%), train_poison_data_count: 400
Global model norm: 43.290329316195866.
Norm before scaling: 43.27338319751964. Distance: 1.517280696752594
Total norm for 4 adversaries is: 43.27338319751964. distance: 1.517280696752594
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0507, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4625/5116 (90.4027%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4537/5116 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1584, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5180/5582 (92.7983%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5109/5582 (91.5263%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1718, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4399/4928 (89.2654%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4464/4928 (90.5844%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0570, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3855/4126 (93.4319%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3841/4126 (93.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7764, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3700/4158 (88.9851%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3683/4158 (88.5762%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0144, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4547/5063 (89.8084%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4343/5063 (85.7792%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1041, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5484/6124 (89.5493%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5427/6124 (88.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0817, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3972/4354 (91.2265%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3768/4354 (86.5411%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.6399, Accuracy: 4653/10000 (46.5300%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4574/5025 (91.0249%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4618/5025 (91.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0604, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4334/4679 (92.6266%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4126/4679 (88.1812%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1831, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4399/4793 (91.7797%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4437/4793 (92.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8591, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4175/4518 (92.4081%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9214, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4726/5167 (91.4651%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4694/5167 (90.8458%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1866, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4149/4433 (93.5935%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4053/4433 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8929, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4139/4503 (91.9165%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4083/4503 (90.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0571, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4351/4707 (92.4368%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4288/4707 (91.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9009, Accuracy: 5683/10000 (56.8300%)
time spent on training: 238.658047914505
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1836, Accuracy: 6921/10000 (69.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.4215, Accuracy: 8830/9900 (89.1919%)
Done in 263.00546884536743 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4673/4885 (95.6602%), train_poison_data_count: 385
Global model norm: 43.31366537708899.
Norm before scaling: 43.29451652499208. Distance: 1.4303970660629735
Total norm for 4 adversaries is: 43.29451652499208. distance: 1.4303970660629735
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2282, Accuracy: 9341/9900 (94.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5013/5305 (94.4958%), train_poison_data_count: 415
Global model norm: 43.31366537708899.
Norm before scaling: 43.294719530882894. Distance: 1.5731516361520141
Total norm for 4 adversaries is: 43.294719530882894. distance: 1.5731516361520141
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1145, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4500/4717 (95.3996%), train_poison_data_count: 370
Global model norm: 43.31366537708899.
Norm before scaling: 43.291598210113904. Distance: 1.3627446383712118
Total norm for 4 adversaries is: 43.291598210113904. distance: 1.3627446383712118
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0914, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4837/5066 (95.4797%), train_poison_data_count: 400
Global model norm: 43.31366537708899.
Norm before scaling: 43.29647746569575. Distance: 1.492514609388354
Total norm for 4 adversaries is: 43.29647746569575. distance: 1.492514609388354
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1893, Accuracy: 9415/9900 (95.1010%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3396/3704 (91.6847%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3390/3704 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9479, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4918/5392 (91.2092%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4795/5392 (88.9280%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1890, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4070/4362 (93.3058%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4059/4362 (93.0536%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8971, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4213/4538 (92.8383%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4222/4538 (93.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8665, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3850/4184 (92.0172%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3800/4184 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8271, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3467/3756 (92.3056%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3512/3756 (93.5037%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9208, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4312/4679 (92.1564%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1421, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3231/3472 (93.0588%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0913, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5711/6391 (89.3600%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5596/6391 (87.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0436, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4760/5265 (90.4084%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4463/5265 (84.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2810, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5277/5902 (89.4104%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5124/5902 (86.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2585, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5431/6124 (88.6839%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5355/6124 (87.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0772, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4628/5083 (91.0486%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4592/5083 (90.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9901, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4134/4465 (92.5868%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4147/4465 (92.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8160, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3495/3804 (91.8770%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3513/3804 (92.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8555, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4544/4918 (92.3953%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4500/4918 (91.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0111, Accuracy: 5402/10000 (54.0200%)
time spent on training: 236.72000861167908
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1845, Accuracy: 6923/10000 (69.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.4217, Accuracy: 8828/9900 (89.1717%)
Done in 260.9556620121002 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4689/4885 (95.9877%), train_poison_data_count: 385
Global model norm: 43.336674801056205.
Norm before scaling: 43.3161989424316. Distance: 1.4090489824551473
Total norm for 4 adversaries is: 43.3161989424316. distance: 1.4090489824551473
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1135, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5036/5305 (94.9293%), train_poison_data_count: 415
Global model norm: 43.336674801056205.
Norm before scaling: 43.31806308970601. Distance: 1.5684289216124103
Total norm for 4 adversaries is: 43.31806308970601. distance: 1.5684289216124103
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0432, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4522/4717 (95.8660%), train_poison_data_count: 370
Global model norm: 43.336674801056205.
Norm before scaling: 43.31480254070917. Distance: 1.2954569037809915
Total norm for 4 adversaries is: 43.31480254070917. distance: 1.2954569037809915
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1009, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4838/5066 (95.4994%), train_poison_data_count: 400
Global model norm: 43.336674801056205.
Norm before scaling: 43.31858723458095. Distance: 1.4915896511264122
Total norm for 4 adversaries is: 43.31858723458095. distance: 1.4915896511264122
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1158, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4230/4538 (93.2129%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4241/4538 (93.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8597, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4468/4989 (89.5570%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4499/4989 (90.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9923, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4405/4793 (91.9049%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4408/4793 (91.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0218, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3704/4158 (89.0813%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3697/4158 (88.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9784, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3581/3861 (92.7480%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3511/3861 (90.9350%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1656, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4728/5232 (90.3670%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4640/5232 (88.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2634, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4268/4663 (91.5291%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4345/4663 (93.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8924, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4755/5197 (91.4951%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4667/5197 (89.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1022, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4762/5167 (92.1618%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4669/5167 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1170, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4026/4416 (91.1685%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4023/4416 (91.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8881, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4014/4354 (92.1911%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3652/4354 (83.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3332, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5035/5455 (92.3006%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4940/5455 (90.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9911, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4142/4456 (92.9533%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4129/4456 (92.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9601, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2978/3271 (91.0425%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2990/3271 (91.4094%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9038, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3079/3297 (93.3879%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3081/3297 (93.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.6905, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5073/5591 (90.7351%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4896/5591 (87.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3130, Accuracy: 4932/10000 (49.3200%)
time spent on training: 233.28399848937988
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1872, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3922, Accuracy: 8890/9900 (89.7980%)
Done in 257.57593870162964 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4668/4885 (95.5578%), train_poison_data_count: 385
Global model norm: 43.358350213114946.
Norm before scaling: 43.338671859156285. Distance: 1.4414937476089698
Total norm for 4 adversaries is: 43.338671859156285. distance: 1.4414937476089698
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0521, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5069/5305 (95.5514%), train_poison_data_count: 415
Global model norm: 43.358350213114946.
Norm before scaling: 43.33591003582148. Distance: 1.4879830930323592
Total norm for 4 adversaries is: 43.33591003582148. distance: 1.4879830930323592
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1346, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4525/4717 (95.9296%), train_poison_data_count: 370
Global model norm: 43.358350213114946.
Norm before scaling: 43.3374127937542. Distance: 1.3888166864489209
Total norm for 4 adversaries is: 43.3374127937542. distance: 1.3888166864489209
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0391, Accuracy: 9792/9900 (98.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4801/5066 (94.7690%), train_poison_data_count: 400
Global model norm: 43.358350213114946.
Norm before scaling: 43.34493284254804. Distance: 1.610113918704908
Total norm for 4 adversaries is: 43.34493284254804. distance: 1.610113918704908
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0643, Accuracy: 9737/9900 (98.3535%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4690/5167 (90.7683%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4742/5167 (91.7747%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1447, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3481/3775 (92.2119%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3561/3775 (94.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8786, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4714/5195 (90.7411%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4669/5195 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2128, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3795/4126 (91.9777%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3823/4126 (92.6563%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8539, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3612/3911 (92.3549%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3439/3911 (87.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1282, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4111/4433 (92.7363%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4109/4433 (92.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8311, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2961/3271 (90.5228%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2931/3271 (89.6056%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9551, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3356/3590 (93.4819%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3271/3590 (91.1142%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1176, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4509/4918 (91.6836%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4570/4918 (92.9240%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0653, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4549/4986 (91.2355%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4541/4986 (91.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0527, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3275/3616 (90.5697%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3332/3616 (92.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9186, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3928/4295 (91.4552%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3928/4295 (91.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9855, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4037/4356 (92.6768%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3842/4356 (88.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2314, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4443/4793 (92.6977%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4430/4793 (92.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8571, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4003/4315 (92.7694%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3951/4315 (91.5643%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8492, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4382/4804 (91.2157%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4363/4804 (90.8201%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0659, Accuracy: 5468/10000 (54.6800%)
time spent on training: 230.42644619941711
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1882, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3711, Accuracy: 8934/9900 (90.2424%)
Done in 255.5172507762909 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4697/4885 (96.1515%), train_poison_data_count: 385
Global model norm: 43.37818285782468.
Norm before scaling: 43.35402557091008. Distance: 1.3425771340884562
Total norm for 4 adversaries is: 43.35402557091008. distance: 1.3425771340884562
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1112, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5058/5305 (95.3440%), train_poison_data_count: 415
Global model norm: 43.37818285782468.
Norm before scaling: 43.35616260622589. Distance: 1.5020075714997343
Total norm for 4 adversaries is: 43.35616260622589. distance: 1.5020075714997343
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0319, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4503/4717 (95.4632%), train_poison_data_count: 370
Global model norm: 43.37818285782468.
Norm before scaling: 43.354981477856875. Distance: 1.353257676242866
Total norm for 4 adversaries is: 43.354981477856875. distance: 1.353257676242866
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0296, Accuracy: 9818/9900 (99.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4818/5066 (95.1046%), train_poison_data_count: 400
Global model norm: 43.37818285782468.
Norm before scaling: 43.35940033783044. Distance: 1.5051895017226873
Total norm for 4 adversaries is: 43.35940033783044. distance: 1.5051895017226873
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0920, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4162/4503 (92.4273%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4084/4503 (90.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9921, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4432/4934 (89.8257%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4287/4934 (86.8869%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.5234, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4401/4804 (91.6112%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4167/4804 (86.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3650, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4105/4456 (92.1230%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4141/4456 (92.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8160, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4257/4651 (91.5287%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4256/4651 (91.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9925, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3864/4184 (92.3518%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9323, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4362/4928 (88.5146%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4426/4928 (89.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9542, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3485/3775 (92.3179%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3574/3775 (94.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9818, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4585/5083 (90.2026%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4550/5083 (89.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0654, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4998/5455 (91.6224%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4928/5455 (90.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0579, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3341/3638 (91.8362%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3391/3638 (93.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8606, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3572/3911 (91.3321%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3493/3911 (89.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0510, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3553/3837 (92.5984%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3592/3837 (93.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8046, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4141/4501 (92.0018%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4072/4501 (90.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0553, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4783/5197 (92.0339%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4723/5197 (90.8794%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1758, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3561/3861 (92.2300%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3506/3861 (90.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8671, Accuracy: 5697/10000 (56.9700%)
time spent on training: 232.17253017425537
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1992, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.3386, Accuracy: 9012/9900 (91.0303%)
Done in 256.373174905777 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4696/4885 (96.1310%), train_poison_data_count: 385
Global model norm: 43.399266559362786.
Norm before scaling: 43.37709801076989. Distance: 1.3762655502951453
Total norm for 4 adversaries is: 43.37709801076989. distance: 1.3762655502951453
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1037, Accuracy: 9619/9900 (97.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5067/5305 (95.5137%), train_poison_data_count: 415
Global model norm: 43.399266559362786.
Norm before scaling: 43.375965294554256. Distance: 1.4952668377352865
Total norm for 4 adversaries is: 43.375965294554256. distance: 1.4952668377352865
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0519, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4535/4717 (96.1416%), train_poison_data_count: 370
Global model norm: 43.399266559362786.
Norm before scaling: 43.374815662882796. Distance: 1.2712331309741884
Total norm for 4 adversaries is: 43.374815662882796. distance: 1.2712331309741884
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0884, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4831/5066 (95.3612%), train_poison_data_count: 400
Global model norm: 43.399266559362786.
Norm before scaling: 43.384447987135175. Distance: 1.5229618992939546
Total norm for 4 adversaries is: 43.384447987135175. distance: 1.5229618992939546
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0580, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2988/3271 (91.3482%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2986/3271 (91.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0106, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4072/4511 (90.2682%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4047/4511 (89.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1856, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3321/3638 (91.2864%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3375/3638 (92.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9293, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5198/5582 (93.1207%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5095/5582 (91.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9749, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4120/4456 (92.4596%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4148/4456 (93.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9737, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5332/5902 (90.3423%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5066/5902 (85.8353%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2423, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4015/4416 (90.9194%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4045/4416 (91.5987%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8264, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4479/4934 (90.7783%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4336/4934 (87.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2365, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4235/4596 (92.1453%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4287/4596 (93.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0229, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3550/3837 (92.5202%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3554/3837 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9594, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5748/6391 (89.9390%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5522/6391 (86.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1794, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3973/4368 (90.9570%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3904/4368 (89.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2095, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3516/3804 (92.4290%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3494/3804 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8562, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5724/6263 (91.3939%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5637/6263 (90.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2740, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4440/4793 (92.6351%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0731, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4947/5424 (91.2058%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4951/5424 (91.2795%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.4629, Accuracy: 4887/10000 (48.8700%)
time spent on training: 237.430006980896
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2012, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.3270, Accuracy: 9025/9900 (91.1616%)
Done in 261.8597800731659 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4713/4885 (96.4790%), train_poison_data_count: 385
Global model norm: 43.42147158187914.
Norm before scaling: 43.39913576733484. Distance: 1.3681114780250971
Total norm for 4 adversaries is: 43.39913576733484. distance: 1.3681114780250971
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0811, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5061/5305 (95.4006%), train_poison_data_count: 415
Global model norm: 43.42147158187914.
Norm before scaling: 43.40075868567492. Distance: 1.517698069659708
Total norm for 4 adversaries is: 43.40075868567492. distance: 1.517698069659708
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2038, Accuracy: 9413/9900 (95.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4530/4717 (96.0356%), train_poison_data_count: 370
Global model norm: 43.42147158187914.
Norm before scaling: 43.398225837692664. Distance: 1.321635018427169
Total norm for 4 adversaries is: 43.398225837692664. distance: 1.321635018427169
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0619, Accuracy: 9739/9900 (98.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4832/5066 (95.3810%), train_poison_data_count: 400
Global model norm: 43.42147158187914.
Norm before scaling: 43.40165731192618. Distance: 1.4914511416569531
Total norm for 4 adversaries is: 43.40165731192618. distance: 1.4914511416569531
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1184, Accuracy: 9555/9900 (96.5152%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4658/5055 (92.1464%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4655/5055 (92.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9628, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3868/4184 (92.4474%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8961, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3586/3861 (92.8775%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3558/3861 (92.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9489, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4360/4804 (90.7577%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0134, Accuracy: 3618/4804 (75.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.5687, Accuracy: 4366/10000 (43.6600%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3211/3472 (92.4827%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3224/3472 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9915, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3623/3969 (91.2824%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3617/3969 (91.1313%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8332, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4514/4989 (90.4791%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4475/4989 (89.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9583, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5173/5582 (92.6729%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5102/5582 (91.4009%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0537, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4432/4793 (92.4682%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4457/4793 (92.9898%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0219, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4244/4662 (91.0339%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4263/4662 (91.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0265, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4461/4934 (90.4135%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4272/4934 (86.5829%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1692, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4599/4986 (92.2383%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4578/4986 (91.8171%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0341, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4127/4433 (93.0972%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4059/4433 (91.5633%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8347, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4243/4716 (89.9703%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4266/4716 (90.4580%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9854, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4230/4596 (92.0366%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4233/4596 (92.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1792, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3991/4354 (91.6628%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3624/4354 (83.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4104, Accuracy: 4856/10000 (48.5600%)
time spent on training: 233.18109107017517
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2038, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3136, Accuracy: 9057/9900 (91.4848%)
Done in 257.4792070388794 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4707/4885 (96.3562%), train_poison_data_count: 385
Global model norm: 43.44378326858171.
Norm before scaling: 43.42151375119611. Distance: 1.3613895966102227
Total norm for 4 adversaries is: 43.42151375119611. distance: 1.3613895966102227
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0238, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5048/5305 (95.1555%), train_poison_data_count: 415
Global model norm: 43.44378326858171.
Norm before scaling: 43.42077297090213. Distance: 1.507526588015687
Total norm for 4 adversaries is: 43.42077297090213. distance: 1.507526588015687
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0326, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4510/4717 (95.6116%), train_poison_data_count: 370
Global model norm: 43.44378326858171.
Norm before scaling: 43.422437248968706. Distance: 1.3716815872972257
Total norm for 4 adversaries is: 43.422437248968706. distance: 1.3716815872972257
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1093, Accuracy: 9608/9900 (97.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4843/5066 (95.5981%), train_poison_data_count: 400
Global model norm: 43.44378326858171.
Norm before scaling: 43.4258513495094. Distance: 1.5033700755098853
Total norm for 4 adversaries is: 43.4258513495094. distance: 1.5033700755098853
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0889, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4698/5116 (91.8296%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4601/5116 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0053, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4309/4662 (92.4281%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4301/4662 (92.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9789, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5332/5902 (90.3423%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5151/5902 (87.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3859, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4587/5063 (90.5985%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4578/5063 (90.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9678, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3995/4354 (91.7547%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0207, Accuracy: 2831/4354 (65.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.7767, Accuracy: 3972/10000 (39.7200%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4703/5195 (90.5294%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4625/5195 (89.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0028, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4048/4356 (92.9293%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3718/4356 (85.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4536, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3975/4295 (92.5495%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3960/4295 (92.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0544, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5766/6263 (92.0645%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5662/6263 (90.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9532, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4115/4511 (91.2215%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4089/4511 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0249, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4314/4663 (92.5155%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4328/4663 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9401, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3976/4336 (91.6974%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4010/4336 (92.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9929, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4390/4928 (89.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1235, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3777/4046 (93.3515%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3789/4046 (93.6480%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9580, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3368/3672 (91.7211%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3359/3672 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.7890, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4017/4356 (92.2176%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4044/4356 (92.8375%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0943, Accuracy: 5427/10000 (54.2700%)
time spent on training: 232.83566117286682
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2045, Accuracy: 6894/10000 (68.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2959, Accuracy: 9098/9900 (91.8990%)
Done in 256.95592403411865 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4714/4885 (96.4995%), train_poison_data_count: 385
Global model norm: 43.46687406088687.
Norm before scaling: 43.44236427350467. Distance: 1.3125560839341668
Total norm for 4 adversaries is: 43.44236427350467. distance: 1.3125560839341668
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0768, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5057/5305 (95.3252%), train_poison_data_count: 415
Global model norm: 43.46687406088687.
Norm before scaling: 43.44747524849689. Distance: 1.559248172594412
Total norm for 4 adversaries is: 43.44747524849689. distance: 1.559248172594412
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0371, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4493/4717 (95.2512%), train_poison_data_count: 370
Global model norm: 43.46687406088687.
Norm before scaling: 43.44544807005462. Distance: 1.383388937939465
Total norm for 4 adversaries is: 43.44544807005462. distance: 1.383388937939465
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1327, Accuracy: 9548/9900 (96.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4832/5066 (95.3810%), train_poison_data_count: 400
Global model norm: 43.46687406088687.
Norm before scaling: 43.44749070133035. Distance: 1.5172456551434768
Total norm for 4 adversaries is: 43.44749070133035. distance: 1.5172456551434768
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0450, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4547/5037 (90.2720%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/5037 (92.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9532, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4242/4647 (91.2847%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4253/4647 (91.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0208, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4348/4663 (93.2447%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4271/4663 (91.5934%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1262, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3997/4336 (92.1817%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3955/4336 (91.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0198, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3510/3756 (93.4505%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3540/3756 (94.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8663, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4156/4625 (89.8595%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4078/4625 (88.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1553, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4061/4362 (93.0995%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4114/4362 (94.3145%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1598, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4430/4874 (90.8904%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4437/4874 (91.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1886, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4299/4767 (90.1825%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4278/4767 (89.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1850, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3502/3775 (92.7682%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3562/3775 (94.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7786, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4338/4662 (93.0502%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4187/4662 (89.8112%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0097, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5521/6124 (90.1535%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5467/6124 (89.2717%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9018, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4105/4511 (90.9998%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4122/4511 (91.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9878, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3647/3911 (93.2498%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3571/3911 (91.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8006, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5057/5591 (90.4489%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4940/5591 (88.3563%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1348, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3805/4126 (92.2201%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3840/4126 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7820, Accuracy: 5828/10000 (58.2800%)
time spent on training: 234.08809971809387
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2029, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2915, Accuracy: 9117/9900 (92.0909%)
Done in 258.3543338775635 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4698/4885 (96.1720%), train_poison_data_count: 385
Global model norm: 43.487518975455764.
Norm before scaling: 43.46531258874713. Distance: 1.3998367299515846
Total norm for 4 adversaries is: 43.46531258874713. distance: 1.3998367299515846
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0163, Accuracy: 9859/9900 (99.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5071/5305 (95.5891%), train_poison_data_count: 415
Global model norm: 43.487518975455764.
Norm before scaling: 43.467560697695156. Distance: 1.558599868800646
Total norm for 4 adversaries is: 43.467560697695156. distance: 1.558599868800646
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0118, Accuracy: 9869/9900 (99.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4527/4717 (95.9720%), train_poison_data_count: 370
Global model norm: 43.487518975455764.
Norm before scaling: 43.46494608401048. Distance: 1.3406430187659462
Total norm for 4 adversaries is: 43.46494608401048. distance: 1.3406430187659462
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0196, Accuracy: 9840/9900 (99.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4839/5066 (95.5191%), train_poison_data_count: 400
Global model norm: 43.487518975455764.
Norm before scaling: 43.46897184972144. Distance: 1.4871907882509794
Total norm for 4 adversaries is: 43.46897184972144. distance: 1.4871907882509794
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0414, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4638/5025 (92.2985%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4585/5025 (91.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1663, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4683/5116 (91.5364%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4624/5116 (90.3831%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0444, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4724/5167 (91.4264%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4737/5167 (91.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0835, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4177/4558 (91.6411%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4091/4558 (89.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1439, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4276/4651 (91.9372%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4235/4651 (91.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0828, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4028/4336 (92.8967%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3971/4336 (91.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1054, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4647/5055 (91.9288%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4647/5055 (91.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8817, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3542/3775 (93.8278%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3574/3775 (94.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7944, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4774/5265 (90.6743%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4674/5265 (88.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0173, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3722/4025 (92.4720%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8994, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4548/4989 (91.1606%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4455/4989 (89.2965%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9796, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4445/4793 (92.7394%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4453/4793 (92.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8920, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3509/3804 (92.2450%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3536/3804 (92.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8591, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3521/3797 (92.7311%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3527/3797 (92.8891%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9535, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4118/4433 (92.8942%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4115/4433 (92.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8501, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4359/4707 (92.6068%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4331/4707 (92.0119%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8390, Accuracy: 5765/10000 (57.6500%)
time spent on training: 233.47259378433228
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2085, Accuracy: 6872/10000 (68.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2752, Accuracy: 9163/9900 (92.5556%)
Done in 257.4536998271942 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.50811481422173.
Norm before scaling: 43.48343316667783. Distance: 1.303286914234592
Total norm for 4 adversaries is: 43.48343316667783. distance: 1.303286914234592
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0697, Accuracy: 9715/9900 (98.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5077/5305 (95.7022%), train_poison_data_count: 415
Global model norm: 43.50811481422173.
Norm before scaling: 43.483400882908754. Distance: 1.4610295394219368
Total norm for 4 adversaries is: 43.483400882908754. distance: 1.4610295394219368
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0455, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4535/4717 (96.1416%), train_poison_data_count: 370
Global model norm: 43.50811481422173.
Norm before scaling: 43.483370002759386. Distance: 1.313799940951226
Total norm for 4 adversaries is: 43.483370002759386. distance: 1.313799940951226
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1655, Accuracy: 9466/9900 (95.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4843/5066 (95.5981%), train_poison_data_count: 400
Global model norm: 43.50811481422173.
Norm before scaling: 43.487340729354074. Distance: 1.4455039232663274
Total norm for 4 adversaries is: 43.487340729354074. distance: 1.4455039232663274
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0687, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4951/5392 (91.8212%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4892/5392 (90.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0828, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4295/4663 (92.1081%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4337/4663 (93.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9798, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3527/3797 (92.8891%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3450/3797 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0622, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5174/5582 (92.6908%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5091/5582 (91.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0225, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4728/5167 (91.5038%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4714/5167 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2105, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3499/3781 (92.5417%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3349/3781 (88.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1375, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3684/3969 (92.8193%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3676/3969 (92.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9467, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3542/3837 (92.3117%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3594/3837 (93.6669%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9820, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5353/5902 (90.6981%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5164/5902 (87.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1368, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5006/5455 (91.7690%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4887/5455 (89.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1102, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4540/5037 (90.1330%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4511/5037 (89.5573%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0104, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4600/5017 (91.6883%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4597/5017 (91.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9571, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4549/4986 (91.2355%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4495/4986 (90.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9470, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4758/5197 (91.5528%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4679/5197 (90.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0397, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3982/4361 (91.3093%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3774/4361 (86.5398%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2512, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5779/6263 (92.2721%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5710/6263 (91.1704%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2159, Accuracy: 5194/10000 (51.9400%)
time spent on training: 238.84657454490662
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2028, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.2766, Accuracy: 9146/9900 (92.3838%)
Done in 263.2031240463257 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4724/4885 (96.7042%), train_poison_data_count: 385
Global model norm: 43.53109156243601.
Norm before scaling: 43.50377419420785. Distance: 1.2888945499018147
Total norm for 4 adversaries is: 43.50377419420785. distance: 1.2888945499018147
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0983, Accuracy: 9632/9900 (97.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5096/5305 (96.0603%), train_poison_data_count: 415
Global model norm: 43.53109156243601.
Norm before scaling: 43.508673143085794. Distance: 1.4990470561300968
Total norm for 4 adversaries is: 43.508673143085794. distance: 1.4990470561300968
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0425, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4524/4717 (95.9084%), train_poison_data_count: 370
Global model norm: 43.53109156243601.
Norm before scaling: 43.50637384831891. Distance: 1.3068758035855261
Total norm for 4 adversaries is: 43.50637384831891. distance: 1.3068758035855261
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0428, Accuracy: 9793/9900 (98.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4858/5066 (95.8942%), train_poison_data_count: 400
Global model norm: 43.53109156243601.
Norm before scaling: 43.50803625481159. Distance: 1.4214913825365283
Total norm for 4 adversaries is: 43.50803625481159. distance: 1.4214913825365283
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0748, Accuracy: 9692/9900 (97.8990%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4624/5017 (92.1666%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4635/5017 (92.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7837, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4447/4928 (90.2394%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9594, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3904/4184 (93.3078%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3826/4184 (91.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9277, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4460/4793 (93.0524%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4414/4793 (92.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0100, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5265/5740 (91.7247%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5193/5740 (90.4704%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1311, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3526/3756 (93.8765%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3557/3756 (94.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8531, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3956/4235 (93.4120%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3861/4235 (91.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9250, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3878/4223 (91.8305%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3882/4223 (91.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8152, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4527/5063 (89.4134%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4321/5063 (85.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2435, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4537/4989 (90.9401%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4483/4989 (89.8577%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9749, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4530/4928 (91.9237%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4496/4928 (91.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9648, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5312/5902 (90.0034%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5098/5902 (86.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1507, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4172/4456 (93.6266%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4185/4456 (93.9183%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8710, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5507/6124 (89.9249%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5414/6124 (88.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9834, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3576/3828 (93.4169%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3615/3828 (94.4357%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8055, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3349/3616 (92.6162%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3328/3616 (92.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8683, Accuracy: 5725/10000 (57.2500%)
time spent on training: 236.84438729286194
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2056, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2550, Accuracy: 9203/9900 (92.9596%)
Done in 261.1276173591614 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4712/4885 (96.4585%), train_poison_data_count: 385
Global model norm: 43.55301356088204.
Norm before scaling: 43.5281274117847. Distance: 1.3445128116529246
Total norm for 4 adversaries is: 43.5281274117847. distance: 1.3445128116529246
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1098, Accuracy: 9610/9900 (97.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5066/5305 (95.4948%), train_poison_data_count: 415
Global model norm: 43.55301356088204.
Norm before scaling: 43.53097939390047. Distance: 1.5140007203275512
Total norm for 4 adversaries is: 43.53097939390047. distance: 1.5140007203275512
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1075, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4555/4717 (96.5656%), train_poison_data_count: 370
Global model norm: 43.55301356088204.
Norm before scaling: 43.52925757060919. Distance: 1.2964352701007318
Total norm for 4 adversaries is: 43.52925757060919. distance: 1.2964352701007318
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0497, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4866/5066 (96.0521%), train_poison_data_count: 400
Global model norm: 43.55301356088204.
Norm before scaling: 43.529866105514984. Distance: 1.436214618695263
Total norm for 4 adversaries is: 43.529866105514984. distance: 1.436214618695263
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0567, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3851/4223 (91.1911%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0032, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4087/4362 (93.6956%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3975/4362 (91.1279%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0716, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5744/6391 (89.8764%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5543/6391 (86.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1878, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4407/4793 (91.9466%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4380/4793 (91.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1035, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3513/3756 (93.5304%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3563/3756 (94.8616%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9323, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4286/4618 (92.8107%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4181/4618 (90.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0288, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3720/4025 (92.4224%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3748/4025 (93.1180%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9182, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3303/3638 (90.7916%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8279, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4034/4315 (93.4878%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4035/4315 (93.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8580, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3968/4295 (92.3865%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3629/4295 (84.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1719, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4518/4928 (91.6802%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4462/4928 (90.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9350, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4561/4986 (91.4761%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4527/4986 (90.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9391, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3832/4126 (92.8745%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3797/4126 (92.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8642, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4547/4918 (92.4563%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4513/4918 (91.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2387, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4724/5195 (90.9336%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4591/5195 (88.3734%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2117, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5233/5740 (91.1672%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5202/5740 (90.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2006, Accuracy: 5239/10000 (52.3900%)
time spent on training: 235.79175543785095
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2062, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2535, Accuracy: 9210/9900 (93.0303%)
Done in 260.05867075920105 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4706/4885 (96.3357%), train_poison_data_count: 385
Global model norm: 43.57452813230598.
Norm before scaling: 43.54934594487686. Distance: 1.363479774688797
Total norm for 4 adversaries is: 43.54934594487686. distance: 1.363479774688797
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0374, Accuracy: 9800/9900 (98.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5078/5305 (95.7210%), train_poison_data_count: 415
Global model norm: 43.57452813230598.
Norm before scaling: 43.55137109010605. Distance: 1.4799828046366834
Total norm for 4 adversaries is: 43.55137109010605. distance: 1.4799828046366834
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0966, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4531/4717 (96.0568%), train_poison_data_count: 370
Global model norm: 43.57452813230598.
Norm before scaling: 43.550312980990014. Distance: 1.3008172199213308
Total norm for 4 adversaries is: 43.550312980990014. distance: 1.3008172199213308
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1035, Accuracy: 9649/9900 (97.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4837/5066 (95.4797%), train_poison_data_count: 400
Global model norm: 43.57452813230598.
Norm before scaling: 43.55316210893877. Distance: 1.4737025422017314
Total norm for 4 adversaries is: 43.55316210893877. distance: 1.4737025422017314
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0989, Accuracy: 9643/9900 (97.4040%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3070/3297 (93.1150%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3072/3297 (93.1756%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7804, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3583/3828 (93.5998%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8525, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4571/5063 (90.2824%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4330/5063 (85.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9552, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4108/4501 (91.2686%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4049/4501 (89.9578%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1020, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4425/4793 (92.3221%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4401/4793 (91.8214%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0619, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3895/4223 (92.2330%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3934/4223 (93.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8897, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3547/3756 (94.4356%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3585/3756 (95.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7160, Accuracy: 5997/10000 (59.9700%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3331/3638 (91.5613%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3399/3638 (93.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7709, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3345/3646 (91.7444%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3361/3646 (92.1832%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9588, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4446/4874 (91.2187%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4357/4874 (89.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2577, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5764/6263 (92.0326%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5685/6263 (90.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1641, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4539/5037 (90.1132%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4559/5037 (90.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0817, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4100/4362 (93.9936%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4049/4362 (92.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9273, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4039/4356 (92.7227%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3867/4356 (88.7741%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1300, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4678/5116 (91.4386%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4593/5116 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9908, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4071/4346 (93.6723%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4069/4346 (93.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8645, Accuracy: 5743/10000 (57.4300%)
time spent on training: 232.5278284549713
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2041, Accuracy: 6879/10000 (68.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2419, Accuracy: 9248/9900 (93.4141%)
Done in 256.7651722431183 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4715/4885 (96.5200%), train_poison_data_count: 385
Global model norm: 43.59455784421735.
Norm before scaling: 43.56855790913041. Distance: 1.3083400651228083
Total norm for 4 adversaries is: 43.56855790913041. distance: 1.3083400651228083
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1307, Accuracy: 9573/9900 (96.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5074/5305 (95.6456%), train_poison_data_count: 415
Global model norm: 43.59455784421735.
Norm before scaling: 43.569441867534145. Distance: 1.4634806483390015
Total norm for 4 adversaries is: 43.569441867534145. distance: 1.4634806483390015
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0962, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4549/4717 (96.4384%), train_poison_data_count: 370
Global model norm: 43.59455784421735.
Norm before scaling: 43.56876664260549. Distance: 1.278704090953681
Total norm for 4 adversaries is: 43.56876664260549. distance: 1.278704090953681
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0806, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4848/5066 (95.6968%), train_poison_data_count: 400
Global model norm: 43.59455784421735.
Norm before scaling: 43.57219169002031. Distance: 1.460176075677797
Total norm for 4 adversaries is: 43.57219169002031. distance: 1.460176075677797
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1370, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4171/4518 (92.3196%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4176/4518 (92.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8710, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4162/4558 (91.3120%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4081/4558 (89.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1397, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3535/3804 (92.9285%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3532/3804 (92.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9387, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3513/3775 (93.0596%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3583/3775 (94.9139%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7085, Accuracy: 6061/10000 (60.6100%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4651/5083 (91.5011%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4579/5083 (90.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0816, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4586/4928 (93.0601%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4537/4928 (92.0657%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8690, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4693/5244 (89.4928%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4604/5244 (87.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2375, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4503/4989 (90.2586%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4477/4989 (89.7374%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0122, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4599/4986 (92.2383%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4534/4986 (90.9346%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9868, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3845/4175 (92.0958%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3820/4175 (91.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0347, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4770/5232 (91.1697%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4683/5232 (89.5069%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0902, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4584/5063 (90.5392%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4406/5063 (87.0235%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2273, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4150/4441 (93.4474%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4122/4441 (92.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9171, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3339/3646 (91.5798%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3403/3646 (93.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8169, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4744/5167 (91.8134%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4741/5167 (91.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1684, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4225/4538 (93.1027%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4170/4538 (91.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8514, Accuracy: 5668/10000 (56.6800%)
time spent on training: 235.42550897598267
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2078, Accuracy: 6884/10000 (68.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2363, Accuracy: 9255/9900 (93.4848%)
Done in 260.39077377319336 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4722/4885 (96.6633%), train_poison_data_count: 385
Global model norm: 43.615870004058586.
Norm before scaling: 43.5907313022935. Distance: 1.326193493314339
Total norm for 4 adversaries is: 43.5907313022935. distance: 1.326193493314339
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0837, Accuracy: 9677/9900 (97.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5084/5305 (95.8341%), train_poison_data_count: 415
Global model norm: 43.615870004058586.
Norm before scaling: 43.590227232216286. Distance: 1.4437437049100956
Total norm for 4 adversaries is: 43.590227232216286. distance: 1.4437437049100956
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0520, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4499/4717 (95.3784%), train_poison_data_count: 370
Global model norm: 43.615870004058586.
Norm before scaling: 43.59304434912753. Distance: 1.38342112277953
Total norm for 4 adversaries is: 43.59304434912753. distance: 1.38342112277953
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0202, Accuracy: 9843/9900 (99.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4857/5066 (95.8745%), train_poison_data_count: 400
Global model norm: 43.615870004058586.
Norm before scaling: 43.591918644328445. Distance: 1.3973884270474486
Total norm for 4 adversaries is: 43.591918644328445. distance: 1.3973884270474486
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0487, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4084/4356 (93.7557%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3877/4356 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3305, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4470/4928 (90.7062%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4392/4928 (89.1234%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1215, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4601/5037 (91.3441%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4579/5037 (90.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9382, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4380/4804 (91.1740%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4151/4804 (86.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3259, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3543/3775 (93.8543%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3598/3775 (95.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7178, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4759/5167 (92.1037%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4724/5167 (91.4264%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1091, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3919/4235 (92.5384%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3946/4235 (93.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9753, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4510/4956 (91.0008%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4352/4956 (87.8128%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1692, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5253/5740 (91.5157%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5205/5740 (90.6794%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1366, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4358/4679 (93.1396%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4309/4679 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0560, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3431/3704 (92.6296%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3439/3704 (92.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7646, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3243/3472 (93.4044%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3229/3472 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9868, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4292/4651 (92.2812%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4243/4651 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0399, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4216/4634 (90.9797%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4196/4634 (90.5481%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8701, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5342/5902 (90.5117%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5097/5902 (86.3606%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2735, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3546/3837 (92.4159%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3615/3837 (94.2142%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7803, Accuracy: 5870/10000 (58.7000%)
time spent on training: 235.01663851737976
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2076, Accuracy: 6881/10000 (68.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2286, Accuracy: 9280/9900 (93.7374%)
Done in 259.40701627731323 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.637090630688675.
Norm before scaling: 43.61006219227465. Distance: 1.305556550375016
Total norm for 4 adversaries is: 43.61006219227465. distance: 1.305556550375016
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0773, Accuracy: 9695/9900 (97.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5067/5305 (95.5137%), train_poison_data_count: 415
Global model norm: 43.637090630688675.
Norm before scaling: 43.612861234262795. Distance: 1.4892855081953407
Total norm for 4 adversaries is: 43.612861234262795. distance: 1.4892855081953407
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0673, Accuracy: 9718/9900 (98.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4532/4717 (96.0780%), train_poison_data_count: 370
Global model norm: 43.637090630688675.
Norm before scaling: 43.612265053376184. Distance: 1.3325635008862986
Total norm for 4 adversaries is: 43.612265053376184. distance: 1.3325635008862986
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0207, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4858/5066 (95.8942%), train_poison_data_count: 400
Global model norm: 43.637090630688675.
Norm before scaling: 43.616475931191985. Distance: 1.4749997866355613
Total norm for 4 adversaries is: 43.616475931191985. distance: 1.4749997866355613
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0873, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3671/3969 (92.4918%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3687/3969 (92.8949%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8539, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4329/4707 (91.9694%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4289/4707 (91.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9146, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3608/3861 (93.4473%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3593/3861 (93.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7861, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4233/4596 (92.1018%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4228/4596 (91.9930%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9926, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4173/4503 (92.6716%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4083/4503 (90.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1796, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4602/4928 (93.3847%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4552/4928 (92.3701%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0279, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4618/5025 (91.9005%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4536/5025 (90.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2992, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4234/4576 (92.5262%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4216/4576 (92.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0327, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4506/4918 (91.6226%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4528/4918 (92.0699%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9123, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4062/4315 (94.1367%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4005/4315 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9761, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3343/3590 (93.1198%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0052, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4148/4456 (93.0880%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4174/4456 (93.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8670, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4017/4354 (92.2600%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3779/4354 (86.7938%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4514, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4089/4501 (90.8465%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4013/4501 (89.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0944, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3622/3911 (92.6106%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3522/3911 (90.0537%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0623, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4206/4558 (92.2773%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4152/4558 (91.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1010, Accuracy: 5277/10000 (52.7700%)
time spent on training: 232.140554189682
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2109, Accuracy: 6882/10000 (68.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2173, Accuracy: 9315/9900 (94.0909%)
Done in 256.30885648727417 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.65704829934037.
Norm before scaling: 43.62971326840015. Distance: 1.2746730029831166
Total norm for 4 adversaries is: 43.62971326840015. distance: 1.2746730029831166
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1152, Accuracy: 9603/9900 (97.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5078/5305 (95.7210%), train_poison_data_count: 415
Global model norm: 43.65704829934037.
Norm before scaling: 43.63129543580216. Distance: 1.4702376278695783
Total norm for 4 adversaries is: 43.63129543580216. distance: 1.4702376278695783
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1139, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4557/4717 (96.6080%), train_poison_data_count: 370
Global model norm: 43.65704829934037.
Norm before scaling: 43.6305903921635. Distance: 1.2564006961756213
Total norm for 4 adversaries is: 43.6305903921635. distance: 1.2564006961756213
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0947, Accuracy: 9662/9900 (97.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4833/5066 (95.4007%), train_poison_data_count: 400
Global model norm: 43.65704829934037.
Norm before scaling: 43.636258396830954. Distance: 1.4860904618885546
Total norm for 4 adversaries is: 43.636258396830954. distance: 1.4860904618885546
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0405, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4702/5116 (91.9077%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4591/5116 (89.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3121, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5001/5392 (92.7485%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4833/5392 (89.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0485, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4319/4767 (90.6021%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4256/4767 (89.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1641, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4300/4618 (93.1139%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4208/4618 (91.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9253, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3781/4046 (93.4503%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3790/4046 (93.6728%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9173, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4190/4625 (90.5946%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4162/4625 (89.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9582, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3331/3638 (91.5613%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3418/3638 (93.9527%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8128, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4034/4416 (91.3496%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4007/4416 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9824, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4448/4874 (91.2597%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4292/4874 (88.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1853, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3373/3646 (92.5123%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3340/3646 (91.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8064, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4584/5063 (90.5392%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4367/5063 (86.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4010, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3821/4126 (92.6079%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3842/4126 (93.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8516, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4484/4934 (90.8796%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4361/4934 (88.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2256, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4161/4511 (92.2412%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4119/4511 (91.3101%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9787, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4184/4518 (92.6073%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4216/4518 (93.3156%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8750, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3073/3297 (93.2059%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3078/3297 (93.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7082, Accuracy: 5953/10000 (59.5300%)
time spent on training: 229.41764116287231
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2105, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2113, Accuracy: 9332/9900 (94.2626%)
Done in 253.59113907814026 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4718/4885 (96.5814%), train_poison_data_count: 385
Global model norm: 43.67776402601786.
Norm before scaling: 43.651922711895665. Distance: 1.3342442182644705
Total norm for 4 adversaries is: 43.651922711895665. distance: 1.3342442182644705
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0268, Accuracy: 9838/9900 (99.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5070/5305 (95.5702%), train_poison_data_count: 415
Global model norm: 43.67776402601786.
Norm before scaling: 43.65376693010009. Distance: 1.501722141953058
Total norm for 4 adversaries is: 43.65376693010009. distance: 1.501722141953058
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0621, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4538/4717 (96.2052%), train_poison_data_count: 370
Global model norm: 43.67776402601786.
Norm before scaling: 43.6532062624521. Distance: 1.3008256967643386
Total norm for 4 adversaries is: 43.6532062624521. distance: 1.3008256967643386
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0795, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.67776402601786.
Norm before scaling: 43.65156756161155. Distance: 1.3946502378333687
Total norm for 4 adversaries is: 43.65156756161155. distance: 1.3946502378333687
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1056, Accuracy: 9611/9900 (97.0808%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5559/6124 (90.7740%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5466/6124 (89.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0811, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4591/5025 (91.3632%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4582/5025 (91.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1586, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3239/3472 (93.2892%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9980, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4633/5037 (91.9794%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0267, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5221/5582 (93.5328%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5161/5582 (92.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1353, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4715/5116 (92.1618%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4620/5116 (90.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0502, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4150/4518 (91.8548%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4169/4518 (92.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0352, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4472/4928 (90.7468%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4480/4928 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9087, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4168/4558 (91.4436%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4042/4558 (88.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1595, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3059/3297 (92.7813%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3069/3297 (93.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8650, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3529/3756 (93.9563%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3544/3756 (94.3557%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9646, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4316/4651 (92.7972%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4255/4651 (91.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1408, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4109/4441 (92.5242%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4169/4441 (93.8753%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8956, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3308/3638 (90.9291%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8499, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4254/4596 (92.5587%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4236/4596 (92.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9954, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3002/3271 (91.7762%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2972/3271 (90.8591%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8610, Accuracy: 5702/10000 (57.0200%)
time spent on training: 233.27997183799744
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2108, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2008, Accuracy: 9360/9900 (94.5455%)
Done in 257.4435250759125 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4726/4885 (96.7451%), train_poison_data_count: 385
Global model norm: 43.69743633650391.
Norm before scaling: 43.671385842519925. Distance: 1.318920326984809
Total norm for 4 adversaries is: 43.671385842519925. distance: 1.318920326984809
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0757, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5098/5305 (96.0980%), train_poison_data_count: 415
Global model norm: 43.69743633650391.
Norm before scaling: 43.66962762553769. Distance: 1.4212713112822786
Total norm for 4 adversaries is: 43.66962762553769. distance: 1.4212713112822786
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0279, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4522/4717 (95.8660%), train_poison_data_count: 370
Global model norm: 43.69743633650391.
Norm before scaling: 43.671550759082564. Distance: 1.3201842838308315
Total norm for 4 adversaries is: 43.671550759082564. distance: 1.3201842838308315
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0844, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4878/5066 (96.2890%), train_poison_data_count: 400
Global model norm: 43.69743633650391.
Norm before scaling: 43.67122092533451. Distance: 1.3560461304196967
Total norm for 4 adversaries is: 43.67122092533451. distance: 1.3560461304196967
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0795, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4605/4989 (92.3031%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4550/4989 (91.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9513, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4172/4465 (93.4378%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4154/4465 (93.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8896, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4031/4315 (93.4183%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4017/4315 (93.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8631, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4344/4767 (91.1265%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4244/4767 (89.0287%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3434, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5741/6391 (89.8294%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5631/6391 (88.1083%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2023, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3397/3672 (92.5109%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3336/3672 (90.8497%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9066, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3693/3969 (93.0461%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3618/3969 (91.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8900, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3358/3590 (93.5376%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3197/3590 (89.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2183, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5388/5902 (91.2911%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5100/5902 (86.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2139, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3767/4013 (93.8699%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3790/4013 (94.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7828, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4390/4804 (91.3822%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4062/4804 (84.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.5474, Accuracy: 4589/10000 (45.8900%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3836/4175 (91.8802%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3748/4175 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9783, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3325/3616 (91.9524%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3352/3616 (92.6991%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7846, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3995/4361 (91.6074%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3806/4361 (87.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1380, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4963/5424 (91.5007%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4958/5424 (91.4086%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2881, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3578/3837 (93.2499%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3621/3837 (94.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8602, Accuracy: 5780/10000 (57.8000%)
time spent on training: 233.54528260231018
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2151, Accuracy: 6851/10000 (68.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2000, Accuracy: 9358/9900 (94.5253%)
Done in 257.7683913707733 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4742/4885 (97.0727%), train_poison_data_count: 385
Global model norm: 43.71844425598951.
Norm before scaling: 43.690173939092126. Distance: 1.273480935321355
Total norm for 4 adversaries is: 43.690173939092126. distance: 1.273480935321355
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1183, Accuracy: 9583/9900 (96.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5103/5305 (96.1923%), train_poison_data_count: 415
Global model norm: 43.71844425598951.
Norm before scaling: 43.69251524771577. Distance: 1.4390008803438485
Total norm for 4 adversaries is: 43.69251524771577. distance: 1.4390008803438485
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1150, Accuracy: 9601/9900 (96.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.71844425598951.
Norm before scaling: 43.69216741206669. Distance: 1.2560246716250825
Total norm for 4 adversaries is: 43.69216741206669. distance: 1.2560246716250825
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1311, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4844/5066 (95.6178%), train_poison_data_count: 400
Global model norm: 43.71844425598951.
Norm before scaling: 43.69542913559438. Distance: 1.4446703334797608
Total norm for 4 adversaries is: 43.69542913559438. distance: 1.4446703334797608
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0427, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3973/4416 (89.9683%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3984/4416 (90.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0121, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5242/5740 (91.3240%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5210/5740 (90.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1142, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4591/5037 (91.1455%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4596/5037 (91.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9257, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4729/5116 (92.4355%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4615/5116 (90.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0401, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4524/4918 (91.9886%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4490/4918 (91.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0143, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3564/3837 (92.8851%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3590/3837 (93.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8869, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4303/4651 (92.5177%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4280/4651 (92.0232%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0331, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3614/3861 (93.6027%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3566/3861 (92.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8924, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3916/4223 (92.7303%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3981/4223 (94.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8574, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4317/4662 (92.5997%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4309/4662 (92.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9575, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5818/6263 (92.8948%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5705/6263 (91.0905%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0273, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3509/3781 (92.8061%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3293/3781 (87.0934%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1365, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3530/3804 (92.7971%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3516/3804 (92.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9882, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3605/3828 (94.1745%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3582/3828 (93.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7498, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4043/4315 (93.6964%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4023/4315 (93.2329%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8712, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4491/4956 (90.6174%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4426/4956 (89.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0340, Accuracy: 5459/10000 (54.5900%)
time spent on training: 233.06581926345825
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2185, Accuracy: 6853/10000 (68.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1945, Accuracy: 9372/9900 (94.6667%)
Done in 257.43713760375977 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4717/4885 (96.5609%), train_poison_data_count: 385
Global model norm: 43.73888251601771.
Norm before scaling: 43.711815088375275. Distance: 1.3070627850583432
Total norm for 4 adversaries is: 43.711815088375275. distance: 1.3070627850583432
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0908, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5127/5305 (96.6447%), train_poison_data_count: 415
Global model norm: 43.73888251601771.
Norm before scaling: 43.709016797613536. Distance: 1.3652634951824394
Total norm for 4 adversaries is: 43.709016797613536. distance: 1.3652634951824394
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0979, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4549/4717 (96.4384%), train_poison_data_count: 370
Global model norm: 43.73888251601771.
Norm before scaling: 43.712298208266716. Distance: 1.2537395330811771
Total norm for 4 adversaries is: 43.712298208266716. distance: 1.2537395330811771
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0568, Accuracy: 9736/9900 (98.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4886/5066 (96.4469%), train_poison_data_count: 400
Global model norm: 43.73888251601771.
Norm before scaling: 43.71282321111206. Distance: 1.3920812375736913
Total norm for 4 adversaries is: 43.71282321111206. distance: 1.3920812375736913
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0597, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4307/4662 (92.3852%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4278/4662 (91.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1285, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3330/3616 (92.0907%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3309/3616 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8809, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3607/3828 (94.2268%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3638/3828 (95.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8208, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3067/3297 (93.0240%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3093/3297 (93.8126%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7463, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4012/4361 (91.9972%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3821/4361 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1528, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4237/4576 (92.5918%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4225/4576 (92.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9533, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3951/4295 (91.9907%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3831/4295 (89.1967%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0862, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4647/5083 (91.4224%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4589/5083 (90.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1576, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4730/5116 (92.4550%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4667/5116 (91.2236%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0158, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3790/4046 (93.6728%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3763/4046 (93.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8304, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5311/5902 (89.9864%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5073/5902 (85.9539%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1844, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4831/5197 (92.9575%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4698/5197 (90.3983%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0418, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4207/4465 (94.2217%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4191/4465 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7966, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3427/3704 (92.5216%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3426/3704 (92.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8581, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3605/3861 (93.3696%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3583/3861 (92.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8732, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3826/4126 (92.7290%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3885/4126 (94.1590%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7513, Accuracy: 5921/10000 (59.2100%)
time spent on training: 231.64813137054443
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2284, Accuracy: 6829/10000 (68.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1732, Accuracy: 9433/9900 (95.2828%)
Done in 255.86916971206665 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4729/4885 (96.8066%), train_poison_data_count: 385
Global model norm: 43.75847434667298.
Norm before scaling: 43.73257046786254. Distance: 1.3119687413004222
Total norm for 4 adversaries is: 43.73257046786254. distance: 1.3119687413004222
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0579, Accuracy: 9745/9900 (98.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5102/5305 (96.1734%), train_poison_data_count: 415
Global model norm: 43.75847434667298.
Norm before scaling: 43.72867225681281. Distance: 1.4109075769100807
Total norm for 4 adversaries is: 43.72867225681281. distance: 1.4109075769100807
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0139, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4552/4717 (96.5020%), train_poison_data_count: 370
Global model norm: 43.75847434667298.
Norm before scaling: 43.730462992686085. Distance: 1.2486150698845981
Total norm for 4 adversaries is: 43.730462992686085. distance: 1.2486150698845981
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0912, Accuracy: 9651/9900 (97.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4872/5066 (96.1705%), train_poison_data_count: 400
Global model norm: 43.75847434667298.
Norm before scaling: 43.73487880426145. Distance: 1.4148240541449002
Total norm for 4 adversaries is: 43.73487880426145. distance: 1.4148240541449002
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0422, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4164/4511 (92.3077%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4106/4511 (91.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9192, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5267/5740 (91.7596%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0923, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4368/4662 (93.6937%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4337/4662 (93.0287%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9331, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3944/4235 (93.1287%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3899/4235 (92.0661%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0063, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4861/5265 (92.3267%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4786/5265 (90.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0535, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4158/4433 (93.7965%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4081/4433 (92.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9792, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4266/4596 (92.8198%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4276/4596 (93.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9129, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4697/5055 (92.9179%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4636/5055 (91.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9404, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4614/5037 (91.6021%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4563/5037 (90.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1323, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4259/4538 (93.8519%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4285/4538 (94.4249%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7733, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3552/3756 (94.5687%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3534/3756 (94.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8469, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3783/4025 (93.9876%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3781/4025 (93.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9029, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4702/5244 (89.6644%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4547/5244 (86.7086%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1664, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4357/4663 (93.4377%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4359/4663 (93.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0155, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3578/3837 (93.2499%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3610/3837 (94.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7930, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4089/4481 (91.2520%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3990/4481 (89.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1689, Accuracy: 5339/10000 (53.3900%)
time spent on training: 235.31602001190186
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2333, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1679, Accuracy: 9444/9900 (95.3939%)
Done in 259.583349943161 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4727/4885 (96.7656%), train_poison_data_count: 385
Global model norm: 43.77854398088106.
Norm before scaling: 43.751549916742235. Distance: 1.3154115172945833
Total norm for 4 adversaries is: 43.751549916742235. distance: 1.3154115172945833
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0475, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5100/5305 (96.1357%), train_poison_data_count: 415
Global model norm: 43.77854398088106.
Norm before scaling: 43.74918805050129. Distance: 1.3914839417123486
Total norm for 4 adversaries is: 43.74918805050129. distance: 1.3914839417123486
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0995, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4542/4717 (96.2900%), train_poison_data_count: 370
Global model norm: 43.77854398088106.
Norm before scaling: 43.75136019090935. Distance: 1.2710298584282886
Total norm for 4 adversaries is: 43.75136019090935. distance: 1.2710298584282886
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0353, Accuracy: 9810/9900 (99.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4864/5066 (96.0126%), train_poison_data_count: 400
Global model norm: 43.77854398088106.
Norm before scaling: 43.75425900028547. Distance: 1.4250744047315551
Total norm for 4 adversaries is: 43.75425900028547. distance: 1.4250744047315551
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0824, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4114/4362 (94.3145%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3966/4362 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1708, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5094/5591 (91.1107%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4983/5591 (89.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0952, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4046/4315 (93.7659%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4005/4315 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9150, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3518/3781 (93.0442%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3464/3781 (91.6160%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9892, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3780/4158 (90.9091%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3739/4158 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8990, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4147/4511 (91.9308%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4097/4511 (90.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8568, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4441/4793 (92.6560%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4386/4793 (91.5084%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0495, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5008/5424 (92.3304%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4986/5424 (91.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3159, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4271/4618 (92.4859%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4202/4618 (90.9918%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1575, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3996/4368 (91.4835%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3894/4368 (89.1484%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9919, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4934 (90.7175%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3875/4934 (78.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4787, Accuracy: 4618/10000 (46.1800%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4814/5232 (92.0107%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5232 (89.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0710, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5392/5902 (91.3589%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5137/5902 (87.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2969, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4962/5392 (92.0252%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4888/5392 (90.6528%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1104, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4652/5017 (92.7247%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4582/5017 (91.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8991, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4732/5195 (91.0876%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4603/5195 (88.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1462, Accuracy: 5395/10000 (53.9500%)
time spent on training: 238.60126447677612
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2350, Accuracy: 6810/10000 (68.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1638, Accuracy: 9464/9900 (95.5960%)
Done in 262.8989701271057 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.801500101398496.
Norm before scaling: 43.77184861809371. Distance: 1.2719107058150327
Total norm for 4 adversaries is: 43.77184861809371. distance: 1.2719107058150327
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0769, Accuracy: 9685/9900 (97.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5107/5305 (96.2677%), train_poison_data_count: 415
Global model norm: 43.801500101398496.
Norm before scaling: 43.773945734823954. Distance: 1.4299642159579686
Total norm for 4 adversaries is: 43.773945734823954. distance: 1.4299642159579686
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0915, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4544/4717 (96.3324%), train_poison_data_count: 370
Global model norm: 43.801500101398496.
Norm before scaling: 43.77376168338817. Distance: 1.2649580057433727
Total norm for 4 adversaries is: 43.77376168338817. distance: 1.2649580057433727
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1326, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4891/5066 (96.5456%), train_poison_data_count: 400
Global model norm: 43.801500101398496.
Norm before scaling: 43.77367244604984. Distance: 1.3453623834415547
Total norm for 4 adversaries is: 43.77367244604984. distance: 1.3453623834415547
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0441, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4900/5265 (93.0674%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4771/5265 (90.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9789, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3846/4126 (93.2138%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3855/4126 (93.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7705, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4188/4501 (93.0460%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4053/4501 (90.0467%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3561, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5553/6124 (90.6760%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5381/6124 (87.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0020, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3014/3271 (92.1431%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2920/3271 (89.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0812, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4326/4663 (92.7729%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8896, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3762/4025 (93.4658%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3788/4025 (94.1118%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8926, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4297/4651 (92.3887%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4283/4651 (92.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0544, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4414/4804 (91.8818%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4195/4804 (87.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2509, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3348/3616 (92.5885%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3377/3616 (93.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.6664, Accuracy: 6087/10000 (60.8700%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3678/3911 (94.0424%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3508/3911 (89.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3073, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4796/5197 (92.2840%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4727/5197 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0998, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4283/4538 (94.3808%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4293/4538 (94.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8023, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5779/6391 (90.4240%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5629/6391 (88.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2098, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3434/3704 (92.7106%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3433/3704 (92.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7689, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3912/4235 (92.3731%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3787/4235 (89.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1612, Accuracy: 5269/10000 (52.6900%)
time spent on training: 234.64048051834106
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2349, Accuracy: 6806/10000 (68.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1615, Accuracy: 9472/9900 (95.6768%)
Done in 258.8003251552582 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.82203333334443.
Norm before scaling: 43.792482164643566. Distance: 1.2560338304057654
Total norm for 4 adversaries is: 43.792482164643566. distance: 1.2560338304057654
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0785, Accuracy: 9685/9900 (97.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5106/5305 (96.2488%), train_poison_data_count: 415
Global model norm: 43.82203333334443.
Norm before scaling: 43.79364591868965. Distance: 1.415633788092074
Total norm for 4 adversaries is: 43.79364591868965. distance: 1.415633788092074
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0570, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4532/4717 (96.0780%), train_poison_data_count: 370
Global model norm: 43.82203333334443.
Norm before scaling: 43.7946187097192. Distance: 1.2896857402282051
Total norm for 4 adversaries is: 43.7946187097192. distance: 1.2896857402282051
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0780, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4860/5066 (95.9337%), train_poison_data_count: 400
Global model norm: 43.82203333334443.
Norm before scaling: 43.79549949900318. Distance: 1.378578384799758
Total norm for 4 adversaries is: 43.79549949900318. distance: 1.378578384799758
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0759, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4750/5116 (92.8460%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4680/5116 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0236, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5252/5582 (94.0881%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5171/5582 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0901, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4003/4235 (94.5218%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3710/4235 (87.6033%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1468, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4233/4625 (91.5243%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4071/4625 (88.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3227, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4103/4481 (91.5644%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3927/4481 (87.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0895, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4849/5232 (92.6797%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4743/5232 (90.6537%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9935, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4379/4662 (93.9296%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4340/4662 (93.0931%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9617, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4204/4441 (94.6634%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4170/4441 (93.8978%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8920, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4174/4518 (92.3860%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4185/4518 (92.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9556, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4600/4928 (93.3442%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4554/4928 (92.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9061, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4232/4634 (91.3250%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4254/4634 (91.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0420, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4546/4934 (92.1362%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4351/4934 (88.1840%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3094, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3617/3861 (93.6804%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3593/3861 (93.0588%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9321, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3331/3616 (92.1184%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3376/3616 (93.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8273, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4037/4416 (91.4176%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4016/4416 (90.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0156, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3563/3797 (93.8372%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3538/3797 (93.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8966, Accuracy: 5751/10000 (57.5100%)
time spent on training: 233.20726251602173
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2359, Accuracy: 6806/10000 (68.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1648, Accuracy: 9464/9900 (95.5960%)
Done in 257.59664702415466 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4736/4885 (96.9498%), train_poison_data_count: 385
Global model norm: 43.84231053855824.
Norm before scaling: 43.81467178773781. Distance: 1.3130746219345475
Total norm for 4 adversaries is: 43.81467178773781. distance: 1.3130746219345475
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0425, Accuracy: 9784/9900 (98.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5113/5305 (96.3808%), train_poison_data_count: 415
Global model norm: 43.84231053855824.
Norm before scaling: 43.812229737932476. Distance: 1.3890127630093676
Total norm for 4 adversaries is: 43.812229737932476. distance: 1.3890127630093676
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1018, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.84231053855824.
Norm before scaling: 43.81335256838091. Distance: 1.21641884897086
Total norm for 4 adversaries is: 43.81335256838091. distance: 1.21641884897086
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1000, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4903/5066 (96.7825%), train_poison_data_count: 400
Global model norm: 43.84231053855824.
Norm before scaling: 43.81417865231029. Distance: 1.3454935162521637
Total norm for 4 adversaries is: 43.81417865231029. distance: 1.3454935162521637
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1770, Accuracy: 9420/9900 (95.1515%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5807/6263 (92.7191%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5726/6263 (91.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0965, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3988/4295 (92.8522%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3896/4295 (90.7101%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8916, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4513/4989 (90.4590%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0578, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3926/4223 (92.9671%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3890/4223 (92.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8741, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5593/6124 (91.3292%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5473/6124 (89.3697%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1087, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4139/4481 (92.3678%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3960/4481 (88.3731%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3675, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4325/4618 (93.6553%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4146/4618 (89.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0968, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4226/4441 (95.1587%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4188/4441 (94.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9275, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3746/4013 (93.3466%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3775/4013 (94.0693%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7750, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4133/4511 (91.6205%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4164/4511 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8607, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3998/4416 (90.5344%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4009/4416 (90.7835%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9324, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4497/4956 (90.7385%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4390/4956 (88.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2156, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4248/4538 (93.6095%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4261/4538 (93.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8131, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4773/5265 (90.6553%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4747/5265 (90.1614%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0287, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4824/5197 (92.8228%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4604/5197 (88.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2340, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4328/4716 (91.7727%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4312/4716 (91.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0350, Accuracy: 5406/10000 (54.0600%)
time spent on training: 238.82892489433289
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2319, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1707, Accuracy: 9435/9900 (95.3030%)
Done in 263.0222294330597 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4719/4885 (96.6018%), train_poison_data_count: 385
Global model norm: 43.86392393804033.
Norm before scaling: 43.835411883099006. Distance: 1.3067077254555894
Total norm for 4 adversaries is: 43.835411883099006. distance: 1.3067077254555894
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0774, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5099/5305 (96.1169%), train_poison_data_count: 415
Global model norm: 43.86392393804033.
Norm before scaling: 43.83713281987301. Distance: 1.4438497203390301
Total norm for 4 adversaries is: 43.83713281987301. distance: 1.4438497203390301
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0157, Accuracy: 9863/9900 (99.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4551/4717 (96.4808%), train_poison_data_count: 370
Global model norm: 43.86392393804033.
Norm before scaling: 43.83555390471087. Distance: 1.225474804706784
Total norm for 4 adversaries is: 43.83555390471087. distance: 1.225474804706784
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1039, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4878/5066 (96.2890%), train_poison_data_count: 400
Global model norm: 43.86392393804033.
Norm before scaling: 43.837656327690325. Distance: 1.3741884437502623
Total norm for 4 adversaries is: 43.837656327690325. distance: 1.3741884437502623
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0965, Accuracy: 9640/9900 (97.3737%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3350/3616 (92.6438%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3361/3616 (92.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7937, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4087/4315 (94.7161%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4024/4315 (93.2561%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9738, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5056/5455 (92.6856%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1357, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4409/4804 (91.7777%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4141/4804 (86.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2497, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4091/4362 (93.7873%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3982/4362 (91.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9474, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5813/6263 (92.8149%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5756/6263 (91.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1493, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4267/4538 (94.0282%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4242/4538 (93.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9044, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4286/4634 (92.4903%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4244/4634 (91.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8432, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4754/5116 (92.9242%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4678/5116 (91.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8182, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4270/4716 (90.5428%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4258/4716 (90.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1350, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3781/4046 (93.4503%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3735/4046 (92.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0193, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4166/4518 (92.2089%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4165/4518 (92.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9258, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4612/5063 (91.0922%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4385/5063 (86.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3127, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5295/5740 (92.2474%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5190/5740 (90.4181%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1518, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5231/5582 (93.7119%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5081/5582 (91.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1188, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4167/4433 (93.9995%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4115/4433 (92.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9083, Accuracy: 5611/10000 (56.1100%)
time spent on training: 236.41021347045898
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2316, Accuracy: 6818/10000 (68.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1702, Accuracy: 9443/9900 (95.3838%)
Done in 260.58680057525635 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4736/4885 (96.9498%), train_poison_data_count: 385
Global model norm: 43.88513588183575.
Norm before scaling: 43.85750046092102. Distance: 1.2983129411760084
Total norm for 4 adversaries is: 43.85750046092102. distance: 1.2983129411760084
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0841, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5110/5305 (96.3242%), train_poison_data_count: 415
Global model norm: 43.88513588183575.
Norm before scaling: 43.85639267781765. Distance: 1.3951689814011128
Total norm for 4 adversaries is: 43.85639267781765. distance: 1.3951689814011128
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0345, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4569/4717 (96.8624%), train_poison_data_count: 370
Global model norm: 43.88513588183575.
Norm before scaling: 43.85695492299012. Distance: 1.2114936289916935
Total norm for 4 adversaries is: 43.85695492299012. distance: 1.2114936289916935
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1240, Accuracy: 9561/9900 (96.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.88513588183575.
Norm before scaling: 43.85889628345799. Distance: 1.3918600277380195
Total norm for 4 adversaries is: 43.85889628345799. distance: 1.3918600277380195
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0752, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4766/5197 (91.7068%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4514/5197 (86.8578%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2529, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3771/4025 (93.6894%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3786/4025 (94.0621%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8541, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3999/4481 (89.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2448, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4302/4651 (92.4962%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4283/4651 (92.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9481, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5369/5902 (90.9692%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5184/5902 (87.8346%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0582, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3833/4126 (92.8987%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3826/4126 (92.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8318, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4043/4368 (92.5595%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3959/4368 (90.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0340, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5809/6391 (90.8934%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5622/6391 (87.9675%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.4030, Accuracy: 4881/10000 (48.8100%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3863/4175 (92.5269%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3801/4175 (91.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9651, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4323/4596 (94.0601%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4274/4596 (92.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9665, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4312/4634 (93.0514%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4258/4634 (91.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8951, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3939/4223 (93.2749%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3961/4223 (93.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9437, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3626/3911 (92.7129%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3374/3911 (86.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2790, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4127/4433 (93.0972%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4093/4433 (92.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9498, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3953/4336 (91.1670%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3983/4336 (91.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1569, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3325/3638 (91.3964%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8871, Accuracy: 5720/10000 (57.2000%)
time spent on training: 234.55045223236084
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2403, Accuracy: 6803/10000 (68.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1739, Accuracy: 9439/9900 (95.3434%)
Done in 258.6303141117096 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4755/4885 (97.3388%), train_poison_data_count: 385
Global model norm: 43.9063737209111.
Norm before scaling: 43.87539924809445. Distance: 1.1971041148836379
Total norm for 4 adversaries is: 43.87539924809445. distance: 1.1971041148836379
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1391, Accuracy: 9523/9900 (96.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 43.9063737209111.
Norm before scaling: 43.878423399651254. Distance: 1.4127060512038054
Total norm for 4 adversaries is: 43.878423399651254. distance: 1.4127060512038054
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0632, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4574/4717 (96.9684%), train_poison_data_count: 370
Global model norm: 43.9063737209111.
Norm before scaling: 43.877683378145804. Distance: 1.2156642583867296
Total norm for 4 adversaries is: 43.877683378145804. distance: 1.2156642583867296
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0637, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4895/5066 (96.6246%), train_poison_data_count: 400
Global model norm: 43.9063737209111.
Norm before scaling: 43.87840809858107. Distance: 1.3344617578680478
Total norm for 4 adversaries is: 43.87840809858107. distance: 1.3344617578680478
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1320, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3546/3756 (94.4089%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9129, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5027/5424 (92.6807%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4967/5424 (91.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2426, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4143/4433 (93.4582%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4065/4433 (91.6986%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7833, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4123/4501 (91.6019%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4066/4501 (90.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9958, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3771/4025 (93.6894%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3788/4025 (94.1118%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8204, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3970/4235 (93.7426%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3901/4235 (92.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9236, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5603/6124 (91.4925%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5443/6124 (88.8798%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1095, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4308/4634 (92.9650%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4264/4634 (92.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9168, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4716 (91.6879%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4261/4716 (90.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2334, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4345/4767 (91.1475%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4234/4767 (88.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1541, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3530/3804 (92.7971%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3550/3804 (93.3228%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8836, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3271/3472 (94.2108%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3302/3472 (95.1037%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8834, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5014/5392 (92.9896%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4898/5392 (90.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0804, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5316/5740 (92.6132%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5207/5740 (90.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1246, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4270/4596 (92.9069%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4282/4596 (93.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9494, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3332/3616 (92.1460%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3351/3616 (92.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8943, Accuracy: 5775/10000 (57.7500%)
time spent on training: 233.50827622413635
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2376, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1820, Accuracy: 9415/9900 (95.1010%)
Done in 257.7187485694885 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4738/4885 (96.9908%), train_poison_data_count: 385
Global model norm: 43.926045081744356.
Norm before scaling: 43.89623161947532. Distance: 1.281138205884599
Total norm for 4 adversaries is: 43.89623161947532. distance: 1.281138205884599
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0383, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5106/5305 (96.2488%), train_poison_data_count: 415
Global model norm: 43.926045081744356.
Norm before scaling: 43.89697688996504. Distance: 1.4391330068009829
Total norm for 4 adversaries is: 43.89697688996504. distance: 1.4391330068009829
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0244, Accuracy: 9842/9900 (99.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4575/4717 (96.9896%), train_poison_data_count: 370
Global model norm: 43.926045081744356.
Norm before scaling: 43.89888172159115. Distance: 1.261351115518422
Total norm for 4 adversaries is: 43.89888172159115. distance: 1.261351115518422
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0655, Accuracy: 9732/9900 (98.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4876/5066 (96.2495%), train_poison_data_count: 400
Global model norm: 43.926045081744356.
Norm before scaling: 43.898960971918946. Distance: 1.370577027420218
Total norm for 4 adversaries is: 43.898960971918946. distance: 1.370577027420218
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0802, Accuracy: 9673/9900 (97.7071%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4675/5063 (92.3366%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4501/5063 (88.8999%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0121, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4452/4804 (92.6728%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4212/4804 (87.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0941, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4187/4558 (91.8605%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4095/4558 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2529, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3552/3756 (94.5687%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3584/3756 (95.4207%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7895, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5056/5424 (93.2153%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4968/5424 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1685, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4185/4511 (92.7732%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4131/4511 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9025, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4835/5167 (93.5746%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4763/5167 (92.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2588, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4068/4356 (93.3884%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3983/4356 (91.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1218, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4745/5244 (90.4844%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4642/5244 (88.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1260, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4466/4793 (93.1776%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4442/4793 (92.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1065, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3589/3828 (93.7565%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3600/3828 (94.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7257, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3804/4046 (94.0188%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3800/4046 (93.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9561, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3764/4013 (93.7952%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3765/4013 (93.8201%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8160, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3008/3271 (91.9596%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2986/3271 (91.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9215, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4113/4362 (94.2916%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4048/4362 (92.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8907, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4093/4346 (94.1786%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4143/4346 (95.3290%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7512, Accuracy: 5983/10000 (59.8300%)
time spent on training: 231.02782773971558
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2362, Accuracy: 6792/10000 (67.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1750, Accuracy: 9436/9900 (95.3131%)
Done in 255.38206505775452 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4759/4885 (97.4207%), train_poison_data_count: 385
Global model norm: 43.9448034692741.
Norm before scaling: 43.91503887791103. Distance: 1.256547801461402
Total norm for 4 adversaries is: 43.91503887791103. distance: 1.256547801461402
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0522, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5097/5305 (96.0792%), train_poison_data_count: 415
Global model norm: 43.9448034692741.
Norm before scaling: 43.917204205132556. Distance: 1.4387505937802094
Total norm for 4 adversaries is: 43.917204205132556. distance: 1.4387505937802094
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0348, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.9448034692741.
Norm before scaling: 43.91789075000856. Distance: 1.2771304824530716
Total norm for 4 adversaries is: 43.91789075000856. distance: 1.2771304824530716
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0409, Accuracy: 9800/9900 (98.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4893/5066 (96.5851%), train_poison_data_count: 400
Global model norm: 43.9448034692741.
Norm before scaling: 43.917851836820724. Distance: 1.355715198813709
Total norm for 4 adversaries is: 43.917851836820724. distance: 1.355715198813709
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0942, Accuracy: 9646/9900 (97.4343%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3861/4126 (93.5773%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3850/4126 (93.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8069, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5020/5455 (92.0257%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4991/5455 (91.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0250, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4245/4558 (93.1330%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4070/4558 (89.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3070, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4002/4235 (94.4982%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3951/4235 (93.2940%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8721, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3531/3804 (92.8233%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3563/3804 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7603, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5844/6391 (91.4411%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5565/6391 (87.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.4700, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4010/4336 (92.4815%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3955/4336 (91.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1163, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4342/4663 (93.1160%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4361/4663 (93.5235%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0739, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4171/4511 (92.4629%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4144/4511 (91.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9056, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4194/4503 (93.1379%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4069/4503 (90.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0172, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4604/5063 (90.9342%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4458/5063 (88.0506%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2121, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4053/4315 (93.9282%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4038/4315 (93.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8958, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3424/3638 (94.1176%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7988, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4220/4441 (95.0236%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4201/4441 (94.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9434, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4351/4679 (92.9900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4160/4679 (88.9079%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1163, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4844/5265 (92.0038%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4683/5265 (88.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0226, Accuracy: 5511/10000 (55.1100%)
time spent on training: 234.84257674217224
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2412, Accuracy: 6785/10000 (67.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1740, Accuracy: 9437/9900 (95.3232%)
Done in 259.0075991153717 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4748/4885 (97.1955%), train_poison_data_count: 385
Global model norm: 43.965096241222994.
Norm before scaling: 43.934588274786414. Distance: 1.2718651079922594
Total norm for 4 adversaries is: 43.934588274786414. distance: 1.2718651079922594
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0739, Accuracy: 9725/9900 (98.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5110/5305 (96.3242%), train_poison_data_count: 415
Global model norm: 43.965096241222994.
Norm before scaling: 43.93654843164103. Distance: 1.4292014708141207
Total norm for 4 adversaries is: 43.93654843164103. distance: 1.4292014708141207
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0472, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4587/4717 (97.2440%), train_poison_data_count: 370
Global model norm: 43.965096241222994.
Norm before scaling: 43.935381516762064. Distance: 1.1819603857770118
Total norm for 4 adversaries is: 43.935381516762064. distance: 1.1819603857770118
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0506, Accuracy: 9766/9900 (98.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4883/5066 (96.3877%), train_poison_data_count: 400
Global model norm: 43.965096241222994.
Norm before scaling: 43.93996147977089. Distance: 1.3867349543094827
Total norm for 4 adversaries is: 43.93996147977089. distance: 1.3867349543094827
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0384, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4058/4336 (93.5886%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3995/4336 (92.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1386, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3591/3828 (93.8088%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3595/3828 (93.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8025, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3363/3672 (91.5850%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3287/3672 (89.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9945, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4341/4651 (93.3348%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4250/4651 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9566, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4026/4361 (92.3183%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3906/4361 (89.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9488, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4648/5025 (92.4975%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0797, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5592/6124 (91.3129%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2207, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3433/3704 (92.6836%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3452/3704 (93.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7759, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4544/4934 (92.0957%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4068/4934 (82.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2879, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4680/5017 (93.2828%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4609/5017 (91.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8834, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5202/5582 (93.1924%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5146/5582 (92.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1137, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4791/5167 (92.7231%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4690/5167 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2048, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3642/3861 (94.3279%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3566/3861 (92.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9724, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3391/3646 (93.0060%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3365/3646 (92.2929%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7759, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4213/4558 (92.4309%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3993/4558 (87.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0694, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4783/5116 (93.4910%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4651/5116 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9507, Accuracy: 5592/10000 (55.9200%)
time spent on training: 235.31295037269592
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2501, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1683, Accuracy: 9452/9900 (95.4747%)
Done in 259.5838587284088 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 43.98597354999233.
Norm before scaling: 43.95568280417505. Distance: 1.2787947972599614
Total norm for 4 adversaries is: 43.95568280417505. distance: 1.2787947972599614
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0137, Accuracy: 9855/9900 (99.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5141/5305 (96.9086%), train_poison_data_count: 415
Global model norm: 43.98597354999233.
Norm before scaling: 43.95392901637535. Distance: 1.3537353513423511
Total norm for 4 adversaries is: 43.95392901637535. distance: 1.3537353513423511
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0614, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.98597354999233.
Norm before scaling: 43.95615491245225. Distance: 1.2628828412473019
Total norm for 4 adversaries is: 43.95615491245225. distance: 1.2628828412473019
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0259, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4885/5066 (96.4272%), train_poison_data_count: 400
Global model norm: 43.98597354999233.
Norm before scaling: 43.95956227300694. Distance: 1.3582362963334293
Total norm for 4 adversaries is: 43.95956227300694. distance: 1.3582362963334293
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1239, Accuracy: 9586/9900 (96.8283%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4143/4511 (91.8422%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4182/4511 (92.7067%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8815, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4087/4346 (94.0405%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4108/4346 (94.5237%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7785, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4426/4804 (92.1316%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3947/4804 (82.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4196, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4787/5232 (91.4946%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4641/5232 (88.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0567, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4330/4618 (93.7635%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4249/4618 (92.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9217, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3384/3590 (94.2618%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0175, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5782/6391 (90.4710%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5610/6391 (87.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1565, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4037/4354 (92.7193%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3450/4354 (79.2375%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4768, Accuracy: 4575/10000 (45.7500%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4668/5055 (92.3442%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4642/5055 (91.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0807, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3621/3837 (94.3706%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3611/3837 (94.1100%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8444, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4186/4503 (92.9602%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4111/4503 (91.2947%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9842, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4320/4576 (94.4056%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4254/4576 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9496, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4437/4793 (92.5725%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4419/4793 (92.1970%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0088, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4309/4634 (92.9866%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4281/4634 (92.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9920, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3774/4158 (90.7648%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3710/4158 (89.2256%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2840, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5284/5740 (92.0557%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5175/5740 (90.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1661, Accuracy: 5256/10000 (52.5600%)
time spent on training: 234.93665480613708
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2523, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1725, Accuracy: 9442/9900 (95.3737%)
Done in 259.153911113739 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4737/4885 (96.9703%), train_poison_data_count: 385
Global model norm: 44.00779377662481.
Norm before scaling: 43.97781090007209. Distance: 1.2738467068034842
Total norm for 4 adversaries is: 43.97781090007209. distance: 1.2738467068034842
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0748, Accuracy: 9696/9900 (97.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5112/5305 (96.3619%), train_poison_data_count: 415
Global model norm: 44.00779377662481.
Norm before scaling: 43.97922233362378. Distance: 1.4379024771461237
Total norm for 4 adversaries is: 43.97922233362378. distance: 1.4379024771461237
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0519, Accuracy: 9770/9900 (98.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 44.00779377662481.
Norm before scaling: 43.9788531724872. Distance: 1.2490578438655604
Total norm for 4 adversaries is: 43.9788531724872. distance: 1.2490578438655604
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0752, Accuracy: 9695/9900 (97.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4891/5066 (96.5456%), train_poison_data_count: 400
Global model norm: 44.00779377662481.
Norm before scaling: 43.98019379549233. Distance: 1.3745229066762705
Total norm for 4 adversaries is: 43.98019379549233. distance: 1.3745229066762705
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0711, Accuracy: 9705/9900 (98.0303%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3896/4184 (93.1166%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3828/4184 (91.4914%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9567, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5783/6263 (92.3359%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5748/6263 (91.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1272, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4192/4456 (94.0754%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4178/4456 (93.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8925, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4293/4538 (94.6011%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4226/4538 (93.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9494, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3960/4235 (93.5065%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3751/4235 (88.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1151, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3907/4223 (92.5172%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3919/4223 (92.8013%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9082, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4999/5455 (91.6407%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4876/5455 (89.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0392, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4599/5037 (91.3043%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4626/5037 (91.8404%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0125, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3545/3756 (94.3823%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3564/3756 (94.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8578, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4875/5265 (92.5926%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4739/5265 (90.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1206, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4688/5055 (92.7399%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4610/5055 (91.1968%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1080, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4465/4804 (92.9434%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4026/4804 (83.8052%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4952, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4649/5063 (91.8230%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4473/5063 (88.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1162, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4008/4295 (93.3178%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3897/4295 (90.7334%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9112, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3023/3271 (92.4182%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2972/3271 (90.8591%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9097, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4056/4356 (93.1129%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4020/4356 (92.2865%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1975, Accuracy: 5288/10000 (52.8800%)
time spent on training: 234.7458837032318
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2597, Accuracy: 6768/10000 (67.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1744, Accuracy: 9441/9900 (95.3636%)
Done in 258.87475776672363 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4723/4885 (96.6837%), train_poison_data_count: 385
Global model norm: 44.028269616129876.
Norm before scaling: 43.999452067344684. Distance: 1.3365552934938862
Total norm for 4 adversaries is: 43.999452067344684. distance: 1.3365552934938862
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0249, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5131/5305 (96.7201%), train_poison_data_count: 415
Global model norm: 44.028269616129876.
Norm before scaling: 43.99684270454813. Distance: 1.3634431846652277
Total norm for 4 adversaries is: 43.99684270454813. distance: 1.3634431846652277
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0524, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.028269616129876.
Norm before scaling: 43.99801631270579. Distance: 1.2011774822817547
Total norm for 4 adversaries is: 43.99801631270579. distance: 1.2011774822817547
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0548, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 44.028269616129876.
Norm before scaling: 43.99819110273171. Distance: 1.314264111015521
Total norm for 4 adversaries is: 43.99819110273171. distance: 1.314264111015521
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1641, Accuracy: 9488/9900 (95.8384%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4199/4503 (93.2489%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4103/4503 (91.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0857, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4188/4456 (93.9856%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4127/4456 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0322, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4895/5265 (92.9725%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4821/5265 (91.5670%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9593, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4450/4793 (92.8437%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4435/4793 (92.5308%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1707, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4610/4928 (93.5471%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4515/4928 (91.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9693, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3340/3638 (91.8087%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3337/3638 (91.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9301, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4348/4663 (93.2447%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4349/4663 (93.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9294, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4477/4928 (90.8482%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4470/4928 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1158, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4161/4465 (93.1915%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4165/4465 (93.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9365, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3682/3911 (94.1447%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3509/3911 (89.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1030, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4202/4518 (93.0058%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4177/4518 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3279, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3983/4235 (94.0496%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3970/4235 (93.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0238, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4561/4934 (92.4402%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4046/4934 (82.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3816, Accuracy: 4841/10000 (48.4100%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4312/4647 (92.7910%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4285/4647 (92.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9080, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4346/4651 (93.4423%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4315/4651 (92.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0147, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4628/4989 (92.7641%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4532/4989 (90.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9942, Accuracy: 5625/10000 (56.2500%)
time spent on training: 234.86446976661682
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2693, Accuracy: 6755/10000 (67.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1644, Accuracy: 9462/9900 (95.5758%)
Done in 259.2035562992096 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4727/4885 (96.7656%), train_poison_data_count: 385
Global model norm: 44.04822879482145.
Norm before scaling: 44.01930645546693. Distance: 1.3224469600057702
Total norm for 4 adversaries is: 44.01930645546693. distance: 1.3224469600057702
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0312, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5118/5305 (96.4750%), train_poison_data_count: 415
Global model norm: 44.04822879482145.
Norm before scaling: 44.016233744015544. Distance: 1.3935823177172824
Total norm for 4 adversaries is: 44.016233744015544. distance: 1.3935823177172824
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0622, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4572/4717 (96.9260%), train_poison_data_count: 370
Global model norm: 44.04822879482145.
Norm before scaling: 44.01742902098199. Distance: 1.213094058460279
Total norm for 4 adversaries is: 44.01742902098199. distance: 1.213094058460279
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1152, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4883/5066 (96.3877%), train_poison_data_count: 400
Global model norm: 44.04822879482145.
Norm before scaling: 44.02278240972224. Distance: 1.4023213929330747
Total norm for 4 adversaries is: 44.02278240972224. distance: 1.4023213929330747
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0464, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4285/4538 (94.4249%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4264/4538 (93.9621%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7405, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4109/4362 (94.1999%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3955/4362 (90.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0489, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4690/5244 (89.4355%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4670/5244 (89.0542%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1146, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3817/4046 (94.3401%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3684/4046 (91.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0311, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3754/4013 (93.5460%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3777/4013 (94.1191%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8118, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4181/4465 (93.6394%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4143/4465 (92.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9071, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4773/5232 (91.2271%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4645/5232 (88.7806%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0512, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4598/4928 (93.3036%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4549/4928 (92.3093%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8260, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4679/5063 (92.4156%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4573/5063 (90.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0155, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5424/5902 (91.9011%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5260/5902 (89.1223%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2407, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4185/4456 (93.9183%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4148/4456 (93.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9407, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4274/4596 (92.9939%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4261/4596 (92.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9844, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4175/4441 (94.0104%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4151/4441 (93.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1318, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5355/5740 (93.2927%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5168/5740 (90.0348%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2329, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3277/3472 (94.3836%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3229/3472 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9543, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3626/3861 (93.9135%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3564/3861 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9035, Accuracy: 5678/10000 (56.7800%)
time spent on training: 235.6266851425171
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2734, Accuracy: 6745/10000 (67.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1506, Accuracy: 9492/9900 (95.8788%)
Done in 259.8310606479645 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.06830219998341.
Norm before scaling: 44.03513528591047. Distance: 1.2168398829615963
Total norm for 4 adversaries is: 44.03513528591047. distance: 1.2168398829615963
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0649, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5124/5305 (96.5881%), train_poison_data_count: 415
Global model norm: 44.06830219998341.
Norm before scaling: 44.03742499062232. Distance: 1.386102415850489
Total norm for 4 adversaries is: 44.03742499062232. distance: 1.386102415850489
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0392, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.06830219998341.
Norm before scaling: 44.03659200649926. Distance: 1.1839086031981623
Total norm for 4 adversaries is: 44.03659200649926. distance: 1.1839086031981623
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0561, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 44.06830219998341.
Norm before scaling: 44.03881511040147. Distance: 1.3069826599319259
Total norm for 4 adversaries is: 44.03881511040147. distance: 1.3069826599319259
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0432, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3581/3797 (94.3113%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3469/3797 (91.3616%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0514, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3071/3297 (93.1453%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3094/3297 (93.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8117, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3677/3911 (94.0169%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3465/3911 (88.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1524, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3001/3271 (91.7456%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2967/3271 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9178, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3819/4046 (94.3895%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3826/4046 (94.5625%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9019, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5329/5740 (92.8397%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5234/5740 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2790, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3715/3969 (93.6004%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3642/3969 (91.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8892, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3442/3704 (92.9266%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3427/3704 (92.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8644, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4423/4767 (92.7837%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4315/4767 (90.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0905, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4554/4956 (91.8886%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4412/4956 (89.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1713, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3402/3590 (94.7632%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3043/3590 (84.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2333, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5448/5902 (92.3077%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5186/5902 (87.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1398, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4601/4928 (93.3644%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4554/4928 (92.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9121, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4000/4235 (94.4510%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3991/4235 (94.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8876, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4834/5265 (91.8139%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4674/5265 (88.7749%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0230, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4088/4356 (93.8476%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3764/4356 (86.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3250, Accuracy: 5147/10000 (51.4700%)
time spent on training: 229.56373357772827
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2796, Accuracy: 6733/10000 (67.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1496, Accuracy: 9503/9900 (95.9899%)
Done in 253.8402919769287 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4754/4885 (97.3183%), train_poison_data_count: 385
Global model norm: 44.08823633360505.
Norm before scaling: 44.056612527767896. Distance: 1.2424221177128782
Total norm for 4 adversaries is: 44.056612527767896. distance: 1.2424221177128782
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0223, Accuracy: 9836/9900 (99.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5126/5305 (96.6258%), train_poison_data_count: 415
Global model norm: 44.08823633360505.
Norm before scaling: 44.058155814219006. Distance: 1.39615735046301
Total norm for 4 adversaries is: 44.058155814219006. distance: 1.39615735046301
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0463, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4551/4717 (96.4808%), train_poison_data_count: 370
Global model norm: 44.08823633360505.
Norm before scaling: 44.06018804883199. Distance: 1.293764681894043
Total norm for 4 adversaries is: 44.06018804883199. distance: 1.293764681894043
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0299, Accuracy: 9824/9900 (99.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.08823633360505.
Norm before scaling: 44.05761968762115. Distance: 1.3037260704733837
Total norm for 4 adversaries is: 44.05761968762115. distance: 1.3037260704733837
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0334, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3791/4025 (94.1863%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3864/4025 (96.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7375, Accuracy: 6016/10000 (60.1600%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5427/5902 (91.9519%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5250/5902 (88.9529%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1803, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4496/4793 (93.8035%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4429/4793 (92.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9275, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4865/5265 (92.4027%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4737/5265 (89.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1330, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4010/4295 (93.3644%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3902/4295 (90.8498%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0816, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3453/3704 (93.2235%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3442/3704 (92.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8189, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4733/5116 (92.5137%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4585/5116 (89.6208%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9494, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5311/5740 (92.5261%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5194/5740 (90.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2145, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3588/3797 (94.4957%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3509/3797 (92.4151%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8498, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4354/4716 (92.3240%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4257/4716 (90.2672%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3791, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4165/4433 (93.9544%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4115/4433 (92.8265%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7878, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4114/4416 (93.1612%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4057/4416 (91.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0468, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3922/4223 (92.8724%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3932/4223 (93.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8810, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4639/5083 (91.2650%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4539/5083 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1276, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4300/4576 (93.9685%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4238/4576 (92.6136%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9305, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5019/5392 (93.0823%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4887/5392 (90.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0325, Accuracy: 5613/10000 (56.1300%)
time spent on training: 236.31359338760376
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.2761, Accuracy: 6738/10000 (67.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1470, Accuracy: 9517/9900 (96.1313%)
Done in 260.49277901649475 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.10906366122855.
Norm before scaling: 44.07629022900592. Distance: 1.2193813156050406
Total norm for 4 adversaries is: 44.07629022900592. distance: 1.2193813156050406
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0405, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5132/5305 (96.7389%), train_poison_data_count: 415
Global model norm: 44.10906366122855.
Norm before scaling: 44.07678597088764. Distance: 1.354681572466667
Total norm for 4 adversaries is: 44.07678597088764. distance: 1.354681572466667
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0708, Accuracy: 9709/9900 (98.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4547/4717 (96.3960%), train_poison_data_count: 370
Global model norm: 44.10906366122855.
Norm before scaling: 44.08172092962329. Distance: 1.298747537737248
Total norm for 4 adversaries is: 44.08172092962329. distance: 1.298747537737248
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0467, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4902/5066 (96.7627%), train_poison_data_count: 400
Global model norm: 44.10906366122855.
Norm before scaling: 44.08007323548036. Distance: 1.3514682979499628
Total norm for 4 adversaries is: 44.08007323548036. distance: 1.3514682979499628
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0733, Accuracy: 9730/9900 (98.2828%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4893/5265 (92.9345%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4761/5265 (90.4274%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0806, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4052/4356 (93.0211%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3835/4356 (88.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3086, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3613/3756 (96.1928%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3586/3756 (95.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8252, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3610/3837 (94.0839%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3616/3837 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9814, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5312/5740 (92.5436%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5239/5740 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0645, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3920/4223 (92.8250%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3947/4223 (93.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9101, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4177/4465 (93.5498%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8770, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5086/5591 (90.9676%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4994/5591 (89.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1934, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5458/5902 (92.4771%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5100/5902 (86.4114%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2441, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4595/4918 (93.4323%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4517/4918 (91.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2018, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3626/3861 (93.9135%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3558/3861 (92.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0019, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3985/4295 (92.7823%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3879/4295 (90.3143%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0060, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3785/4158 (91.0293%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3717/4158 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1295, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5842/6263 (93.2780%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5722/6263 (91.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0861, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4024/4354 (92.4208%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0157, Accuracy: 3193/4354 (73.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.9588, Accuracy: 4008/10000 (40.0800%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3592/3797 (94.6010%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9332, Accuracy: 5690/10000 (56.9000%)
time spent on training: 236.27211499214172
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.2911, Accuracy: 6717/10000 (67.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1396, Accuracy: 9535/9900 (96.3131%)
Done in 260.41830825805664 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4752/4885 (97.2774%), train_poison_data_count: 385
Global model norm: 44.1303790652801.
Norm before scaling: 44.097460919766256. Distance: 1.2062184087539887
Total norm for 4 adversaries is: 44.097460919766256. distance: 1.2062184087539887
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1022, Accuracy: 9637/9900 (97.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5142/5305 (96.9274%), train_poison_data_count: 415
Global model norm: 44.1303790652801.
Norm before scaling: 44.098307978895996. Distance: 1.3471206706511007
Total norm for 4 adversaries is: 44.098307978895996. distance: 1.3471206706511007
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0495, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4573/4717 (96.9472%), train_poison_data_count: 370
Global model norm: 44.1303790652801.
Norm before scaling: 44.10045738761532. Distance: 1.2203563472279995
Total norm for 4 adversaries is: 44.10045738761532. distance: 1.2203563472279995
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0834, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4915/5066 (97.0193%), train_poison_data_count: 400
Global model norm: 44.1303790652801.
Norm before scaling: 44.102671736493186. Distance: 1.3777557414652875
Total norm for 4 adversaries is: 44.102671736493186. distance: 1.3777557414652875
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0690, Accuracy: 9718/9900 (98.1616%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3574/3797 (94.1269%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3541/3797 (93.2578%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8608, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4626/5037 (91.8404%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4617/5037 (91.6617%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9912, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4543/4934 (92.0754%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4342/4934 (88.0016%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2508, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5044/5455 (92.4656%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4949/5455 (90.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0397, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5427/5902 (91.9519%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5106/5902 (86.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.5627, Accuracy: 4769/10000 (47.6900%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5834/6391 (91.2846%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5654/6391 (88.4682%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1076, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3696/3911 (94.5027%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3484/3911 (89.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0625, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4808/5195 (92.5505%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4606/5195 (88.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1528, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3991/4235 (94.2385%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3920/4235 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8888, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4754/5116 (92.9242%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4669/5116 (91.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0211, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4327/4538 (95.3504%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4330/4538 (95.4165%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8960, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5241/5582 (93.8911%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5070/5582 (90.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3044, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4230/4558 (92.8039%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4146/4558 (90.9609%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1076, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3803/4046 (93.9941%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3804/4046 (94.0188%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7957, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3608/3828 (94.2529%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3557/3828 (92.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8287, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4687/5055 (92.7201%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4661/5055 (92.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9912, Accuracy: 5554/10000 (55.5400%)
time spent on training: 238.37079572677612
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.2925, Accuracy: 6700/10000 (67.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1368, Accuracy: 9545/9900 (96.4141%)
Done in 262.694313287735 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4758/4885 (97.4002%), train_poison_data_count: 385
Global model norm: 44.151966186842266.
Norm before scaling: 44.119451503577906. Distance: 1.207789556327323
Total norm for 4 adversaries is: 44.119451503577906. distance: 1.207789556327323
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0411, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5121/5305 (96.5316%), train_poison_data_count: 415
Global model norm: 44.151966186842266.
Norm before scaling: 44.11993154318125. Distance: 1.4041084513307545
Total norm for 4 adversaries is: 44.11993154318125. distance: 1.4041084513307545
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0461, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4581/4717 (97.1168%), train_poison_data_count: 370
Global model norm: 44.151966186842266.
Norm before scaling: 44.12006019844105. Distance: 1.1811712168099975
Total norm for 4 adversaries is: 44.12006019844105. distance: 1.1811712168099975
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0759, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4896/5066 (96.6443%), train_poison_data_count: 400
Global model norm: 44.151966186842266.
Norm before scaling: 44.12393628099931. Distance: 1.36218821256671
Total norm for 4 adversaries is: 44.12393628099931. distance: 1.36218821256671
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0507, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5252/5582 (94.0881%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5131/5582 (91.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0186, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4159/4501 (92.4017%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4086/4501 (90.7798%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1190, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3660/3911 (93.5822%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3323/3911 (84.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3552, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4367/4663 (93.6522%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4348/4663 (93.2447%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0028, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4908/5265 (93.2194%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4744/5265 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1511, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4051/4416 (91.7346%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4003/4416 (90.6476%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1084, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4173/4433 (94.1349%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4164/4433 (93.9319%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7808, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5832/6263 (93.1183%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5623/6263 (89.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2151, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5086/5455 (93.2356%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4959/5455 (90.9074%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9584, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4311/4634 (93.0298%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4239/4634 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0264, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4365/4707 (92.7342%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4362/4707 (92.6705%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9399, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3887/4126 (94.2075%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3843/4126 (93.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9606, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4792/5116 (93.6669%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4670/5116 (91.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0779, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4676/5063 (92.3563%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4450/5063 (87.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3014, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4048/4361 (92.8227%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3897/4361 (89.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.5105, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5562/6124 (90.8230%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5542/6124 (90.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9980, Accuracy: 5484/10000 (54.8400%)
time spent on training: 238.78141021728516
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3004, Accuracy: 6708/10000 (67.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1314, Accuracy: 9558/9900 (96.5455%)
Done in 263.170471906662 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.17355933957057.
Norm before scaling: 44.14274746003371. Distance: 1.2781536089766181
Total norm for 4 adversaries is: 44.14274746003371. distance: 1.2781536089766181
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0272, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5138/5305 (96.8520%), train_poison_data_count: 415
Global model norm: 44.17355933957057.
Norm before scaling: 44.14089878233677. Distance: 1.3530928046292512
Total norm for 4 adversaries is: 44.14089878233677. distance: 1.3530928046292512
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1002, Accuracy: 9660/9900 (97.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4569/4717 (96.8624%), train_poison_data_count: 370
Global model norm: 44.17355933957057.
Norm before scaling: 44.14308206657004. Distance: 1.2413614753537225
Total norm for 4 adversaries is: 44.14308206657004. distance: 1.2413614753537225
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1088, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 44.17355933957057.
Norm before scaling: 44.14258983458818. Distance: 1.3244426166723071
Total norm for 4 adversaries is: 44.14258983458818. distance: 1.3244426166723071
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0532, Accuracy: 9762/9900 (98.6061%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4073/4356 (93.5032%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3867/4356 (88.7741%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2189, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4109/4362 (94.1999%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4010/4362 (91.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9679, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4370/4679 (93.3960%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4247/4679 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2329, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3820/4158 (91.8711%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3777/4158 (90.8369%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0369, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4356/4651 (93.6573%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4311/4651 (92.6897%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0525, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3905/4175 (93.5329%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3798/4175 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0790, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4319/4618 (93.5253%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4257/4618 (92.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0741, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4233/4625 (91.5243%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4106/4625 (88.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0946, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5228/5582 (93.6582%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5057/5582 (90.5948%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2871, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4467/4874 (91.6496%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4255/4874 (87.3000%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3297, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4560/4934 (92.4199%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4130/4934 (83.7049%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4267, Accuracy: 4868/10000 (48.6800%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5094/5424 (93.9159%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5036/5424 (92.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.5139, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4460/4804 (92.8393%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4139/4804 (86.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3943, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4624/4918 (94.0220%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4567/4918 (92.8630%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1097, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3619/3861 (93.7322%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3554/3861 (92.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8721, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3970/4223 (94.0090%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3910/4223 (92.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.7735, Accuracy: 5876/10000 (58.7600%)
time spent on training: 235.0012972354889
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3036, Accuracy: 6710/10000 (67.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1223, Accuracy: 9575/9900 (96.7172%)
Done in 259.3317663669586 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.19436579218484.
Norm before scaling: 44.15916369544661. Distance: 1.1684517770625966
Total norm for 4 adversaries is: 44.15916369544661. distance: 1.1684517770625966
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0414, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 44.19436579218484.
Norm before scaling: 44.16116778612602. Distance: 1.3665921904267209
Total norm for 4 adversaries is: 44.16116778612602. distance: 1.3665921904267209
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0729, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4567/4717 (96.8200%), train_poison_data_count: 370
Global model norm: 44.19436579218484.
Norm before scaling: 44.164012056622525. Distance: 1.2133523304905296
Total norm for 4 adversaries is: 44.164012056622525. distance: 1.2133523304905296
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0503, Accuracy: 9768/9900 (98.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4908/5066 (96.8812%), train_poison_data_count: 400
Global model norm: 44.19436579218484.
Norm before scaling: 44.164122617374616. Distance: 1.3431481632668987
Total norm for 4 adversaries is: 44.164122617374616. distance: 1.3431481632668987
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0336, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4286/4647 (92.2315%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4250/4647 (91.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8656, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3560/3804 (93.5857%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3532/3804 (92.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9566, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5145/5591 (92.0229%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4965/5591 (88.8034%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2292, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4327/4634 (93.3751%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4245/4634 (91.6055%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8889, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4176/4433 (94.2026%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4152/4433 (93.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7452, Accuracy: 5991/10000 (59.9100%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3454/3704 (93.2505%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3411/3704 (92.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8760, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3629/3837 (94.5791%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3650/3837 (95.1264%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7466, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5070/5455 (92.9423%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4956/5455 (90.8524%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1635, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5376/5740 (93.6585%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5275/5740 (91.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0964, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4617/4986 (92.5993%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4558/4986 (91.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9711, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4211/4456 (94.5018%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9291, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4059/4356 (93.1818%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3810/4356 (87.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2076, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3385/3590 (94.2897%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3286/3590 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0297, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4244/4503 (94.2483%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4128/4503 (91.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0400, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4656/5037 (92.4360%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4689/5037 (93.0911%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9244, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4806/5167 (93.0134%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4755/5167 (92.0263%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0711, Accuracy: 5436/10000 (54.3600%)
time spent on training: 235.88823652267456
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3128, Accuracy: 6687/10000 (66.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1165, Accuracy: 9591/9900 (96.8788%)
Done in 260.15109753608704 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4781/4885 (97.8710%), train_poison_data_count: 385
Global model norm: 44.21357495114976.
Norm before scaling: 44.17844342302307. Distance: 1.2024354320964186
Total norm for 4 adversaries is: 44.17844342302307. distance: 1.2024354320964186
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0108, Accuracy: 9876/9900 (99.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5109/5305 (96.3054%), train_poison_data_count: 415
Global model norm: 44.21357495114976.
Norm before scaling: 44.18200494032469. Distance: 1.3996447248623347
Total norm for 4 adversaries is: 44.18200494032469. distance: 1.3996447248623347
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0556, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4549/4717 (96.4384%), train_poison_data_count: 370
Global model norm: 44.21357495114976.
Norm before scaling: 44.18502882720501. Distance: 1.2888400261530604
Total norm for 4 adversaries is: 44.18502882720501. distance: 1.2888400261530604
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0612, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4903/5066 (96.7825%), train_poison_data_count: 400
Global model norm: 44.21357495114976.
Norm before scaling: 44.183697182101994. Distance: 1.3512331610944035
Total norm for 4 adversaries is: 44.183697182101994. distance: 1.3512331610944035
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0858, Accuracy: 9666/9900 (97.6364%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3361/3638 (92.3859%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3364/3638 (92.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8958, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4372/4716 (92.7057%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4283/4716 (90.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0474, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4557/4956 (91.9492%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4430/4956 (89.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1646, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5064/5392 (93.9169%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4892/5392 (90.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0964, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3892/4184 (93.0210%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3880/4184 (92.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7156, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4141/4481 (92.4124%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3958/4481 (88.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1724, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3413/3646 (93.6094%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3427/3646 (93.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8480, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4665/5025 (92.8358%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4571/5025 (90.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2125, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3367/3590 (93.7883%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3266/3590 (90.9749%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9338, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4270/4596 (92.9069%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4307/4596 (93.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0687, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4044/4336 (93.2657%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3944/4336 (90.9594%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2293, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4475/4874 (91.8137%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4211/4874 (86.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3066, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4821/5167 (93.3037%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4758/5167 (92.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2042, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4327/4618 (93.6986%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4272/4618 (92.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9786, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4532/4928 (91.9643%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4473/4928 (90.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1911, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4316/4647 (92.8771%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4286/4647 (92.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0096, Accuracy: 5551/10000 (55.5100%)
time spent on training: 233.6640682220459
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3170, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1187, Accuracy: 9588/9900 (96.8485%)
Done in 257.8871805667877 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4766/4885 (97.5640%), train_poison_data_count: 385
Global model norm: 44.23337600426148.
Norm before scaling: 44.198755970014304. Distance: 1.1748677503952878
Total norm for 4 adversaries is: 44.198755970014304. distance: 1.1748677503952878
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1043, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 44.23337600426148.
Norm before scaling: 44.20003606872468. Distance: 1.3496018228719824
Total norm for 4 adversaries is: 44.20003606872468. distance: 1.3496018228719824
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0744, Accuracy: 9710/9900 (98.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4578/4717 (97.0532%), train_poison_data_count: 370
Global model norm: 44.23337600426148.
Norm before scaling: 44.20182013583052. Distance: 1.2194878227717614
Total norm for 4 adversaries is: 44.20182013583052. distance: 1.2194878227717614
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0790, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.23337600426148.
Norm before scaling: 44.201328557963755. Distance: 1.3008700961910076
Total norm for 4 adversaries is: 44.201328557963755. distance: 1.3008700961910076
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0387, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4018/4368 (91.9872%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1371, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4774/5195 (91.8961%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4546/5195 (87.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1068, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4038/4315 (93.5805%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3995/4315 (92.5840%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9978, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3404/3646 (93.3626%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3386/3646 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8224, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3408/3590 (94.9304%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3290/3590 (91.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0681, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3882/4126 (94.0863%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3902/4126 (94.5710%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8872, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4043/4361 (92.7081%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4361 (90.9195%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0537, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3618/3837 (94.2924%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3603/3837 (93.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8664, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4015/4235 (94.8052%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3886/4235 (91.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9308, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5483/5902 (92.9007%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5258/5902 (89.0884%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2161, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4198/4433 (94.6988%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9217, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3381/3638 (92.9357%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3386/3638 (93.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8098, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4821/5232 (92.1445%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4745/5232 (90.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0321, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4016/4336 (92.6199%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3993/4336 (92.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0953, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4571/4989 (91.6216%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4564/4989 (91.4813%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1666, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4157/4481 (92.7695%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3992/4481 (89.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1026, Accuracy: 5450/10000 (54.5000%)
time spent on training: 231.82912707328796
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3287, Accuracy: 6670/10000 (66.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1135, Accuracy: 9601/9900 (96.9798%)
Done in 255.9770221710205 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.25268132766082.
Norm before scaling: 44.21679131041807. Distance: 1.1842863366751355
Total norm for 4 adversaries is: 44.21679131041807. distance: 1.1842863366751355
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0245, Accuracy: 9840/9900 (99.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 44.25268132766082.
Norm before scaling: 44.217810005468245. Distance: 1.305287343176176
Total norm for 4 adversaries is: 44.217810005468245. distance: 1.305287343176176
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0598, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.25268132766082.
Norm before scaling: 44.21965684803323. Distance: 1.1678601983189973
Total norm for 4 adversaries is: 44.21965684803323. distance: 1.1678601983189973
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0612, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 44.25268132766082.
Norm before scaling: 44.223289574841814. Distance: 1.3259948252725102
Total norm for 4 adversaries is: 44.223289574841814. distance: 1.3259948252725102
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0499, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4784/5116 (93.5106%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4710/5116 (92.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9133, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4119/4362 (94.4292%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3931/4362 (90.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0041, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4220/4441 (95.0236%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4193/4441 (94.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9006, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4417/4663 (94.7244%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4347/4663 (93.2232%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9381, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4708/5083 (92.6225%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4561/5083 (89.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0189, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4358/4767 (91.4202%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4211/4767 (88.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0993, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3612/3797 (95.1277%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3552/3797 (93.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8500, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4781/5195 (92.0308%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4654/5195 (89.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0709, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4333/4618 (93.8285%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4279/4618 (92.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0470, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4219/4433 (95.1726%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4095/4433 (92.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8605, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4706/5055 (93.0959%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4623/5055 (91.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0728, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3817/4158 (91.7989%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3780/4158 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8718, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3528/3781 (93.3086%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3307/3781 (87.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2217, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3857/4175 (92.3832%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3758/4175 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9153, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4898/5265 (93.0294%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4703/5265 (89.3257%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2777, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3620/3837 (94.3445%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3616/3837 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8742, Accuracy: 5843/10000 (58.4300%)
time spent on training: 233.5095181465149
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3241, Accuracy: 6671/10000 (66.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1108, Accuracy: 9607/9900 (97.0404%)
Done in 257.7564878463745 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.272390444430066.
Norm before scaling: 44.23802859337343. Distance: 1.2296286000513859
Total norm for 4 adversaries is: 44.23802859337343. distance: 1.2296286000513859
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0313, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5143/5305 (96.9463%), train_poison_data_count: 415
Global model norm: 44.272390444430066.
Norm before scaling: 44.23750430471157. Distance: 1.3143032946506639
Total norm for 4 adversaries is: 44.23750430471157. distance: 1.3143032946506639
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0370, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.272390444430066.
Norm before scaling: 44.23853218057972. Distance: 1.1537795093436767
Total norm for 4 adversaries is: 44.23853218057972. distance: 1.1537795093436767
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0802, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4916/5066 (97.0391%), train_poison_data_count: 400
Global model norm: 44.272390444430066.
Norm before scaling: 44.24017121376722. Distance: 1.3039756249039427
Total norm for 4 adversaries is: 44.24017121376722. distance: 1.3039756249039427
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0202, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3704/3911 (94.7072%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3477/3911 (88.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2441, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4834/5195 (93.0510%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4590/5195 (88.3542%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1653, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3575/3775 (94.7020%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3599/3775 (95.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8187, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4413/4679 (94.3150%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4275/4679 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0328, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4064/4361 (93.1896%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3898/4361 (89.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1175, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3436/3672 (93.5730%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3412/3672 (92.9194%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9480, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4189/4481 (93.4836%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4006/4481 (89.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0727, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3841/4126 (93.0926%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3864/4126 (93.6500%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8347, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3728/3969 (93.9279%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3666/3969 (92.3658%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9200, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4798/5116 (93.7842%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4727/5116 (92.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9840, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4662/5063 (92.0798%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4391/5063 (86.7272%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1670, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3106/3297 (94.2069%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3073/3297 (93.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8426, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4599/5037 (91.3043%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4632/5037 (91.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0359, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4290/4596 (93.3420%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4266/4596 (92.8198%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1072, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4146/4501 (92.1129%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3960/4501 (87.9804%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9941, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4223/4465 (94.5801%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4219/4465 (94.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9430, Accuracy: 5791/10000 (57.9100%)
time spent on training: 231.70602011680603
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3295, Accuracy: 6668/10000 (66.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1032, Accuracy: 9621/9900 (97.1818%)
Done in 255.93830966949463 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 44.29123227949226.
Norm before scaling: 44.25674714626856. Distance: 1.1820594234600985
Total norm for 4 adversaries is: 44.25674714626856. distance: 1.1820594234600985
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0487, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 44.29123227949226.
Norm before scaling: 44.25918811299949. Distance: 1.3694280521313613
Total norm for 4 adversaries is: 44.25918811299949. distance: 1.3694280521313613
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0332, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4572/4717 (96.9260%), train_poison_data_count: 370
Global model norm: 44.29123227949226.
Norm before scaling: 44.25890265096038. Distance: 1.199965551994519
Total norm for 4 adversaries is: 44.25890265096038. distance: 1.199965551994519
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0638, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.29123227949226.
Norm before scaling: 44.25917845972389. Distance: 1.2680207641989292
Total norm for 4 adversaries is: 44.25917845972389. distance: 1.2680207641989292
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0469, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4022/4361 (92.2266%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4361 (90.9195%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0869, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4103/4346 (94.4087%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4125/4346 (94.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7517, Accuracy: 5975/10000 (59.7500%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5093/5455 (93.3639%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4990/5455 (91.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0345, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4206/4465 (94.1993%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4179/4465 (93.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8392, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4018/4336 (92.6661%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3992/4336 (92.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2815, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4246/4441 (95.6091%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4201/4441 (94.5958%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9203, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4105/4362 (94.1082%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4018/4362 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1005, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3702/3969 (93.2729%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3705/3969 (93.3485%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9168, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3965/4295 (92.3166%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3885/4295 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0150, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4687/5017 (93.4224%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4639/5017 (92.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9758, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4645/5063 (91.7440%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4473/5063 (88.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2469, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3056/3271 (93.4271%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2943/3271 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0258, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5880/6263 (93.8847%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5718/6263 (91.2981%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0768, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4515/4874 (92.6344%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4330/4874 (88.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1262, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3693/3911 (94.4260%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3383/3911 (86.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2883, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4464/4804 (92.9226%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4296/4804 (89.4255%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0277, Accuracy: 5442/10000 (54.4200%)
time spent on training: 235.0588743686676
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3410, Accuracy: 6651/10000 (66.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0961, Accuracy: 9638/9900 (97.3535%)
Done in 259.37733030319214 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4759/4885 (97.4207%), train_poison_data_count: 385
Global model norm: 44.3104077102131.
Norm before scaling: 44.276935547577985. Distance: 1.238188201585228
Total norm for 4 adversaries is: 44.276935547577985. distance: 1.238188201585228
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0159, Accuracy: 9855/9900 (99.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5134/5305 (96.7766%), train_poison_data_count: 415
Global model norm: 44.3104077102131.
Norm before scaling: 44.277120264378645. Distance: 1.3804463547172916
Total norm for 4 adversaries is: 44.277120264378645. distance: 1.3804463547172916
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0850, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.3104077102131.
Norm before scaling: 44.27916450408349. Distance: 1.2150218379252002
Total norm for 4 adversaries is: 44.27916450408349. distance: 1.2150218379252002
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0480, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4926/5066 (97.2365%), train_poison_data_count: 400
Global model norm: 44.3104077102131.
Norm before scaling: 44.2796069737526. Distance: 1.3286742028537701
Total norm for 4 adversaries is: 44.2796069737526. distance: 1.3286742028537701
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0359, Accuracy: 9814/9900 (99.1313%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5497/5902 (93.1379%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5198/5902 (88.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0926, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4608/4918 (93.6966%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4611/4918 (93.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0295, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3791/4025 (94.1863%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3792/4025 (94.2112%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8021, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3286/3472 (94.6429%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3199/3472 (92.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9139, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4463/4793 (93.1150%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4461/4793 (93.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9269, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4560/4934 (92.4199%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4408/4934 (89.3393%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1425, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3710/3911 (94.8606%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3629/3911 (92.7896%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0552, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5035/5392 (93.3791%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4835/5392 (89.6699%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1809, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3405/3638 (93.5954%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3397/3638 (93.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7737, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5613/6124 (91.6558%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5447/6124 (88.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0563, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3917/4175 (93.8204%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3851/4175 (92.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8957, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4271/4625 (92.3459%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4042/4625 (87.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1336, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4035/4354 (92.6734%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3690/4354 (84.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.6523, Accuracy: 4752/10000 (47.5200%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4176/4511 (92.5737%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4139/4511 (91.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0431, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3504/3704 (94.6004%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3437/3704 (92.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7930, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3663/3861 (94.8718%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3590/3861 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9262, Accuracy: 5708/10000 (57.0800%)
time spent on training: 234.45786833763123
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3593, Accuracy: 6592/10000 (65.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0957, Accuracy: 9632/9900 (97.2929%)
Done in 258.83909845352173 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4757/4885 (97.3797%), train_poison_data_count: 385
Global model norm: 44.33007188622076.
Norm before scaling: 44.295710687961225. Distance: 1.2149758711722727
Total norm for 4 adversaries is: 44.295710687961225. distance: 1.2149758711722727
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0160, Accuracy: 9857/9900 (99.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5155/5305 (97.1725%), train_poison_data_count: 415
Global model norm: 44.33007188622076.
Norm before scaling: 44.292972711713816. Distance: 1.307585826266941
Total norm for 4 adversaries is: 44.292972711713816. distance: 1.307585826266941
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0425, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.33007188622076.
Norm before scaling: 44.297743047050375. Distance: 1.1813441889919256
Total norm for 4 adversaries is: 44.297743047050375. distance: 1.1813441889919256
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0859, Accuracy: 9682/9900 (97.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4916/5066 (97.0391%), train_poison_data_count: 400
Global model norm: 44.33007188622076.
Norm before scaling: 44.296734457449006. Distance: 1.309529667279737
Total norm for 4 adversaries is: 44.296734457449006. distance: 1.309529667279737
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0216, Accuracy: 9851/9900 (99.5051%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4695/5083 (92.3667%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4461/5083 (87.7631%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4255, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3454/3646 (94.7340%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9082, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4236/4503 (94.0706%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4126/4503 (91.6278%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9848, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4205/4501 (93.4237%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4098/4501 (91.0464%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9650, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3755/4013 (93.5709%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3712/4013 (92.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8610, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4171/4362 (95.6213%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3990/4362 (91.4718%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0353, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4086/4315 (94.6929%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4073/4315 (94.3917%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8855, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4374/4651 (94.0443%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4264/4651 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3061, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4074/4416 (92.2554%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4057/4416 (91.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1849, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3446/3704 (93.0346%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3460/3704 (93.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8209, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4366/4707 (92.7555%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4335/4707 (92.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9168, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4324/4662 (92.7499%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4347/4662 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8511, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5052/5424 (93.1416%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4969/5424 (91.6114%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1599, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4054/4336 (93.4963%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4035/4336 (93.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9686, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4151/4481 (92.6356%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3966/4481 (88.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2112, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3627/3828 (94.7492%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3627/3828 (94.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7405, Accuracy: 5983/10000 (59.8300%)
time spent on training: 229.19667506217957
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3590, Accuracy: 6593/10000 (65.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0911, Accuracy: 9654/9900 (97.5152%)
Done in 253.32737350463867 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4755/4885 (97.3388%), train_poison_data_count: 385
Global model norm: 44.34851624975392.
Norm before scaling: 44.31496544181633. Distance: 1.2800380277945251
Total norm for 4 adversaries is: 44.31496544181633. distance: 1.2800380277945251
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0254, Accuracy: 9840/9900 (99.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5146/5305 (97.0028%), train_poison_data_count: 415
Global model norm: 44.34851624975392.
Norm before scaling: 44.31541719505611. Distance: 1.3703820971014888
Total norm for 4 adversaries is: 44.31541719505611. distance: 1.3703820971014888
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0148, Accuracy: 9864/9900 (99.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4568/4717 (96.8412%), train_poison_data_count: 370
Global model norm: 44.34851624975392.
Norm before scaling: 44.318022950072184. Distance: 1.2413499995860022
Total norm for 4 adversaries is: 44.318022950072184. distance: 1.2413499995860022
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0678, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4913/5066 (96.9799%), train_poison_data_count: 400
Global model norm: 44.34851624975392.
Norm before scaling: 44.3158882255422. Distance: 1.3093040246777963
Total norm for 4 adversaries is: 44.3158882255422. distance: 1.3093040246777963
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0865, Accuracy: 9692/9900 (97.8990%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3902/4184 (93.2600%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3884/4184 (92.8298%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9413, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4622/5037 (91.7610%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5037 (92.1183%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9201, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3823/4158 (91.9432%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3784/4158 (91.0053%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8983, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3032/3271 (92.6934%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3058/3271 (93.4882%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7689, Accuracy: 6038/10000 (60.3800%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4641/4918 (94.3676%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4596/4918 (93.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1046, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5478/5902 (92.8160%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5159/5902 (87.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5207, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4088/4354 (93.8907%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3326/4354 (76.3895%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.7554, Accuracy: 4425/10000 (44.2500%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3765/3969 (94.8602%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3689/3969 (92.9453%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8915, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4069/4356 (93.4114%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3902/4356 (89.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2595, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4011/4295 (93.3877%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3751/4295 (87.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3467, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3894/4126 (94.3771%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3866/4126 (93.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9222, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4624/4928 (93.8312%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4534/4928 (92.0049%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9824, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4188/4511 (92.8397%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4142/4511 (91.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9296, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4339/4618 (93.9584%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4185/4618 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1003, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3476/3704 (93.8445%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3459/3704 (93.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8305, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3347/3616 (92.5608%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3340/3616 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9552, Accuracy: 5737/10000 (57.3700%)
time spent on training: 231.05215716362
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3583, Accuracy: 6586/10000 (65.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0891, Accuracy: 9661/9900 (97.5859%)
Done in 255.20581459999084 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.36747570451383.
Norm before scaling: 44.33122565821269. Distance: 1.1642269555994171
Total norm for 4 adversaries is: 44.33122565821269. distance: 1.1642269555994171
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0900, Accuracy: 9668/9900 (97.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5155/5305 (97.1725%), train_poison_data_count: 415
Global model norm: 44.36747570451383.
Norm before scaling: 44.332086148800705. Distance: 1.3107830806896281
Total norm for 4 adversaries is: 44.332086148800705. distance: 1.3107830806896281
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0872, Accuracy: 9689/9900 (97.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.36747570451383.
Norm before scaling: 44.33354687938074. Distance: 1.153198339099462
Total norm for 4 adversaries is: 44.33354687938074. distance: 1.153198339099462
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0354, Accuracy: 9811/9900 (99.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4934/5066 (97.3944%), train_poison_data_count: 400
Global model norm: 44.36747570451383.
Norm before scaling: 44.33558438736034. Distance: 1.2917640813374152
Total norm for 4 adversaries is: 44.33558438736034. distance: 1.2917640813374152
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0498, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3019/3271 (92.2959%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3040/3271 (92.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8333, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4186/4456 (93.9408%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4183/4456 (93.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8888, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3802/4013 (94.7421%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3787/4013 (94.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6639, Accuracy: 6075/10000 (60.7500%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3516/3781 (92.9913%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3460/3781 (91.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1371, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3547/3775 (93.9603%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3557/3775 (94.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7955, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4830/5232 (92.3165%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4730/5232 (90.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2198, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4599/4989 (92.1828%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4489/4989 (89.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1466, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3432/3646 (94.1306%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3415/3646 (93.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7292, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4115/4315 (95.3650%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8956, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4610/4918 (93.7373%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4548/4918 (92.4766%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1916, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4092/4416 (92.6630%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4016/4416 (90.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8887, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5842/6263 (93.2780%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5804/6263 (92.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0303, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5659/6124 (92.4069%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5478/6124 (89.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0705, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4378/4651 (94.1303%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4332/4651 (93.1413%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9402, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3750/4356 (86.0882%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4170, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4079/4356 (93.6410%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3701/4356 (84.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2998, Accuracy: 4975/10000 (49.7500%)
time spent on training: 230.38445353507996
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3560, Accuracy: 6592/10000 (65.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0923, Accuracy: 9646/9900 (97.4343%)
Done in 254.704931974411 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4752/4885 (97.2774%), train_poison_data_count: 385
Global model norm: 44.38640368436319.
Norm before scaling: 44.35360399674416. Distance: 1.2662171285567063
Total norm for 4 adversaries is: 44.35360399674416. distance: 1.2662171285567063
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0266, Accuracy: 9838/9900 (99.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5161/5305 (97.2856%), train_poison_data_count: 415
Global model norm: 44.38640368436319.
Norm before scaling: 44.35140768094345. Distance: 1.3158576342847446
Total norm for 4 adversaries is: 44.35140768094345. distance: 1.3158576342847446
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0646, Accuracy: 9745/9900 (98.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4588/4717 (97.2652%), train_poison_data_count: 370
Global model norm: 44.38640368436319.
Norm before scaling: 44.352087504599204. Distance: 1.1634426642873754
Total norm for 4 adversaries is: 44.352087504599204. distance: 1.1634426642873754
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0720, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4949/5066 (97.6905%), train_poison_data_count: 400
Global model norm: 44.38640368436319.
Norm before scaling: 44.351029232085615. Distance: 1.194342624898234
Total norm for 4 adversaries is: 44.351029232085615. distance: 1.194342624898234
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0621, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4341/4716 (92.0483%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4240/4716 (89.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0373, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4291/4634 (92.5982%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4245/4634 (91.6055%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0105, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3624/3828 (94.6708%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3582/3828 (93.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9043, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4620/4989 (92.6037%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4527/4989 (90.7396%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0337, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4817/5116 (94.1556%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4712/5116 (92.1032%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0554, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4152/4362 (95.1857%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4026/4362 (92.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0552, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4709/5017 (93.8609%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4584/5017 (91.3693%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9867, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4095/4354 (94.0514%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3536/4354 (81.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.7025, Accuracy: 4476/10000 (44.7600%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3369/3638 (92.6058%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3400/3638 (93.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8727, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4801/5195 (92.4158%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4534/5195 (87.2762%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0940, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4270/4596 (92.9069%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4329/4596 (94.1906%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9838, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4543/4928 (92.1875%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0924, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4786/5244 (91.2662%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4629/5244 (88.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0949, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5485/5902 (92.9346%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5205/5902 (88.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3642, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4656/5025 (92.6567%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4637/5025 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2092, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5642/6124 (92.1293%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5442/6124 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1081, Accuracy: 5346/10000 (53.4600%)
time spent on training: 235.49819016456604
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3599, Accuracy: 6595/10000 (65.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0872, Accuracy: 9665/9900 (97.6263%)
Done in 259.96175050735474 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.407906208118646.
Norm before scaling: 44.373052334018. Distance: 1.2127722837547255
Total norm for 4 adversaries is: 44.373052334018. distance: 1.2127722837547255
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0292, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.407906208118646.
Norm before scaling: 44.369986237443634. Distance: 1.2545940378611444
Total norm for 4 adversaries is: 44.369986237443634. distance: 1.2545940378611444
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0557, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4586/4717 (97.2228%), train_poison_data_count: 370
Global model norm: 44.407906208118646.
Norm before scaling: 44.37352000172795. Distance: 1.1749213232930322
Total norm for 4 adversaries is: 44.37352000172795. distance: 1.1749213232930322
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0270, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4939/5066 (97.4931%), train_poison_data_count: 400
Global model norm: 44.407906208118646.
Norm before scaling: 44.3741128322408. Distance: 1.271585861820199
Total norm for 4 adversaries is: 44.3741128322408. distance: 1.271585861820199
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0577, Accuracy: 9756/9900 (98.5455%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4815/5116 (94.1165%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4677/5116 (91.4191%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0456, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4817/5197 (92.6881%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4645/5197 (89.3785%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1953, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4123/4356 (94.6511%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3803/4356 (87.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0714, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4418/4679 (94.4219%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4056/4679 (86.6852%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3799, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4337/4647 (93.3290%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4265/4647 (91.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0731, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3711/3911 (94.8862%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3402/3911 (86.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3529, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4096/4315 (94.9247%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4068/4315 (94.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8337, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3399/3646 (93.2255%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3386/3646 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7814, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4335/4634 (93.5477%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4280/4634 (92.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8532, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4728/5055 (93.5312%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4711/5055 (93.1949%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8416, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4177/4362 (95.7588%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4018/4362 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9177, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4591/4934 (93.0482%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4146/4934 (84.0292%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.6322, Accuracy: 4505/10000 (45.0500%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4353/4767 (91.3153%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4234/4767 (88.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2420, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4166/4433 (93.9770%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4143/4433 (93.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9287, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4499/4928 (91.2946%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4465/4928 (90.6047%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0838, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3622/3837 (94.3967%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3603/3837 (93.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0087, Accuracy: 5616/10000 (56.1600%)
time spent on training: 233.3388307094574
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3578, Accuracy: 6597/10000 (65.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0907, Accuracy: 9653/9900 (97.5051%)
Done in 257.45254850387573 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4768/4885 (97.6049%), train_poison_data_count: 385
Global model norm: 44.427916017743705.
Norm before scaling: 44.392849623067114. Distance: 1.1870591700620718
Total norm for 4 adversaries is: 44.392849623067114. distance: 1.1870591700620718
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0903, Accuracy: 9665/9900 (97.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.427916017743705.
Norm before scaling: 44.39235741075681. Distance: 1.3523176872787568
Total norm for 4 adversaries is: 44.39235741075681. distance: 1.3523176872787568
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0341, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4573/4717 (96.9472%), train_poison_data_count: 370
Global model norm: 44.427916017743705.
Norm before scaling: 44.39467406075798. Distance: 1.2056928207598823
Total norm for 4 adversaries is: 44.39467406075798. distance: 1.2056928207598823
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0226, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4922/5066 (97.1575%), train_poison_data_count: 400
Global model norm: 44.427916017743705.
Norm before scaling: 44.394592945678646. Distance: 1.2853102664200036
Total norm for 4 adversaries is: 44.394592945678646. distance: 1.2853102664200036
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0808, Accuracy: 9704/9900 (98.0202%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4656/4986 (93.3815%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4555/4986 (91.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0265, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4417/4767 (92.6579%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4283/4767 (89.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0909, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4089/4315 (94.7625%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4066/4315 (94.2294%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8571, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3456/3672 (94.1176%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3394/3672 (92.4292%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0762, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4253/4558 (93.3085%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3982/4558 (87.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.6410, Accuracy: 4750/10000 (47.5000%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3666/3828 (95.7680%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3633/3828 (94.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8115, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4380/4679 (93.6097%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4032/4679 (86.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5061, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4553/4956 (91.8684%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4361/4956 (87.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1138, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4105/4356 (94.2378%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3861/4356 (88.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2845, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4302/4538 (94.7995%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4259/4538 (93.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8652, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3750/4013 (93.4463%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3779/4013 (94.1690%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7158, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4921/5265 (93.4663%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4828/5265 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9384, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4407/4663 (94.5100%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4378/4663 (93.8881%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0146, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5863/6263 (93.6133%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5758/6263 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2255, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4695/5063 (92.7316%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4299/5063 (84.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2788, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4089/4416 (92.5951%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4113/4416 (93.1386%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0965, Accuracy: 5460/10000 (54.6000%)
time spent on training: 235.25816917419434
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3620, Accuracy: 6599/10000 (65.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0921, Accuracy: 9650/9900 (97.4747%)
Done in 259.56936955451965 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 44.447620210567095.
Norm before scaling: 44.41177915744524. Distance: 1.2040604756840971
Total norm for 4 adversaries is: 44.41177915744524. distance: 1.2040604756840971
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0414, Accuracy: 9801/9900 (99.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5173/5305 (97.5118%), train_poison_data_count: 415
Global model norm: 44.447620210567095.
Norm before scaling: 44.4077907566095. Distance: 1.2060702550709603
Total norm for 4 adversaries is: 44.4077907566095. distance: 1.2060702550709603
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0507, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4586/4717 (97.2228%), train_poison_data_count: 370
Global model norm: 44.447620210567095.
Norm before scaling: 44.413319722240985. Distance: 1.1549705437210958
Total norm for 4 adversaries is: 44.413319722240985. distance: 1.1549705437210958
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0665, Accuracy: 9739/9900 (98.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.447620210567095.
Norm before scaling: 44.41251027960407. Distance: 1.2608745573422548
Total norm for 4 adversaries is: 44.41251027960407. distance: 1.2608745573422548
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0391, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5358/5740 (93.3449%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5212/5740 (90.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2540, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4383/4651 (94.2378%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4321/4651 (92.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0584, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4266/4503 (94.7368%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4067/4503 (90.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9834, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4433/4767 (92.9935%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4327/4767 (90.7699%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1889, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5147/5591 (92.0587%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4894/5591 (87.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2153, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4171/4465 (93.4155%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4219/4465 (94.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8316, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4602/4956 (92.8571%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4457/4956 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1957, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3499/3704 (94.4654%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3459/3704 (93.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8710, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3830/4025 (95.1553%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3827/4025 (95.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7852, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4748/5083 (93.4094%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4538/5083 (89.2780%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2971, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5665/6124 (92.5049%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5456/6124 (89.0921%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1866, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3992/4295 (92.9453%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3928/4295 (91.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8932, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4471/4804 (93.0683%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4021/4804 (83.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4835, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4505/4793 (93.9912%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4463/4793 (93.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9822, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4199/4433 (94.7214%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4142/4433 (93.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8957, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4079/4361 (93.5336%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3855/4361 (88.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1839, Accuracy: 5370/10000 (53.7000%)
time spent on training: 236.71640992164612
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3658, Accuracy: 6594/10000 (65.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0913, Accuracy: 9658/9900 (97.5556%)
Done in 260.9981815814972 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 44.46813097996769.
Norm before scaling: 44.43428450699344. Distance: 1.2457631309317903
Total norm for 4 adversaries is: 44.43428450699344. distance: 1.2457631309317903
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0263, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5149/5305 (97.0594%), train_poison_data_count: 415
Global model norm: 44.46813097996769.
Norm before scaling: 44.431258352088115. Distance: 1.3340565339395347
Total norm for 4 adversaries is: 44.431258352088115. distance: 1.3340565339395347
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0379, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4597/4717 (97.4560%), train_poison_data_count: 370
Global model norm: 44.46813097996769.
Norm before scaling: 44.43384083035699. Distance: 1.1547438116112192
Total norm for 4 adversaries is: 44.43384083035699. distance: 1.1547438116112192
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0507, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4905/5066 (96.8220%), train_poison_data_count: 400
Global model norm: 44.46813097996769.
Norm before scaling: 44.43422681554516. Distance: 1.292819334311306
Total norm for 4 adversaries is: 44.43422681554516. distance: 1.292819334311306
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0389, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4255/4558 (93.3523%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4164/4558 (91.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0763, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4341/4596 (94.4517%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4309/4596 (93.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8876, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4555/4874 (93.4551%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4368/4874 (89.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2060, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3858/4158 (92.7850%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3836/4158 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9013, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5089/5455 (93.2906%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4975/5455 (91.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1140, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4109/4346 (94.5467%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4113/4346 (94.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8186, Accuracy: 5989/10000 (59.8900%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4427/4679 (94.6142%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4366/4679 (93.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9750, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4106/4416 (92.9801%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4070/4416 (92.1649%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8357, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3618/3828 (94.5141%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3619/3828 (94.5402%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.7894, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4003/4223 (94.7904%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3978/4223 (94.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8520, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4908/5265 (93.2194%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4733/5265 (89.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0342, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5621/6124 (91.7864%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5407/6124 (88.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0202, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4092/4361 (93.8317%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3939/4361 (90.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0093, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4602/4956 (92.8571%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4377/4956 (88.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2223, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5344/5740 (93.1010%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5153/5740 (89.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1918, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3797/4013 (94.6175%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3798/4013 (94.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0137, Accuracy: 5578/10000 (55.7800%)
time spent on training: 237.22340941429138
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3735, Accuracy: 6580/10000 (65.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0890, Accuracy: 9661/9900 (97.5859%)
Done in 261.33035159111023 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4758/4885 (97.4002%), train_poison_data_count: 385
Global model norm: 44.487920257392624.
Norm before scaling: 44.45274329800974. Distance: 1.2173270207997327
Total norm for 4 adversaries is: 44.45274329800974. distance: 1.2173270207997327
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0398, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5160/5305 (97.2667%), train_poison_data_count: 415
Global model norm: 44.487920257392624.
Norm before scaling: 44.451260395867855. Distance: 1.2975280220666126
Total norm for 4 adversaries is: 44.451260395867855. distance: 1.2975280220666126
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0548, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.487920257392624.
Norm before scaling: 44.45187827777219. Distance: 1.1366367376047217
Total norm for 4 adversaries is: 44.45187827777219. distance: 1.1366367376047217
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0775, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.487920257392624.
Norm before scaling: 44.455019731149314. Distance: 1.2707953160754064
Total norm for 4 adversaries is: 44.455019731149314. distance: 1.2707953160754064
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0772, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3929/4184 (93.9054%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3891/4184 (92.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9157, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3420/3590 (95.2646%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3284/3590 (91.4763%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1731, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3804/4158 (91.4863%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3744/4158 (90.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9384, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3829/4025 (95.1304%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3796/4025 (94.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8236, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3841/4046 (94.9333%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3727/4046 (92.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8864, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4687/5025 (93.2736%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4570/5025 (90.9453%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2279, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4669/5063 (92.2181%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4401/5063 (86.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1737, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4090/4356 (93.8935%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4067/4356 (93.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0006, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4370/4651 (93.9583%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4330/4651 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9292, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4128/4356 (94.7658%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3731/4356 (85.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3041, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4303/4576 (94.0341%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4242/4576 (92.7010%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9911, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4232/4456 (94.9731%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4210/4456 (94.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8006, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3121/3297 (94.6618%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3139/3297 (95.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7637, Accuracy: 5952/10000 (59.5200%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4506/4804 (93.7968%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4093/4804 (85.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4530, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3767/3969 (94.9106%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3649/3969 (91.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8487, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4816/5195 (92.7045%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4555/5195 (87.6805%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1980, Accuracy: 5119/10000 (51.1900%)
time spent on training: 229.74125623703003
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3752, Accuracy: 6578/10000 (65.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0885, Accuracy: 9663/9900 (97.6061%)
Done in 253.65958714485168 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 44.50629097693311.
Norm before scaling: 44.47037231316908. Distance: 1.1572432504730286
Total norm for 4 adversaries is: 44.47037231316908. distance: 1.1572432504730286
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0614, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5177/5305 (97.5872%), train_poison_data_count: 415
Global model norm: 44.50629097693311.
Norm before scaling: 44.468696470891885. Distance: 1.294591617040014
Total norm for 4 adversaries is: 44.468696470891885. distance: 1.294591617040014
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0315, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4594/4717 (97.3924%), train_poison_data_count: 370
Global model norm: 44.50629097693311.
Norm before scaling: 44.470350353318274. Distance: 1.1354613280772266
Total norm for 4 adversaries is: 44.470350353318274. distance: 1.1354613280772266
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0554, Accuracy: 9751/9900 (98.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.50629097693311.
Norm before scaling: 44.47263274730385. Distance: 1.3000858040149537
Total norm for 4 adversaries is: 44.47263274730385. distance: 1.3000858040149537
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0718, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3664/3837 (95.4913%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3675/3837 (95.7780%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7198, Accuracy: 6081/10000 (60.8100%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5269/5582 (94.3927%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5114/5582 (91.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1041, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5086/5455 (93.2356%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4918/5455 (90.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1195, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4368/4679 (93.3533%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4307/4679 (92.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0014, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4247/4518 (94.0018%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4238/4518 (93.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9609, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4383/4618 (94.9112%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4340/4618 (93.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0177, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4339/4716 (92.0059%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4246/4716 (90.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1674, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4788/5244 (91.3043%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4682/5244 (89.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9820, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4558/4874 (93.5166%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4282/4874 (87.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3121, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4565/4928 (92.6339%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4510/4928 (91.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0934, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3902/4126 (94.5710%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3914/4126 (94.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7362, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3637/3828 (95.0104%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3598/3828 (93.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9799, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3245/3472 (93.4620%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9945, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3389/3638 (93.1556%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3373/3638 (92.7158%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8297, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3411/3590 (95.0139%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3247/3590 (90.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1679, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3959/4223 (93.7485%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3900/4223 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9212, Accuracy: 5652/10000 (56.5200%)
time spent on training: 232.4703438282013
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3774, Accuracy: 6569/10000 (65.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0909, Accuracy: 9658/9900 (97.5556%)
Done in 256.9981589317322 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4766/4885 (97.5640%), train_poison_data_count: 385
Global model norm: 44.52444849374189.
Norm before scaling: 44.48814662839628. Distance: 1.215659502417462
Total norm for 4 adversaries is: 44.48814662839628. distance: 1.215659502417462
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0980, Accuracy: 9641/9900 (97.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5170/5305 (97.4552%), train_poison_data_count: 415
Global model norm: 44.52444849374189.
Norm before scaling: 44.485677064277525. Distance: 1.2763571939463876
Total norm for 4 adversaries is: 44.485677064277525. distance: 1.2763571939463876
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0385, Accuracy: 9792/9900 (98.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.52444849374189.
Norm before scaling: 44.49031150017734. Distance: 1.1602321304526646
Total norm for 4 adversaries is: 44.49031150017734. distance: 1.1602321304526646
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0523, Accuracy: 9779/9900 (98.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.52444849374189.
Norm before scaling: 44.487848915989126. Distance: 1.2342569801793053
Total norm for 4 adversaries is: 44.487848915989126. distance: 1.2342569801793053
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0281, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4234/4441 (95.3389%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4195/4441 (94.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9475, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4669/5017 (93.0636%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4627/5017 (92.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9692, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4663/4918 (94.8150%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4597/4918 (93.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0153, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4900/5197 (94.2852%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4741/5197 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9974, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4143/4356 (95.1102%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3732/4356 (85.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1576, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5138/5455 (94.1888%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5000/5455 (91.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1112, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3129/3297 (94.9045%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3150/3297 (95.5414%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7173, Accuracy: 6104/10000 (61.0400%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4838/5195 (93.1280%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4705/5195 (90.5679%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1996, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3684/3828 (96.2382%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3637/3828 (95.0104%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7263, Accuracy: 6145/10000 (61.4500%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4234/4456 (95.0180%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4159/4456 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8724, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4094/4361 (93.8776%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3860/4361 (88.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2994, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4012/4235 (94.7344%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3831/4235 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1003, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4662/5025 (92.7761%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0931, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3423/3646 (93.8837%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3429/3646 (94.0483%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.6810, Accuracy: 6060/10000 (60.6000%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3796/4158 (91.2939%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3724/4158 (89.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0469, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4323/4538 (95.2622%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4329/4538 (95.3944%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7324, Accuracy: 5978/10000 (59.7800%)
time spent on training: 232.69678235054016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.3925, Accuracy: 6526/10000 (65.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0832, Accuracy: 9685/9900 (97.8283%)
Done in 256.80875515937805 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4775/4885 (97.7482%), train_poison_data_count: 385
Global model norm: 44.542658900362724.
Norm before scaling: 44.50520620001945. Distance: 1.1408114868721329
Total norm for 4 adversaries is: 44.50520620001945. distance: 1.1408114868721329
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0692, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5143/5305 (96.9463%), train_poison_data_count: 415
Global model norm: 44.542658900362724.
Norm before scaling: 44.50635817463332. Distance: 1.342043524981452
Total norm for 4 adversaries is: 44.50635817463332. distance: 1.342043524981452
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0104, Accuracy: 9876/9900 (99.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.542658900362724.
Norm before scaling: 44.50767742321964. Distance: 1.181406095575636
Total norm for 4 adversaries is: 44.50767742321964. distance: 1.181406095575636
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0249, Accuracy: 9843/9900 (99.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4939/5066 (97.4931%), train_poison_data_count: 400
Global model norm: 44.542658900362724.
Norm before scaling: 44.5079681463401. Distance: 1.2553583691255146
Total norm for 4 adversaries is: 44.5079681463401. distance: 1.2553583691255146
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0398, Accuracy: 9795/9900 (98.9394%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4064/4295 (94.6217%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3948/4295 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0198, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5271/5582 (94.4285%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5182/5582 (92.8341%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1823, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3420/3672 (93.1373%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3409/3672 (92.8377%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9225, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4269/4518 (94.4887%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4198/4518 (92.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9562, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3594/3797 (94.6537%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3537/3797 (93.1525%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8912, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4193/4362 (96.1256%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3994/4362 (91.5635%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1055, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4483/4804 (93.3181%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3810/4804 (79.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.7233, Accuracy: 4573/10000 (45.7300%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4815/5116 (94.1165%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4693/5116 (91.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9038, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4670/5025 (92.9353%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4587/5025 (91.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2242, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3135/3297 (95.0864%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3127/3297 (94.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7237, Accuracy: 6090/10000 (60.9000%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3497/3704 (94.4114%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3445/3704 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9551, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5074/5424 (93.5472%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5016/5424 (92.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2286, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3653/3861 (94.6128%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3635/3861 (94.1466%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9004, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4551/4874 (93.3730%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4499/4874 (92.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1470, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4376/4647 (94.1683%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4324/4647 (93.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8952, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4092/4356 (93.9394%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3778/4356 (86.7309%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.5634, Accuracy: 4863/10000 (48.6300%)
time spent on training: 233.04407167434692
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.3949, Accuracy: 6519/10000 (65.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0798, Accuracy: 9690/9900 (97.8788%)
Done in 257.1744420528412 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4770/4885 (97.6459%), train_poison_data_count: 385
Global model norm: 44.56072489451894.
Norm before scaling: 44.52386177745732. Distance: 1.1865144454552532
Total norm for 4 adversaries is: 44.52386177745732. distance: 1.1865144454552532
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0941, Accuracy: 9670/9900 (97.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.56072489451894.
Norm before scaling: 44.52505165195628. Distance: 1.3382083265007607
Total norm for 4 adversaries is: 44.52505165195628. distance: 1.3382083265007607
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0339, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.56072489451894.
Norm before scaling: 44.52558215026854. Distance: 1.1629228581685473
Total norm for 4 adversaries is: 44.52558215026854. distance: 1.1629228581685473
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0568, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4931/5066 (97.3352%), train_poison_data_count: 400
Global model norm: 44.56072489451894.
Norm before scaling: 44.52920910893419. Distance: 1.3351628695659257
Total norm for 4 adversaries is: 44.52920910893419. distance: 1.3351628695659257
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0249, Accuracy: 9834/9900 (99.3333%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4237/4503 (94.0928%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4116/4503 (91.4057%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0128, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3630/3861 (94.0171%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3613/3861 (93.5768%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8988, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3946/4184 (94.3117%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3881/4184 (92.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9186, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4266/4518 (94.4223%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4235/4518 (93.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9482, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4759/5083 (93.6258%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4624/5083 (90.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1733, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4526/4804 (94.2132%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3804/4804 (79.1840%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.7067, Accuracy: 4629/10000 (46.2900%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4100/4356 (94.1230%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3834/4356 (88.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3066, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4732/5244 (90.2365%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4572/5244 (87.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1521, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4451/4679 (95.1272%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4198/4679 (89.7200%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2515, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4072/4416 (92.2101%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4038/4416 (91.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0185, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4643/4918 (94.4083%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4540/4918 (92.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1529, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3374/3616 (93.3075%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3402/3616 (94.0819%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7511, Accuracy: 6041/10000 (60.4100%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4301/4576 (93.9904%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4255/4576 (92.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9648, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4655/4928 (94.4602%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4558/4928 (92.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8326, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3818/4013 (95.1408%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3784/4013 (94.2935%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8505, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4061/4336 (93.6577%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3999/4336 (92.2279%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2438, Accuracy: 5263/10000 (52.6300%)
time spent on training: 233.51987743377686
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4091, Accuracy: 6498/10000 (64.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0747, Accuracy: 9707/9900 (98.0505%)
Done in 257.5463590621948 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.579726903394665.
Norm before scaling: 44.54301653756316. Distance: 1.1783968199569825
Total norm for 4 adversaries is: 44.54301653756316. distance: 1.1783968199569825
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0364, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5163/5305 (97.3233%), train_poison_data_count: 415
Global model norm: 44.579726903394665.
Norm before scaling: 44.54126258050646. Distance: 1.2745168125634503
Total norm for 4 adversaries is: 44.54126258050646. distance: 1.2745168125634503
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0588, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.579726903394665.
Norm before scaling: 44.54475946397202. Distance: 1.1884776156945056
Total norm for 4 adversaries is: 44.54475946397202. distance: 1.1884776156945056
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0072, Accuracy: 9878/9900 (99.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4931/5066 (97.3352%), train_poison_data_count: 400
Global model norm: 44.579726903394665.
Norm before scaling: 44.544860858535074. Distance: 1.2524019052920474
Total norm for 4 adversaries is: 44.544860858535074. distance: 1.2524019052920474
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0402, Accuracy: 9800/9900 (98.9899%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5885/6263 (93.9646%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5793/6263 (92.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0510, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3317/3472 (95.5357%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3230/3472 (93.0300%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9418, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3864/4158 (92.9293%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3842/4158 (92.4002%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9761, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3393/3638 (93.2655%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3431/3638 (94.3101%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8999, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4575/4874 (93.8654%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4276/4874 (87.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3678, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4126/4356 (94.7199%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3560/4356 (81.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5149, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4274/4538 (94.1825%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4298/4538 (94.7113%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8045, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4631/4928 (93.9732%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4570/4928 (92.7354%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9725, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4372/4618 (94.6730%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4301/4618 (93.1356%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8882, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4427/4707 (94.0514%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4349/4707 (92.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0709, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4424/4679 (94.5501%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4357/4679 (93.1182%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0689, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4365/4647 (93.9316%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4368/4647 (93.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9131, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4341/4576 (94.8645%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4314/4576 (94.2745%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2346, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3817/4046 (94.3401%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3810/4046 (94.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9427, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4369/4651 (93.9368%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4343/4651 (93.3778%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0824, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4735/5055 (93.6696%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4698/5055 (92.9377%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9036, Accuracy: 5743/10000 (57.4300%)
time spent on training: 234.18908786773682
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4077, Accuracy: 6495/10000 (64.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0760, Accuracy: 9700/9900 (97.9798%)
Done in 258.4184753894806 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 44.59798042959387.
Norm before scaling: 44.56179462318661. Distance: 1.204898270550966
Total norm for 4 adversaries is: 44.56179462318661. distance: 1.204898270550966
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0673, Accuracy: 9738/9900 (98.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.59798042959387.
Norm before scaling: 44.56130701637703. Distance: 1.3151903734814325
Total norm for 4 adversaries is: 44.56130701637703. distance: 1.3151903734814325
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0661, Accuracy: 9729/9900 (98.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.59798042959387.
Norm before scaling: 44.561034447324325. Distance: 1.1187631659558843
Total norm for 4 adversaries is: 44.561034447324325. distance: 1.1187631659558843
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0271, Accuracy: 9823/9900 (99.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4919/5066 (97.0983%), train_poison_data_count: 400
Global model norm: 44.59798042959387.
Norm before scaling: 44.56384634843796. Distance: 1.309127379972636
Total norm for 4 adversaries is: 44.56384634843796. distance: 1.309127379972636
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0417, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5329/5740 (92.8397%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5202/5740 (90.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0908, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3905/4175 (93.5329%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3809/4175 (91.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9055, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4601/4918 (93.5543%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4577/4918 (93.0663%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1077, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4049/4235 (95.6080%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3874/4235 (91.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0065, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5111/5455 (93.6939%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5027/5455 (92.1540%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0397, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4350/4662 (93.3076%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4274/4662 (91.6774%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0503, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4227/4465 (94.6697%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4197/4465 (93.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9497, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4414/4651 (94.9043%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4295/4651 (92.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0561, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4401/4618 (95.3010%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4347/4618 (94.1317%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8966, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4682/5037 (92.9522%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4665/5037 (92.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1047, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4075/4354 (93.5921%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3585/4354 (82.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4787, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4218/4441 (94.9786%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4140/4441 (93.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0255, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4280/4538 (94.3147%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4253/4538 (93.7197%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.7841, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4817/5116 (94.1556%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4650/5116 (90.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0598, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5637/6124 (92.0477%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5360/6124 (87.5245%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1390, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4166/4362 (95.5066%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4097/4362 (93.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8827, Accuracy: 5744/10000 (57.4400%)
time spent on training: 236.24942064285278
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4060, Accuracy: 6490/10000 (64.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0733, Accuracy: 9707/9900 (98.0505%)
Done in 260.49445152282715 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 44.61779829624819.
Norm before scaling: 44.58148619250835. Distance: 1.1915392691976114
Total norm for 4 adversaries is: 44.58148619250835. distance: 1.1915392691976114
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0488, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5165/5305 (97.3610%), train_poison_data_count: 415
Global model norm: 44.61779829624819.
Norm before scaling: 44.58021293962364. Distance: 1.317909627423868
Total norm for 4 adversaries is: 44.58021293962364. distance: 1.317909627423868
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0556, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4591/4717 (97.3288%), train_poison_data_count: 370
Global model norm: 44.61779829624819.
Norm before scaling: 44.58212143626425. Distance: 1.171379696760164
Total norm for 4 adversaries is: 44.58212143626425. distance: 1.171379696760164
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0281, Accuracy: 9819/9900 (99.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.61779829624819.
Norm before scaling: 44.582076257589215. Distance: 1.2694041496622535
Total norm for 4 adversaries is: 44.582076257589215. distance: 1.2694041496622535
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0302, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4114/4361 (94.3362%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3956/4361 (90.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9793, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3589/3797 (94.5220%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3565/3797 (93.8899%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9339, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4647/4918 (94.4896%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4614/4918 (93.8186%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0980, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3389/3638 (93.1556%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3397/3638 (93.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7969, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3448/3590 (96.0446%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3436/3590 (95.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8733, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4685/4986 (93.9631%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4573/4986 (91.7168%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9141, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5058/5392 (93.8056%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4821/5392 (89.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1224, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3585/3804 (94.2429%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3529/3804 (92.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9079, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4666/5025 (92.8557%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4638/5025 (92.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0227, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4501/4793 (93.9078%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4436/4793 (92.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0910, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4605/4956 (92.9177%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4425/4956 (89.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3585, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4781/5116 (93.4519%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4620/5116 (90.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0776, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4786/5055 (94.6785%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4737/5055 (93.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8716, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4695/5063 (92.7316%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4393/5063 (86.7667%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4124, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4203/4433 (94.8116%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4143/4433 (93.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8169, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4389/4662 (94.1441%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4367/4662 (93.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9062, Accuracy: 5725/10000 (57.2500%)
time spent on training: 234.2599127292633
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4083, Accuracy: 6493/10000 (64.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0740, Accuracy: 9708/9900 (98.0606%)
Done in 258.3226761817932 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.63634118183929.
Norm before scaling: 44.598426578975996. Distance: 1.1893551039121597
Total norm for 4 adversaries is: 44.598426578975996. distance: 1.1893551039121597
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0638, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5305 (96.9274%), train_poison_data_count: 415
Global model norm: 44.63634118183929.
Norm before scaling: 44.60020155241033. Distance: 1.3579939480648107
Total norm for 4 adversaries is: 44.60020155241033. distance: 1.3579939480648107
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0340, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4599/4717 (97.4984%), train_poison_data_count: 370
Global model norm: 44.63634118183929.
Norm before scaling: 44.60016597152414. Distance: 1.1415055416505684
Total norm for 4 adversaries is: 44.60016597152414. distance: 1.1415055416505684
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0283, Accuracy: 9836/9900 (99.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4920/5066 (97.1180%), train_poison_data_count: 400
Global model norm: 44.63634118183929.
Norm before scaling: 44.59945434783928. Distance: 1.2673745013825868
Total norm for 4 adversaries is: 44.59945434783928. distance: 1.2673745013825868
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0242, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4469/4804 (93.0266%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4134/4804 (86.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1121, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4522/4793 (94.3459%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9416, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3578/3781 (94.6310%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3314/3781 (87.6488%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4878, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3936/4175 (94.2754%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3849/4175 (92.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8705, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4158/4362 (95.3232%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4068/4362 (93.2600%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9972, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4714/5083 (92.7405%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4614/5083 (90.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1396, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4554/4874 (93.4346%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4265/4874 (87.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2978, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3463/3646 (94.9808%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3461/3646 (94.9259%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7252, Accuracy: 6065/10000 (60.6500%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3585/3756 (95.4473%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3557/3756 (94.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9613, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3971/4223 (94.0327%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3970/4223 (94.0090%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9819, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4180/4356 (95.9596%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4139/4356 (95.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9011, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4714/5025 (93.8109%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4659/5025 (92.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9692, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5875/6391 (91.9261%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5666/6391 (88.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1279, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4263/4518 (94.3559%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4213/4518 (93.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0022, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4827/5167 (93.4198%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4767/5167 (92.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2441, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4440/4679 (94.8921%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4392/4679 (93.8662%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0339, Accuracy: 5596/10000 (55.9600%)
time spent on training: 235.55232858657837
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4226, Accuracy: 6468/10000 (64.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0704, Accuracy: 9718/9900 (98.1616%)
Done in 259.8260247707367 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.65517296636807.
Norm before scaling: 44.61544808704506. Distance: 1.1446009800211037
Total norm for 4 adversaries is: 44.61544808704506. distance: 1.1446009800211037
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0356, Accuracy: 9806/9900 (99.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5182/5305 (97.6814%), train_poison_data_count: 415
Global model norm: 44.65517296636807.
Norm before scaling: 44.613862515093054. Distance: 1.2310324694568107
Total norm for 4 adversaries is: 44.613862515093054. distance: 1.2310324694568107
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0250, Accuracy: 9841/9900 (99.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4590/4717 (97.3076%), train_poison_data_count: 370
Global model norm: 44.65517296636807.
Norm before scaling: 44.61772305864005. Distance: 1.132322271097802
Total norm for 4 adversaries is: 44.61772305864005. distance: 1.132322271097802
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0421, Accuracy: 9796/9900 (98.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4947/5066 (97.6510%), train_poison_data_count: 400
Global model norm: 44.65517296636807.
Norm before scaling: 44.618472693143026. Distance: 1.228431007370037
Total norm for 4 adversaries is: 44.618472693143026. distance: 1.228431007370037
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0225, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4652/4956 (93.8660%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4572/4956 (92.2518%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1603, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3604/3797 (94.9170%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3549/3797 (93.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0511, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4744/5017 (94.5585%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4692/5017 (93.5220%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9308, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4219/4433 (95.1726%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4219/4433 (95.1726%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7139, Accuracy: 6016/10000 (60.1600%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3558/3781 (94.1021%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3479/3781 (92.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0439, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4963/5265 (94.2640%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4790/5265 (90.9782%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9556, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4908/5197 (94.4391%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4800/5197 (92.3610%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1461, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3430/3646 (94.0757%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3441/3646 (94.3774%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7157, Accuracy: 6057/10000 (60.5700%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4089/4356 (93.8705%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3690/4356 (84.7107%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.7610, Accuracy: 4456/10000 (44.5600%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3568/3804 (93.7960%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3578/3804 (94.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8893, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3437/3590 (95.7382%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3375/3590 (94.0111%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9701, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3857/4046 (95.3287%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3753/4046 (92.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0488, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4834/5244 (92.1815%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4715/5244 (89.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0409, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4715/5025 (93.8308%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2170, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3586/3756 (95.4739%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3600/3756 (95.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9318, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5088/5392 (94.3620%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4887/5392 (90.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1904, Accuracy: 5200/10000 (52.0000%)
time spent on training: 232.51394820213318
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4386, Accuracy: 6450/10000 (64.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0682, Accuracy: 9722/9900 (98.2020%)
Done in 256.8006970882416 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4796/4885 (98.1781%), train_poison_data_count: 385
Global model norm: 44.6725731735403.
Norm before scaling: 44.6337129864964. Distance: 1.1223704548361468
Total norm for 4 adversaries is: 44.6337129864964. distance: 1.1223704548361468
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1017, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 44.6725731735403.
Norm before scaling: 44.63758138469198. Distance: 1.3665219239989663
Total norm for 4 adversaries is: 44.63758138469198. distance: 1.3665219239989663
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0435, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4598/4717 (97.4772%), train_poison_data_count: 370
Global model norm: 44.6725731735403.
Norm before scaling: 44.63617299291153. Distance: 1.1406527999207476
Total norm for 4 adversaries is: 44.63617299291153. distance: 1.1406527999207476
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0124, Accuracy: 9865/9900 (99.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4915/5066 (97.0193%), train_poison_data_count: 400
Global model norm: 44.6725731735403.
Norm before scaling: 44.637428241331286. Distance: 1.2928875209036454
Total norm for 4 adversaries is: 44.637428241331286. distance: 1.2928875209036454
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0465, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4397/4663 (94.2955%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4410/4663 (94.5743%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0508, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4388/4618 (95.0195%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4300/4618 (93.1139%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9299, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4408/4662 (94.5517%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4354/4662 (93.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8853, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4204/4511 (93.1944%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4151/4511 (92.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9870, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4148/4362 (95.0940%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4103/4362 (94.0624%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0378, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4306/4558 (94.4713%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4161/4558 (91.2900%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2264, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3637/3828 (95.0104%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3634/3828 (94.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7201, Accuracy: 6017/10000 (60.1700%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4390/4716 (93.0874%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4275/4716 (90.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0973, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4225/4465 (94.6249%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4191/4465 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8656, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4579/4928 (92.9180%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4452/4928 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2733, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5096/5455 (93.4189%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4886/5455 (89.5692%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9603, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4379/4647 (94.2328%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4289/4647 (92.2961%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9953, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5107/5591 (91.3432%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4959/5591 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3439, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3404/3616 (94.1372%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3361/3616 (92.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8226, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4684/4986 (93.9430%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4569/4986 (91.6366%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9041, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4849/5167 (93.8456%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4746/5167 (91.8521%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1134, Accuracy: 5426/10000 (54.2600%)
time spent on training: 235.74352884292603
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4348, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0693, Accuracy: 9724/9900 (98.2222%)
Done in 259.86755299568176 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.690809263395394.
Norm before scaling: 44.651846025843376. Distance: 1.1447006464772662
Total norm for 4 adversaries is: 44.651846025843376. distance: 1.1447006464772662
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0366, Accuracy: 9805/9900 (99.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5179/5305 (97.6249%), train_poison_data_count: 415
Global model norm: 44.690809263395394.
Norm before scaling: 44.65451962620217. Distance: 1.3195800555402981
Total norm for 4 adversaries is: 44.65451962620217. distance: 1.3195800555402981
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0355, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4608/4717 (97.6892%), train_poison_data_count: 370
Global model norm: 44.690809263395394.
Norm before scaling: 44.654685012377904. Distance: 1.1324978621675301
Total norm for 4 adversaries is: 44.654685012377904. distance: 1.1324978621675301
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0614, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4946/5066 (97.6313%), train_poison_data_count: 400
Global model norm: 44.690809263395394.
Norm before scaling: 44.652704438498176. Distance: 1.2069675959620174
Total norm for 4 adversaries is: 44.652704438498176. distance: 1.2069675959620174
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0417, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3901/4175 (93.4371%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3777/4175 (90.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0102, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4334/4596 (94.2994%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4277/4596 (93.0592%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9827, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3432/3616 (94.9115%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3426/3616 (94.7456%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8414, Accuracy: 5985/10000 (59.8500%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4167/4356 (95.6612%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3950/4356 (90.6795%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2213, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4797/5244 (91.4760%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4713/5244 (89.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1097, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3152/3297 (95.6021%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3102/3297 (94.0855%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7582, Accuracy: 6015/10000 (60.1500%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3420/3646 (93.8014%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3420/3646 (93.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7441, Accuracy: 6030/10000 (60.3000%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3626/3797 (95.4964%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3580/3797 (94.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8323, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4247/4456 (95.3097%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4209/4456 (94.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8599, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3678/3828 (96.0815%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3645/3828 (95.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7410, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5286/5582 (94.6972%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5080/5582 (91.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2948, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3314/3472 (95.4493%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3306/3472 (95.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8442, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4184/4362 (95.9193%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4100/4362 (93.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9882, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5111/5424 (94.2294%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5013/5424 (92.4226%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3089, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4462/4679 (95.3623%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4258/4679 (91.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0075, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3434/3590 (95.6546%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3239/3590 (90.2228%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1417, Accuracy: 5342/10000 (53.4200%)
time spent on training: 228.66184163093567
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4391, Accuracy: 6430/10000 (64.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0679, Accuracy: 9725/9900 (98.2323%)
Done in 252.79179692268372 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.70720582780462.
Norm before scaling: 44.668556135458. Distance: 1.1563409305593084
Total norm for 4 adversaries is: 44.668556135458. distance: 1.1563409305593084
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0975, Accuracy: 9647/9900 (97.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5162/5305 (97.3044%), train_poison_data_count: 415
Global model norm: 44.70720582780462.
Norm before scaling: 44.66943198986165. Distance: 1.303697221662401
Total norm for 4 adversaries is: 44.66943198986165. distance: 1.303697221662401
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0198, Accuracy: 9852/9900 (99.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4598/4717 (97.4772%), train_poison_data_count: 370
Global model norm: 44.70720582780462.
Norm before scaling: 44.67075188777048. Distance: 1.1470905631479893
Total norm for 4 adversaries is: 44.67075188777048. distance: 1.1470905631479893
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0827, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4946/5066 (97.6313%), train_poison_data_count: 400
Global model norm: 44.70720582780462.
Norm before scaling: 44.67152112705239. Distance: 1.2682874484707902
Total norm for 4 adversaries is: 44.67152112705239. distance: 1.2682874484707902
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0460, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3595/3804 (94.5058%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3567/3804 (93.7697%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0455, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3135/3297 (95.0864%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3097/3297 (93.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8582, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4091/4354 (93.9596%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3519/4354 (80.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.6154, Accuracy: 4593/10000 (45.9300%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4179/4433 (94.2702%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4120/4433 (92.9393%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9562, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3605/3775 (95.4967%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3581/3775 (94.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9150, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4881/5195 (93.9557%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4691/5195 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1701, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5087/5392 (94.3435%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4950/5392 (91.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1385, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4857/5244 (92.6201%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4685/5244 (89.3402%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0673, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4115/4356 (94.4674%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3824/4356 (87.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3734, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4080/4416 (92.3913%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4002/4416 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8943, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4182/4481 (93.3274%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3998/4481 (89.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2921, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4228/4441 (95.2038%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4174/4441 (93.9878%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9644, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4072/4336 (93.9114%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3998/4336 (92.2048%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0616, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3476/3646 (95.3374%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3449/3646 (94.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7649, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4419/4647 (95.0936%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4284/4647 (92.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0030, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3393/3638 (93.2655%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3406/3638 (93.6229%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9385, Accuracy: 5741/10000 (57.4100%)
time spent on training: 229.0323052406311
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4455, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0670, Accuracy: 9728/9900 (98.2626%)
Done in 253.06119966506958 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4796/4885 (98.1781%), train_poison_data_count: 385
Global model norm: 44.725509676473365.
Norm before scaling: 44.68599757089742. Distance: 1.1299061290606807
Total norm for 4 adversaries is: 44.68599757089742. distance: 1.1299061290606807
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1076, Accuracy: 9619/9900 (97.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.725509676473365.
Norm before scaling: 44.68654528044837. Distance: 1.2973573086579213
Total norm for 4 adversaries is: 44.68654528044837. distance: 1.2973573086579213
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0619, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4609/4717 (97.7104%), train_poison_data_count: 370
Global model norm: 44.725509676473365.
Norm before scaling: 44.68860766765326. Distance: 1.125785129813101
Total norm for 4 adversaries is: 44.68860766765326. distance: 1.125785129813101
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0352, Accuracy: 9814/9900 (99.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.725509676473365.
Norm before scaling: 44.689002378591425. Distance: 1.2782870667915904
Total norm for 4 adversaries is: 44.689002378591425. distance: 1.2782870667915904
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0291, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4353/4538 (95.9233%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4284/4538 (94.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8601, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5410/5740 (94.2509%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5296/5740 (92.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1785, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4596/4934 (93.1496%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4281/4934 (86.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2761, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3818/4013 (95.1408%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3816/4013 (95.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.6996, Accuracy: 6030/10000 (60.3000%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4173/4511 (92.5072%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4128/4511 (91.5096%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9448, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4198/4501 (93.2682%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4044/4501 (89.8467%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0156, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4309/4518 (95.3741%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4243/4518 (93.9132%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0168, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3606/3804 (94.7950%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3594/3804 (94.4795%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7984, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3564/3781 (94.2608%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3415/3781 (90.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1558, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4261/4441 (95.9469%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4143/4441 (93.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0336, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4378/4662 (93.9082%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4315/4662 (92.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9939, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3289/3472 (94.7293%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3290/3472 (94.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7871, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3725/3911 (95.2442%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3690/3911 (94.3493%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9872, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4350/4634 (93.8714%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4230/4634 (91.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0229, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4376/4618 (94.7596%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4172/4618 (90.3421%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0397, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4864/5195 (93.6285%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4637/5195 (89.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3392, Accuracy: 5192/10000 (51.9200%)
time spent on training: 232.62795734405518
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4435, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0644, Accuracy: 9741/9900 (98.3939%)
Done in 256.80545353889465 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4783/4885 (97.9120%), train_poison_data_count: 385
Global model norm: 44.742939823647035.
Norm before scaling: 44.703232862068404. Distance: 1.165639692116768
Total norm for 4 adversaries is: 44.703232862068404. distance: 1.165639692116768
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0701, Accuracy: 9720/9900 (98.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5165/5305 (97.3610%), train_poison_data_count: 415
Global model norm: 44.742939823647035.
Norm before scaling: 44.70367796101555. Distance: 1.2853412900779972
Total norm for 4 adversaries is: 44.70367796101555. distance: 1.2853412900779972
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0463, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.742939823647035.
Norm before scaling: 44.70606995061954. Distance: 1.137243877123545
Total norm for 4 adversaries is: 44.70606995061954. distance: 1.137243877123545
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0270, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4954/5066 (97.7892%), train_poison_data_count: 400
Global model norm: 44.742939823647035.
Norm before scaling: 44.70381722419309. Distance: 1.1821435787987349
Total norm for 4 adversaries is: 44.70381722419309. distance: 1.1821435787987349
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0450, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3046/3271 (93.1214%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3044/3271 (93.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7717, Accuracy: 5966/10000 (59.6600%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4666/4928 (94.6834%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4527/4928 (91.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9498, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4460/4804 (92.8393%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4124/4804 (85.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3069, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4382/4618 (94.8896%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4264/4618 (92.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9898, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3584/3756 (95.4207%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3587/3756 (95.5005%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8110, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4344/4634 (93.7419%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4254/4634 (91.7997%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1089, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3427/3638 (94.2001%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3414/3638 (93.8428%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8758, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3495/3704 (94.3575%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3450/3704 (93.1425%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9284, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4450/4707 (94.5400%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4373/4707 (92.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9196, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4201/4481 (93.7514%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3997/4481 (89.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2655, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4095/4354 (94.0514%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3859/4354 (88.6311%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.6948, Accuracy: 4760/10000 (47.6000%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3432/3646 (94.1306%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3461/3646 (94.9259%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7206, Accuracy: 5984/10000 (59.8400%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3996/4223 (94.6247%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3979/4223 (94.2221%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8321, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4243/4511 (94.0590%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4187/4511 (92.8176%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9263, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4237/4456 (95.0853%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4190/4456 (94.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1019, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3657/3861 (94.7164%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3601/3861 (93.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8741, Accuracy: 5813/10000 (58.1300%)
time spent on training: 227.88321733474731
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4427, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0687, Accuracy: 9729/9900 (98.2727%)
Done in 252.09088516235352 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4795/4885 (98.1576%), train_poison_data_count: 385
Global model norm: 44.75943729050333.
Norm before scaling: 44.7184510930786. Distance: 1.0992014045133043
Total norm for 4 adversaries is: 44.7184510930786. distance: 1.0992014045133043
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0580, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.75943729050333.
Norm before scaling: 44.72153697202976. Distance: 1.3388494244154678
Total norm for 4 adversaries is: 44.72153697202976. distance: 1.3388494244154678
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0318, Accuracy: 9823/9900 (99.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.75943729050333.
Norm before scaling: 44.72408221834672. Distance: 1.1596182143931966
Total norm for 4 adversaries is: 44.72408221834672. distance: 1.1596182143931966
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0832, Accuracy: 9675/9900 (97.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4946/5066 (97.6313%), train_poison_data_count: 400
Global model norm: 44.75943729050333.
Norm before scaling: 44.72235037480561. Distance: 1.2387056315431932
Total norm for 4 adversaries is: 44.72235037480561. distance: 1.2387056315431932
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0523, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3562/3804 (93.6383%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3537/3804 (92.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9839, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4210/4501 (93.5348%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4109/4501 (91.2908%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0093, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4422/4663 (94.8317%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4342/4663 (93.1160%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9126, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5164/5591 (92.3627%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4981/5591 (89.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2728, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4824/5244 (91.9908%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4741/5244 (90.4081%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1240, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4247/4433 (95.8042%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4134/4433 (93.2551%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8047, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4431/4707 (94.1364%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4300/4707 (91.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8643, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4231/4456 (94.9506%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4165/4456 (93.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8996, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4119/4356 (94.5592%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3741/4356 (85.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2965, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4338/4576 (94.7990%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4327/4576 (94.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8750, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4463/4679 (95.3836%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4167/4679 (89.0575%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2224, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4368/4634 (94.2598%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4311/4634 (93.0298%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8136, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3784/4013 (94.2935%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3769/4013 (93.9198%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8362, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4874/5232 (93.1575%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4768/5232 (91.1315%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1468, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3920/4126 (95.0073%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3895/4126 (94.4014%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7529, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3588/3756 (95.5272%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3553/3756 (94.5953%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8795, Accuracy: 5809/10000 (58.0900%)
time spent on training: 234.57183289527893
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4548, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0715, Accuracy: 9723/9900 (98.2121%)
Done in 261.3974106311798 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4774/4885 (97.7277%), train_poison_data_count: 385
Global model norm: 44.77774977597691.
Norm before scaling: 44.73939294682037. Distance: 1.22007058807095
Total norm for 4 adversaries is: 44.73939294682037. distance: 1.22007058807095
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0481, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5180/5305 (97.6437%), train_poison_data_count: 415
Global model norm: 44.77774977597691.
Norm before scaling: 44.73733153651224. Distance: 1.2345547605553986
Total norm for 4 adversaries is: 44.73733153651224. distance: 1.2345547605553986
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0438, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4607/4717 (97.6680%), train_poison_data_count: 370
Global model norm: 44.77774977597691.
Norm before scaling: 44.740169191206824. Distance: 1.1046368599471144
Total norm for 4 adversaries is: 44.740169191206824. distance: 1.1046368599471144
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0402, Accuracy: 9800/9900 (98.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4957/5066 (97.8484%), train_poison_data_count: 400
Global model norm: 44.77774977597691.
Norm before scaling: 44.73854029027643. Distance: 1.2017425918049205
Total norm for 4 adversaries is: 44.73854029027643. distance: 1.2017425918049205
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0330, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4822/5055 (95.3907%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4644/5055 (91.8694%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8646, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4206/4481 (93.8630%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4000/4481 (89.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3049, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4424/4767 (92.8047%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4259/4767 (89.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3504, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4921/5265 (93.4663%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4744/5265 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2529, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4287/4558 (94.0544%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4182/4558 (91.7508%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1528, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5196/5591 (92.9351%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5008/5591 (89.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5126, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4896/5232 (93.5780%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4794/5232 (91.6284%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9946, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3615/3756 (96.2460%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3619/3756 (96.3525%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7950, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4268/4433 (96.2779%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4196/4433 (94.6537%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8151, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4519/4793 (94.2833%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4460/4793 (93.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8813, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4055/4235 (95.7497%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3991/4235 (94.2385%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8767, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4399/4707 (93.4566%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4360/4707 (92.6280%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8735, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3850/4025 (95.6522%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3804/4025 (94.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8099, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3634/3837 (94.7094%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3650/3837 (95.1264%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0027, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5853/6391 (91.5819%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5629/6391 (88.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3718, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4101/4354 (94.1893%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0125, Accuracy: 3362/4354 (77.2164%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.8458, Accuracy: 4276/10000 (42.7600%)
time spent on training: 235.33063173294067
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4640, Accuracy: 6412/10000 (64.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0699, Accuracy: 9724/9900 (98.2222%)
Done in 259.7781913280487 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 44.79739137956654.
Norm before scaling: 44.75833001206312. Distance: 1.1304535079803766
Total norm for 4 adversaries is: 44.75833001206312. distance: 1.1304535079803766
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0542, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.79739137956654.
Norm before scaling: 44.75675222932499. Distance: 1.2512437831331698
Total norm for 4 adversaries is: 44.75675222932499. distance: 1.2512437831331698
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0303, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4619/4717 (97.9224%), train_poison_data_count: 370
Global model norm: 44.79739137956654.
Norm before scaling: 44.75864638012693. Distance: 1.0764509832595033
Total norm for 4 adversaries is: 44.75864638012693. distance: 1.0764509832595033
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0263, Accuracy: 9823/9900 (99.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4933/5066 (97.3747%), train_poison_data_count: 400
Global model norm: 44.79739137956654.
Norm before scaling: 44.76122905990322. Distance: 1.2732247953109188
Total norm for 4 adversaries is: 44.76122905990322. distance: 1.2732247953109188
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0128, Accuracy: 9870/9900 (99.6970%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5117/5424 (94.3400%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5014/5424 (92.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1686, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4325/4576 (94.5149%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4301/4576 (93.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8988, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4617/4934 (93.5752%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4117/4934 (83.4414%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4520, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5269/5582 (94.3927%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5069/5582 (90.8097%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1471, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4619/4956 (93.2002%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4511/4956 (91.0210%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9903, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5526/5902 (93.6293%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5097/5902 (86.3606%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1560, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3145/3297 (95.3897%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3140/3297 (95.2381%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.6962, Accuracy: 6135/10000 (61.3500%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3288/3472 (94.7005%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3290/3472 (94.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9453, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4684/4928 (95.0487%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4643/4928 (94.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9201, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4219/4481 (94.1531%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4000/4481 (89.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1441, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4695/5025 (93.4328%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4657/5025 (92.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1772, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4672/4986 (93.7024%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4615/4986 (92.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9080, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4560/4928 (92.5325%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4510/4928 (91.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9990, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4519/4804 (94.0674%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4271/4804 (88.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4479, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3466/3646 (95.0631%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3430/3646 (94.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7674, Accuracy: 5990/10000 (59.9000%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4465/4707 (94.8587%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4331/4707 (92.0119%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8840, Accuracy: 5775/10000 (57.7500%)
time spent on training: 235.96176481246948
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4695, Accuracy: 6420/10000 (64.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0711, Accuracy: 9722/9900 (98.2020%)
Done in 260.3053138256073 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.8167233997429.
Norm before scaling: 44.77778521575319. Distance: 1.135290973017185
Total norm for 4 adversaries is: 44.77778521575319. distance: 1.135290973017185
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0413, Accuracy: 9789/9900 (98.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5305 (97.6060%), train_poison_data_count: 415
Global model norm: 44.8167233997429.
Norm before scaling: 44.7770900457896. Distance: 1.2716784351115973
Total norm for 4 adversaries is: 44.7770900457896. distance: 1.2716784351115973
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0744, Accuracy: 9705/9900 (98.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 44.8167233997429.
Norm before scaling: 44.77917961238027. Distance: 1.158177341733856
Total norm for 4 adversaries is: 44.77917961238027. distance: 1.158177341733856
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0237, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4942/5066 (97.5523%), train_poison_data_count: 400
Global model norm: 44.8167233997429.
Norm before scaling: 44.778981973270675. Distance: 1.2323887453296436
Total norm for 4 adversaries is: 44.778981973270675. distance: 1.2323887453296436
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0142, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4875/5116 (95.2893%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4727/5116 (92.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0711, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4400/4651 (94.6033%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4252/4651 (91.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1275, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5151/5591 (92.1302%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5021/5591 (89.8050%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5763, Accuracy: 4768/10000 (47.6800%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4502/4804 (93.7136%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4216/4804 (87.7602%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2889, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4251/4456 (95.3995%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4190/4456 (94.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9925, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4690/5063 (92.6328%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4267/5063 (84.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3324, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4009/4223 (94.9325%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4014/4223 (95.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8367, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4614/4934 (93.5144%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4072/4934 (82.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4365, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3679/3828 (96.1076%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0023, Accuracy: 3659/3828 (95.5852%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7376, Accuracy: 6047/10000 (60.4700%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5536/5902 (93.7987%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5003/5902 (84.7679%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2596, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4083/4416 (92.4592%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4041/4416 (91.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0800, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4316/4538 (95.1080%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4297/4538 (94.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8307, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4664/5025 (92.8159%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4621/5025 (91.9602%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9740, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4293/4625 (92.8216%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4114/4625 (88.9514%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3078, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4886/5197 (94.0158%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4767/5197 (91.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1641, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3582/3804 (94.1640%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3522/3804 (92.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0858, Accuracy: 5651/10000 (56.5100%)
time spent on training: 237.19439554214478
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4847, Accuracy: 6377/10000 (63.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0671, Accuracy: 9732/9900 (98.3030%)
Done in 261.54548740386963 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.83706123896698.
Norm before scaling: 44.79858216358178. Distance: 1.1706106358760417
Total norm for 4 adversaries is: 44.79858216358178. distance: 1.1706106358760417
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0590, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5184/5305 (97.7191%), train_poison_data_count: 415
Global model norm: 44.83706123896698.
Norm before scaling: 44.79607657554956. Distance: 1.211082991196789
Total norm for 4 adversaries is: 44.79607657554956. distance: 1.211082991196789
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0494, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.83706123896698.
Norm before scaling: 44.79790230335847. Distance: 1.095783849452281
Total norm for 4 adversaries is: 44.79790230335847. distance: 1.095783849452281
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0174, Accuracy: 9858/9900 (99.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4938/5066 (97.4734%), train_poison_data_count: 400
Global model norm: 44.83706123896698.
Norm before scaling: 44.79955220679876. Distance: 1.2470730368540377
Total norm for 4 adversaries is: 44.79955220679876. distance: 1.2470730368540377
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0259, Accuracy: 9841/9900 (99.4040%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4479/4804 (93.2348%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3905/4804 (81.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5434, Accuracy: 4729/10000 (47.2900%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3704/3911 (94.7072%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3554/3911 (90.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2296, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3804/4013 (94.7919%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3749/4013 (93.4214%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8110, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4883/5232 (93.3295%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4711/5232 (90.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2222, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5172/5591 (92.5058%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4917/5591 (87.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3801, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3661/3837 (95.4131%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3632/3837 (94.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0079, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5131/5424 (94.5981%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4957/5424 (91.3901%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2132, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4858/5167 (94.0197%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4770/5167 (92.3166%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2349, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4272/4456 (95.8707%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4236/4456 (95.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9346, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4657/4928 (94.5008%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4566/4928 (92.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9626, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4224/4433 (95.2854%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4089/4433 (92.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0088, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3114/3297 (94.4495%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3091/3297 (93.7519%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7605, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4412/4716 (93.5539%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3314, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4348/4596 (94.6040%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4317/4596 (93.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8920, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4530/4793 (94.5128%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4448/4793 (92.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9441, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4116/4416 (93.2065%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4076/4416 (92.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9249, Accuracy: 5775/10000 (57.7500%)
time spent on training: 235.3696849346161
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.4863, Accuracy: 6369/10000 (63.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0678, Accuracy: 9729/9900 (98.2727%)
Done in 259.8048942089081 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.855399183793914.
Norm before scaling: 44.81510817680169. Distance: 1.1430449746529157
Total norm for 4 adversaries is: 44.81510817680169. distance: 1.1430449746529157
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0651, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.855399183793914.
Norm before scaling: 44.81469959516283. Distance: 1.2478122639912592
Total norm for 4 adversaries is: 44.81469959516283. distance: 1.2478122639912592
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0351, Accuracy: 9808/9900 (99.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4620/4717 (97.9436%), train_poison_data_count: 370
Global model norm: 44.855399183793914.
Norm before scaling: 44.81637203242178. Distance: 1.0893137747301713
Total norm for 4 adversaries is: 44.81637203242178. distance: 1.0893137747301713
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0266, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 44.855399183793914.
Norm before scaling: 44.81693040555726. Distance: 1.2166517731438673
Total norm for 4 adversaries is: 44.81693040555726. distance: 1.2166517731438673
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0280, Accuracy: 9828/9900 (99.2727%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3061/3271 (93.5799%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2969/3271 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9355, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4864/5116 (95.0743%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4698/5116 (91.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0007, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4218/4501 (93.7125%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4118/4501 (91.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0777, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4131/4356 (94.8347%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3934/4356 (90.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3175, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4060/4368 (92.9487%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3889/4368 (89.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0279, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3660/3837 (95.3870%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3645/3837 (94.9961%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7686, Accuracy: 5978/10000 (59.7800%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5421/5740 (94.4425%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5273/5740 (91.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2511, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3422/3590 (95.3203%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3434/3590 (95.6546%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8949, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3170/3297 (96.1480%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3132/3297 (94.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7048, Accuracy: 6090/10000 (60.9000%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4355/4716 (92.3452%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4328/4716 (91.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0598, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4757/5055 (94.1048%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4642/5055 (91.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1556, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3689/3911 (94.3237%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3262/3911 (83.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.5151, Accuracy: 4889/10000 (48.8900%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3849/4158 (92.5685%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3795/4158 (91.2698%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8577, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4256/4456 (95.5117%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4222/4456 (94.7487%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9626, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4234/4511 (93.8595%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9857, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3410/3672 (92.8649%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3358/3672 (91.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9311, Accuracy: 5744/10000 (57.4400%)
time spent on training: 229.98955035209656
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5039, Accuracy: 6347/10000 (63.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0656, Accuracy: 9734/9900 (98.3232%)
Done in 254.11051034927368 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.87268638490944.
Norm before scaling: 44.83366202951263. Distance: 1.1534926554624219
Total norm for 4 adversaries is: 44.83366202951263. distance: 1.1534926554624219
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0781, Accuracy: 9711/9900 (98.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5178/5305 (97.6060%), train_poison_data_count: 415
Global model norm: 44.87268638490944.
Norm before scaling: 44.8297724296449. Distance: 1.2134212494183705
Total norm for 4 adversaries is: 44.8297724296449. distance: 1.2134212494183705
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0387, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.87268638490944.
Norm before scaling: 44.83420112838314. Distance: 1.0881227420299224
Total norm for 4 adversaries is: 44.83420112838314. distance: 1.0881227420299224
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0499, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4956/5066 (97.8287%), train_poison_data_count: 400
Global model norm: 44.87268638490944.
Norm before scaling: 44.83381314121352. Distance: 1.2048218885933484
Total norm for 4 adversaries is: 44.83381314121352. distance: 1.2048218885933484
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0394, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4735/5063 (93.5216%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4168/5063 (82.3227%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.4668, Accuracy: 4811/10000 (48.1100%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4793/5083 (94.2947%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4600/5083 (90.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2901, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3611/3797 (95.1014%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3499/3797 (92.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9391, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5619/6124 (91.7538%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5416/6124 (88.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2161, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4918/5232 (93.9985%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4787/5232 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1430, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3628/3861 (93.9653%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3589/3861 (92.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8646, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4704/5037 (93.3889%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4643/5037 (92.1779%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0349, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4842/5116 (94.6443%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4730/5116 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9964, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4103/4368 (93.9332%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3957/4368 (90.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0631, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3432/3672 (93.4641%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3384/3672 (92.1569%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9785, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5468/5902 (92.6466%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5126/5902 (86.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2557, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4127/4361 (94.6343%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3810/4361 (87.3653%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1852, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3811/4158 (91.6546%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3716/4158 (89.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1420, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4722/5025 (93.9701%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4656/5025 (92.6567%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1827, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4271/4456 (95.8483%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4215/4456 (94.5916%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8902, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4242/4433 (95.6914%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4174/4433 (94.1575%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8248, Accuracy: 5953/10000 (59.5300%)
time spent on training: 236.43163895606995
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5199, Accuracy: 6314/10000 (63.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0656, Accuracy: 9734/9900 (98.3232%)
Done in 260.6188910007477 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.89301926481374.
Norm before scaling: 44.85495695111007. Distance: 1.1965213223194204
Total norm for 4 adversaries is: 44.85495695111007. distance: 1.1965213223194204
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0149, Accuracy: 9861/9900 (99.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.89301926481374.
Norm before scaling: 44.852585148809986. Distance: 1.2561131720732444
Total norm for 4 adversaries is: 44.852585148809986. distance: 1.2561131720732444
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0227, Accuracy: 9845/9900 (99.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4620/4717 (97.9436%), train_poison_data_count: 370
Global model norm: 44.89301926481374.
Norm before scaling: 44.85371323335798. Distance: 1.0946449433117706
Total norm for 4 adversaries is: 44.85371323335798. distance: 1.0946449433117706
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1136, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.89301926481374.
Norm before scaling: 44.85408199790739. Distance: 1.2098270862549612
Total norm for 4 adversaries is: 44.85408199790739. distance: 1.2098270862549612
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0550, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3803/4025 (94.4845%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3792/4025 (94.2112%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9224, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4578/4928 (92.8977%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1086, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3896/4175 (93.3174%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3782/4175 (90.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0203, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4115/4416 (93.1839%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4072/4416 (92.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0735, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3621/3797 (95.3648%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3529/3797 (92.9418%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8377, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4899/5195 (94.3022%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4738/5195 (91.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1629, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4871/5232 (93.1002%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4751/5232 (90.8066%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1268, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5143/5455 (94.2805%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4983/5455 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9066, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4437/4716 (94.0840%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4290/4716 (90.9669%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2348, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4450/4679 (95.1058%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1056, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5916/6263 (94.4595%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5754/6263 (91.8729%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.4794, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4675/4918 (95.0590%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4618/4918 (93.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9699, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4251/4456 (95.3995%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4188/4456 (93.9856%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9118, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5483/5902 (92.9007%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5261/5902 (89.1393%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0751, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4239/4481 (94.5994%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4044/4481 (90.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0730, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5189/5591 (92.8099%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4997/5591 (89.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1732, Accuracy: 5313/10000 (53.1300%)
time spent on training: 241.3801507949829
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5263, Accuracy: 6299/10000 (62.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0699, Accuracy: 9718/9900 (98.1616%)
Done in 265.8335111141205 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4792/4885 (98.0962%), train_poison_data_count: 385
Global model norm: 44.91295563625684.
Norm before scaling: 44.87282648374877. Distance: 1.0974583023074953
Total norm for 4 adversaries is: 44.87282648374877. distance: 1.0974583023074953
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0942, Accuracy: 9656/9900 (97.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.91295563625684.
Norm before scaling: 44.87221167782322. Distance: 1.272093408750652
Total norm for 4 adversaries is: 44.87221167782322. distance: 1.272093408750652
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0298, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4614/4717 (97.8164%), train_poison_data_count: 370
Global model norm: 44.91295563625684.
Norm before scaling: 44.872426588816765. Distance: 1.0603943885506535
Total norm for 4 adversaries is: 44.872426588816765. distance: 1.0603943885506535
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0430, Accuracy: 9788/9900 (98.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4960/5066 (97.9076%), train_poison_data_count: 400
Global model norm: 44.91295563625684.
Norm before scaling: 44.87447363244568. Distance: 1.2119464239799458
Total norm for 4 adversaries is: 44.87447363244568. distance: 1.2119464239799458
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0391, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4204/4501 (93.4015%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4501 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1187, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4772/5083 (93.8816%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4567/5083 (89.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3962, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3569/3804 (93.8223%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3564/3804 (93.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8877, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3627/3756 (96.5655%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3589/3756 (95.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8087, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3946/4175 (94.5150%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3808/4175 (91.2096%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0162, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4615/4934 (93.5347%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3980/4934 (80.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.8038, Accuracy: 4354/10000 (43.5400%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4090/4336 (94.3266%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4018/4336 (92.6661%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9255, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4073/4356 (93.5032%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4083/4356 (93.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0466, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4840/5244 (92.2960%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4684/5244 (89.3211%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1505, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4749/5017 (94.6582%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0139, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3659/3828 (95.5852%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3639/3828 (95.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8540, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4325/4538 (95.3063%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4274/4538 (94.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0003, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3393/3638 (93.2655%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3405/3638 (93.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8801, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4422/4662 (94.8520%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4334/4662 (92.9644%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9930, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3630/3797 (95.6018%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3585/3797 (94.4166%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8974, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4337/4634 (93.5909%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9151, Accuracy: 5730/10000 (57.3000%)
time spent on training: 230.3522915840149
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5320, Accuracy: 6292/10000 (62.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0663, Accuracy: 9727/9900 (98.2525%)
Done in 254.6805465221405 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.93045706065861.
Norm before scaling: 44.89013280708245. Distance: 1.1688838678080102
Total norm for 4 adversaries is: 44.89013280708245. distance: 1.1688838678080102
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0356, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5199/5305 (98.0019%), train_poison_data_count: 415
Global model norm: 44.93045706065861.
Norm before scaling: 44.88758473867663. Distance: 1.204980583509345
Total norm for 4 adversaries is: 44.88758473867663. distance: 1.204980583509345
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0444, Accuracy: 9787/9900 (98.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 44.93045706065861.
Norm before scaling: 44.891631123427395. Distance: 1.1001299477894944
Total norm for 4 adversaries is: 44.891631123427395. distance: 1.1001299477894944
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0724, Accuracy: 9717/9900 (98.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4959/5066 (97.8879%), train_poison_data_count: 400
Global model norm: 44.93045706065861.
Norm before scaling: 44.888979803650024. Distance: 1.169842394133422
Total norm for 4 adversaries is: 44.888979803650024. distance: 1.169842394133422
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0918, Accuracy: 9651/9900 (97.4848%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3938/4175 (94.3234%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3807/4175 (91.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1409, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4219/4465 (94.4905%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4218/4465 (94.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8280, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4659/4918 (94.7336%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4522/4918 (91.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1768, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4706/5037 (93.4286%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4666/5037 (92.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9358, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3537/3781 (93.5467%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3139/3781 (83.0204%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5083, Accuracy: 4848/10000 (48.4800%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4405/4634 (95.0583%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4317/4634 (93.1593%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8734, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4348/4576 (95.0175%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4322/4576 (94.4493%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8135, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3677/3861 (95.2344%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8989, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5690/6124 (92.9131%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5458/6124 (89.1248%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0134, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3983/4223 (94.3168%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4007/4223 (94.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9789, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4751/5083 (93.4684%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4539/5083 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1288, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4151/4356 (95.2938%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3651/4356 (83.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.7707, Accuracy: 4348/10000 (43.4800%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4548/4793 (94.8884%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4483/4793 (93.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0174, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4728/5055 (93.5312%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4707/5055 (93.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9369, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4179/4362 (95.8047%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4019/4362 (92.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0538, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4207/4433 (94.9019%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4198/4433 (94.6988%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7695, Accuracy: 5995/10000 (59.9500%)
time spent on training: 234.42862701416016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5364, Accuracy: 6282/10000 (62.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0644, Accuracy: 9731/9900 (98.2929%)
Done in 259.00267338752747 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.94891984806545.
Norm before scaling: 44.909102803868585. Distance: 1.1500705863187812
Total norm for 4 adversaries is: 44.909102803868585. distance: 1.1500705863187812
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0396, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5157/5305 (97.2102%), train_poison_data_count: 415
Global model norm: 44.94891984806545.
Norm before scaling: 44.90797475158574. Distance: 1.2700851405883236
Total norm for 4 adversaries is: 44.90797475158574. distance: 1.2700851405883236
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0508, Accuracy: 9774/9900 (98.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 44.94891984806545.
Norm before scaling: 44.90990601418717. Distance: 1.0980317366135623
Total norm for 4 adversaries is: 44.90990601418717. distance: 1.0980317366135623
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0263, Accuracy: 9829/9900 (99.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4937/5066 (97.4536%), train_poison_data_count: 400
Global model norm: 44.94891984806545.
Norm before scaling: 44.91129630875525. Distance: 1.253208287008886
Total norm for 4 adversaries is: 44.91129630875525. distance: 1.253208287008886
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0180, Accuracy: 9858/9900 (99.5758%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4717/5025 (93.8706%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4683/5025 (93.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0130, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4237/4441 (95.4064%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4195/4441 (94.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8872, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5206/5591 (93.1139%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5023/5591 (89.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1045, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4237/4481 (94.5548%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4057/4481 (90.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2120, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4447/4767 (93.2872%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4282/4767 (89.8259%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1930, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4793/5055 (94.8170%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4715/5055 (93.2740%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9422, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4284/4518 (94.8207%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4274/4518 (94.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8863, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4277/4625 (92.4757%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4085/4625 (88.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2738, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4535/4793 (94.6172%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4468/4793 (93.2193%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0463, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4794/5083 (94.3144%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4665/5083 (91.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0415, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4850/5244 (92.4867%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4693/5244 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1605, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5907/6263 (94.3158%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5671/6263 (90.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1755, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3980/4175 (95.3293%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3815/4175 (91.3772%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0082, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4132/4416 (93.5688%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4126/4416 (93.4330%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9091, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4931/5265 (93.6562%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4707/5265 (89.4017%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1202, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3829/4025 (95.1304%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3812/4025 (94.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8662, Accuracy: 5809/10000 (58.0900%)
time spent on training: 237.2623279094696
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5440, Accuracy: 6284/10000 (62.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0620, Accuracy: 9736/9900 (98.3434%)
Done in 261.56953382492065 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.96834009976491.
Norm before scaling: 44.9277686351242. Distance: 1.1629305462684931
Total norm for 4 adversaries is: 44.9277686351242. distance: 1.1629305462684931
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0492, Accuracy: 9775/9900 (98.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5183/5305 (97.7003%), train_poison_data_count: 415
Global model norm: 44.96834009976491.
Norm before scaling: 44.92691547808507. Distance: 1.2507909179923824
Total norm for 4 adversaries is: 44.92691547808507. distance: 1.2507909179923824
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0160, Accuracy: 9854/9900 (99.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 44.96834009976491.
Norm before scaling: 44.929844401786546. Distance: 1.1269575677582488
Total norm for 4 adversaries is: 44.929844401786546. distance: 1.1269575677582488
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0210, Accuracy: 9835/9900 (99.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4965/5066 (98.0063%), train_poison_data_count: 400
Global model norm: 44.96834009976491.
Norm before scaling: 44.929003510486545. Distance: 1.1948817854631852
Total norm for 4 adversaries is: 44.929003510486545. distance: 1.1948817854631852
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0484, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4065/4295 (94.6449%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3864/4295 (89.9651%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0992, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4007/4223 (94.8852%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3966/4223 (93.9143%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9734, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4573/4793 (95.4100%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4446/4793 (92.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0629, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4472/4707 (95.0074%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4383/4707 (93.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8470, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5118/5455 (93.8222%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4945/5455 (90.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2353, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4411/4651 (94.8398%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4308/4651 (92.6252%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0655, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3629/3837 (94.5791%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3647/3837 (95.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9752, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4280/4441 (96.3747%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4221/4441 (95.0462%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9202, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3447/3638 (94.7499%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3392/3638 (93.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8122, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4045/4235 (95.5136%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4032/4235 (95.2066%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8783, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4154/4362 (95.2315%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4077/4362 (93.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9715, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3658/3797 (96.3392%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3580/3797 (94.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9249, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3886/4158 (93.4584%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3775/4158 (90.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0344, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3945/4126 (95.6132%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3903/4126 (94.5952%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7247, Accuracy: 6029/10000 (60.2900%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4900/5195 (94.3215%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4627/5195 (89.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3819, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3839/4046 (94.8838%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3810/4046 (94.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9375, Accuracy: 5749/10000 (57.4900%)
time spent on training: 231.00296354293823
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5486, Accuracy: 6275/10000 (62.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0583, Accuracy: 9743/9900 (98.4141%)
Done in 255.09317445755005 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4792/4885 (98.0962%), train_poison_data_count: 385
Global model norm: 44.98424338943929.
Norm before scaling: 44.943376647646176. Distance: 1.1056391176968834
Total norm for 4 adversaries is: 44.943376647646176. distance: 1.1056391176968834
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0264, Accuracy: 9831/9900 (99.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5190/5305 (97.8322%), train_poison_data_count: 415
Global model norm: 44.98424338943929.
Norm before scaling: 44.942387979553196. Distance: 1.2270033706146182
Total norm for 4 adversaries is: 44.942387979553196. distance: 1.2270033706146182
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0624, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4616/4717 (97.8588%), train_poison_data_count: 370
Global model norm: 44.98424338943929.
Norm before scaling: 44.9454082379912. Distance: 1.0808210525364021
Total norm for 4 adversaries is: 44.9454082379912. distance: 1.0808210525364021
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0764, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4967/5066 (98.0458%), train_poison_data_count: 400
Global model norm: 44.98424338943929.
Norm before scaling: 44.94405159125621. Distance: 1.1721866447590021
Total norm for 4 adversaries is: 44.94405159125621. distance: 1.1721866447590021
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0233, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4081/4361 (93.5795%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3775/4361 (86.5627%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1741, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3128/3297 (94.8741%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3111/3297 (94.3585%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9054, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4422/4716 (93.7659%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4281/4716 (90.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1919, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4837/5167 (93.6133%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4769/5167 (92.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1549, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4084/4368 (93.4982%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4038/4368 (92.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0022, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4396/4679 (93.9517%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4271/4679 (91.2802%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0720, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4106/4356 (94.2608%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3892/4356 (89.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5592, Accuracy: 4710/10000 (47.1000%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5458/5902 (92.4771%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5138/5902 (87.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1888, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3688/3861 (95.5193%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3604/3861 (93.3437%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8504, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4173/4356 (95.7989%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3823/4356 (87.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1341, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5887/6263 (93.9965%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5753/6263 (91.8569%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2340, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4029/4235 (95.1358%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3968/4235 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0817, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4859/5232 (92.8708%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4750/5232 (90.7875%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1513, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4744/5017 (94.5585%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4614/5017 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9118, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4483/4804 (93.3181%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3998/4804 (83.2223%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3806, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4521/4793 (94.3251%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4481/4793 (93.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9516, Accuracy: 5705/10000 (57.0500%)
time spent on training: 237.28007292747498
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5606, Accuracy: 6253/10000 (62.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0542, Accuracy: 9749/9900 (98.4747%)
Done in 261.6388339996338 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4771/4885 (97.6663%), train_poison_data_count: 385
Global model norm: 45.004268189511066.
Norm before scaling: 44.96554534924143. Distance: 1.184138811460776
Total norm for 4 adversaries is: 44.96554534924143. distance: 1.184138811460776
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0506, Accuracy: 9775/9900 (98.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5173/5305 (97.5118%), train_poison_data_count: 415
Global model norm: 45.004268189511066.
Norm before scaling: 44.96311422293834. Distance: 1.248334490330308
Total norm for 4 adversaries is: 44.96311422293834. distance: 1.248334490330308
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0500, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4604/4717 (97.6044%), train_poison_data_count: 370
Global model norm: 45.004268189511066.
Norm before scaling: 44.964866656073134. Distance: 1.0952804212457399
Total norm for 4 adversaries is: 44.964866656073134. distance: 1.0952804212457399
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0220, Accuracy: 9849/9900 (99.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4955/5066 (97.8089%), train_poison_data_count: 400
Global model norm: 45.004268189511066.
Norm before scaling: 44.96385809910277. Distance: 1.1719287605669788
Total norm for 4 adversaries is: 44.96385809910277. distance: 1.1719287605669788
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0650, Accuracy: 9735/9900 (98.3333%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3651/3837 (95.1525%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3636/3837 (94.7615%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8274, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3688/3861 (95.5193%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3660/3861 (94.7941%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7960, Accuracy: 6014/10000 (60.1400%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3926/4175 (94.0359%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3720/4175 (89.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1594, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4218/4441 (94.9786%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4162/4441 (93.7176%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0304, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4117/4336 (94.9493%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4050/4336 (93.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1143, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3830/4046 (94.6614%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3819/4046 (94.3895%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8934, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4621/4956 (93.2405%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4438/4956 (89.5480%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2954, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4396/4618 (95.1927%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4310/4618 (93.3304%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9521, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3399/3616 (93.9989%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3359/3616 (92.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9299, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4378/4576 (95.6731%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4246/4576 (92.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9269, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4007/4223 (94.8852%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3984/4223 (94.3405%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9214, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4244/4503 (94.2483%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4145/4503 (92.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9639, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3464/3590 (96.4903%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3364/3590 (93.7047%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0229, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4482/4707 (95.2199%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4409/4707 (93.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9270, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3847/4013 (95.8634%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3801/4013 (94.7172%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8100, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3481/3704 (93.9795%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3454/3704 (93.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9502, Accuracy: 5754/10000 (57.5400%)
time spent on training: 228.11554479599
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5751, Accuracy: 6216/10000 (62.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0507, Accuracy: 9767/9900 (98.6566%)
Done in 252.46468114852905 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4776/4885 (97.7687%), train_poison_data_count: 385
Global model norm: 45.01951616729682.
Norm before scaling: 44.97913877348795. Distance: 1.1720928244009285
Total norm for 4 adversaries is: 44.97913877348795. distance: 1.1720928244009285
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0638, Accuracy: 9728/9900 (98.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5186/5305 (97.7568%), train_poison_data_count: 415
Global model norm: 45.01951616729682.
Norm before scaling: 44.97795684068475. Distance: 1.2479694085712254
Total norm for 4 adversaries is: 44.97795684068475. distance: 1.2479694085712254
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0631, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4605/4717 (97.6256%), train_poison_data_count: 370
Global model norm: 45.01951616729682.
Norm before scaling: 44.980153772507684. Distance: 1.0950453036442767
Total norm for 4 adversaries is: 44.980153772507684. distance: 1.0950453036442767
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0356, Accuracy: 9802/9900 (99.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4969/5066 (98.0853%), train_poison_data_count: 400
Global model norm: 45.01951616729682.
Norm before scaling: 44.97784013840177. Distance: 1.1314520723893955
Total norm for 4 adversaries is: 44.97784013840177. distance: 1.1314520723893955
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0302, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4412/4596 (95.9965%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4377/4596 (95.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8288, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4109/4356 (94.3297%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3868/4356 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4727, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4066/4295 (94.6682%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3977/4295 (92.5960%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9172, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4394/4634 (94.8209%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0129, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4436/4767 (93.0564%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4319/4767 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2060, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4033/4223 (95.5008%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3983/4223 (94.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8605, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3878/4046 (95.8478%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3817/4046 (94.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7618, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4769/5083 (93.8225%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4565/5083 (89.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1617, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4156/4362 (95.2774%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4136/4362 (94.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8354, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4426/4663 (94.9174%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0182, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3171/3297 (96.1783%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3130/3297 (94.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.7324, Accuracy: 6062/10000 (60.6200%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4252/4433 (95.9170%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4189/4433 (94.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9508, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4957/5265 (94.1500%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4807/5265 (91.3010%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9594, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4713/4986 (94.5247%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4586/4986 (91.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9586, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4405/4647 (94.7923%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4307/4647 (92.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9401, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4721/5017 (94.1001%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4605/5017 (91.7879%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9068, Accuracy: 5804/10000 (58.0400%)
time spent on training: 233.43780517578125
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5713, Accuracy: 6221/10000 (62.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0512, Accuracy: 9765/9900 (98.6364%)
Done in 257.40557837486267 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4783/4885 (97.9120%), train_poison_data_count: 385
Global model norm: 45.03637039330684.
Norm before scaling: 44.99468691507851. Distance: 1.1314151959433691
Total norm for 4 adversaries is: 44.99468691507851. distance: 1.1314151959433691
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0638, Accuracy: 9749/9900 (98.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5194/5305 (97.9076%), train_poison_data_count: 415
Global model norm: 45.03637039330684.
Norm before scaling: 44.99311470762777. Distance: 1.2151556565218409
Total norm for 4 adversaries is: 44.99311470762777. distance: 1.2151556565218409
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0353, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 45.03637039330684.
Norm before scaling: 44.9981404238171. Distance: 1.1604069910838868
Total norm for 4 adversaries is: 44.9981404238171. distance: 1.1604069910838868
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0238, Accuracy: 9836/9900 (99.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 45.03637039330684.
Norm before scaling: 44.99584941796021. Distance: 1.1794311548074177
Total norm for 4 adversaries is: 44.99584941796021. distance: 1.1794311548074177
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0416, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3973/4184 (94.9570%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3897/4184 (93.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1023, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5951/6391 (93.1153%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5686/6391 (88.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4246, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4593/4934 (93.0888%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4166/4934 (84.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.8315, Accuracy: 4540/10000 (45.4000%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4408/4618 (95.4526%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4271/4618 (92.4859%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9846, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4067/4235 (96.0331%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4007/4235 (94.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9230, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4225/4465 (94.6249%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4225/4465 (94.6249%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7911, Accuracy: 5991/10000 (59.9100%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4274/4503 (94.9145%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4205/4503 (93.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9680, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4687/5025 (93.2736%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4597/5025 (91.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0889, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5321/5582 (95.3243%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5129/5582 (91.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3656, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3590/3804 (94.3743%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3607/3804 (94.8212%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8689, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3846/4158 (92.4964%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3754/4158 (90.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0352, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4328/4538 (95.3724%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4302/4538 (94.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8614, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4080/4368 (93.4066%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0799, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4765/5083 (93.7439%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4624/5083 (90.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1161, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4836/5116 (94.5270%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4723/5116 (92.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9608, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4129/4356 (94.7888%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3952/4356 (90.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3731, Accuracy: 5127/10000 (51.2700%)
time spent on training: 235.5372452735901
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.5667, Accuracy: 6225/10000 (62.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0527, Accuracy: 9764/9900 (98.6263%)
Done in 259.64539432525635 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 45.05513251362504.
Norm before scaling: 45.01470028987753. Distance: 1.1706286605557767
Total norm for 4 adversaries is: 45.01470028987753. distance: 1.1706286605557767
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0593, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5305 (98.1338%), train_poison_data_count: 415
Global model norm: 45.05513251362504.
Norm before scaling: 45.011151775750946. Distance: 1.1955014746388426
Total norm for 4 adversaries is: 45.011151775750946. distance: 1.1955014746388426
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0637, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4614/4717 (97.8164%), train_poison_data_count: 370
Global model norm: 45.05513251362504.
Norm before scaling: 45.01537551996123. Distance: 1.0967983273392548
Total norm for 4 adversaries is: 45.01537551996123. distance: 1.0967983273392548
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0367, Accuracy: 9806/9900 (99.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4940/5066 (97.5128%), train_poison_data_count: 400
Global model norm: 45.05513251362504.
Norm before scaling: 45.0161998835211. Distance: 1.269051094219971
Total norm for 4 adversaries is: 45.0161998835211. distance: 1.269051094219971
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0112, Accuracy: 9875/9900 (99.7475%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5882/6263 (93.9167%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5711/6263 (91.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3280, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4260/4433 (96.0975%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4181/4433 (94.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9945, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3460/3672 (94.2266%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3385/3672 (92.1841%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9504, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5144/5455 (94.2988%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4977/5455 (91.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1506, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4700/5025 (93.5323%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4651/5025 (92.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2532, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4424/4618 (95.7990%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4239/4618 (91.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0587, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4440/4707 (94.3276%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4376/4707 (92.9679%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8829, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4200/4362 (96.2861%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4058/4362 (93.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1434, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4627/4989 (92.7440%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4552/4989 (91.2407%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1210, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4794/5083 (94.3144%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4652/5083 (91.5208%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2392, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4402/4647 (94.7278%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4333/4647 (93.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0476, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4119/4368 (94.2995%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3981/4368 (91.1401%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1023, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4118/4354 (94.5797%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3644/4354 (83.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.7896, Accuracy: 4557/10000 (45.5700%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4429/4767 (92.9096%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4321/4767 (90.6440%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1489, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4443/4662 (95.3024%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4394/4662 (94.2514%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8761, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4561/4804 (94.9417%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4461/4804 (92.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2134, Accuracy: 5510/10000 (55.1000%)
time spent on training: 237.63545942306519
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.5792, Accuracy: 6204/10000 (62.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0541, Accuracy: 9759/9900 (98.5758%)
Done in 262.16644620895386 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4797/4885 (98.1986%), train_poison_data_count: 385
Global model norm: 45.073751412615415.
Norm before scaling: 45.03209846962636. Distance: 1.1097089238033764
Total norm for 4 adversaries is: 45.03209846962636. distance: 1.1097089238033764
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0563, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5192/5305 (97.8699%), train_poison_data_count: 415
Global model norm: 45.073751412615415.
Norm before scaling: 45.03145466426426. Distance: 1.2193640115889015
Total norm for 4 adversaries is: 45.03145466426426. distance: 1.2193640115889015
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0332, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4623/4717 (98.0072%), train_poison_data_count: 370
Global model norm: 45.073751412615415.
Norm before scaling: 45.03289677549277. Distance: 1.0427208080682437
Total norm for 4 adversaries is: 45.03289677549277. distance: 1.0427208080682437
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0655, Accuracy: 9740/9900 (98.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4964/5066 (97.9866%), train_poison_data_count: 400
Global model norm: 45.073751412615415.
Norm before scaling: 45.03109684004141. Distance: 1.1446783081985321
Total norm for 4 adversaries is: 45.03109684004141. distance: 1.1446783081985321
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0543, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4045/4235 (95.5136%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3923/4235 (92.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9837, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3580/3775 (94.8344%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3578/3775 (94.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7850, Accuracy: 5991/10000 (59.9100%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4570/4874 (93.7628%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4301/4874 (88.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.6586, Accuracy: 4687/10000 (46.8700%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4906/5265 (93.1814%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4728/5265 (89.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0565, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4808/5083 (94.5898%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4610/5083 (90.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.4618, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4234/4511 (93.8595%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4179/4511 (92.6402%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8706, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4344/4538 (95.7250%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4307/4538 (94.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9517, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4412/4716 (93.5539%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4280/4716 (90.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1939, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4437/4663 (95.1533%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4403/4663 (94.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9644, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4263/4441 (95.9919%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4155/4441 (93.5600%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0723, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4546/4793 (94.8467%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4534/4793 (94.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0757, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4455/4662 (95.5598%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4389/4662 (94.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8677, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3506/3704 (94.6544%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3492/3704 (94.2765%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8521, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4683/4989 (93.8665%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4458/4989 (89.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2076, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4154/4346 (95.5821%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4125/4346 (94.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8633, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4192/4362 (96.1027%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4089/4362 (93.7414%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8800, Accuracy: 5753/10000 (57.5300%)
time spent on training: 232.91949892044067
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.5841, Accuracy: 6203/10000 (62.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0568, Accuracy: 9747/9900 (98.4545%)
Done in 257.0863711833954 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4795/4885 (98.1576%), train_poison_data_count: 385
Global model norm: 45.09075727465178.
Norm before scaling: 45.0484195885036. Distance: 1.1144303130640725
Total norm for 4 adversaries is: 45.0484195885036. distance: 1.1144303130640725
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0371, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5197/5305 (97.9642%), train_poison_data_count: 415
Global model norm: 45.09075727465178.
Norm before scaling: 45.04713108017743. Distance: 1.211893848431969
Total norm for 4 adversaries is: 45.04713108017743. distance: 1.211893848431969
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0782, Accuracy: 9721/9900 (98.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 45.09075727465178.
Norm before scaling: 45.05043424847936. Distance: 1.1134021894116508
Total norm for 4 adversaries is: 45.05043424847936. distance: 1.1134021894116508
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0305, Accuracy: 9826/9900 (99.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4962/5066 (97.9471%), train_poison_data_count: 400
Global model norm: 45.09075727465178.
Norm before scaling: 45.04869327322381. Distance: 1.1369364421865356
Total norm for 4 adversaries is: 45.04869327322381. distance: 1.1369364421865356
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0431, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3752/3969 (94.5326%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3671/3969 (92.4918%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9523, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4309/4558 (94.5371%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4131/4558 (90.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3076, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4635/4918 (94.2456%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4593/4918 (93.3916%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0770, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5518/5902 (93.4937%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5231/5902 (88.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2661, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4960/5265 (94.2070%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4718/5265 (89.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0850, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4248/4511 (94.1698%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4190/4511 (92.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0946, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4321/4625 (93.4270%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4185/4625 (90.4865%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1514, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4132/4416 (93.5688%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4081/4416 (92.4139%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0575, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3164/3297 (95.9660%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3139/3297 (95.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6386, Accuracy: 6289/10000 (62.8900%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4795/5025 (95.4229%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4739/5025 (94.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1501, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4263/4441 (95.9919%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4236/4441 (95.3839%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8946, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4207/4481 (93.8853%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4028/4481 (89.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1704, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3637/3797 (95.7861%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3575/3797 (94.1533%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8338, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3469/3646 (95.1454%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3427/3646 (93.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7811, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3845/4025 (95.5280%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3820/4025 (94.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8336, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4607/4928 (93.4862%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4487/4928 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2118, Accuracy: 5248/10000 (52.4800%)
time spent on training: 233.7116310596466
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
Misclassifications by client 2 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
Misclassifications by client 0 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
Misclassifications by client 1 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Misclassifications by client 3 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
Misclassifications by client 12 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Misclassifications by client 18 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
Misclassifications by client 17 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
Misclassifications by client 14 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Misclassifications by client 16 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Misclassifications by client 13 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Misclassifications by client 11 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
Misclassifications by client 9 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Misclassifications by client 6 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Misclassifications by client 19 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Misclassifications by client 4 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
Misclassifications by client 10 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
Misclassifications by client 5 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
Misclassifications by client 8 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
Misclassifications by client 15 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Misclassifications by client 7 are spread across different classes. Client is not suspicious.
No suspicious behavior detected for user 7.
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6049, Accuracy: 6164/10000 (61.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0541, Accuracy: 9760/9900 (98.5859%)
Done in 257.7529561519623 sec.
Saving all the graphs.
This run has a label: Oct.24_00.49.35. Visdom environment: cifar100_CerP
