current path: saved_models/model_cifar100_Dec.05_00.09.25_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4313/4885 (88.2907%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43993486433577. Distance: 2.2935511614605018
Total norm for 4 adversaries is: 42.43993486433577. distance: 2.2935511614605018
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4363, Accuracy: 8839/9900 (89.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43536704185039. Distance: 2.2512527792837727
Total norm for 4 adversaries is: 42.43536704185039. distance: 2.2512527792837727
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7164, Accuracy: 8338/9900 (84.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43860455116308. Distance: 2.176116862686179
Total norm for 4 adversaries is: 42.43860455116308. distance: 2.176116862686179
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4256, Accuracy: 8893/9900 (89.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44032747852418. Distance: 2.3036747145705614
Total norm for 4 adversaries is: 42.44032747852418. distance: 2.3036747145705614
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5973, Accuracy: 8501/9900 (85.8687%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3834/4356 (88.0165%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3705/4356 (85.0551%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3399, Accuracy: 4776/10000 (47.7600%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3942/4465 (88.2867%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4103/4465 (91.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0093, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4040/4647 (86.9378%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4163/4647 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9194, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5055 (87.9327%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4511/5055 (89.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1674, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4444/5116 (86.8647%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4487/5116 (87.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9837, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3629/4126 (87.9544%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3760/4126 (91.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9543, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3085/3472 (88.8537%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0550, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4434/4986 (88.9290%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4446/4986 (89.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0512, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3540/4013 (88.2133%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3673/4013 (91.5275%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8431, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4030/4618 (87.2672%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4069/4618 (88.1117%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0918, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4427/5083 (87.0942%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4436/5083 (87.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0759, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3971/4511 (88.0293%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4024/4511 (89.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1893, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3333/3797 (87.7798%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3388/3797 (89.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9274, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5002/5582 (89.6095%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5059/5582 (90.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1283, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3149/3616 (87.0852%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3207/3616 (88.6892%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0949, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4827/5455 (88.4876%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4823/5455 (88.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9356, Accuracy: 5371/10000 (53.7100%)
time spent on training: 257.4392776489258
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1486, Accuracy: 6980/10000 (69.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.9420, Accuracy: 60/9900 (0.6061%)
Done in 284.77616453170776 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4364/4885 (89.3347%), train_poison_data_count: 385
Global model norm: 42.46482632260934.
Norm before scaling: 42.47182544971725. Distance: 2.163220513766551
Total norm for 4 adversaries is: 42.47182544971725. distance: 2.163220513766551
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1852, Accuracy: 9409/9900 (95.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.46482632260934.
Norm before scaling: 42.467617488578874. Distance: 2.2068363610025923
Total norm for 4 adversaries is: 42.467617488578874. distance: 2.2068363610025923
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4210, Accuracy: 8858/9900 (89.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4168/4717 (88.3612%), train_poison_data_count: 370
Global model norm: 42.46482632260934.
Norm before scaling: 42.47299952295061. Distance: 2.2159545911550254
Total norm for 4 adversaries is: 42.47299952295061. distance: 2.2159545911550254
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1860, Accuracy: 9433/9900 (95.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.46482632260934.
Norm before scaling: 42.47551856934033. Distance: 2.3554654097652
Total norm for 4 adversaries is: 42.47551856934033. distance: 2.3554654097652
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1739, Accuracy: 9422/9900 (95.1717%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3589/4025 (89.1677%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3701/4025 (91.9503%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8808, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3334/3797 (87.8062%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3401/3797 (89.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0283, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3935/4625 (85.0811%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4012/4625 (86.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0840, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3864/4481 (86.2308%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3840/4481 (85.6952%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2204, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3837/4315 (88.9224%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9977, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3702/4235 (87.4144%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3826/4235 (90.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9680, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3364/3828 (87.8788%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9448, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3827/4416 (86.6621%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3962/4416 (89.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8661, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3147/3638 (86.5036%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3267/3638 (89.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9687, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4534/5265 (86.1159%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4546/5265 (86.3438%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9958, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3355/3781 (88.7331%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3324/3781 (87.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2214, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4441 (89.0790%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4015/4441 (90.4076%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2040, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3961/4433 (89.3526%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4002/4433 (90.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9456, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4407/5083 (86.7008%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4484/5083 (88.2156%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0247, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4309/4928 (87.4391%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9313, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4157/4793 (86.7306%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4340/4793 (90.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0222, Accuracy: 5425/10000 (54.2500%)
time spent on training: 253.36064410209656
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1567, Accuracy: 6960/10000 (69.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.5843, Accuracy: 64/9900 (0.6465%)
Done in 281.10842728614807 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.50133269969308.
Norm before scaling: 42.503035852049734. Distance: 2.1100649235215085
Total norm for 4 adversaries is: 42.503035852049734. distance: 2.1100649235215085
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1896, Accuracy: 9400/9900 (94.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 42.50133269969308.
Norm before scaling: 42.50481647799606. Distance: 2.2024247159009605
Total norm for 4 adversaries is: 42.50481647799606. distance: 2.2024247159009605
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0724, Accuracy: 9695/9900 (97.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.50133269969308.
Norm before scaling: 42.504230602854406. Distance: 2.0952694062787476
Total norm for 4 adversaries is: 42.504230602854406. distance: 2.0952694062787476
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1904, Accuracy: 9394/9900 (94.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.50133269969308.
Norm before scaling: 42.50763229951696. Distance: 2.258790012463322
Total norm for 4 adversaries is: 42.50763229951696. distance: 2.258790012463322
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1719, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3130/3616 (86.5597%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3266/3616 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8216, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3518/3837 (91.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8623, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4173/4679 (89.1857%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4251/4679 (90.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0687, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3100/3638 (85.2117%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3289/3638 (90.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0808, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3603/4046 (89.0509%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3665/4046 (90.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0052, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3977/4518 (88.0257%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4070/4518 (90.0841%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1669, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3366/3797 (88.6489%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3409/3797 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2470, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4439/5025 (88.3383%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4472/5025 (88.9950%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2322, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3893/4362 (89.2481%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3942/4362 (90.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0179, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3984/4558 (87.4068%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3998/4558 (87.7139%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1685, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3201/3672 (87.1732%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3271/3672 (89.0795%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1146, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4300/4874 (88.2232%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4338/4874 (89.0029%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2902, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3596/4025 (89.3416%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3702/4025 (91.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9337, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4097/4663 (87.8619%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4231/4663 (90.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0911, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3445/3911 (88.0849%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3428/3911 (87.6502%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0691, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4419/5017 (88.0805%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4555/5017 (90.7913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8489, Accuracy: 5640/10000 (56.4000%)
time spent on training: 252.85501527786255
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1862, Accuracy: 6882/10000 (68.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.3886, Accuracy: 61/9900 (0.6162%)
Done in 280.19960737228394 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.53120551292677.
Norm before scaling: 42.53516181037019. Distance: 2.1249848533539346
Total norm for 4 adversaries is: 42.53516181037019. distance: 2.1249848533539346
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5921, Accuracy: 8563/9900 (86.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 42.53120551292677.
Norm before scaling: 42.530816607821265. Distance: 2.1568317457851145
Total norm for 4 adversaries is: 42.530816607821265. distance: 2.1568317457851145
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0990, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 42.53120551292677.
Norm before scaling: 42.53316146512918. Distance: 2.0876182614023513
Total norm for 4 adversaries is: 42.53316146512918. distance: 2.0876182614023513
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1493, Accuracy: 9506/9900 (96.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.53120551292677.
Norm before scaling: 42.537843617753325. Distance: 2.270043740376259
Total norm for 4 adversaries is: 42.537843617753325. distance: 2.270043740376259
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2795, Accuracy: 9179/9900 (92.7172%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5262/6124 (85.9242%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5301/6124 (86.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0519, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3882/4356 (89.1185%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3611/4356 (82.8972%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2838, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3530/4158 (84.8966%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3615/4158 (86.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1714, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4866/5455 (89.2026%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4836/5455 (88.6526%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9748, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3920/4511 (86.8987%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4043/4511 (89.6254%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0671, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4500/5232 (86.0092%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4531/5232 (86.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0614, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4474/5244 (85.3166%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4544/5244 (86.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0776, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4353/4918 (88.5116%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4384/4918 (89.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0616, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3587/4126 (86.9365%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3734/4126 (90.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.7961, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4366/4928 (88.5958%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4410/4928 (89.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1644, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3708/4223 (87.8049%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3855/4223 (91.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0011, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4513/5195 (86.8720%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4613/5195 (88.7969%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1376, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4128/4679 (88.2240%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4186/4679 (89.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9468, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3170/3646 (86.9446%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3297/3646 (90.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8536, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3161/3616 (87.4170%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3219/3616 (89.0210%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9049, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4021/4716 (85.2629%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4123/4716 (87.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9757, Accuracy: 5406/10000 (54.0600%)
time spent on training: 260.4943890571594
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2071, Accuracy: 6846/10000 (68.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.5769, Accuracy: 47/9900 (0.4747%)
Done in 287.9726288318634 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.57000065838251.
Norm before scaling: 42.573953350684384. Distance: 2.1187339849626343
Total norm for 4 adversaries is: 42.573953350684384. distance: 2.1187339849626343
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1215, Accuracy: 9586/9900 (96.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.57000065838251.
Norm before scaling: 42.565836816244875. Distance: 2.1460212575849735
Total norm for 4 adversaries is: 42.565836816244875. distance: 2.1460212575849735
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1230, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.57000065838251.
Norm before scaling: 42.57194335860327. Distance: 2.0844768310562256
Total norm for 4 adversaries is: 42.57194335860327. distance: 2.0844768310562256
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1796, Accuracy: 9438/9900 (95.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.57000065838251.
Norm before scaling: 42.58018917014842. Distance: 2.2979926679210374
Total norm for 4 adversaries is: 42.58018917014842. distance: 2.2979926679210374
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1687, Accuracy: 9463/9900 (95.5859%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5253/6124 (85.7773%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5382/6124 (87.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9762, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3928/4433 (88.6082%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3995/4433 (90.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9361, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3380/3781 (89.3943%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3216/3781 (85.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4337, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3543/3969 (89.2668%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3573/3969 (90.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9834, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/5025 (88.4179%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4503/5025 (89.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0814, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4218/4679 (90.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9247, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4136/4707 (87.8691%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4222/4707 (89.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9084, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4405/4986 (88.3474%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4413/4986 (88.5078%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9599, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3869/4315 (89.6640%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3941/4315 (91.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8817, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3832/4416 (86.7754%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3930/4416 (88.9946%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9813, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4242/4804 (88.3014%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4051/4804 (84.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2025, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4159/4793 (86.7724%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4283/4793 (89.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0211, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4490/5232 (85.8180%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4580/5232 (87.5382%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0191, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4094/4662 (87.8164%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4218/4662 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0367, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4202/4956 (84.7861%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4304/4956 (86.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1788, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3821/4368 (87.4771%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3829/4368 (87.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9505, Accuracy: 5435/10000 (54.3500%)
time spent on training: 261.26837515830994
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2546, Accuracy: 6748/10000 (67.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.5746, Accuracy: 47/9900 (0.4747%)
Done in 288.3722002506256 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4363/4885 (89.3142%), train_poison_data_count: 385
Global model norm: 42.608277740730735.
Norm before scaling: 42.61219966801614. Distance: 2.1476986256093036
Total norm for 4 adversaries is: 42.61219966801614. distance: 2.1476986256093036
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2598, Accuracy: 9271/9900 (93.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 42.608277740730735.
Norm before scaling: 42.607494171451954. Distance: 2.1657899647864802
Total norm for 4 adversaries is: 42.607494171451954. distance: 2.1657899647864802
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2059, Accuracy: 9399/9900 (94.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 42.608277740730735.
Norm before scaling: 42.606945521131. Distance: 2.0476205647316146
Total norm for 4 adversaries is: 42.606945521131. distance: 2.0476205647316146
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1731, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4487/5066 (88.5709%), train_poison_data_count: 400
Global model norm: 42.608277740730735.
Norm before scaling: 42.617700930683576. Distance: 2.270287602728514
Total norm for 4 adversaries is: 42.617700930683576. distance: 2.270287602728514
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1709, Accuracy: 9461/9900 (95.5657%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5283/6124 (86.2671%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5345/6124 (87.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1779, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5056/5902 (85.6659%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5096/5902 (86.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1449, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4169/4707 (88.5702%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4208/4707 (89.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9573, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4071/4647 (87.6049%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4166/4647 (89.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8794, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2911/3297 (88.2924%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3019/3297 (91.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7633, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5536/6263 (88.3921%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5652/6263 (90.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1676, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4127/4663 (88.5053%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4272/4663 (91.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0246, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4289/4956 (86.5416%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4337/4956 (87.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1701, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3598/4046 (88.9273%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3710/4046 (91.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9598, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3666/4184 (87.6195%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3770/4184 (90.1052%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8281, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4819/5591 (86.1921%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4902/5591 (87.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1689, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4063/4634 (87.6780%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4201/4634 (90.6560%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9138, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3339/3828 (87.2257%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3471/3828 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9014, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3105/3638 (85.3491%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3254/3638 (89.4447%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8920, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3365/3781 (88.9976%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3431/3781 (90.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0962, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3366/3837 (87.7248%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3506/3837 (91.3735%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9447, Accuracy: 5530/10000 (55.3000%)
time spent on training: 259.63117933273315
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2273, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.3371, Accuracy: 82/9900 (0.8283%)
Done in 287.17263770103455 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.65303187265458.
Norm before scaling: 42.656563357365506. Distance: 2.1080279534963875
Total norm for 4 adversaries is: 42.656563357365506. distance: 2.1080279534963875
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1974, Accuracy: 9431/9900 (95.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.65303187265458.
Norm before scaling: 42.65393623532519. Distance: 2.1516284896493407
Total norm for 4 adversaries is: 42.65393623532519. distance: 2.1516284896493407
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1666, Accuracy: 9486/9900 (95.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4182/4717 (88.6580%), train_poison_data_count: 370
Global model norm: 42.65303187265458.
Norm before scaling: 42.65474327696086. Distance: 2.082847220610066
Total norm for 4 adversaries is: 42.65474327696086. distance: 2.082847220610066
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1382, Accuracy: 9552/9900 (96.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 42.65303187265458.
Norm before scaling: 42.658241711743116. Distance: 2.22287699536786
Total norm for 4 adversaries is: 42.658241711743116. distance: 2.22287699536786
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2009, Accuracy: 9397/9900 (94.9192%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3873/4501 (86.0475%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3930/4501 (87.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0537, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3641/4175 (87.2096%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3730/4175 (89.3413%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8718, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3114/3616 (86.1173%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3239/3616 (89.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9070, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4045/4634 (87.2896%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4109/4634 (88.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9806, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3974/4558 (87.1874%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4020/4558 (88.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1041, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4560/5167 (88.2524%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4637/5167 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1158, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3936/4356 (90.3581%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3865/4356 (88.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0643, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4120/4716 (87.3622%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4201/4716 (89.0797%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9158, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5322/6124 (86.9040%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5335/6124 (87.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0250, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4410/5055 (87.2404%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9338, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4475/5025 (89.0547%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4557/5025 (90.6866%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2239, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4350/4918 (88.4506%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4381/4918 (89.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2028, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3702/4223 (87.6628%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3805/4223 (90.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9552, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3957/4481 (88.3062%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3913/4481 (87.3243%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0047, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3164/3638 (86.9709%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3283/3638 (90.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9265, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3575/4013 (89.0855%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3704/4013 (92.3000%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8130, Accuracy: 5684/10000 (56.8400%)
time spent on training: 256.7212302684784
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2261, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.8925, Accuracy: 47/9900 (0.4747%)
Done in 284.1032602787018 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 42.698459542068086.
Norm before scaling: 42.70096099987095. Distance: 2.0984513748857774
Total norm for 4 adversaries is: 42.70096099987095. distance: 2.0984513748857774
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2204, Accuracy: 9355/9900 (94.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4760/5305 (89.7267%), train_poison_data_count: 415
Global model norm: 42.698459542068086.
Norm before scaling: 42.698026417633606. Distance: 2.155669645630738
Total norm for 4 adversaries is: 42.698026417633606. distance: 2.155669645630738
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2479, Accuracy: 9313/9900 (94.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.698459542068086.
Norm before scaling: 42.69947872513712. Distance: 2.0409735716361412
Total norm for 4 adversaries is: 42.69947872513712. distance: 2.0409735716361412
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3310, Accuracy: 9085/9900 (91.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.698459542068086.
Norm before scaling: 42.70438561531181. Distance: 2.2531369911329775
Total norm for 4 adversaries is: 42.70438561531181. distance: 2.2531369911329775
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1164, Accuracy: 9584/9900 (96.8081%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3187/3646 (87.4109%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7605, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3946/4501 (87.6694%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4064/4501 (90.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0025, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4054/4651 (87.1641%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4173/4651 (89.7226%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9602, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4558/5167 (88.2137%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4667/5167 (90.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9657, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4850/5455 (88.9093%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4913/5455 (90.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0358, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4877/5591 (87.2295%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4919/5591 (87.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0369, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4180/4679 (89.3353%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4185/4679 (89.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0963, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4443/5017 (88.5589%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4510/5017 (89.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8760, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4192/4793 (87.4609%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4275/4793 (89.1926%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9930, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4006/4456 (89.9013%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4097/4456 (91.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0356, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4787/5424 (88.2559%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4961/5424 (91.4639%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0882, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3638/4175 (87.1377%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3623/4175 (86.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9701, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4481/5116 (87.5880%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4535/5116 (88.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9445, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3258/3704 (87.9590%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3338/3704 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8890, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4451/5232 (85.0726%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4603/5232 (87.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0952, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3184/3472 (91.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0291, Accuracy: 5472/10000 (54.7200%)
time spent on training: 259.67073488235474
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2122, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.5829, Accuracy: 64/9900 (0.6465%)
Done in 287.41307187080383 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 42.73719283442921.
Norm before scaling: 42.73963061832221. Distance: 2.0959707979759683
Total norm for 4 adversaries is: 42.73963061832221. distance: 2.0959707979759683
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3021, Accuracy: 9142/9900 (92.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 42.73719283442921.
Norm before scaling: 42.73668726605471. Distance: 2.1671830686759064
Total norm for 4 adversaries is: 42.73668726605471. distance: 2.1671830686759064
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2936, Accuracy: 9229/9900 (93.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4226/4717 (89.5908%), train_poison_data_count: 370
Global model norm: 42.73719283442921.
Norm before scaling: 42.73707286959341. Distance: 2.039295753204244
Total norm for 4 adversaries is: 42.73707286959341. distance: 2.039295753204244
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1394, Accuracy: 9542/9900 (96.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4493/5066 (88.6893%), train_poison_data_count: 400
Global model norm: 42.73719283442921.
Norm before scaling: 42.743507650742266. Distance: 2.2282580963230774
Total norm for 4 adversaries is: 42.743507650742266. distance: 2.2282580963230774
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3201, Accuracy: 9075/9900 (91.6667%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3222/3590 (89.7493%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3330/3590 (92.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9113, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3830/4368 (87.6832%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3862/4368 (88.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9454, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3376/3704 (91.1447%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9301, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4320/4928 (87.6623%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4375/4928 (88.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0669, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3963/4356 (90.9780%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3904/4356 (89.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0669, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3547/3911 (90.6929%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3431/3911 (87.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1284, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4099/4651 (88.1316%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4206/4651 (90.4322%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1134, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3701/4184 (88.4560%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8682, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3914/4346 (90.0598%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4036/4346 (92.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9115, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4167/4793 (86.9393%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9962, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3349/3804 (88.0389%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9547, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4459/4986 (89.4304%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4509/4986 (90.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9090, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5452/6124 (89.0268%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5397/6124 (88.1287%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0782, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4116/4707 (87.4442%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4214/4707 (89.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9189, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3769/4235 (88.9965%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3707/4235 (87.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0633, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3622/4046 (89.5205%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3689/4046 (91.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9629, Accuracy: 5427/10000 (54.2700%)
time spent on training: 254.83921909332275
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2293, Accuracy: 6860/10000 (68.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.6666, Accuracy: 68/9900 (0.6869%)
Done in 282.4287922382355 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 42.78052096027832.
Norm before scaling: 42.782145945695035. Distance: 2.108578001559266
Total norm for 4 adversaries is: 42.782145945695035. distance: 2.108578001559266
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1111, Accuracy: 9610/9900 (97.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 42.78052096027832.
Norm before scaling: 42.78333575540102. Distance: 2.183972812022243
Total norm for 4 adversaries is: 42.78333575540102. distance: 2.183972812022243
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0961, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 42.78052096027832.
Norm before scaling: 42.778449335372855. Distance: 2.017007398063168
Total norm for 4 adversaries is: 42.778449335372855. distance: 2.017007398063168
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3566, Accuracy: 9074/9900 (91.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.78052096027832.
Norm before scaling: 42.78596063820906. Distance: 2.2554986310247327
Total norm for 4 adversaries is: 42.78596063820906. distance: 2.2554986310247327
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2409, Accuracy: 9271/9900 (93.6465%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4414/4986 (88.5279%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4506/4986 (90.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9119, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4046/4634 (87.3112%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4163/4634 (89.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.7979, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4133/4716 (87.6378%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4222/4716 (89.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9716, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5578/6124 (91.0843%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5553/6124 (90.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9817, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4358/4918 (88.6133%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4495/4918 (91.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9461, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3357/3797 (88.4119%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3436/3797 (90.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0525, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4976/5582 (89.1437%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0791, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4331/4956 (87.3890%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4383/4956 (88.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0137, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3944/4433 (88.9691%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4016/4433 (90.5933%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8412, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3844/4354 (88.2866%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3381/4354 (77.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4420, Accuracy: 4648/10000 (46.4800%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4291/4928 (87.0739%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4407/4928 (89.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9978, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3519/3911 (89.9770%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3529/3911 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9143, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3894/4481 (86.9002%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3923/4481 (87.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1660, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4600/5197 (88.5126%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4637/5197 (89.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0371, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4811/5455 (88.1943%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4925/5455 (90.2841%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1450, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3795/4361 (87.0213%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3710/4361 (85.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1331, Accuracy: 5142/10000 (51.4200%)
time spent on training: 264.67772150039673
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.2884, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 10.2879, Accuracy: 38/9900 (0.3838%)
Done in 291.95716547966003 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 42.82434114304547.
Norm before scaling: 42.82692218303663. Distance: 2.1170164369964017
Total norm for 4 adversaries is: 42.82692218303663. distance: 2.1170164369964017
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1735, Accuracy: 9489/9900 (95.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4754/5305 (89.6136%), train_poison_data_count: 415
Global model norm: 42.82434114304547.
Norm before scaling: 42.82353872287997. Distance: 2.165004594018304
Total norm for 4 adversaries is: 42.82353872287997. distance: 2.165004594018304
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.3051, Accuracy: 9163/9900 (92.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 42.82434114304547.
Norm before scaling: 42.823223736787234. Distance: 2.053645576891753
Total norm for 4 adversaries is: 42.823223736787234. distance: 2.053645576891753
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1462, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 42.82434114304547.
Norm before scaling: 42.82900856439914. Distance: 2.26008507424979
Total norm for 4 adversaries is: 42.82900856439914. distance: 2.26008507424979
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2502, Accuracy: 9291/9900 (93.8485%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4297/4928 (87.1956%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4440/4928 (90.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9512, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3731/4184 (89.1730%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3785/4184 (90.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0114, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4172/4707 (88.6339%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4268/4707 (90.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9956, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3365/3828 (87.9049%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8901, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3933/4503 (87.3418%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4000/4503 (88.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8806, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4150/4662 (89.0176%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4245/4662 (91.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9236, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3714/4235 (87.6978%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3782/4235 (89.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9906, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4411/5244 (84.1152%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4526/5244 (86.3082%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9431, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4200/4793 (87.6278%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8684, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4018/4481 (89.6675%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3957/4481 (88.3062%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1316, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3894/4346 (89.5996%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4034/4346 (92.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7775, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3796/4361 (87.0443%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3765/4361 (86.3334%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0699, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4489/5055 (88.8032%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4535/5055 (89.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9398, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4518/5195 (86.9682%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4539/5195 (87.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0752, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3862/4315 (89.5017%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3996/4315 (92.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8641, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4158/4663 (89.1701%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4254/4663 (91.2288%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1311, Accuracy: 5208/10000 (52.0800%)
time spent on training: 262.17731499671936
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.2763, Accuracy: 6745/10000 (67.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 10.1043, Accuracy: 30/9900 (0.3030%)
Done in 289.6029706001282 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4399/4885 (90.0512%), train_poison_data_count: 385
Global model norm: 42.85770879462643.
Norm before scaling: 42.858615958918485. Distance: 2.085275723638822
Total norm for 4 adversaries is: 42.858615958918485. distance: 2.085275723638822
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1417, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 42.85770879462643.
Norm before scaling: 42.86120347904239. Distance: 2.1932599120716714
Total norm for 4 adversaries is: 42.86120347904239. distance: 2.1932599120716714
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3173, Accuracy: 9153/9900 (92.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.85770879462643.
Norm before scaling: 42.85493021748271. Distance: 2.0159061442810398
Total norm for 4 adversaries is: 42.85493021748271. distance: 2.0159061442810398
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1857, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4492/5066 (88.6696%), train_poison_data_count: 400
Global model norm: 42.85770879462643.
Norm before scaling: 42.86233555897663. Distance: 2.224667033452198
Total norm for 4 adversaries is: 42.86233555897663. distance: 2.224667033452198
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1622, Accuracy: 9484/9900 (95.7980%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3908/4315 (90.5678%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3941/4315 (91.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9021, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3197/3590 (89.0529%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3240/3590 (90.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0303, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4163/4679 (88.9720%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4240/4679 (90.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9258, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4542/5167 (87.9040%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4628/5167 (89.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1420, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3355/3775 (88.8742%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3549/3775 (94.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7426, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3388/3828 (88.5057%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3474/3828 (90.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9373, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3747/4235 (88.4770%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3873/4235 (91.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9130, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4069/4647 (87.5619%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4647 (90.5315%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9036, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4317/4918 (87.7796%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4439/4918 (90.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0352, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3953/4433 (89.1721%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4034/4433 (90.9993%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8769, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3946/4481 (88.0607%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3937/4481 (87.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0524, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3789/4295 (88.2189%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3655/4295 (85.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0789, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3970/4503 (88.1634%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4015/4503 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9437, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3895/4354 (89.4580%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3789/4354 (87.0234%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3114, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4419/4986 (88.6282%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4485/4986 (89.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0205, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5548/6263 (88.5837%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5690/6263 (90.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1231, Accuracy: 5207/10000 (52.0700%)
time spent on training: 257.88887429237366
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3640, Accuracy: 6591/10000 (65.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 10.3665, Accuracy: 36/9900 (0.3636%)
Done in 285.3355920314789 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 42.89375984673135.
Norm before scaling: 42.89339415013401. Distance: 2.1377703713196006
Total norm for 4 adversaries is: 42.89339415013401. distance: 2.1377703713196006
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1753, Accuracy: 9457/9900 (95.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4703/5305 (88.6522%), train_poison_data_count: 415
Global model norm: 42.89375984673135.
Norm before scaling: 42.897200372573124. Distance: 2.3157915969204637
Total norm for 4 adversaries is: 42.897200372573124. distance: 2.3157915969204637
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0513, Accuracy: 9771/9900 (98.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 42.89375984673135.
Norm before scaling: 42.89491667963845. Distance: 2.0922391764018644
Total norm for 4 adversaries is: 42.89491667963845. distance: 2.0922391764018644
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1615, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.89375984673135.
Norm before scaling: 42.899121141657. Distance: 2.2556952346601924
Total norm for 4 adversaries is: 42.899121141657. distance: 2.2556952346601924
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0878, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3705/4223 (87.7338%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9455, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4837/5455 (88.6709%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4860/5455 (89.0926%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0943, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5006/5582 (89.6811%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5097/5582 (91.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0589, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3971/4465 (88.9362%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4465 (91.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8898, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5025/5591 (89.8766%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5015/5591 (89.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0613, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3517/3911 (89.9259%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3437/3911 (87.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9581, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3902/4356 (89.5776%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3423/4356 (78.5813%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4605, Accuracy: 4689/10000 (46.8900%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4405/5037 (87.4528%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4520/5037 (89.7360%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9401, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4165/4679 (89.0147%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4232/4679 (90.4467%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0441, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3919/4362 (89.8441%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9792, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4049/4518 (89.6193%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0637, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4453/5083 (87.6057%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4487/5083 (88.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1376, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3700/4013 (92.2003%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8076, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4557/5197 (87.6852%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4702/5197 (90.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0199, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2919/3297 (88.5350%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3050/3297 (92.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8049, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3938/4441 (88.6737%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4027/4441 (90.6778%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1324, Accuracy: 5298/10000 (52.9800%)
time spent on training: 261.08121705055237
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4662, Accuracy: 6463/10000 (64.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 10.4623, Accuracy: 22/9900 (0.2222%)
Done in 288.590500831604 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4345/4885 (88.9458%), train_poison_data_count: 385
Global model norm: 42.936219219889836.
Norm before scaling: 42.937426082541904. Distance: 2.142248164791942
Total norm for 4 adversaries is: 42.937426082541904. distance: 2.142248164791942
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1957, Accuracy: 9432/9900 (95.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4733/5305 (89.2177%), train_poison_data_count: 415
Global model norm: 42.936219219889836.
Norm before scaling: 42.934420945823. Distance: 2.1973237839525237
Total norm for 4 adversaries is: 42.934420945823. distance: 2.1973237839525237
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1371, Accuracy: 9551/9900 (96.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 42.936219219889836.
Norm before scaling: 42.935839669499885. Distance: 2.0680110014838657
Total norm for 4 adversaries is: 42.935839669499885. distance: 2.0680110014838657
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3377, Accuracy: 9031/9900 (91.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4474/5066 (88.3143%), train_poison_data_count: 400
Global model norm: 42.936219219889836.
Norm before scaling: 42.940561776752816. Distance: 2.290668119724658
Total norm for 4 adversaries is: 42.940561776752816. distance: 2.290668119724658
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2253, Accuracy: 9320/9900 (94.1414%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3955/4501 (87.8694%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4036/4501 (89.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0971, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3933/4511 (87.1869%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4079/4511 (90.4234%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9029, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3997/4354 (91.8006%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3644/4354 (83.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4926, Accuracy: 4696/10000 (46.9600%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3898/4346 (89.6917%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4010/4346 (92.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9442, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4123/4707 (87.5929%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4259/4707 (90.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8378, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4943/5591 (88.4099%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4971/5591 (88.9107%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0557, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4059/4647 (87.3467%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4196/4647 (90.2948%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8272, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4037/4538 (88.9599%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4160/4538 (91.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9355, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4297/4934 (87.0896%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4360/4934 (88.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2083, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4342/4804 (90.3830%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4328/4804 (90.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0370, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5567/6263 (88.8871%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5634/6263 (89.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2254, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3953/4481 (88.2169%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3998/4481 (89.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0299, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4353/5063 (85.9767%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4456/5063 (88.0111%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9651, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3678/4223 (87.0945%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3916/4223 (92.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9034, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3975/4441 (89.5069%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4078/4441 (91.8262%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0537, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3324/3756 (88.4984%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3475/3756 (92.5186%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9063, Accuracy: 5616/10000 (56.1600%)
time spent on training: 259.82208228111267
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.5221, Accuracy: 6336/10000 (63.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 10.9321, Accuracy: 15/9900 (0.1515%)
Done in 287.5466549396515 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4361/4885 (89.2733%), train_poison_data_count: 385
Global model norm: 42.975696881620635.
Norm before scaling: 42.98000562807155. Distance: 2.189653916556676
Total norm for 4 adversaries is: 42.98000562807155. distance: 2.189653916556676
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1596, Accuracy: 9500/9900 (95.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 42.975696881620635.
Norm before scaling: 42.97562018940579. Distance: 2.285862687947247
Total norm for 4 adversaries is: 42.97562018940579. distance: 2.285862687947247
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0660, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4194/4717 (88.9124%), train_poison_data_count: 370
Global model norm: 42.975696881620635.
Norm before scaling: 42.97917487174748. Distance: 2.1147217979259803
Total norm for 4 adversaries is: 42.97917487174748. distance: 2.1147217979259803
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1934, Accuracy: 9408/9900 (95.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 42.975696881620635.
Norm before scaling: 42.98248360069919. Distance: 2.2996741644556504
Total norm for 4 adversaries is: 42.98248360069919. distance: 2.2996741644556504
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2096, Accuracy: 9353/9900 (94.4747%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4392/5244 (83.7529%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4579/5244 (87.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9836, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4299/4928 (87.2362%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4470/4928 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8816, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3374/3804 (88.6961%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3452/3804 (90.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9228, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3548/4013 (88.4127%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3673/4013 (91.5275%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8107, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3528/4158 (84.8485%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3615/4158 (86.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0506, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4983/5582 (89.2691%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5020/5582 (89.9319%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0760, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4802/5455 (88.0293%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9924, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4048/4354 (92.9720%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3792/4354 (87.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.4936, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3919/4433 (88.4051%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4433 (90.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0572, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3160/3646 (86.6703%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3322/3646 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8486, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4037/4518 (89.3537%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4129/4518 (91.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0148, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3731/4235 (88.0992%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3797/4235 (89.6576%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2221, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3919/4362 (89.8441%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3918/4362 (89.8212%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0665, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4732/5392 (87.7596%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4684/5392 (86.8694%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1512, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4929/5591 (88.1595%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4914/5591 (87.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0881, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3310/3756 (88.1257%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3453/3756 (91.9329%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0033, Accuracy: 5501/10000 (55.0100%)
time spent on training: 252.57652831077576
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.5448, Accuracy: 6295/10000 (62.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 10.6871, Accuracy: 37/9900 (0.3737%)
Done in 280.14581203460693 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4343/4885 (88.9048%), train_poison_data_count: 385
Global model norm: 43.008609353426266.
Norm before scaling: 43.01328515930064. Distance: 2.1697521126142707
Total norm for 4 adversaries is: 43.01328515930064. distance: 2.1697521126142707
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1677, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4715/5305 (88.8784%), train_poison_data_count: 415
Global model norm: 43.008609353426266.
Norm before scaling: 43.01047547954524. Distance: 2.282474763862343
Total norm for 4 adversaries is: 43.01047547954524. distance: 2.282474763862343
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0201, Accuracy: 9842/9900 (99.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4175/4717 (88.5096%), train_poison_data_count: 370
Global model norm: 43.008609353426266.
Norm before scaling: 43.01149294538176. Distance: 2.149999764908179
Total norm for 4 adversaries is: 43.01149294538176. distance: 2.149999764908179
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1339, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4430/5066 (87.4457%), train_poison_data_count: 400
Global model norm: 43.008609353426266.
Norm before scaling: 43.01739859674513. Distance: 2.3727611228417698
Total norm for 4 adversaries is: 43.01739859674513. distance: 2.3727611228417698
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1166, Accuracy: 9601/9900 (96.9798%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4082/4634 (88.0880%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4167/4634 (89.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9305, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3992/4503 (88.6520%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4037/4503 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1287, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4281/4928 (86.8709%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4469/4928 (90.6859%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8269, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3308/3804 (86.9611%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3416/3804 (89.8002%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9068, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3590 (87.7994%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3129/3590 (87.1588%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1640, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4058/4647 (87.3252%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4226/4647 (90.9404%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9481, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3945/4625 (85.2973%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3986/4625 (86.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1443, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3976/4356 (91.2764%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4045/4356 (92.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0194, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3336/3797 (87.8588%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3454/3797 (90.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8933, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3982/4456 (89.3627%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4075/4456 (91.4497%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9257, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3550/4025 (88.1988%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3705/4025 (92.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8657, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3184/3472 (91.7051%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0110, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2869/3297 (87.0185%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3025/3297 (91.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8229, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3799/4416 (86.0281%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3970/4416 (89.9004%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9509, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3951/4356 (90.7025%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4045/4356 (92.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0382, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3123/3638 (85.8439%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9173, Accuracy: 5531/10000 (55.3100%)
time spent on training: 252.0996105670929
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.4811, Accuracy: 6399/10000 (63.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 10.4351, Accuracy: 37/9900 (0.3737%)
Done in 279.5806653499603 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4354/4885 (89.1300%), train_poison_data_count: 385
Global model norm: 43.04446737822411.
Norm before scaling: 43.04884296771953. Distance: 2.2249539102645506
Total norm for 4 adversaries is: 43.04884296771953. distance: 2.2249539102645506
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1635, Accuracy: 9540/9900 (96.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4720/5305 (88.9727%), train_poison_data_count: 415
Global model norm: 43.04446737822411.
Norm before scaling: 43.04678425580272. Distance: 2.2545974174157832
Total norm for 4 adversaries is: 43.04678425580272. distance: 2.2545974174157832
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1482, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4191/4717 (88.8488%), train_poison_data_count: 370
Global model norm: 43.04446737822411.
Norm before scaling: 43.042226949604384. Distance: 2.0860411657512277
Total norm for 4 adversaries is: 43.042226949604384. distance: 2.0860411657512277
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0991, Accuracy: 9648/9900 (97.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 43.04446737822411.
Norm before scaling: 43.052427046676186. Distance: 2.2967439990411096
Total norm for 4 adversaries is: 43.052427046676186. distance: 2.2967439990411096
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0860, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3612/4175 (86.5150%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9959, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4210/4956 (84.9475%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4415/4956 (89.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1127, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4366/5037 (86.6786%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4563/5037 (90.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9040, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4317/4793 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9802, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3322/3804 (87.3291%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3421/3804 (89.9317%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0264, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4739/5392 (87.8895%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4835/5392 (89.6699%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9982, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3917/4465 (87.7268%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4078/4465 (91.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9270, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4066/4596 (88.4682%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4204/4596 (91.4708%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0313, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5477/6124 (89.4350%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5513/6124 (90.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8991, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2845/3271 (86.9765%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2935/3271 (89.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0753, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3165/3590 (88.1616%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3228/3590 (89.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0939, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3866/4501 (85.8920%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4020/4501 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0478, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4514/5232 (86.2768%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4607/5232 (88.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0558, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3184/3672 (86.7102%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3301/3672 (89.8965%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9943, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3730/4223 (88.3258%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3854/4223 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9855, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4120/4354 (94.6256%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0115, Accuracy: 3439/4354 (78.9848%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5526, Accuracy: 4636/10000 (46.3600%)
time spent on training: 254.82135605812073
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.5534, Accuracy: 6284/10000 (62.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 8.7879, Accuracy: 236/9900 (2.3838%)
Done in 282.0527493953705 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4370/4885 (89.4575%), train_poison_data_count: 385
Global model norm: 43.089700509971784.
Norm before scaling: 43.09299791992387. Distance: 2.1708440735222396
Total norm for 4 adversaries is: 43.09299791992387. distance: 2.1708440735222396
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3095, Accuracy: 9164/9900 (92.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4734/5305 (89.2366%), train_poison_data_count: 415
Global model norm: 43.089700509971784.
Norm before scaling: 43.08998663543756. Distance: 2.210509565476363
Total norm for 4 adversaries is: 43.08998663543756. distance: 2.210509565476363
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1346, Accuracy: 9568/9900 (96.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4173/4717 (88.4672%), train_poison_data_count: 370
Global model norm: 43.089700509971784.
Norm before scaling: 43.09293843280402. Distance: 2.2059658483522995
Total norm for 4 adversaries is: 43.09293843280402. distance: 2.2059658483522995
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0921, Accuracy: 9651/9900 (97.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4444/5066 (87.7221%), train_poison_data_count: 400
Global model norm: 43.089700509971784.
Norm before scaling: 43.09732467951172. Distance: 2.294077512554002
Total norm for 4 adversaries is: 43.09732467951172. distance: 2.294077512554002
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1793, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4954/5582 (88.7496%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5040/5582 (90.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1123, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4010/4647 (86.2922%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4189/4647 (90.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9528, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3922/4465 (87.8387%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4084/4465 (91.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9060, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4387/5083 (86.3073%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4519/5083 (88.9042%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1655, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3735/4416 (84.5788%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3951/4416 (89.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9321, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4257/4956 (85.8959%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4377/4956 (88.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1396, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3887/4362 (89.1105%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3877/4362 (88.8812%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0278, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3945/4356 (90.5647%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3962/4356 (90.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2002, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3298/3781 (87.2256%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3461/3781 (91.5366%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0529, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3159/3590 (87.9944%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3246/3590 (90.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9999, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4069/4651 (87.4866%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4189/4651 (90.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0503, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4060/4662 (87.0871%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4228/4662 (90.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8935, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3043/3472 (87.6440%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3177/3472 (91.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9329, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4788/5424 (88.2743%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4966/5424 (91.5560%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0970, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2844/3271 (86.9459%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2944/3271 (90.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9029, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4307/5037 (85.5072%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4502/5037 (89.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9028, Accuracy: 5564/10000 (55.6400%)
time spent on training: 258.61283349990845
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.4838, Accuracy: 6391/10000 (63.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.6815, Accuracy: 243/9900 (2.4545%)
Done in 285.8347280025482 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.11916853688739.
Norm before scaling: 43.12315015280728. Distance: 2.154222834707665
Total norm for 4 adversaries is: 43.12315015280728. distance: 2.154222834707665
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1834, Accuracy: 9429/9900 (95.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4710/5305 (88.7842%), train_poison_data_count: 415
Global model norm: 43.11916853688739.
Norm before scaling: 43.12201076596499. Distance: 2.2940754339957508
Total norm for 4 adversaries is: 43.12201076596499. distance: 2.2940754339957508
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1445, Accuracy: 9531/9900 (96.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 43.11916853688739.
Norm before scaling: 43.116004779711005. Distance: 2.0452570453816676
Total norm for 4 adversaries is: 43.116004779711005. distance: 2.0452570453816676
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3222, Accuracy: 9136/9900 (92.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4396/5066 (86.7746%), train_poison_data_count: 400
Global model norm: 43.11916853688739.
Norm before scaling: 43.12793100320473. Distance: 2.3592546444946505
Total norm for 4 adversaries is: 43.12793100320473. distance: 2.3592546444946505
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4172, Accuracy: 8878/9900 (89.6768%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4255/4989 (85.2876%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4426/4989 (88.7152%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0024, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3569/4013 (88.9360%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3717/4013 (92.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8091, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4453/5195 (85.7170%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4460/5195 (85.8518%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0444, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3490/3969 (87.9315%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3564/3969 (89.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9044, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4044/4356 (92.8375%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4032/4356 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1811, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3919/4441 (88.2459%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4008/4441 (90.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0024, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4037/4518 (89.3537%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4153/4518 (91.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0848, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3430/3911 (87.7014%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3323/3911 (84.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0563, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3865/4362 (88.6061%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3850/4362 (88.2623%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1257, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3355/3804 (88.1966%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3432/3804 (90.2208%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0385, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3668/4223 (86.8577%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9034, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4047/4634 (87.3328%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4184/4634 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8312, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4162/4354 (95.5903%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3596/4354 (82.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3005, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4315/5244 (82.2845%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4549/5244 (86.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9680, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4375/5037 (86.8573%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4575/5037 (90.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0004, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3191/3704 (86.1501%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3370/3704 (90.9827%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8780, Accuracy: 5574/10000 (55.7400%)
time spent on training: 257.209223985672
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5697, Accuracy: 6231/10000 (62.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.7904, Accuracy: 168/9900 (1.6970%)
Done in 284.3659837245941 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4361/4885 (89.2733%), train_poison_data_count: 385
Global model norm: 43.15922696330777.
Norm before scaling: 43.162632187840586. Distance: 2.175399116640647
Total norm for 4 adversaries is: 43.162632187840586. distance: 2.175399116640647
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2059, Accuracy: 9394/9900 (94.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4706/5305 (88.7088%), train_poison_data_count: 415
Global model norm: 43.15922696330777.
Norm before scaling: 43.16424420210625. Distance: 2.264294990307381
Total norm for 4 adversaries is: 43.16424420210625. distance: 2.264294990307381
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1252, Accuracy: 9594/9900 (96.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4164/4717 (88.2764%), train_poison_data_count: 370
Global model norm: 43.15922696330777.
Norm before scaling: 43.159726167929115. Distance: 2.124085959029539
Total norm for 4 adversaries is: 43.159726167929115. distance: 2.124085959029539
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1761, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.15922696330777.
Norm before scaling: 43.165188757931. Distance: 2.298836110894423
Total norm for 4 adversaries is: 43.165188757931. distance: 2.298836110894423
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.3261, Accuracy: 9096/9900 (91.8788%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3761/4416 (85.1676%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3969/4416 (89.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9786, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4493/5197 (86.4537%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4597/5197 (88.4549%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0003, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4251/4918 (86.4376%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4446/4918 (90.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1998, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5542/6263 (88.4879%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5634/6263 (89.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1292, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3142/3646 (86.1766%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3295/3646 (90.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8028, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4124/4707 (87.6142%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4256/4707 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8994, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4323/5063 (85.3842%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4375/5063 (86.4112%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1433, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3671/4295 (85.4715%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3834/4295 (89.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8968, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4149/4793 (86.5637%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4343/4793 (90.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0552, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3986/4538 (87.8361%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4185/4538 (92.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9129, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4426/5083 (87.0746%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4514/5083 (88.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9095, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3109/3638 (85.4590%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3242/3638 (89.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8650, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5429/6124 (88.6512%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5551/6124 (90.6434%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9265, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3994/4618 (86.4877%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4128/4618 (89.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9459, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3489/3969 (87.9063%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3576/3969 (90.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9126, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3463/4158 (83.2852%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3675/4158 (88.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8418, Accuracy: 5549/10000 (55.4900%)
time spent on training: 260.2357473373413
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.5165, Accuracy: 6317/10000 (63.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.1100, Accuracy: 147/9900 (1.4848%)
Done in 287.9911878108978 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4347/4885 (88.9867%), train_poison_data_count: 385
Global model norm: 43.19689715509813.
Norm before scaling: 43.201125914418455. Distance: 2.119867409392517
Total norm for 4 adversaries is: 43.201125914418455. distance: 2.119867409392517
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2422, Accuracy: 9323/9900 (94.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4684/5305 (88.2941%), train_poison_data_count: 415
Global model norm: 43.19689715509813.
Norm before scaling: 43.199516689281374. Distance: 2.2830200644040417
Total norm for 4 adversaries is: 43.199516689281374. distance: 2.2830200644040417
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2077, Accuracy: 9366/9900 (94.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4196/4717 (88.9548%), train_poison_data_count: 370
Global model norm: 43.19689715509813.
Norm before scaling: 43.194040071012694. Distance: 2.0764916676997793
Total norm for 4 adversaries is: 43.194040071012694. distance: 2.0764916676997793
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1711, Accuracy: 9451/9900 (95.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4446/5066 (87.7615%), train_poison_data_count: 400
Global model norm: 43.19689715509813.
Norm before scaling: 43.20197076893961. Distance: 2.2989278948321124
Total norm for 4 adversaries is: 43.20197076893961. distance: 2.2989278948321124
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2237, Accuracy: 9339/9900 (94.3333%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4047/4716 (85.8142%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4206/4716 (89.1858%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0346, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3955/4481 (88.2615%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3974/4481 (88.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0199, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3864/4361 (88.6035%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3890/4361 (89.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0195, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4144/4793 (86.4594%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4337/4793 (90.4861%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0013, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3731/4295 (86.8685%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3773/4295 (87.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9783, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4383/5244 (83.5812%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4576/5244 (87.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9939, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4307/4989 (86.3299%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4451/4989 (89.2163%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9278, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4529/5197 (87.1464%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4610/5197 (88.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2054, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3748/4356 (86.0422%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2054, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4002/4647 (86.1201%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9649, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4013 (89.2350%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3712/4013 (92.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7536, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4005/4538 (88.2547%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4164/4538 (91.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8055, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4081/4707 (86.7007%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4228/4707 (89.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8701, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5510/6263 (87.9770%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5737/6263 (91.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0948, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3747/4235 (88.4770%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3764/4235 (88.8784%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9814, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3342/3861 (86.5579%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3471/3861 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0209, Accuracy: 5400/10000 (54.0000%)
time spent on training: 259.2481508255005
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.4755, Accuracy: 6392/10000 (63.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.9177, Accuracy: 218/9900 (2.2020%)
Done in 286.6195683479309 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4318/4885 (88.3930%), train_poison_data_count: 385
Global model norm: 43.22736238077032.
Norm before scaling: 43.23097119100134. Distance: 2.2311681395829055
Total norm for 4 adversaries is: 43.23097119100134. distance: 2.2311681395829055
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0781, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4705/5305 (88.6899%), train_poison_data_count: 415
Global model norm: 43.22736238077032.
Norm before scaling: 43.23187052287062. Distance: 2.2526467967914923
Total norm for 4 adversaries is: 43.23187052287062. distance: 2.2526467967914923
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2184, Accuracy: 9404/9900 (94.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 43.22736238077032.
Norm before scaling: 43.22663098110426. Distance: 2.083042951055883
Total norm for 4 adversaries is: 43.22663098110426. distance: 2.083042951055883
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1749, Accuracy: 9489/9900 (95.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4424/5066 (87.3273%), train_poison_data_count: 400
Global model norm: 43.22736238077032.
Norm before scaling: 43.2323914773583. Distance: 2.3298765416652136
Total norm for 4 adversaries is: 43.2323914773583. distance: 2.3298765416652136
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1513, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4473/5055 (88.4866%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4576/5055 (90.5242%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8714, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3358/3828 (87.7220%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8797, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3831/4361 (87.8468%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3906/4361 (89.5666%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9500, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3547/4013 (88.3877%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3659/4013 (91.1787%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0736, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4013/4518 (88.8225%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4158/4518 (92.0319%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9213, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3965/4558 (86.9899%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4078/4558 (89.4691%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0323, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3606/4126 (87.3970%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3795/4126 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8452, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4186/4679 (89.4636%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3932/4679 (84.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1240, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3740/4235 (88.3117%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3761/4235 (88.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0160, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4319/5037 (85.7455%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8239, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3177/3672 (86.5196%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3358/3672 (91.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8762, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4296/4928 (87.1753%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4441/4928 (90.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8911, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4038/4356 (92.6997%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3934/4356 (90.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0252, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3951/4456 (88.6670%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4094/4456 (91.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0077, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4120/4793 (85.9587%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0003, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4401/5025 (87.5821%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4588/5025 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0172, Accuracy: 5438/10000 (54.3800%)
time spent on training: 257.68811416625977
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.5118, Accuracy: 6333/10000 (63.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.9470, Accuracy: 203/9900 (2.0505%)
Done in 285.58183431625366 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4372/4885 (89.4985%), train_poison_data_count: 385
Global model norm: 43.26422978745331.
Norm before scaling: 43.26855776219393. Distance: 2.136175389914946
Total norm for 4 adversaries is: 43.26855776219393. distance: 2.136175389914946
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0999, Accuracy: 9661/9900 (97.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4703/5305 (88.6522%), train_poison_data_count: 415
Global model norm: 43.26422978745331.
Norm before scaling: 43.26571387450244. Distance: 2.2642042243359435
Total norm for 4 adversaries is: 43.26571387450244. distance: 2.2642042243359435
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1136, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4236/4717 (89.8028%), train_poison_data_count: 370
Global model norm: 43.26422978745331.
Norm before scaling: 43.262951626055724. Distance: 2.043267135273821
Total norm for 4 adversaries is: 43.262951626055724. distance: 2.043267135273821
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2445, Accuracy: 9291/9900 (93.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4437/5066 (87.5839%), train_poison_data_count: 400
Global model norm: 43.26422978745331.
Norm before scaling: 43.270074143757256. Distance: 2.281842298563311
Total norm for 4 adversaries is: 43.270074143757256. distance: 2.281842298563311
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2864, Accuracy: 9231/9900 (93.2424%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3864/4346 (88.9093%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4031/4346 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9200, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3657/4184 (87.4044%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3765/4184 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9270, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4015/4356 (92.1717%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3802/4356 (87.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0803, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3191/3646 (87.5206%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3320/3646 (91.0587%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8033, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4431/5083 (87.1729%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4521/5083 (88.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1120, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3978/4356 (91.3223%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3943/4356 (90.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1050, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3941/4558 (86.4634%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4116/4558 (90.3028%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1357, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3594/4175 (86.0838%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3771/4175 (90.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8059, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3054/3472 (87.9608%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3142/3472 (90.4954%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1441, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3959/4501 (87.9582%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0317, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4813/5424 (88.7353%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4945/5424 (91.1689%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1610, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3912/4481 (87.3019%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3979/4481 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1852, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4778/5455 (87.5894%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4917/5455 (90.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1824, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4517/5232 (86.3341%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4677/5232 (89.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1086, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5437/6391 (85.0728%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5543/6391 (86.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1157, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3350/3775 (88.7417%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3529/3775 (93.4834%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8972, Accuracy: 5606/10000 (56.0600%)
time spent on training: 260.4974853992462
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.4688, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.2789, Accuracy: 141/9900 (1.4242%)
Done in 288.11186146736145 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4363/4885 (89.3142%), train_poison_data_count: 385
Global model norm: 43.31148396851218.
Norm before scaling: 43.308593573836475. Distance: 2.1726063107728715
Total norm for 4 adversaries is: 43.308593573836475. distance: 2.1726063107728715
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1144, Accuracy: 9598/9900 (96.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4732/5305 (89.1989%), train_poison_data_count: 415
Global model norm: 43.31148396851218.
Norm before scaling: 43.30620613993305. Distance: 2.1804215483851075
Total norm for 4 adversaries is: 43.30620613993305. distance: 2.1804215483851075
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1229, Accuracy: 9566/9900 (96.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.31148396851218.
Norm before scaling: 43.30693619567482. Distance: 2.0270032651900354
Total norm for 4 adversaries is: 43.30693619567482. distance: 2.0270032651900354
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1674, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4417/5066 (87.1891%), train_poison_data_count: 400
Global model norm: 43.31148396851218.
Norm before scaling: 43.3157734039915. Distance: 2.299416621485506
Total norm for 4 adversaries is: 43.3157734039915. distance: 2.299416621485506
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1452, Accuracy: 9520/9900 (96.1616%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3563/4025 (88.5217%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3754/4025 (93.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7263, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3715/4223 (87.9706%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3823/4223 (90.5281%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0602, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3350/3638 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8671, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4415/5063 (87.2013%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4424/5063 (87.3790%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9921, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4259/4874 (87.3820%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4275/4874 (87.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2029, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4324/4804 (90.0083%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4133/4804 (86.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2519, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3531/4158 (84.9206%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3632/4158 (87.3497%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8203, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3982/4518 (88.1363%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4179/4518 (92.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9365, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3772/4235 (89.0673%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3773/4235 (89.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0109, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4286/4934 (86.8666%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4158/4934 (84.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1980, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5577/6391 (87.2633%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5669/6391 (88.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1155, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3724/4295 (86.7055%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3823/4295 (89.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1310, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3352/3756 (89.2439%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3479/3756 (92.6251%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9166, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3930/4481 (87.7036%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3951/4481 (88.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0321, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3612/4175 (86.5150%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3654/4175 (87.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9948, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3169/3590 (88.2730%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3181/3590 (88.6072%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1217, Accuracy: 5288/10000 (52.8800%)
time spent on training: 255.80924272537231
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.4998, Accuracy: 6365/10000 (63.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.4573, Accuracy: 113/9900 (1.1414%)
Done in 283.4832124710083 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 43.35176171899621.
Norm before scaling: 43.35239104790314. Distance: 2.1425446305138887
Total norm for 4 adversaries is: 43.35239104790314. distance: 2.1425446305138887
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2509, Accuracy: 9279/9900 (93.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 43.35176171899621.
Norm before scaling: 43.350608629576215. Distance: 2.1776139435590087
Total norm for 4 adversaries is: 43.350608629576215. distance: 2.1776139435590087
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.3103, Accuracy: 9187/9900 (92.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 43.35176171899621.
Norm before scaling: 43.353828474073374. Distance: 2.0558426659347346
Total norm for 4 adversaries is: 43.353828474073374. distance: 2.0558426659347346
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1029, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4436/5066 (87.5642%), train_poison_data_count: 400
Global model norm: 43.35176171899621.
Norm before scaling: 43.35582333426719. Distance: 2.2776302726663222
Total norm for 4 adversaries is: 43.35582333426719. distance: 2.2776302726663222
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1324, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3385/3828 (88.4274%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8007, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3472/3911 (88.7752%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3327/3911 (85.0678%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1192, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3898/4362 (89.3627%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3909/4362 (89.6149%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0268, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4618/5197 (88.8590%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4614/5197 (88.7820%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1593, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4280/4679 (91.4725%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4388/4679 (93.7807%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9552, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4148/4793 (86.5429%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4324/4793 (90.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0684, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4599/5116 (89.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1906, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4026/4625 (87.0486%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4066/4625 (87.9135%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0475, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4102/4618 (88.8263%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4096/4618 (88.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0673, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2859/3271 (87.4045%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9754, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3651/4175 (87.4491%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3743/4175 (89.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9127, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3100/3616 (85.7301%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3303/3616 (91.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8187, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3928/4481 (87.6590%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3999/4481 (89.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1311, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3830/4368 (87.6832%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3898/4368 (89.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8761, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5001/5740 (87.1254%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5213/5740 (90.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9554, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4081/4647 (87.8201%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4207/4647 (90.5315%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8795, Accuracy: 5643/10000 (56.4300%)
time spent on training: 256.43201971054077
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5129, Accuracy: 6347/10000 (63.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.2229, Accuracy: 319/9900 (3.2222%)
Done in 284.2595765590668 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 43.38524284679066.
Norm before scaling: 43.38422992574606. Distance: 2.09091985929679
Total norm for 4 adversaries is: 43.38422992574606. distance: 2.09091985929679
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3011, Accuracy: 9158/9900 (92.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 43.38524284679066.
Norm before scaling: 43.37860778403625. Distance: 2.1323067201630583
Total norm for 4 adversaries is: 43.37860778403625. distance: 2.1323067201630583
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2468, Accuracy: 9299/9900 (93.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4212/4717 (89.2940%), train_poison_data_count: 370
Global model norm: 43.38524284679066.
Norm before scaling: 43.38427916551037. Distance: 2.0426088092634536
Total norm for 4 adversaries is: 43.38427916551037. distance: 2.0426088092634536
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1422, Accuracy: 9521/9900 (96.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4472/5066 (88.2748%), train_poison_data_count: 400
Global model norm: 43.38524284679066.
Norm before scaling: 43.39120734665031. Distance: 2.2618627420026325
Total norm for 4 adversaries is: 43.39120734665031. distance: 2.2618627420026325
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0958, Accuracy: 9634/9900 (97.3131%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4969/5591 (88.8750%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5022/5591 (89.8229%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0095, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4256/4956 (85.8757%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4341/4956 (87.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0602, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3921/4511 (86.9209%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4073/4511 (90.2904%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8842, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8218, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3204/3590 (89.2479%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3339/3590 (93.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8941, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4172/4793 (87.0436%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4387/4793 (91.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0149, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3359/3804 (88.3018%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3466/3804 (91.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8970, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3378/3837 (88.0375%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3554/3837 (92.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9178, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3900/4361 (89.4290%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3836/4361 (87.9615%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1403, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4455/5063 (87.9913%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4461/5063 (88.1098%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3461, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3819/4368 (87.4313%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0718, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4279/4679 (91.4512%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4136/4679 (88.3950%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0853, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4624/5265 (87.8253%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4666/5265 (88.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0696, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4133/4767 (86.7002%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4236/4767 (88.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1313, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5169/5902 (87.5805%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5031/5902 (85.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2010, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3711/4223 (87.8759%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8983, Accuracy: 5592/10000 (55.9200%)
time spent on training: 260.84360098838806
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.5089, Accuracy: 6397/10000 (63.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.2736, Accuracy: 321/9900 (3.2424%)
Done in 288.33451795578003 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 43.432030905700806.
Norm before scaling: 43.42886183218555. Distance: 2.0296108968491087
Total norm for 4 adversaries is: 43.42886183218555. distance: 2.0296108968491087
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3419, Accuracy: 9044/9900 (91.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 43.432030905700806.
Norm before scaling: 43.429891982114405. Distance: 2.189025673839007
Total norm for 4 adversaries is: 43.429891982114405. distance: 2.189025673839007
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2547, Accuracy: 9201/9900 (92.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 43.432030905700806.
Norm before scaling: 43.426121205211125. Distance: 2.018234692637764
Total norm for 4 adversaries is: 43.426121205211125. distance: 2.018234692637764
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1928, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4463/5066 (88.0971%), train_poison_data_count: 400
Global model norm: 43.432030905700806.
Norm before scaling: 43.43613841166348. Distance: 2.272553786678852
Total norm for 4 adversaries is: 43.43613841166348. distance: 2.272553786678852
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1777, Accuracy: 9438/9900 (95.3333%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3392/3797 (89.3337%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3460/3797 (91.1246%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9345, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3354/3861 (86.8687%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3503/3861 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9265, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4158/4707 (88.3365%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9801, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4014/4518 (88.8446%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4171/4518 (92.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9763, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3601/4013 (89.7334%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3700/4013 (92.2003%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9751, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4591/5167 (88.8523%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4680/5167 (90.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1009, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3503/3969 (88.2590%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3635/3969 (91.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8437, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3966/4441 (89.3042%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4117/4441 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0574, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4000/4558 (87.7578%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4088/4558 (89.6885%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0202, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3932/4465 (88.0627%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4144/4465 (92.8108%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8783, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3185/3638 (87.5481%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9641, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4030/4538 (88.8056%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4175/4538 (92.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7847, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5027/5740 (87.5784%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5245/5740 (91.3763%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0669, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3370/3837 (87.8290%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3547/3837 (92.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8426, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3890/4361 (89.1997%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3765/4361 (86.3334%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1435, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4154/4793 (86.6681%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4282/4793 (89.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0587, Accuracy: 5303/10000 (53.0300%)
time spent on training: 255.472154378891
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.5051, Accuracy: 6407/10000 (64.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.6807, Accuracy: 213/9900 (2.1515%)
Done in 283.0392532348633 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 43.46372437923449.
Norm before scaling: 43.46148168924985. Distance: 2.0776280547520583
Total norm for 4 adversaries is: 43.46148168924985. distance: 2.0776280547520583
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2332, Accuracy: 9262/9900 (93.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4744/5305 (89.4251%), train_poison_data_count: 415
Global model norm: 43.46372437923449.
Norm before scaling: 43.460844109417906. Distance: 2.157613350906338
Total norm for 4 adversaries is: 43.460844109417906. distance: 2.157613350906338
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1121, Accuracy: 9613/9900 (97.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 43.46372437923449.
Norm before scaling: 43.45926978082826. Distance: 2.0082683120057916
Total norm for 4 adversaries is: 43.45926978082826. distance: 2.0082683120057916
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1991, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 43.46372437923449.
Norm before scaling: 43.465492329404256. Distance: 2.2058765732932573
Total norm for 4 adversaries is: 43.465492329404256. distance: 2.2058765732932573
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2769, Accuracy: 9176/9900 (92.6869%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4102/4767 (86.0499%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4248/4767 (89.1126%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1107, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3967/4441 (89.3267%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4099/4441 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0343, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4033/4356 (92.5849%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3956/4356 (90.8173%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3992, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5589/6391 (87.4511%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5695/6391 (89.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1603, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3711/4184 (88.6950%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3780/4184 (90.3442%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0052, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3909/4346 (89.9448%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4043/4346 (93.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7789, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4396/5037 (87.2742%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0316, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4076/4634 (87.9586%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8329, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4398/4934 (89.1366%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4372/4934 (88.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1426, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4816/5424 (88.7906%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4886/5424 (90.0811%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1216, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3347/3781 (88.5216%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3307/3781 (87.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0670, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3429/3861 (88.8112%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3483/3861 (90.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9622, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4522/5055 (89.4560%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4662/5055 (92.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8149, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4049/4433 (91.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7950, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4609/5167 (89.2007%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4672/5167 (90.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1195, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3208/3590 (89.3593%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3190/3590 (88.8579%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0255, Accuracy: 5540/10000 (55.4000%)
time spent on training: 261.3071279525757
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7344, Accuracy: 6065/10000 (60.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.8039, Accuracy: 684/9900 (6.9091%)
Done in 288.79287004470825 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 43.49521514183342.
Norm before scaling: 43.49489940687371. Distance: 2.152958887610426
Total norm for 4 adversaries is: 43.49489940687371. distance: 2.152958887610426
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2423, Accuracy: 9272/9900 (93.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 43.49521514183342.
Norm before scaling: 43.49345962640173. Distance: 2.1528571151825973
Total norm for 4 adversaries is: 43.49345962640173. distance: 2.1528571151825973
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2102, Accuracy: 9383/9900 (94.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 43.49521514183342.
Norm before scaling: 43.493118618782674. Distance: 2.0537982365242446
Total norm for 4 adversaries is: 43.493118618782674. distance: 2.0537982365242446
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2125, Accuracy: 9332/9900 (94.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4494/5066 (88.7090%), train_poison_data_count: 400
Global model norm: 43.49521514183342.
Norm before scaling: 43.50022730274665. Distance: 2.2726358265252493
Total norm for 4 adversaries is: 43.50022730274665. distance: 2.2726358265252493
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1821, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3809/4368 (87.2024%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3943/4368 (90.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9540, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3361/3828 (87.8004%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3518/3828 (91.9018%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7293, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4136/4356 (94.9495%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3813/4356 (87.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0685, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3377/3861 (87.4644%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8516, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3057/3472 (88.0472%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3167/3472 (91.2154%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0891, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4080/4538 (89.9074%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4193/4538 (92.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8264, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4723/5392 (87.5927%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4845/5392 (89.8553%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9730, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3757/4295 (87.4738%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3717/4295 (86.5425%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9964, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3722/4235 (87.8867%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3829/4235 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9512, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3986/4456 (89.4524%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4072/4456 (91.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0203, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4562/5265 (86.6477%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4577/5265 (86.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0948, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3965/4441 (89.2817%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4091/4441 (92.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0885, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3568/4013 (88.9110%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3707/4013 (92.3748%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8403, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3919/4465 (87.7716%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4085/4465 (91.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8370, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5535/6263 (88.3762%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5687/6263 (90.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9685, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4396/4986 (88.1669%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4531/4986 (90.8744%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9082, Accuracy: 5689/10000 (56.8900%)
time spent on training: 258.76759934425354
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 2 with 1 misclassifications.
Client 3 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {3: 1})
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(3, 1)]
Top 3 clients: [(3, 1)]
Client 3 misclassification ratio: 1.0000
Client 3 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
