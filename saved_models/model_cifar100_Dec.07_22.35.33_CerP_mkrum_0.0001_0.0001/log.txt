current path: saved_models/model_cifar100_Dec.07_22.35.33_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4308/4885 (88.1883%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43996218925036. Distance: 2.292858946476538
Total norm for 4 adversaries is: 42.43996218925036. distance: 2.292858946476538
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4453, Accuracy: 8820/9900 (89.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435298002978165. Distance: 2.250587598579401
Total norm for 4 adversaries is: 42.435298002978165. distance: 2.250587598579401
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7243, Accuracy: 8314/9900 (83.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43862612414176. Distance: 2.175889182024763
Total norm for 4 adversaries is: 42.43862612414176. distance: 2.175889182024763
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4295, Accuracy: 8883/9900 (89.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44031597339816. Distance: 2.3039974925438163
Total norm for 4 adversaries is: 42.44031597339816. distance: 2.3039974925438163
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5924, Accuracy: 8518/9900 (86.0404%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3833/4356 (87.9936%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3678/4356 (84.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4149, Accuracy: 4661/10000 (46.6100%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3933/4465 (88.0851%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4103/4465 (91.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9397, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4040/4647 (86.9378%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4146/4647 (89.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9838, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4444/5055 (87.9130%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4498/5055 (88.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1007, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4448/5116 (86.9429%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4487/5116 (87.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0588, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3626/4126 (87.8817%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3744/4126 (90.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9643, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0647, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4434/4986 (88.9290%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4447/4986 (89.1897%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1343, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3690/4013 (91.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8445, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4074/4618 (88.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0303, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4421/5083 (86.9762%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4427/5083 (87.0942%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0325, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3966/4511 (87.9184%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4038/4511 (89.5145%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0863, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3333/3797 (87.7798%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3387/3797 (89.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9723, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5002/5582 (89.6095%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5036/5582 (90.2186%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1881, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3201/3616 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1302, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4830/5455 (88.5426%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4842/5455 (88.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8852, Accuracy: 5491/10000 (54.9100%)
time spent on training: 263.0030722618103
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1051, Accuracy: 7048/10000 (70.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0663, Accuracy: 119/9900 (1.2020%)
Done in 293.1716742515564 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.454830086295836.
Norm before scaling: 42.4607067898516. Distance: 2.1084541854096415
Total norm for 4 adversaries is: 42.4607067898516. distance: 2.1084541854096415
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2593, Accuracy: 9223/9900 (93.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 42.454830086295836.
Norm before scaling: 42.45830474243599. Distance: 2.1666623139949017
Total norm for 4 adversaries is: 42.45830474243599. distance: 2.1666623139949017
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5592, Accuracy: 8547/9900 (86.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.454830086295836.
Norm before scaling: 42.46207953270998. Distance: 2.1638699111900674
Total norm for 4 adversaries is: 42.46207953270998. distance: 2.1638699111900674
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2281, Accuracy: 9349/9900 (94.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 42.454830086295836.
Norm before scaling: 42.46475301969196. Distance: 2.2910649521144375
Total norm for 4 adversaries is: 42.46475301969196. distance: 2.2910649521144375
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2695, Accuracy: 9171/9900 (92.6364%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3600/4025 (89.4410%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3714/4025 (92.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9423, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3344/3797 (88.0695%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3396/3797 (89.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0474, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3938/4625 (85.1459%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4005/4625 (86.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1640, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3849/4481 (85.8960%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3878/4481 (86.5432%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1435, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3862/4315 (89.5017%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9920, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3714/4235 (87.6978%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3818/4235 (90.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9716, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3381/3828 (88.3229%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9661, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3814/4416 (86.3678%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3956/4416 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9501, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3285/3638 (90.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9545, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4544/5265 (86.3058%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4512/5265 (85.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9615, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3350/3781 (88.6009%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3308/3781 (87.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3466, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3983/4441 (89.6870%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4033/4441 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1576, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3978/4433 (89.7361%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9880, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4434/5083 (87.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0862, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4328/4928 (87.8247%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4399/4928 (89.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9218, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4793 (87.1479%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0613, Accuracy: 5381/10000 (53.8100%)
time spent on training: 262.05740690231323
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0972, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0699, Accuracy: 229/9900 (2.3131%)
Done in 292.2510509490967 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 42.47741961039786.
Norm before scaling: 42.47779319878873. Distance: 2.017170158565806
Total norm for 4 adversaries is: 42.47779319878873. distance: 2.017170158565806
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2355, Accuracy: 9266/9900 (93.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.47741961039786.
Norm before scaling: 42.47874152379414. Distance: 2.0966713864748927
Total norm for 4 adversaries is: 42.47874152379414. distance: 2.0966713864748927
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0847, Accuracy: 9666/9900 (97.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 42.47741961039786.
Norm before scaling: 42.478915381082004. Distance: 1.9891497021279183
Total norm for 4 adversaries is: 42.478915381082004. distance: 1.9891497021279183
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2185, Accuracy: 9342/9900 (94.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 42.47741961039786.
Norm before scaling: 42.48374717952811. Distance: 2.1646450098801022
Total norm for 4 adversaries is: 42.48374717952811. distance: 2.1646450098801022
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1510, Accuracy: 9509/9900 (96.0505%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3290/3616 (90.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8525, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3513/3837 (91.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9545, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4169/4679 (89.1002%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4277/4679 (91.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0234, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3103/3638 (85.2941%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3264/3638 (89.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0429, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3627/4046 (89.6441%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3627/4046 (89.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9763, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3991/4518 (88.3355%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4085/4518 (90.4161%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1233, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3387/3797 (89.2020%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3418/3797 (90.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1071, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4441/5025 (88.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2686, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3921/4362 (89.8900%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3938/4362 (90.2797%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0325, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3996/4558 (87.6700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4012/4558 (88.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1413, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3202/3672 (87.2004%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3284/3672 (89.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0057, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4330/4874 (88.8387%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4372/4874 (89.7005%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2339, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3609/4025 (89.6646%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9313, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4099/4663 (87.9048%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4219/4663 (90.4782%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0979, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3454/3911 (88.3150%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3461/3911 (88.4940%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0282, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4439/5017 (88.4792%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4564/5017 (90.9707%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8443, Accuracy: 5648/10000 (56.4800%)
time spent on training: 264.98056626319885
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0909, Accuracy: 7043/10000 (70.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0834, Accuracy: 432/9900 (4.3636%)
Done in 295.6591680049896 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 42.49779836898539.
Norm before scaling: 42.499942555108234. Distance: 1.971542194894956
Total norm for 4 adversaries is: 42.499942555108234. distance: 1.971542194894956
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5226, Accuracy: 8711/9900 (87.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4839/5305 (91.2158%), train_poison_data_count: 415
Global model norm: 42.49779836898539.
Norm before scaling: 42.49588962200492. Distance: 2.0206659254229846
Total norm for 4 adversaries is: 42.49588962200492. distance: 2.0206659254229846
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0767, Accuracy: 9692/9900 (97.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 42.49779836898539.
Norm before scaling: 42.4992848055632. Distance: 1.9555591521205966
Total norm for 4 adversaries is: 42.4992848055632. distance: 1.9555591521205966
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1370, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 42.49779836898539.
Norm before scaling: 42.503620307661. Distance: 2.116989858488605
Total norm for 4 adversaries is: 42.503620307661. distance: 2.116989858488605
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3336, Accuracy: 9056/9900 (91.4747%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5269/6124 (86.0385%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5323/6124 (86.9203%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1100, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3884/4356 (89.1644%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3676/4356 (84.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4268, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3548/4158 (85.3295%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3598/4158 (86.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1101, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4898/5455 (89.7892%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4931/5455 (90.3941%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0021, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3938/4511 (87.2977%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4050/4511 (89.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9960, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4546/5232 (86.8884%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4564/5232 (87.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0223, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4495/5244 (85.7170%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4569/5244 (87.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0051, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4381/4918 (89.0809%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4399/4918 (89.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0654, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3622/4126 (87.7848%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3733/4126 (90.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8269, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4358/4928 (88.4334%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4381/4928 (88.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2552, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3739/4223 (88.5390%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3850/4223 (91.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9035, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4514/5195 (86.8912%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4607/5195 (88.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1218, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4166/4679 (89.0361%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4117/4679 (87.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0782, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3202/3646 (87.8223%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3280/3646 (89.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8620, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3201/3616 (88.5232%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3214/3616 (88.8827%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9271, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4073/4716 (86.3656%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4100/4716 (86.9381%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0028, Accuracy: 5402/10000 (54.0200%)
time spent on training: 269.29037141799927
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0880, Accuracy: 7065/10000 (70.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4296, Accuracy: 691/9900 (6.9798%)
Done in 299.536660194397 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 42.522703322478954.
Norm before scaling: 42.525525135922045. Distance: 1.9580142051991964
Total norm for 4 adversaries is: 42.525525135922045. distance: 1.9580142051991964
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1691, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4868/5305 (91.7625%), train_poison_data_count: 415
Global model norm: 42.522703322478954.
Norm before scaling: 42.517817094811114. Distance: 1.983489852894704
Total norm for 4 adversaries is: 42.517817094811114. distance: 1.983489852894704
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1393, Accuracy: 9545/9900 (96.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 42.522703322478954.
Norm before scaling: 42.5234812775358. Distance: 1.9184494503858873
Total norm for 4 adversaries is: 42.5234812775358. distance: 1.9184494503858873
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1900, Accuracy: 9394/9900 (94.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4557/5066 (89.9526%), train_poison_data_count: 400
Global model norm: 42.522703322478954.
Norm before scaling: 42.529820650118545. Distance: 2.0773369004623348
Total norm for 4 adversaries is: 42.529820650118545. distance: 2.0773369004623348
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2704, Accuracy: 9229/9900 (93.2222%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5280/6124 (86.2182%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5339/6124 (87.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0451, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4020/4433 (90.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0234, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3377/3781 (89.3150%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3205/3781 (84.7659%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3119, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3578/3969 (90.1487%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3573/3969 (90.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9958, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4537/5025 (90.2886%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2583, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4189/4679 (89.5277%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4234/4679 (90.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0386, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4169/4707 (88.5702%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4204/4707 (89.3138%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0053, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4438/4986 (89.0092%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4469/4986 (89.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9589, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3900/4315 (90.3824%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3969/4315 (91.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8472, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3862/4416 (87.4547%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3924/4416 (88.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9862, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4242/4804 (88.3014%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4065/4804 (84.6170%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1557, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4253/4793 (88.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0256, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4551/5232 (86.9839%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4553/5232 (87.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9401, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4121/4662 (88.3955%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4195/4662 (89.9828%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1446, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4252/4956 (85.7950%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4320/4956 (87.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0812, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3819/4368 (87.4313%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3829/4368 (87.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9945, Accuracy: 5378/10000 (53.7800%)
time spent on training: 271.1945676803589
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0872, Accuracy: 7073/10000 (70.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7358, Accuracy: 1072/9900 (10.8283%)
Done in 301.53135323524475 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 42.5470729659368.
Norm before scaling: 42.54734122265676. Distance: 1.921102166826411
Total norm for 4 adversaries is: 42.54734122265676. distance: 1.921102166826411
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2884, Accuracy: 9183/9900 (92.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4853/5305 (91.4797%), train_poison_data_count: 415
Global model norm: 42.5470729659368.
Norm before scaling: 42.54384658015701. Distance: 1.951358209672759
Total norm for 4 adversaries is: 42.54384658015701. distance: 1.951358209672759
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2133, Accuracy: 9360/9900 (94.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4319/4717 (91.5624%), train_poison_data_count: 370
Global model norm: 42.5470729659368.
Norm before scaling: 42.54686782730384. Distance: 1.862329011787265
Total norm for 4 adversaries is: 42.54686782730384. distance: 1.862329011787265
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2358, Accuracy: 9304/9900 (93.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 42.5470729659368.
Norm before scaling: 42.55159293755567. Distance: 2.0157371312378447
Total norm for 4 adversaries is: 42.55159293755567. distance: 2.0157371312378447
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1169, Accuracy: 9599/9900 (96.9596%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5367/6124 (87.6388%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5355/6124 (87.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1082, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5165/5902 (87.5127%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5176/5902 (87.6991%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2029, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4186/4707 (88.9314%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4199/4707 (89.2076%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9854, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4095/4647 (88.1214%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4169/4647 (89.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9075, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2983/3297 (90.4762%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3027/3297 (91.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8004, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5569/6263 (88.9190%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5642/6263 (90.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1513, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4181/4663 (89.6633%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4245/4663 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1033, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4334/4956 (87.4496%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4377/4956 (88.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2751, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3626/4046 (89.6194%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3720/4046 (91.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8887, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3720/4184 (88.9101%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3769/4184 (90.0813%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8142, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4874/5591 (87.1758%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1217, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4092/4634 (88.3038%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4179/4634 (90.1813%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9495, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3398/3828 (88.7670%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3503/3828 (91.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9578, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3151/3638 (86.6135%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3269/3638 (89.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8760, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3395/3781 (89.7911%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3358/3781 (88.8125%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2078, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3418/3837 (89.0800%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3528/3837 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8711, Accuracy: 5736/10000 (57.3600%)
time spent on training: 263.45346188545227
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0837, Accuracy: 7078/10000 (70.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2111, Accuracy: 1398/9900 (14.1212%)
Done in 293.980673789978 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 42.5704809652108.
Norm before scaling: 42.568707387385075. Distance: 1.8532977121804108
Total norm for 4 adversaries is: 42.568707387385075. distance: 1.8532977121804108
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2715, Accuracy: 9243/9900 (93.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4881/5305 (92.0075%), train_poison_data_count: 415
Global model norm: 42.5704809652108.
Norm before scaling: 42.56797183989977. Distance: 1.9384951958133103
Total norm for 4 adversaries is: 42.56797183989977. distance: 1.9384951958133103
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1556, Accuracy: 9529/9900 (96.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 42.5704809652108.
Norm before scaling: 42.572125437401084. Distance: 1.8806798736386199
Total norm for 4 adversaries is: 42.572125437401084. distance: 1.8806798736386199
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1500, Accuracy: 9515/9900 (96.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 42.5704809652108.
Norm before scaling: 42.57230608173801. Distance: 1.948831034230171
Total norm for 4 adversaries is: 42.57230608173801. distance: 1.948831034230171
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2404, Accuracy: 9324/9900 (94.1818%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3918/4501 (87.0473%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3948/4501 (87.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9954, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3721/4175 (89.1257%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3765/4175 (90.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9637, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3175/3616 (87.8042%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3243/3616 (89.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9048, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4061/4634 (87.6349%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4099/4634 (88.4549%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9800, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4027/4558 (88.3502%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4009/4558 (87.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1389, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4558/5167 (88.2137%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4582/5167 (88.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1539, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3891/4356 (89.3251%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3857/4356 (88.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1781, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4143/4716 (87.8499%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4176/4716 (88.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9959, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5394/6124 (88.0797%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5321/6124 (86.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2177, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4462/5055 (88.2690%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4589/5055 (90.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0109, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4530/5025 (90.1493%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4576/5025 (91.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1091, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4370/4918 (88.8573%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4376/4918 (88.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1226, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3763/4223 (89.1073%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3806/4223 (90.1255%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9228, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3926/4481 (87.6144%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3866/4481 (86.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0768, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3303/3638 (90.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8721, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3580/4013 (89.2101%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3679/4013 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8018, Accuracy: 5720/10000 (57.2000%)
time spent on training: 267.96278715133667
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0844, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6934, Accuracy: 1897/9900 (19.1616%)
Done in 298.12690830230713 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4510/4885 (92.3234%), train_poison_data_count: 385
Global model norm: 42.59376719552111.
Norm before scaling: 42.59157041149325. Distance: 1.8389775207124721
Total norm for 4 adversaries is: 42.59157041149325. distance: 1.8389775207124721
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2384, Accuracy: 9298/9900 (93.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4860/5305 (91.6117%), train_poison_data_count: 415
Global model norm: 42.59376719552111.
Norm before scaling: 42.59079943237815. Distance: 1.922795703206381
Total norm for 4 adversaries is: 42.59079943237815. distance: 1.922795703206381
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2274, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4331/4717 (91.8168%), train_poison_data_count: 370
Global model norm: 42.59376719552111.
Norm before scaling: 42.59269389510585. Distance: 1.7841415359435278
Total norm for 4 adversaries is: 42.59269389510585. distance: 1.7841415359435278
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4229, Accuracy: 8871/9900 (89.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 42.59376719552111.
Norm before scaling: 42.59511702226706. Distance: 1.9551503170987063
Total norm for 4 adversaries is: 42.59511702226706. distance: 1.9551503170987063
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1313, Accuracy: 9562/9900 (96.5859%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3212/3646 (88.0965%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3314/3646 (90.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8188, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3961/4501 (88.0027%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4028/4501 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0101, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4110/4651 (88.3681%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4196/4651 (90.2172%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0292, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4608/5167 (89.1813%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4675/5167 (90.4780%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0042, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4918/5455 (90.1558%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4937/5455 (90.5041%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0783, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4910/5591 (87.8197%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4867/5591 (87.0506%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1174, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4225/4679 (90.2971%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4177/4679 (89.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0568, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4480/5017 (89.2964%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4518/5017 (90.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9067, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4277/4793 (89.2343%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4328/4793 (90.2984%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0782, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4028/4456 (90.3950%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4095/4456 (91.8986%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8785, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4829/5424 (89.0302%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4909/5424 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1357, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3690/4175 (88.3832%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3700/4175 (88.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9594, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4567/5116 (89.2690%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4585/5116 (89.6208%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0579, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3311/3704 (89.3898%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3359/3704 (90.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9048, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4523/5232 (86.4488%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4643/5232 (88.7424%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0958, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3111/3472 (89.6025%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3169/3472 (91.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9938, Accuracy: 5581/10000 (55.8100%)
time spent on training: 268.89078974723816
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0869, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1931, Accuracy: 2480/9900 (25.0505%)
Done in 299.6128959655762 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4512/4885 (92.3644%), train_poison_data_count: 385
Global model norm: 42.61734432258039.
Norm before scaling: 42.615383640788245. Distance: 1.8070354958041952
Total norm for 4 adversaries is: 42.615383640788245. distance: 1.8070354958041952
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1959, Accuracy: 9421/9900 (95.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4884/5305 (92.0641%), train_poison_data_count: 415
Global model norm: 42.61734432258039.
Norm before scaling: 42.61144195344207. Distance: 1.8830256677783457
Total norm for 4 adversaries is: 42.61144195344207. distance: 1.8830256677783457
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1934, Accuracy: 9449/9900 (95.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 42.61734432258039.
Norm before scaling: 42.614432627503824. Distance: 1.7862275830004093
Total norm for 4 adversaries is: 42.614432627503824. distance: 1.7862275830004093
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1430, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4647/5066 (91.7292%), train_poison_data_count: 400
Global model norm: 42.61734432258039.
Norm before scaling: 42.61874925529769. Distance: 1.9213131339149476
Total norm for 4 adversaries is: 42.61874925529769. distance: 1.9213131339149476
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3463, Accuracy: 9039/9900 (91.3030%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3237/3590 (90.1671%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3338/3590 (92.9805%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9587, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4368 (88.7821%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3873/4368 (88.6676%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8498, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3313/3704 (89.4438%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3386/3704 (91.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9809, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4353/4928 (88.3320%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4365/4928 (88.5755%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0964, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3923/4356 (90.0597%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1707, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3510/3911 (89.7469%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3307/3911 (84.5564%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2293, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4166/4651 (89.5721%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4176/4651 (89.7871%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0208, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3753/4184 (89.6989%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3766/4184 (90.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9348, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3927/4346 (90.3590%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3998/4346 (91.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9215, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4375/4793 (91.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1153, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3435/3804 (90.2997%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9244, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4495/4986 (90.1524%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4475/4986 (89.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8599, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5371/6124 (87.7041%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5294/6124 (86.4468%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9917, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4195/4707 (89.1226%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4233/4707 (89.9299%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9995, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3833/4235 (90.5077%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3729/4235 (88.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1228, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3665/4046 (90.5833%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3695/4046 (91.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9497, Accuracy: 5467/10000 (54.6700%)
time spent on training: 264.58479022979736
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0911, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7147, Accuracy: 3081/9900 (31.1212%)
Done in 295.1775155067444 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4551/4885 (93.1627%), train_poison_data_count: 385
Global model norm: 42.63967741251979.
Norm before scaling: 42.63390698040777. Distance: 1.771192768494128
Total norm for 4 adversaries is: 42.63390698040777. distance: 1.771192768494128
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0720, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4903/5305 (92.4222%), train_poison_data_count: 415
Global model norm: 42.63967741251979.
Norm before scaling: 42.63552896444613. Distance: 1.8457369039361042
Total norm for 4 adversaries is: 42.63552896444613. distance: 1.8457369039361042
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1040, Accuracy: 9649/9900 (97.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 42.63967741251979.
Norm before scaling: 42.636731454704936. Distance: 1.749400581153746
Total norm for 4 adversaries is: 42.636731454704936. distance: 1.749400581153746
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3303, Accuracy: 9136/9900 (92.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 42.63967741251979.
Norm before scaling: 42.6411531778391. Distance: 1.9394816447424732
Total norm for 4 adversaries is: 42.6411531778391. distance: 1.9394816447424732
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1694, Accuracy: 9473/9900 (95.6869%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4457/4986 (89.3903%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4472/4986 (89.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1401, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4073/4634 (87.8938%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4145/4634 (89.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9347, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4160/4716 (88.2103%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4209/4716 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1850, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5375/6124 (87.7694%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5437/6124 (88.7818%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0741, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4410/4918 (89.6706%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4514/4918 (91.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0891, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3400/3797 (89.5444%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3432/3797 (90.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0521, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5000/5582 (89.5736%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5044/5582 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1453, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4362/4956 (88.0145%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4307/4956 (86.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2126, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4019/4433 (90.6610%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4029/4433 (90.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8559, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3874/4354 (88.9757%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3366/4354 (77.3082%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4379, Accuracy: 4669/10000 (46.6900%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4352/4928 (88.3117%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4430/4928 (89.8945%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1027, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3498/3911 (89.4400%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3444/3911 (88.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9626, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3856/4481 (86.0522%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3834/4481 (85.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1190, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4604/5197 (88.5896%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4609/5197 (88.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0261, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4854/5455 (88.9826%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4888/5455 (89.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0325, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3841/4361 (88.0761%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3718/4361 (85.2557%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1864, Accuracy: 5061/10000 (50.6100%)
time spent on training: 272.5089237689972
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0962, Accuracy: 7047/10000 (70.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3580, Accuracy: 3543/9900 (35.7879%)
Done in 303.2194199562073 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4532/4885 (92.7738%), train_poison_data_count: 385
Global model norm: 42.66540938750178.
Norm before scaling: 42.66498880266172. Distance: 1.775529677649802
Total norm for 4 adversaries is: 42.66498880266172. distance: 1.775529677649802
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1652, Accuracy: 9504/9900 (96.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 42.66540938750178.
Norm before scaling: 42.65850640781171. Distance: 1.8289370567207306
Total norm for 4 adversaries is: 42.65850640781171. distance: 1.8289370567207306
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1492, Accuracy: 9506/9900 (96.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4369/4717 (92.6224%), train_poison_data_count: 370
Global model norm: 42.66540938750178.
Norm before scaling: 42.659486484360954. Distance: 1.7087037995126582
Total norm for 4 adversaries is: 42.659486484360954. distance: 1.7087037995126582
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0736, Accuracy: 9708/9900 (98.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 42.66540938750178.
Norm before scaling: 42.66804009452289. Distance: 1.9055620421672084
Total norm for 4 adversaries is: 42.66804009452289. distance: 1.9055620421672084
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1736, Accuracy: 9472/9900 (95.6768%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4338/4928 (88.0276%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4353/4928 (88.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9875, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3789/4184 (90.5593%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3823/4184 (91.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8932, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4265/4707 (90.6097%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4220/4707 (89.6537%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0434, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3438/3828 (89.8119%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3547/3828 (92.6594%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8741, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4014/4503 (89.1406%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4031/4503 (89.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9386, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4208/4662 (90.2617%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4216/4662 (90.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0010, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3795/4235 (89.6104%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3817/4235 (90.1299%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0829, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4443/5244 (84.7254%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4495/5244 (85.7170%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0025, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4268/4793 (89.0465%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0142, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3987/4481 (88.9757%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3868/4481 (86.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2136, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4039/4346 (92.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7409, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3848/4361 (88.2366%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3729/4361 (85.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1647, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4557/5055 (90.1484%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4556/5055 (90.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9629, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4586/5195 (88.2772%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4551/5195 (87.6035%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1378, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3935/4315 (91.1935%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3985/4315 (92.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9794, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4226/4663 (90.6284%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4284/4663 (91.8722%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0519, Accuracy: 5403/10000 (54.0300%)
time spent on training: 267.2337086200714
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1008, Accuracy: 7040/10000 (70.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9425, Accuracy: 4123/9900 (41.6465%)
Done in 297.74000906944275 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4550/4885 (93.1423%), train_poison_data_count: 385
Global model norm: 42.688802540065325.
Norm before scaling: 42.68492768832826. Distance: 1.6988455527002215
Total norm for 4 adversaries is: 42.68492768832826. distance: 1.6988455527002215
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1617, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4921/5305 (92.7615%), train_poison_data_count: 415
Global model norm: 42.688802540065325.
Norm before scaling: 42.68395248573739. Distance: 1.8152655188177276
Total norm for 4 adversaries is: 42.68395248573739. distance: 1.8152655188177276
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2275, Accuracy: 9336/9900 (94.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4384/4717 (92.9404%), train_poison_data_count: 370
Global model norm: 42.688802540065325.
Norm before scaling: 42.68304875904705. Distance: 1.671258759343682
Total norm for 4 adversaries is: 42.68304875904705. distance: 1.671258759343682
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1778, Accuracy: 9478/9900 (95.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4674/5066 (92.2621%), train_poison_data_count: 400
Global model norm: 42.688802540065325.
Norm before scaling: 42.68869816674989. Distance: 1.8397462985072408
Total norm for 4 adversaries is: 42.68869816674989. distance: 1.8397462985072408
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1489, Accuracy: 9516/9900 (96.1212%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3975/4315 (92.1205%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3975/4315 (92.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8741, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3276/3590 (91.2535%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3220/3590 (89.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1063, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4228/4679 (90.3612%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4287/4679 (91.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9085, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4628/5167 (89.5684%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4671/5167 (90.4006%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1093, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3392/3775 (89.8543%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3524/3775 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7851, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3451/3828 (90.1515%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3470/3828 (90.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9641, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3804/4235 (89.8229%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3864/4235 (91.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9260, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4142/4647 (89.1328%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9977, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4426/4918 (89.9959%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0430, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9855, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3981/4481 (88.8418%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3888/4481 (86.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1723, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3829/4295 (89.1502%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3704/4295 (86.2398%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2073, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4016/4503 (89.1850%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4021/4503 (89.2960%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9875, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3871/4354 (88.9068%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3573/4354 (82.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3703, Accuracy: 4811/10000 (48.1100%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4495/4986 (90.1524%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4455/4986 (89.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9892, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5590/6263 (89.2544%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5693/6263 (90.8989%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1354, Accuracy: 5211/10000 (52.1100%)
time spent on training: 267.792528629303
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1134, Accuracy: 7012/10000 (70.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6125, Accuracy: 4671/9900 (47.1818%)
Done in 298.71148586273193 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4532/4885 (92.7738%), train_poison_data_count: 385
Global model norm: 42.71180562612344.
Norm before scaling: 42.70697247577818. Distance: 1.7342301729236616
Total norm for 4 adversaries is: 42.70697247577818. distance: 1.7342301729236616
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1631, Accuracy: 9499/9900 (95.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4899/5305 (92.3468%), train_poison_data_count: 415
Global model norm: 42.71180562612344.
Norm before scaling: 42.70740693863156. Distance: 1.8689543851508024
Total norm for 4 adversaries is: 42.70740693863156. distance: 1.8689543851508024
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0847, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4385/4717 (92.9616%), train_poison_data_count: 370
Global model norm: 42.71180562612344.
Norm before scaling: 42.70388394632931. Distance: 1.648441188139202
Total norm for 4 adversaries is: 42.70388394632931. distance: 1.648441188139202
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1702, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4682/5066 (92.4201%), train_poison_data_count: 400
Global model norm: 42.71180562612344.
Norm before scaling: 42.70972781005956. Distance: 1.8197336872940308
Total norm for 4 adversaries is: 42.70972781005956. distance: 1.8197336872940308
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0644, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3764/4223 (89.1309%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3821/4223 (90.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9872, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4935/5455 (90.4675%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4859/5455 (89.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1339, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5109/5582 (91.5263%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5097/5582 (91.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1175, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4027/4465 (90.1904%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4085/4465 (91.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8080, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4960/5591 (88.7140%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4959/5591 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1955, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3533/3911 (90.3350%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3385/3911 (86.5508%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0513, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3929/4356 (90.1974%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0144, Accuracy: 3294/4356 (75.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6598, Accuracy: 4469/10000 (44.6900%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4479/5037 (88.9220%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9703, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4249/4679 (90.8100%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4222/4679 (90.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1547, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3999/4362 (91.6781%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3906/4362 (89.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1707, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4127/4518 (91.3457%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4166/4518 (92.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9050, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4508/5083 (88.6878%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4507/5083 (88.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1869, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3604/4013 (89.8081%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3719/4013 (92.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7786, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4614/5197 (88.7820%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4672/5197 (89.8980%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1068, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2974/3297 (90.2032%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3059/3297 (92.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7954, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4036/4441 (90.8804%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4028/4441 (90.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1395, Accuracy: 5304/10000 (53.0400%)
time spent on training: 270.82655334472656
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1158, Accuracy: 7020/10000 (70.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3576, Accuracy: 5069/9900 (51.2020%)
Done in 300.9527790546417 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4546/4885 (93.0604%), train_poison_data_count: 385
Global model norm: 42.73487631104497.
Norm before scaling: 42.7296372488003. Distance: 1.7199695768548922
Total norm for 4 adversaries is: 42.7296372488003. distance: 1.7199695768548922
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0899, Accuracy: 9683/9900 (97.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4920/5305 (92.7427%), train_poison_data_count: 415
Global model norm: 42.73487631104497.
Norm before scaling: 42.72664892453318. Distance: 1.7478175860009895
Total norm for 4 adversaries is: 42.72664892453318. distance: 1.7478175860009895
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2915, Accuracy: 9240/9900 (93.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4395/4717 (93.1736%), train_poison_data_count: 370
Global model norm: 42.73487631104497.
Norm before scaling: 42.72800026722451. Distance: 1.656447560745475
Total norm for 4 adversaries is: 42.72800026722451. distance: 1.656447560745475
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3052, Accuracy: 9134/9900 (92.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4669/5066 (92.1634%), train_poison_data_count: 400
Global model norm: 42.73487631104497.
Norm before scaling: 42.73329808972156. Distance: 1.8254844963023473
Total norm for 4 adversaries is: 42.73329808972156. distance: 1.8254844963023473
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1744, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4046/4501 (89.8911%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4028/4501 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9915, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4035/4511 (89.4480%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4105/4511 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9973, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3910/4354 (89.8025%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3418/4354 (78.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5895, Accuracy: 4428/10000 (44.2800%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3960/4346 (91.1183%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4028/4346 (92.6829%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8419, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4245/4707 (90.1848%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4263/4707 (90.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9093, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4948/5591 (88.4994%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4919/5591 (87.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9647, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4145/4647 (89.1973%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8119, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4116/4538 (90.7007%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4179/4538 (92.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9469, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4384/4934 (88.8529%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4379/4934 (88.7515%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1292, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4337/4804 (90.2789%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4178/4804 (86.9692%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0725, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5682/6263 (90.7233%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5668/6263 (90.4998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2820, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3972/4481 (88.6409%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3936/4481 (87.8375%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9996, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4445/5063 (87.7938%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4396/5063 (86.8260%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1125, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3749/4223 (88.7758%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3866/4223 (91.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9574, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4062/4441 (91.4659%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4104/4441 (92.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0181, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3404/3756 (90.6283%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3479/3756 (92.6251%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8950, Accuracy: 5624/10000 (56.2400%)
time spent on training: 270.9054071903229
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1177, Accuracy: 7011/10000 (70.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1898, Accuracy: 5349/9900 (54.0303%)
Done in 301.8630316257477 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4581/4885 (93.7769%), train_poison_data_count: 385
Global model norm: 42.758525511367324.
Norm before scaling: 42.751259233098914. Distance: 1.6700760619607644
Total norm for 4 adversaries is: 42.751259233098914. distance: 1.6700760619607644
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1295, Accuracy: 9584/9900 (96.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4933/5305 (92.9877%), train_poison_data_count: 415
Global model norm: 42.758525511367324.
Norm before scaling: 42.75521658139361. Distance: 1.844663426059422
Total norm for 4 adversaries is: 42.75521658139361. distance: 1.844663426059422
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0659, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.758525511367324.
Norm before scaling: 42.75219720916034. Distance: 1.6249715362403456
Total norm for 4 adversaries is: 42.75219720916034. distance: 1.6249715362403456
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2018, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4718/5066 (93.1307%), train_poison_data_count: 400
Global model norm: 42.758525511367324.
Norm before scaling: 42.75288675834504. Distance: 1.7573526416715404
Total norm for 4 adversaries is: 42.75288675834504. distance: 1.7573526416715404
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1956, Accuracy: 9412/9900 (95.0707%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4484/5244 (85.5072%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4576/5244 (87.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9789, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4433/4928 (89.9554%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4432/4928 (89.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8990, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3430/3804 (90.1682%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9209, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3651/4013 (90.9793%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8336, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3640/4158 (87.5421%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3619/4158 (87.0370%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8499, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5114/5582 (91.6159%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4997/5582 (89.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1072, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9692, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3910/4354 (89.8025%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3541/4354 (81.3275%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.7115, Accuracy: 4505/10000 (45.0500%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4056/4433 (91.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0293, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3253/3646 (89.2211%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3322/3646 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8389, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4097/4518 (90.6817%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4093/4518 (90.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0452, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3873/4235 (91.4522%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3790/4235 (89.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2259, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4007/4362 (91.8615%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3896/4362 (89.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1547, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4879/5392 (90.4859%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4769/5392 (88.4458%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1313, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4926/5591 (88.1059%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4925/5591 (88.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1463, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3411/3756 (90.8147%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3477/3756 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9584, Accuracy: 5627/10000 (56.2700%)
time spent on training: 273.1880433559418
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1256, Accuracy: 7000/10000 (70.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9554, Accuracy: 5776/9900 (58.3434%)
Done in 303.8945734500885 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.78173078847807.
Norm before scaling: 42.77366795029244. Distance: 1.6791696149296904
Total norm for 4 adversaries is: 42.77366795029244. distance: 1.6791696149296904
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0931, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
